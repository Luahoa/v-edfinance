
> api@0.0.1 test C:\Users\luaho\Demo project\v-edfinance\apps\api
> vitest run "--run" "--reporter=verbose"


[1m[7m[36m RUN [39m[27m[22m [36mv2.1.9 [39m[90mC:/Users/luaho/Demo project/v-edfinance/apps/api[39m

[90mstdout[2m | src/modules/simulation/market-simulation.service.spec.ts[2m > [22m[2mMarket Simulation Service - Comprehensive Test Suite[2m > [22m[2mStock/Crypto Price Simulation[2m > [22m[2mVirtual Portfolio Creation[2m > [22m[2mshould create new portfolio with default balance for new user
[22m[39mðŸ§¹ Cleaning up after test...

[90mstdout[2m | src/modules/simulation/market-simulation.service.spec.ts[2m > [22m[2mMarket Simulation Service - Comprehensive Test Suite[2m > [22m[2mStock/Crypto Price Simulation[2m > [22m[2mVirtual Portfolio Creation[2m > [22m[2mshould return existing portfolio for existing user
[22m[39mðŸ§¹ Cleaning up after test...

[90mstdout[2m | src/modules/simulation/market-simulation.service.spec.ts[2m > [22m[2mMarket Simulation Service - Comprehensive Test Suite[2m > [22m[2mStock/Crypto Price Simulation[2m > [22m[2mStock Trading - BUY Operations[2m > [22m[2mshould execute BUY trade for stock with sufficient balance
[22m[39mðŸ§¹ Cleaning up after test...

[90mstdout[2m | src/modules/simulation/market-simulation.service.spec.ts[2m > [22m[2mMarket Simulation Service - Comprehensive Test Suite[2m > [22m[2mStock/Crypto Price Simulation[2m > [22m[2mStock Trading - BUY Operations[2m > [22m[2mshould accumulate stock holdings on multiple BUY trades
[22m[39mðŸ§¹ Cleaning up after test...

[90mstdout[2m | src/modules/simulation/market-simulation.service.spec.ts[2m > [22m[2mMarket Simulation Service - Comprehensive Test Suite[2m > [22m[2mStock/Crypto Price Simulation[2m > [22m[2mStock Trading - BUY Operations[2m > [22m[2mshould throw error when balance insufficient for BUY trade
[22m[39mðŸ§¹ Cleaning up after test...

[90mstdout[2m | src/modules/simulation/market-simulation.service.spec.ts[2m > [22m[2mMarket Simulation Service - Comprehensive Test Suite[2m > [22m[2mStock/Crypto Price Simulation[2m > [22m[2mCrypto Trading - BUY Operations[2m > [22m[2mshould execute BUY trade for Bitcoin
[22m[39mðŸ§¹ Cleaning up after test...

[90mstdout[2m | src/modules/simulation/market-simulation.service.spec.ts[2m > [22m[2mMarket Simulation Service - Comprehensive Test Suite[2m > [22m[2mStock/Crypto Price Simulation[2m > [22m[2mCrypto Trading - BUY Operations[2m > [22m[2mshould execute BUY trade for Ethereum
[22m[39mðŸ§¹ Cleaning up after test...

[90mstdout[2m | src/modules/simulation/market-simulation.service.spec.ts[2m > [22m[2mMarket Simulation Service - Comprehensive Test Suite[2m > [22m[2mStock/Crypto Price Simulation[2m > [22m[2mCrypto Trading - BUY Operations[2m > [22m[2mshould handle fractional crypto amounts
[22m[39mðŸ§¹ Cleaning up after test...

[90mstdout[2m | src/modules/simulation/market-simulation.service.spec.ts[2m > [22m[2mMarket Simulation Service - Comprehensive Test Suite[2m > [22m[2mStock/Crypto Price Simulation[2m > [22m[2mAsset Trading - SELL Operations[2m > [22m[2mshould execute SELL trade with sufficient assets
[22m[39mðŸ§¹ Cleaning up after test...

[90mstdout[2m | src/modules/simulation/market-simulation.service.spec.ts[2m > [22m[2mMarket Simulation Service - Comprehensive Test Suite[2m > [22m[2mStock/Crypto Price Simulation[2m > [22m[2mAsset Trading - SELL Operations[2m > [22m[2mshould remove asset from portfolio when fully sold
[22m[39mðŸ§¹ Cleaning up after test...

[90mstdout[2m | src/modules/simulation/market-simulation.service.spec.ts[2m > [22m[2mMarket Simulation Service - Comprehensive Test Suite[2m > [22m[2mStock/Crypto Price Simulation[2m > [22m[2mAsset Trading - SELL Operations[2m > [22m[2mshould throw error when trying to sell more than owned
[22m[39mðŸ§¹ Cleaning up after test...

[90mstdout[2m | src/modules/simulation/market-simulation.service.spec.ts[2m > [22m[2mMarket Simulation Service - Comprehensive Test Suite[2m > [22m[2mStock/Crypto Price Simulation[2m > [22m[2mAsset Trading - SELL Operations[2m > [22m[2mshould throw error when trying to sell non-existent asset
[22m[39mðŸ§¹ Cleaning up after test...

[90mstdout[2m | src/modules/simulation/market-simulation.service.spec.ts[2m > [22m[2mMarket Simulation Service - Comprehensive Test Suite[2m > [22m[2mStock/Crypto Price Simulation[2m > [22m[2mMulti-Asset Portfolio Management[2m > [22m[2mshould handle diverse portfolio with multiple stocks and crypto
[22m[39mðŸ§¹ Cleaning up after test...

[90mstdout[2m | src/modules/simulation/market-simulation.service.spec.ts[2m > [22m[2mMarket Simulation Service - Comprehensive Test Suite[2m > [22m[2mScenario-Based Predictions[2m > [22m[2mLife Scenario Generation[2m > [22m[2mshould start life scenario with AI-generated event
[22m[39mðŸ§¹ Cleaning up after test...

[90mstdout[2m | src/modules/simulation/market-simulation.service.spec.ts[2m > [22m[2mMarket Simulation Service - Comprehensive Test Suite[2m > [22m[2mScenario-Based Predictions[2m > [22m[2mLife Scenario Generation[2m > [22m[2mshould handle AI response with code block formatting
[22m[39mðŸ§¹ Cleaning up after test...

[90mstdout[2m | src/modules/simulation/market-simulation.service.spec.ts[2m > [22m[2mMarket Simulation Service - Comprehensive Test Suite[2m > [22m[2mScenario-Based Predictions[2m > [22m[2mLife Scenario Continuation[2m > [22m[2mshould continue scenario based on user choice
[22m[39mðŸ§¹ Cleaning up after test...

[90mstdout[2m | src/modules/simulation/market-simulation.service.spec.ts[2m > [22m[2mMarket Simulation Service - Comprehensive Test Suite[2m > [22m[2mScenario-Based Predictions[2m > [22m[2mLife Scenario Continuation[2m > [22m[2mshould throw error for invalid scenario
[22m[39mðŸ§¹ Cleaning up after test...

[90mstdout[2m | src/modules/simulation/market-simulation.service.spec.ts[2m > [22m[2mMarket Simulation Service - Comprehensive Test Suite[2m > [22m[2mScenario-Based Predictions[2m > [22m[2mLife Scenario Continuation[2m > [22m[2mshould throw error for mismatched userId
[22m[39mðŸ§¹ Cleaning up after test...

[90mstdout[2m | src/modules/simulation/market-simulation.service.spec.ts[2m > [22m[2mMarket Simulation Service - Comprehensive Test Suite[2m > [22m[2mScenario-Based Predictions[2m > [22m[2mLife Scenario Continuation[2m > [22m[2mshould throw error for invalid choice
[22m[39mðŸ§¹ Cleaning up after test...

[90mstdout[2m | src/modules/simulation/market-simulation.service.spec.ts[2m > [22m[2mMarket Simulation Service - Comprehensive Test Suite[2m > [22m[2mScenario-Based Predictions[2m > [22m[2mLife Scenario Continuation[2m > [22m[2mshould occasionally age the user during scenario progression
[22m[39mðŸ§¹ Cleaning up after test...

[90mstdout[2m | src/modules/simulation/market-simulation.service.spec.ts[2m > [22m[2mMarket Simulation Service - Comprehensive Test Suite[2m > [22m[2mScenario-Based Predictions[2m > [22m[2mBudget Decision Scenarios[2m > [22m[2mshould validate optimal 50/30/20 budget allocation
[22m[39mðŸ§¹ Cleaning up after test...

[90mstdout[2m | src/modules/simulation/market-simulation.service.spec.ts[2m > [22m[2mMarket Simulation Service - Comprehensive Test Suite[2m > [22m[2mScenario-Based Predictions[2m > [22m[2mBudget Decision Scenarios[2m > [22m[2mshould warn about high wants allocation
[22m[39mðŸ§¹ Cleaning up after test...

[90mstdout[2m | src/modules/simulation/market-simulation.service.spec.ts[2m > [22m[2mMarket Simulation Service - Comprehensive Test Suite[2m > [22m[2mScenario-Based Predictions[2m > [22m[2mBudget Decision Scenarios[2m > [22m[2mshould warn about low savings allocation
[22m[39mðŸ§¹ Cleaning up after test...

[90mstdout[2m | src/modules/simulation/market-simulation.service.spec.ts[2m > [22m[2mMarket Simulation Service - Comprehensive Test Suite[2m > [22m[2mScenario-Based Predictions[2m > [22m[2mBudget Decision Scenarios[2m > [22m[2mshould throw error when allocation does not sum to 100
[22m[39mðŸ§¹ Cleaning up after test...

[90mstdout[2m | src/modules/simulation/market-simulation.service.spec.ts[2m > [22m[2mMarket Simulation Service - Comprehensive Test Suite[2m > [22m[2mScenario-Based Predictions[2m > [22m[2mBudget Decision Scenarios[2m > [22m[2mshould provide loss aversion nudge
[22m[39mðŸ§¹ Cleaning up after test...

[90mstdout[2m | src/modules/simulation/market-simulation.service.spec.ts[2m > [22m[2mMarket Simulation Service - Comprehensive Test Suite[2m > [22m[2mScenario-Based Predictions[2m > [22m[2mFinancial Stress Test Scenarios[2m > [22m[2mshould calculate survival months accurately
[22m[39mðŸ§¹ Cleaning up after test...

[90mstdout[2m | src/modules/simulation/market-simulation.service.spec.ts[2m > [22m[2mMarket Simulation Service - Comprehensive Test Suite[2m > [22m[2mScenario-Based Predictions[2m > [22m[2mFinancial Stress Test Scenarios[2m > [22m[2mshould calculate inflation impact on survival
[22m[39mðŸ§¹ Cleaning up after test...

[90mstdout[2m | src/modules/simulation/market-simulation.service.spec.ts[2m > [22m[2mMarket Simulation Service - Comprehensive Test Suite[2m > [22m[2mScenario-Based Predictions[2m > [22m[2mFinancial Stress Test Scenarios[2m > [22m[2mshould emit nudge request during stress test
[22m[39mðŸ§¹ Cleaning up after test...

[90mstdout[2m | src/modules/simulation/market-simulation.service.spec.ts[2m > [22m[2mMarket Simulation Service - Comprehensive Test Suite[2m > [22m[2mScenario-Based Predictions[2m > [22m[2mFinancial Stress Test Scenarios[2m > [22m[2mshould provide social proof nudge
[22m[39mðŸ§¹ Cleaning up after test...

[90mstdout[2m | src/modules/simulation/market-simulation.service.spec.ts[2m > [22m[2mMarket Simulation Service - Comprehensive Test Suite[2m > [22m[2mMulti-Market Localization[2m > [22m[2mLong-Term Impact Calculations[2m > [22m[2mshould provide impact statements in Vietnamese (VI)
[22m[39mðŸ§¹ Cleaning up after test...

[90mstdout[2m | src/modules/simulation/market-simulation.service.spec.ts[2m > [22m[2mMarket Simulation Service - Comprehensive Test Suite[2m > [22m[2mMulti-Market Localization[2m > [22m[2mLong-Term Impact Calculations[2m > [22m[2mshould provide impact statements in English (EN)
[22m[39mðŸ§¹ Cleaning up after test...

[90mstdout[2m | src/modules/simulation/market-simulation.service.spec.ts[2m > [22m[2mMarket Simulation Service - Comprehensive Test Suite[2m > [22m[2mMulti-Market Localization[2m > [22m[2mLong-Term Impact Calculations[2m > [22m[2mshould provide impact statements in Chinese (ZH)
[22m[39mðŸ§¹ Cleaning up after test...

[90mstdout[2m | src/modules/simulation/market-simulation.service.spec.ts[2m > [22m[2mMarket Simulation Service - Comprehensive Test Suite[2m > [22m[2mMulti-Market Localization[2m > [22m[2mLong-Term Impact Calculations[2m > [22m[2mshould calculate future value with 8% annual return
[22m[39mðŸ§¹ Cleaning up after test...

[90mstdout[2m | src/modules/simulation/market-simulation.service.spec.ts[2m > [22m[2mMarket Simulation Service - Comprehensive Test Suite[2m > [22m[2mMulti-Market Localization[2m > [22m[2mLong-Term Impact Calculations[2m > [22m[2mshould handle custom year periods
[22m[39mðŸ§¹ Cleaning up after test...

[90mstdout[2m | src/modules/simulation/market-simulation.service.spec.ts[2m > [22m[2mMarket Simulation Service - Comprehensive Test Suite[2m > [22m[2mMulti-Market Localization[2m > [22m[2mLong-Term Impact Calculations[2m > [22m[2mshould emit nudge request for budgeting context
[22m[39mðŸ§¹ Cleaning up after test...

[90mstdout[2m | src/modules/simulation/market-simulation.service.spec.ts[2m > [22m[2mMarket Simulation Service - Comprehensive Test Suite[2m > [22m[2mMulti-Market Localization[2m > [22m[2mMarket-Specific Currency Handling[2m > [22m[2mshould handle VND (Vietnamese Dong) amounts
[22m[39mðŸ§¹ Cleaning up after test...

[90mstdout[2m | src/modules/simulation/market-simulation.service.spec.ts[2m > [22m[2mMarket Simulation Service - Comprehensive Test Suite[2m > [22m[2mMulti-Market Localization[2m > [22m[2mMarket-Specific Currency Handling[2m > [22m[2mshould format large VND amounts with localization
[22m[39mðŸ§¹ Cleaning up after test...

[90mstdout[2m | src/modules/simulation/market-simulation.service.spec.ts[2m > [22m[2mMarket Simulation Service - Comprehensive Test Suite[2m > [22m[2mJSONB Market Data Validation[2m > [22m[2mPortfolio Assets Validation[2m > [22m[2mshould validate JSONB portfolio assets on BUY trade
[22m[39mðŸ§¹ Cleaning up after test...

[90mstdout[2m | src/modules/simulation/market-simulation.service.spec.ts[2m > [22m[2mMarket Simulation Service - Comprehensive Test Suite[2m > [22m[2mJSONB Market Data Validation[2m > [22m[2mPortfolio Assets Validation[2m > [22m[2mshould validate JSONB portfolio assets on SELL trade
[22m[39mðŸ§¹ Cleaning up after test...

[90mstdout[2m | src/modules/simulation/market-simulation.service.spec.ts[2m > [22m[2mMarket Simulation Service - Comprehensive Test Suite[2m > [22m[2mJSONB Market Data Validation[2m > [22m[2mPortfolio Assets Validation[2m > [22m[2mshould validate complex multi-asset portfolio
[22m[39mðŸ§¹ Cleaning up after test...

[90mstdout[2m | src/modules/simulation/market-simulation.service.spec.ts[2m > [22m[2mMarket Simulation Service - Comprehensive Test Suite[2m > [22m[2mJSONB Market Data Validation[2m > [22m[2mSimulation Status Validation[2m > [22m[2mshould validate JSONB simulation status on scenario start
[22m[39mðŸ§¹ Cleaning up after test...

[90mstdout[2m | src/modules/simulation/market-simulation.service.spec.ts[2m > [22m[2mMarket Simulation Service - Comprehensive Test Suite[2m > [22m[2mJSONB Market Data Validation[2m > [22m[2mSimulation Status Validation[2m > [22m[2mshould validate JSONB simulation status on scenario continuation
[22m[39mðŸ§¹ Cleaning up after test...

[90mstdout[2m | src/modules/simulation/market-simulation.service.spec.ts[2m > [22m[2mMarket Simulation Service - Comprehensive Test Suite[2m > [22m[2mJSONB Market Data Validation[2m > [22m[2mSimulation Event Validation[2m > [22m[2mshould validate JSONB event structure
[22m[39mðŸ§¹ Cleaning up after test...

[90mstdout[2m | src/modules/simulation/market-simulation.service.spec.ts[2m > [22m[2mMarket Simulation Service - Comprehensive Test Suite[2m > [22m[2mJSONB Market Data Validation[2m > [22m[2mSimulation Decisions Validation[2m > [22m[2mshould validate JSONB decisions array
[22m[39mðŸ§¹ Cleaning up after test...

[90mstdout[2m | src/modules/simulation/market-simulation.service.spec.ts[2m > [22m[2mMarket Simulation Service - Comprehensive Test Suite[2m > [22m[2mCommitment Device Market Scenarios[2m > [22m[2mGoal-Based Savings[2m > [22m[2mshould create market-linked commitment for retirement
[22m[39mðŸ§¹ Cleaning up after test...

[90mstdout[2m | src/modules/simulation/market-simulation.service.spec.ts[2m > [22m[2mMarket Simulation Service - Comprehensive Test Suite[2m > [22m[2mCommitment Device Market Scenarios[2m > [22m[2mGoal-Based Savings[2m > [22m[2mshould throw error for insufficient balance
[22m[39mðŸ§¹ Cleaning up after test...

[90mstdout[2m | src/modules/simulation/market-simulation.service.spec.ts[2m > [22m[2mMarket Simulation Service - Comprehensive Test Suite[2m > [22m[2mCommitment Device Market Scenarios[2m > [22m[2mEarly Withdrawal Penalties[2m > [22m[2mshould apply 10% penalty for early withdrawal
[22m[39mðŸ§¹ Cleaning up after test...

[90mstdout[2m | src/modules/simulation/market-simulation.service.spec.ts[2m > [22m[2mMarket Simulation Service - Comprehensive Test Suite[2m > [22m[2mCommitment Device Market Scenarios[2m > [22m[2mEarly Withdrawal Penalties[2m > [22m[2mshould log early withdrawal behavior
[22m[39mðŸ§¹ Cleaning up after test...

[90mstdout[2m | src/modules/simulation/market-simulation.service.spec.ts[2m > [22m[2mMarket Simulation Service - Comprehensive Test Suite[2m > [22m[2mCommitment Device Market Scenarios[2m > [22m[2mEarly Withdrawal Penalties[2m > [22m[2mshould return full amount without penalty for on-time withdrawal
[22m[39mðŸ§¹ Cleaning up after test...

[90mstdout[2m | src/modules/simulation/market-simulation.service.spec.ts[2m > [22m[2mMarket Simulation Service - Comprehensive Test Suite[2m > [22m[2mCommitment Device Market Scenarios[2m > [22m[2mEarly Withdrawal Penalties[2m > [22m[2mshould use transaction for withdrawal process
[22m[39mðŸ§¹ Cleaning up after test...

[90mstdout[2m | src/modules/simulation/market-simulation.service.spec.ts[2m > [22m[2mMarket Simulation Service - Comprehensive Test Suite[2m > [22m[2mCommitment Device Market Scenarios[2m > [22m[2mEarly Withdrawal Penalties[2m > [22m[2mshould throw error for invalid commitment
[22m[39mðŸ§¹ Cleaning up after test...

[90mstdout[2m | src/modules/simulation/market-simulation.service.spec.ts[2m > [22m[2mMarket Simulation Service - Comprehensive Test Suite[2m > [22m[2mCommitment Device Market Scenarios[2m > [22m[2mEarly Withdrawal Penalties[2m > [22m[2mshould throw error for mismatched user
[22m[39mðŸ§¹ Cleaning up after test...

 [32mâœ“[39m src/modules/simulation/market-simulation.service.spec.ts[2m > [22mMarket Simulation Service - Comprehensive Test Suite[2m > [22mStock/Crypto Price Simulation[2m > [22mVirtual Portfolio Creation[2m > [22mshould create new portfolio with default balance for new user
 [32mâœ“[39m src/modules/simulation/market-simulation.service.spec.ts[2m > [22mMarket Simulation Service - Comprehensive Test Suite[2m > [22mStock/Crypto Price Simulation[2m > [22mVirtual Portfolio Creation[2m > [22mshould return existing portfolio for existing user
 [32mâœ“[39m src/modules/simulation/market-simulation.service.spec.ts[2m > [22mMarket Simulation Service - Comprehensive Test Suite[2m > [22mStock/Crypto Price Simulation[2m > [22mStock Trading - BUY Operations[2m > [22mshould execute BUY trade for stock with sufficient balance
 [32mâœ“[39m src/modules/simulation/market-simulation.service.spec.ts[2m > [22mMarket Simulation Service - Comprehensive Test Suite[2m > [22mStock/Crypto Price Simulation[2m > [22mStock Trading - BUY Operations[2m > [22mshould accumulate stock holdings on multiple BUY trades
 [32mâœ“[39m src/modules/simulation/market-simulation.service.spec.ts[2m > [22mMarket Simulation Service - Comprehensive Test Suite[2m > [22mStock/Crypto Price Simulation[2m > [22mStock Trading - BUY Operations[2m > [22mshould throw error when balance insufficient for BUY trade
 [32mâœ“[39m src/modules/simulation/market-simulation.service.spec.ts[2m > [22mMarket Simulation Service - Comprehensive Test Suite[2m > [22mStock/Crypto Price Simulation[2m > [22mCrypto Trading - BUY Operations[2m > [22mshould execute BUY trade for Bitcoin
 [32mâœ“[39m src/modules/simulation/market-simulation.service.spec.ts[2m > [22mMarket Simulation Service - Comprehensive Test Suite[2m > [22mStock/Crypto Price Simulation[2m > [22mCrypto Trading - BUY Operations[2m > [22mshould execute BUY trade for Ethereum
 [32mâœ“[39m src/modules/simulation/market-simulation.service.spec.ts[2m > [22mMarket Simulation Service - Comprehensive Test Suite[2m > [22mStock/Crypto Price Simulation[2m > [22mCrypto Trading - BUY Operations[2m > [22mshould handle fractional crypto amounts
 [32mâœ“[39m src/modules/simulation/market-simulation.service.spec.ts[2m > [22mMarket Simulation Service - Comprehensive Test Suite[2m > [22mStock/Crypto Price Simulation[2m > [22mAsset Trading - SELL Operations[2m > [22mshould execute SELL trade with sufficient assets
 [32mâœ“[39m src/modules/simulation/market-simulation.service.spec.ts[2m > [22mMarket Simulation Service - Comprehensive Test Suite[2m > [22mStock/Crypto Price Simulation[2m > [22mAsset Trading - SELL Operations[2m > [22mshould remove asset from portfolio when fully sold
 [32mâœ“[39m src/modules/simulation/market-simulation.service.spec.ts[2m > [22mMarket Simulation Service - Comprehensive Test Suite[2m > [22mStock/Crypto Price Simulation[2m > [22mAsset Trading - SELL Operations[2m > [22mshould throw error when trying to sell more than owned
 [32mâœ“[39m src/modules/simulation/market-simulation.service.spec.ts[2m > [22mMarket Simulation Service - Comprehensive Test Suite[2m > [22mStock/Crypto Price Simulation[2m > [22mAsset Trading - SELL Operations[2m > [22mshould throw error when trying to sell non-existent asset
 [32mâœ“[39m src/modules/simulation/market-simulation.service.spec.ts[2m > [22mMarket Simulation Service - Comprehensive Test Suite[2m > [22mStock/Crypto Price Simulation[2m > [22mMulti-Asset Portfolio Management[2m > [22mshould handle diverse portfolio with multiple stocks and crypto
 [32mâœ“[39m src/modules/simulation/market-simulation.service.spec.ts[2m > [22mMarket Simulation Service - Comprehensive Test Suite[2m > [22mScenario-Based Predictions[2m > [22mLife Scenario Generation[2m > [22mshould start life scenario with AI-generated event
 [32mâœ“[39m src/modules/simulation/market-simulation.service.spec.ts[2m > [22mMarket Simulation Service - Comprehensive Test Suite[2m > [22mScenario-Based Predictions[2m > [22mLife Scenario Generation[2m > [22mshould handle AI response with code block formatting
 [32mâœ“[39m src/modules/simulation/market-simulation.service.spec.ts[2m > [22mMarket Simulation Service - Comprehensive Test Suite[2m > [22mScenario-Based Predictions[2m > [22mLife Scenario Continuation[2m > [22mshould continue scenario based on user choice
 [32mâœ“[39m src/modules/simulation/market-simulation.service.spec.ts[2m > [22mMarket Simulation Service - Comprehensive Test Suite[2m > [22mScenario-Based Predictions[2m > [22mLife Scenario Continuation[2m > [22mshould throw error for invalid scenario
 [32mâœ“[39m src/modules/simulation/market-simulation.service.spec.ts[2m > [22mMarket Simulation Service - Comprehensive Test Suite[2m > [22mScenario-Based Predictions[2m > [22mLife Scenario Continuation[2m > [22mshould throw error for mismatched userId
 [32mâœ“[39m src/modules/simulation/market-simulation.service.spec.ts[2m > [22mMarket Simulation Service - Comprehensive Test Suite[2m > [22mScenario-Based Predictions[2m > [22mLife Scenario Continuation[2m > [22mshould throw error for invalid choice
 [32mâœ“[39m src/modules/simulation/market-simulation.service.spec.ts[2m > [22mMarket Simulation Service - Comprehensive Test Suite[2m > [22mScenario-Based Predictions[2m > [22mLife Scenario Continuation[2m > [22mshould occasionally age the user during scenario progression
 [32mâœ“[39m src/modules/simulation/market-simulation.service.spec.ts[2m > [22mMarket Simulation Service - Comprehensive Test Suite[2m > [22mScenario-Based Predictions[2m > [22mBudget Decision Scenarios[2m > [22mshould validate optimal 50/30/20 budget allocation
 [32mâœ“[39m src/modules/simulation/market-simulation.service.spec.ts[2m > [22mMarket Simulation Service - Comprehensive Test Suite[2m > [22mScenario-Based Predictions[2m > [22mBudget Decision Scenarios[2m > [22mshould warn about high wants allocation
 [32mâœ“[39m src/modules/simulation/market-simulation.service.spec.ts[2m > [22mMarket Simulation Service - Comprehensive Test Suite[2m > [22mScenario-Based Predictions[2m > [22mBudget Decision Scenarios[2m > [22mshould warn about low savings allocation
 [32mâœ“[39m src/modules/simulation/market-simulation.service.spec.ts[2m > [22mMarket Simulation Service - Comprehensive Test Suite[2m > [22mScenario-Based Predictions[2m > [22mBudget Decision Scenarios[2m > [22mshould throw error when allocation does not sum to 100
 [32mâœ“[39m src/modules/simulation/market-simulation.service.spec.ts[2m > [22mMarket Simulation Service - Comprehensive Test Suite[2m > [22mScenario-Based Predictions[2m > [22mBudget Decision Scenarios[2m > [22mshould provide loss aversion nudge
 [32mâœ“[39m src/modules/simulation/market-simulation.service.spec.ts[2m > [22mMarket Simulation Service - Comprehensive Test Suite[2m > [22mScenario-Based Predictions[2m > [22mFinancial Stress Test Scenarios[2m > [22mshould calculate survival months accurately
 [32mâœ“[39m src/modules/simulation/market-simulation.service.spec.ts[2m > [22mMarket Simulation Service - Comprehensive Test Suite[2m > [22mScenario-Based Predictions[2m > [22mFinancial Stress Test Scenarios[2m > [22mshould calculate inflation impact on survival
 [32mâœ“[39m src/modules/simulation/market-simulation.service.spec.ts[2m > [22mMarket Simulation Service - Comprehensive Test Suite[2m > [22mScenario-Based Predictions[2m > [22mFinancial Stress Test Scenarios[2m > [22mshould emit nudge request during stress test
 [32mâœ“[39m src/modules/simulation/market-simulation.service.spec.ts[2m > [22mMarket Simulation Service - Comprehensive Test Suite[2m > [22mScenario-Based Predictions[2m > [22mFinancial Stress Test Scenarios[2m > [22mshould provide social proof nudge
 [32mâœ“[39m src/modules/simulation/market-simulation.service.spec.ts[2m > [22mMarket Simulation Service - Comprehensive Test Suite[2m > [22mMulti-Market Localization[2m > [22mLong-Term Impact Calculations[2m > [22mshould provide impact statements in Vietnamese (VI)
 [32mâœ“[39m src/modules/simulation/market-simulation.service.spec.ts[2m > [22mMarket Simulation Service - Comprehensive Test Suite[2m > [22mMulti-Market Localization[2m > [22mLong-Term Impact Calculations[2m > [22mshould provide impact statements in English (EN)
 [32mâœ“[39m src/modules/simulation/market-simulation.service.spec.ts[2m > [22mMarket Simulation Service - Comprehensive Test Suite[2m > [22mMulti-Market Localization[2m > [22mLong-Term Impact Calculations[2m > [22mshould provide impact statements in Chinese (ZH)
 [32mâœ“[39m src/modules/simulation/market-simulation.service.spec.ts[2m > [22mMarket Simulation Service - Comprehensive Test Suite[2m > [22mMulti-Market Localization[2m > [22mLong-Term Impact Calculations[2m > [22mshould calculate future value with 8% annual return
 [32mâœ“[39m src/modules/simulation/market-simulation.service.spec.ts[2m > [22mMarket Simulation Service - Comprehensive Test Suite[2m > [22mMulti-Market Localization[2m > [22mLong-Term Impact Calculations[2m > [22mshould handle custom year periods
 [32mâœ“[39m src/modules/simulation/market-simulation.service.spec.ts[2m > [22mMarket Simulation Service - Comprehensive Test Suite[2m > [22mMulti-Market Localization[2m > [22mLong-Term Impact Calculations[2m > [22mshould emit nudge request for budgeting context
 [32mâœ“[39m src/modules/simulation/market-simulation.service.spec.ts[2m > [22mMarket Simulation Service - Comprehensive Test Suite[2m > [22mMulti-Market Localization[2m > [22mMarket-Specific Currency Handling[2m > [22mshould handle VND (Vietnamese Dong) amounts
 [32mâœ“[39m src/modules/simulation/market-simulation.service.spec.ts[2m > [22mMarket Simulation Service - Comprehensive Test Suite[2m > [22mMulti-Market Localization[2m > [22mMarket-Specific Currency Handling[2m > [22mshould format large VND amounts with localization
 [32mâœ“[39m src/modules/simulation/market-simulation.service.spec.ts[2m > [22mMarket Simulation Service - Comprehensive Test Suite[2m > [22mJSONB Market Data Validation[2m > [22mPortfolio Assets Validation[2m > [22mshould validate JSONB portfolio assets on BUY trade
 [32mâœ“[39m src/modules/simulation/market-simulation.service.spec.ts[2m > [22mMarket Simulation Service - Comprehensive Test Suite[2m > [22mJSONB Market Data Validation[2m > [22mPortfolio Assets Validation[2m > [22mshould validate JSONB portfolio assets on SELL trade
 [32mâœ“[39m src/modules/simulation/market-simulation.service.spec.ts[2m > [22mMarket Simulation Service - Comprehensive Test Suite[2m > [22mJSONB Market Data Validation[2m > [22mPortfolio Assets Validation[2m > [22mshould validate complex multi-asset portfolio
 [32mâœ“[39m src/modules/simulation/market-simulation.service.spec.ts[2m > [22mMarket Simulation Service - Comprehensive Test Suite[2m > [22mJSONB Market Data Validation[2m > [22mSimulation Status Validation[2m > [22mshould validate JSONB simulation status on scenario start
 [32mâœ“[39m src/modules/simulation/market-simulation.service.spec.ts[2m > [22mMarket Simulation Service - Comprehensive Test Suite[2m > [22mJSONB Market Data Validation[2m > [22mSimulation Status Validation[2m > [22mshould validate JSONB simulation status on scenario continuation
 [32mâœ“[39m src/modules/simulation/market-simulation.service.spec.ts[2m > [22mMarket Simulation Service - Comprehensive Test Suite[2m > [22mJSONB Market Data Validation[2m > [22mSimulation Event Validation[2m > [22mshould validate JSONB event structure
 [32mâœ“[39m src/modules/simulation/market-simulation.service.spec.ts[2m > [22mMarket Simulation Service - Comprehensive Test Suite[2m > [22mJSONB Market Data Validation[2m > [22mSimulation Decisions Validation[2m > [22mshould validate JSONB decisions array
 [32mâœ“[39m src/modules/simulation/market-simulation.service.spec.ts[2m > [22mMarket Simulation Service - Comprehensive Test Suite[2m > [22mCommitment Device Market Scenarios[2m > [22mGoal-Based Savings[2m > [22mshould create market-linked commitment for retirement
 [32mâœ“[39m src/modules/simulation/market-simulation.service.spec.ts[2m > [22mMarket Simulation Service - Comprehensive Test Suite[2m > [22mCommitment Device Market Scenarios[2m > [22mGoal-Based Savings[2m > [22mshould throw error for insufficient balance
 [32mâœ“[39m src/modules/simulation/market-simulation.service.spec.ts[2m > [22mMarket Simulation Service - Comprehensive Test Suite[2m > [22mCommitment Device Market Scenarios[2m > [22mEarly Withdrawal Penalties[2m > [22mshould apply 10% penalty for early withdrawal
 [32mâœ“[39m src/modules/simulation/market-simulation.service.spec.ts[2m > [22mMarket Simulation Service - Comprehensive Test Suite[2m > [22mCommitment Device Market Scenarios[2m > [22mEarly Withdrawal Penalties[2m > [22mshould log early withdrawal behavior
 [32mâœ“[39m src/modules/simulation/market-simulation.service.spec.ts[2m > [22mMarket Simulation Service - Comprehensive Test Suite[2m > [22mCommitment Device Market Scenarios[2m > [22mEarly Withdrawal Penalties[2m > [22mshould return full amount without penalty for on-time withdrawal
 [32mâœ“[39m src/modules/simulation/market-simulation.service.spec.ts[2m > [22mMarket Simulation Service - Comprehensive Test Suite[2m > [22mCommitment Device Market Scenarios[2m > [22mEarly Withdrawal Penalties[2m > [22mshould use transaction for withdrawal process
 [32mâœ“[39m src/modules/simulation/market-simulation.service.spec.ts[2m > [22mMarket Simulation Service - Comprehensive Test Suite[2m > [22mCommitment Device Market Scenarios[2m > [22mEarly Withdrawal Penalties[2m > [22mshould throw error for invalid commitment
 [32mâœ“[39m src/modules/simulation/market-simulation.service.spec.ts[2m > [22mMarket Simulation Service - Comprehensive Test Suite[2m > [22mCommitment Device Market Scenarios[2m > [22mEarly Withdrawal Penalties[2m > [22mshould throw error for mismatched user
[90mstdout[2m | src/modules/simulation/market-simulation.service.spec.ts
[22m[39mðŸ”§ Vitest setup: Starting MSW mock server...
âœ… Vitest teardown complete

[90mstdout[2m | src/ai/ai.service.spec.ts[2m > [22m[2mAiService[2m > [22m[2monModuleInit[2m > [22m[2mshould initialize with GEMINI_API_KEY from ConfigService
[22m[39mðŸ§¹ Cleaning up after test...

[90mstdout[2m | src/ai/ai.service.spec.ts[2m > [22m[2mAiService[2m > [22m[2monModuleInit[2m > [22m[2mshould log error when GEMINI_API_KEY is missing
[22m[39mðŸ§¹ Cleaning up after test...

[90mstdout[2m | src/ai/ai.service.spec.ts[2m > [22m[2mAiService[2m > [22m[2monModuleInit[2m > [22m[2mshould fallback to process.env when ConfigService is unavailable
[22m[39mðŸ§¹ Cleaning up after test...

[90mstdout[2m | src/ai/ai.service.spec.ts[2m > [22m[2mAiService[2m > [22m[2mRate Limiting & Token Budgeting[2m > [22m[2mshould throw ForbiddenException when rate limit exceeded
[22m[39mðŸ§¹ Cleaning up after test...

[90mstdout[2m | src/ai/ai.service.spec.ts[2m > [22m[2mAiService[2m > [22m[2mRate Limiting & Token Budgeting[2m > [22m[2mshould throw ForbiddenException when monthly budget exceeded
[22m[39mðŸ§¹ Cleaning up after test...

[90mstdout[2m | src/ai/ai.service.spec.ts[2m > [22m[2mAiService[2m > [22m[2mRate Limiting & Token Budgeting[2m > [22m[2mshould return total tokens used when limits not exceeded
[22m[39mðŸ§¹ Cleaning up after test...

[90mstdout[2m | src/ai/ai.service.spec.ts[2m > [22m[2mAiService[2m > [22m[2mRate Limiting & Token Budgeting[2m > [22m[2mshould handle missing tokensUsed in payload
[22m[39mðŸ§¹ Cleaning up after test...

[90mstdout[2m | src/ai/ai.service.spec.ts[2m > [22m[2mAiService[2m > [22m[2mPII Masking[2m > [22m[2mshould mask email addresses
[22m[39mðŸ§¹ Cleaning up after test...

[90mstdout[2m | src/ai/ai.service.spec.ts[2m > [22m[2mAiService[2m > [22m[2mPII Masking[2m > [22m[2mshould mask displayName and fullName
[22m[39mðŸ§¹ Cleaning up after test...

[90mstdout[2m | src/ai/ai.service.spec.ts[2m > [22m[2mAiService[2m > [22m[2mPII Masking[2m > [22m[2mshould mask phone and address recursively
[22m[39mðŸ§¹ Cleaning up after test...

[90mstdout[2m | src/ai/ai.service.spec.ts[2m > [22m[2mAiService[2m > [22m[2mPII Masking[2m > [22m[2mshould handle null and undefined data
[22m[39mðŸ§¹ Cleaning up after test...

[90mstdout[2m | src/ai/ai.service.spec.ts[2m > [22m[2mAiService[2m > [22m[2mPII Masking[2m > [22m[2mshould mask short strings properly
[22m[39mðŸ§¹ Cleaning up after test...

[90mstdout[2m | src/ai/ai.service.spec.ts[2m > [22m[2mAiService[2m > [22m[2mThread Management[2m > [22m[2mshould create thread with title and module
[22m[39mðŸ§¹ Cleaning up after test...

[90mstdout[2m | src/ai/ai.service.spec.ts[2m > [22m[2mAiService[2m > [22m[2mThread Management[2m > [22m[2mshould create thread without module
[22m[39mðŸ§¹ Cleaning up after test...

[90mstdout[2m | src/ai/ai.service.spec.ts[2m > [22m[2mAiService[2m > [22m[2mThread Management[2m > [22m[2mshould get threads ordered by updatedAt desc
[22m[39mðŸ§¹ Cleaning up after test...

[90mstdout[2m | src/ai/ai.service.spec.ts[2m > [22m[2mAiService[2m > [22m[2mThread Management[2m > [22m[2mshould get messages ordered by createdAt asc
[22m[39mðŸ§¹ Cleaning up after test...

[90mstdout[2m | src/ai/ai.service.spec.ts[2m > [22m[2mAiService[2m > [22m[2mThread Management[2m > [22m[2mshould save message and update thread timestamp
[22m[39mðŸ§¹ Cleaning up after test...

[90mstdout[2m | src/ai/ai.service.spec.ts[2m > [22m[2mAiService[2m > [22m[2mCourse Advice Generation[2m > [22m[2mshould generate course advice with progress tracking
[22m[39mðŸ§¹ Cleaning up after test...

[90mstdout[2m | src/ai/ai.service.spec.ts[2m > [22m[2mAiService[2m > [22m[2mCourse Advice Generation[2m > [22m[2mshould use loss aversion for medium progress
[22m[39mðŸ§¹ Cleaning up after test...

[90mstdout[2m | src/ai/ai.service.spec.ts[2m > [22m[2mAiService[2m > [22m[2mCourse Advice Generation[2m > [22m[2mshould use goal gradient for near completion
[22m[39mðŸ§¹ Cleaning up after test...

[90mstdout[2m | src/ai/ai.service.spec.ts[2m > [22m[2mAiService[2m > [22m[2mCourse Advice Generation[2m > [22m[2mshould return fallback advice on JSON parse error
[22m[39mðŸ§¹ Cleaning up after test...

[90mstdout[2m | src/ai/ai.service.spec.ts[2m > [22m[2mAiService[2m > [22m[2mCourse Advice Generation[2m > [22m[2mshould check user AI usage before generating advice
[22m[39mðŸ§¹ Cleaning up after test...

[90mstdout[2m | src/ai/ai.service.spec.ts[2m > [22m[2mAiService[2m > [22m[2mCourse Advice Generation[2m > [22m[2mshould log token usage for advice generation
[22m[39mðŸ§¹ Cleaning up after test...

[90mstdout[2m | src/ai/ai.service.spec.ts[2m > [22m[2mAiService[2m > [22m[2mChat Response Generation[2m > [22m[2mshould generate response with context and history
[22m[39mðŸ§¹ Cleaning up after test...

[90mstdout[2m | src/ai/ai.service.spec.ts[2m > [22m[2mAiService[2m > [22m[2mChat Response Generation[2m > [22m[2mshould throw NotFoundException when thread not found
[22m[39mðŸ§¹ Cleaning up after test...

[90mstdout[2m | src/ai/ai.service.spec.ts[2m > [22m[2mAiService[2m > [22m[2mChat Response Generation[2m > [22m[2mshould summarize history when messages exceed threshold
[22m[39mðŸ§¹ Cleaning up after test...

[90mstdout[2m | src/ai/ai.service.spec.ts[2m > [22m[2mAiService[2m > [22m[2mChat Response Generation[2m > [22m[2mshould mask PII in user context
[22m[39mðŸ§¹ Cleaning up after test...

[90mstdout[2m | src/ai/ai.service.spec.ts[2m > [22m[2mAiService[2m > [22m[2mChat Response Generation[2m > [22m[2mshould log token usage after response
[22m[39mðŸ§¹ Cleaning up after test...

[90mstdout[2m | src/ai/ai.service.spec.ts[2m > [22m[2mAiService[2m > [22m[2mChat Response Generation[2m > [22m[2mshould parse action cards from response
[22m[39mðŸ§¹ Cleaning up after test...

[90mstdout[2m | src/ai/ai.service.spec.ts[2m > [22m[2mAiService[2m > [22m[2mChat Response Generation[2m > [22m[2mshould use cache for FAQ questions
[22m[39mðŸ§¹ Cleaning up after test...

[90mstdout[2m | src/ai/ai.service.spec.ts[2m > [22m[2mAiService[2m > [22m[2mChat Response Generation[2m > [22m[2mshould cache FAQ responses
[22m[39mðŸ§¹ Cleaning up after test...

[90mstdout[2m | src/ai/ai.service.spec.ts[2m > [22m[2mAiService[2m > [22m[2mHelper Functions[2m > [22m[2mparseActionCards[2m > [22m[2mshould parse valid action card JSON
[22m[39mðŸ§¹ Cleaning up after test...

[90mstdout[2m | src/ai/ai.service.spec.ts[2m > [22m[2mAiService[2m > [22m[2mHelper Functions[2m > [22m[2mparseActionCards[2m > [22m[2mshould handle text without action cards
[22m[39mðŸ§¹ Cleaning up after test...

[90mstdout[2m | src/ai/ai.service.spec.ts[2m > [22m[2mAiService[2m > [22m[2mHelper Functions[2m > [22m[2mparseActionCards[2m > [22m[2mshould handle invalid JSON in action card
[22m[39mðŸ§¹ Cleaning up after test...

[90mstdout[2m | src/ai/ai.service.spec.ts[2m > [22m[2mAiService[2m > [22m[2mHelper Functions[2m > [22m[2mgenerateCacheKey[2m > [22m[2mshould generate consistent hash for same prompt
[22m[39mðŸ§¹ Cleaning up after test...

[90mstdout[2m | src/ai/ai.service.spec.ts[2m > [22m[2mAiService[2m > [22m[2mHelper Functions[2m > [22m[2mgenerateCacheKey[2m > [22m[2mshould be case-insensitive
[22m[39mðŸ§¹ Cleaning up after test...

[90mstdout[2m | src/ai/ai.service.spec.ts[2m > [22m[2mAiService[2m > [22m[2mHelper Functions[2m > [22m[2mgenerateCacheKey[2m > [22m[2mshould trim whitespace
[22m[39mðŸ§¹ Cleaning up after test...

[90mstdout[2m | src/ai/ai.service.spec.ts[2m > [22m[2mAiService[2m > [22m[2mHelper Functions[2m > [22m[2mclassifyIntent[2m > [22m[2mshould classify FAQ questions (Vietnamese)
[22m[39mðŸ§¹ Cleaning up after test...

[90mstdout[2m | src/ai/ai.service.spec.ts[2m > [22m[2mAiService[2m > [22m[2mHelper Functions[2m > [22m[2mclassifyIntent[2m > [22m[2mshould classify FAQ questions (English)
[22m[39mðŸ§¹ Cleaning up after test...

[90mstdout[2m | src/ai/ai.service.spec.ts[2m > [22m[2mAiService[2m > [22m[2mHelper Functions[2m > [22m[2mclassifyIntent[2m > [22m[2mshould classify personalized queries
[22m[39mðŸ§¹ Cleaning up after test...

[90mstdout[2m | src/ai/ai.service.spec.ts[2m > [22m[2mAiService[2m > [22m[2mHelper Functions[2m > [22m[2mclassifyIntent[2m > [22m[2mshould handle mixed case
[22m[39mðŸ§¹ Cleaning up after test...

[90mstdout[2m | src/ai/ai.service.spec.ts[2m > [22m[2mAiService[2m > [22m[2mHelper Functions[2m > [22m[2msummarizeHistory[2m > [22m[2mshould summarize message history
[22m[39mðŸ§¹ Cleaning up after test...

[90mstdout[2m | src/ai/ai.service.spec.ts[2m > [22m[2mAiService[2m > [22m[2mHelper Functions[2m > [22m[2msummarizeHistory[2m > [22m[2mshould return empty string on error
[22m[39mðŸ§¹ Cleaning up after test...

[90mstdout[2m | src/ai/ai.service.spec.ts[2m > [22m[2mAiService[2m > [22m[2mHelper Functions[2m > [22m[2msummarizeHistory[2m > [22m[2mshould reverse messages for chronological order
[22m[39mðŸ§¹ Cleaning up after test...

[90mstdout[2m | src/ai/ai.service.spec.ts[2m > [22m[2mAiService[2m > [22m[2mError Handling[2m > [22m[2mshould handle Gemini API timeout
[22m[39mðŸ§¹ Cleaning up after test...

[90mstdout[2m | src/ai/ai.service.spec.ts[2m > [22m[2mAiService[2m > [22m[2mError Handling[2m > [22m[2mshould handle invalid course ID in getCourseAdvice
[22m[39mðŸ§¹ Cleaning up after test...

 [32mâœ“[39m src/ai/ai.service.spec.ts[2m > [22mAiService[2m > [22monModuleInit[2m > [22mshould initialize with GEMINI_API_KEY from ConfigService
 [32mâœ“[39m src/ai/ai.service.spec.ts[2m > [22mAiService[2m > [22monModuleInit[2m > [22mshould log error when GEMINI_API_KEY is missing
 [32mâœ“[39m src/ai/ai.service.spec.ts[2m > [22mAiService[2m > [22monModuleInit[2m > [22mshould fallback to process.env when ConfigService is unavailable
 [32mâœ“[39m src/ai/ai.service.spec.ts[2m > [22mAiService[2m > [22mRate Limiting & Token Budgeting[2m > [22mshould throw ForbiddenException when rate limit exceeded
 [32mâœ“[39m src/ai/ai.service.spec.ts[2m > [22mAiService[2m > [22mRate Limiting & Token Budgeting[2m > [22mshould throw ForbiddenException when monthly budget exceeded
 [32mâœ“[39m src/ai/ai.service.spec.ts[2m > [22mAiService[2m > [22mRate Limiting & Token Budgeting[2m > [22mshould return total tokens used when limits not exceeded
 [32mâœ“[39m src/ai/ai.service.spec.ts[2m > [22mAiService[2m > [22mRate Limiting & Token Budgeting[2m > [22mshould handle missing tokensUsed in payload
 [32mâœ“[39m src/ai/ai.service.spec.ts[2m > [22mAiService[2m > [22mPII Masking[2m > [22mshould mask email addresses
 [32mâœ“[39m src/ai/ai.service.spec.ts[2m > [22mAiService[2m > [22mPII Masking[2m > [22mshould mask displayName and fullName
 [32mâœ“[39m src/ai/ai.service.spec.ts[2m > [22mAiService[2m > [22mPII Masking[2m > [22mshould mask phone and address recursively
 [32mâœ“[39m src/ai/ai.service.spec.ts[2m > [22mAiService[2m > [22mPII Masking[2m > [22mshould handle null and undefined data
 [32mâœ“[39m src/ai/ai.service.spec.ts[2m > [22mAiService[2m > [22mPII Masking[2m > [22mshould mask short strings properly
 [32mâœ“[39m src/ai/ai.service.spec.ts[2m > [22mAiService[2m > [22mThread Management[2m > [22mshould create thread with title and module
 [32mâœ“[39m src/ai/ai.service.spec.ts[2m > [22mAiService[2m > [22mThread Management[2m > [22mshould create thread without module
 [32mâœ“[39m src/ai/ai.service.spec.ts[2m > [22mAiService[2m > [22mThread Management[2m > [22mshould get threads ordered by updatedAt desc
 [32mâœ“[39m src/ai/ai.service.spec.ts[2m > [22mAiService[2m > [22mThread Management[2m > [22mshould get messages ordered by createdAt asc
 [32mâœ“[39m src/ai/ai.service.spec.ts[2m > [22mAiService[2m > [22mThread Management[2m > [22mshould save message and update thread timestamp
 [32mâœ“[39m src/ai/ai.service.spec.ts[2m > [22mAiService[2m > [22mCourse Advice Generation[2m > [22mshould generate course advice with progress tracking
 [32mâœ“[39m src/ai/ai.service.spec.ts[2m > [22mAiService[2m > [22mCourse Advice Generation[2m > [22mshould use loss aversion for medium progress
 [32mâœ“[39m src/ai/ai.service.spec.ts[2m > [22mAiService[2m > [22mCourse Advice Generation[2m > [22mshould use goal gradient for near completion
 [32mâœ“[39m src/ai/ai.service.spec.ts[2m > [22mAiService[2m > [22mCourse Advice Generation[2m > [22mshould return fallback advice on JSON parse error
 [32mâœ“[39m src/ai/ai.service.spec.ts[2m > [22mAiService[2m > [22mCourse Advice Generation[2m > [22mshould check user AI usage before generating advice
 [32mâœ“[39m src/ai/ai.service.spec.ts[2m > [22mAiService[2m > [22mCourse Advice Generation[2m > [22mshould log token usage for advice generation
 [32mâœ“[39m src/ai/ai.service.spec.ts[2m > [22mAiService[2m > [22mChat Response Generation[2m > [22mshould generate response with context and history
 [32mâœ“[39m src/ai/ai.service.spec.ts[2m > [22mAiService[2m > [22mChat Response Generation[2m > [22mshould throw NotFoundException when thread not found
 [32mâœ“[39m src/ai/ai.service.spec.ts[2m > [22mAiService[2m > [22mChat Response Generation[2m > [22mshould summarize history when messages exceed threshold
 [32mâœ“[39m src/ai/ai.service.spec.ts[2m > [22mAiService[2m > [22mChat Response Generation[2m > [22mshould mask PII in user context
 [32mâœ“[39m src/ai/ai.service.spec.ts[2m > [22mAiService[2m > [22mChat Response Generation[2m > [22mshould log token usage after response
 [32mâœ“[39m src/ai/ai.service.spec.ts[2m > [22mAiService[2m > [22mChat Response Generation[2m > [22mshould parse action cards from response
 [32mâœ“[39m src/ai/ai.service.spec.ts[2m > [22mAiService[2m > [22mChat Response Generation[2m > [22mshould use cache for FAQ questions
 [32mâœ“[39m src/ai/ai.service.spec.ts[2m > [22mAiService[2m > [22mChat Response Generation[2m > [22mshould cache FAQ responses
 [32mâœ“[39m src/ai/ai.service.spec.ts[2m > [22mAiService[2m > [22mHelper Functions[2m > [22mparseActionCards[2m > [22mshould parse valid action card JSON
 [32mâœ“[39m src/ai/ai.service.spec.ts[2m > [22mAiService[2m > [22mHelper Functions[2m > [22mparseActionCards[2m > [22mshould handle text without action cards
 [32mâœ“[39m src/ai/ai.service.spec.ts[2m > [22mAiService[2m > [22mHelper Functions[2m > [22mparseActionCards[2m > [22mshould handle invalid JSON in action card
 [32mâœ“[39m src/ai/ai.service.spec.ts[2m > [22mAiService[2m > [22mHelper Functions[2m > [22mgenerateCacheKey[2m > [22mshould generate consistent hash for same prompt
 [32mâœ“[39m src/ai/ai.service.spec.ts[2m > [22mAiService[2m > [22mHelper Functions[2m > [22mgenerateCacheKey[2m > [22mshould be case-insensitive
 [32mâœ“[39m src/ai/ai.service.spec.ts[2m > [22mAiService[2m > [22mHelper Functions[2m > [22mgenerateCacheKey[2m > [22mshould trim whitespace
 [32mâœ“[39m src/ai/ai.service.spec.ts[2m > [22mAiService[2m > [22mHelper Functions[2m > [22mclassifyIntent[2m > [22mshould classify FAQ questions (Vietnamese)
 [32mâœ“[39m src/ai/ai.service.spec.ts[2m > [22mAiService[2m > [22mHelper Functions[2m > [22mclassifyIntent[2m > [22mshould classify FAQ questions (English)
 [32mâœ“[39m src/ai/ai.service.spec.ts[2m > [22mAiService[2m > [22mHelper Functions[2m > [22mclassifyIntent[2m > [22mshould classify personalized queries
 [32mâœ“[39m src/ai/ai.service.spec.ts[2m > [22mAiService[2m > [22mHelper Functions[2m > [22mclassifyIntent[2m > [22mshould handle mixed case
 [32mâœ“[39m src/ai/ai.service.spec.ts[2m > [22mAiService[2m > [22mHelper Functions[2m > [22msummarizeHistory[2m > [22mshould summarize message history
 [32mâœ“[39m src/ai/ai.service.spec.ts[2m > [22mAiService[2m > [22mHelper Functions[2m > [22msummarizeHistory[2m > [22mshould return empty string on error
 [32mâœ“[39m src/ai/ai.service.spec.ts[2m > [22mAiService[2m > [22mHelper Functions[2m > [22msummarizeHistory[2m > [22mshould reverse messages for chronological order
 [32mâœ“[39m src/ai/ai.service.spec.ts[2m > [22mAiService[2m > [22mError Handling[2m > [22mshould handle Gemini API timeout
 [32mâœ“[39m src/ai/ai.service.spec.ts[2m > [22mAiService[2m > [22mError Handling[2m > [22mshould handle invalid course ID in getCourseAdvice
 [32mâœ“[39m src/ai/ai.service.spec.ts[2m > [22mAiService[2m > [22mIntegration Scenarios[2m > [22mshould handle full chat flow with rate limiting and caching
[90mstdout[2m | src/ai/ai.service.spec.ts[2m > [22m[2mAiService[2m > [22m[2mIntegration Scenarios[2m > [22m[2mshould handle full chat flow with rate limiting and caching
[22m[39mðŸ§¹ Cleaning up after test...

[90mstdout[2m | src/ai/ai.service.spec.ts
[22m[39mðŸ”§ Vitest setup: Starting MSW mock server...
âœ… Vitest teardown complete

[90mstdout[2m | src/modules/simulation/scenario-generator.service.spec.ts[2m > [22m[2mSimulationService - AI Scenario Generation (90%+ Coverage)[2m > [22m[2mScenario Generation Logic[2m > [22m[2mshould generate initial life scenario with AI
[22m[39mðŸ§¹ Cleaning up after test...

[90mstdout[2m | src/modules/simulation/scenario-generator.service.spec.ts[2m > [22m[2mSimulationService - AI Scenario Generation (90%+ Coverage)[2m > [22m[2mScenario Generation Logic[2m > [22m[2mshould handle AI response with markdown code blocks
[22m[39mðŸ§¹ Cleaning up after test...

[90mstdout[2m | src/modules/simulation/scenario-generator.service.spec.ts[2m > [22m[2mSimulationService - AI Scenario Generation (90%+ Coverage)[2m > [22m[2mScenario Generation Logic[2m > [22m[2mshould continue scenario based on previous choice
[22m[39mðŸ§¹ Cleaning up after test...

[90mstdout[2m | src/modules/simulation/scenario-generator.service.spec.ts[2m > [22m[2mSimulationService - AI Scenario Generation (90%+ Coverage)[2m > [22m[2mScenario Generation Logic[2m > [22m[2mshould throw error for invalid choice
[22m[39mðŸ§¹ Cleaning up after test...

[90mstdout[2m | src/modules/simulation/scenario-generator.service.spec.ts[2m > [22m[2mSimulationService - AI Scenario Generation (90%+ Coverage)[2m > [22m[2mScenario Generation Logic[2m > [22m[2mshould throw error for unauthorized scenario access
[22m[39mðŸ§¹ Cleaning up after test...

[90mstdout[2m | src/modules/simulation/scenario-generator.service.spec.ts[2m > [22m[2mSimulationService - AI Scenario Generation (90%+ Coverage)[2m > [22m[2mScenario Generation Logic[2m > [22m[2mshould throw error when scenario does not exist
[22m[39mðŸ§¹ Cleaning up after test...

[90mstdout[2m | src/modules/simulation/scenario-generator.service.spec.ts[2m > [22m[2mSimulationService - AI Scenario Generation (90%+ Coverage)[2m > [22m[2mDifficulty Scaling[2m > [22m[2mshould generate age-appropriate scenarios for young users
[22m[39mðŸ§¹ Cleaning up after test...

[90mstdout[2m | src/modules/simulation/scenario-generator.service.spec.ts[2m > [22m[2mSimulationService - AI Scenario Generation (90%+ Coverage)[2m > [22m[2mDifficulty Scaling[2m > [22m[2mshould update user status based on choice impact
[22m[39mðŸ§¹ Cleaning up after test...

[90mstdout[2m | src/modules/simulation/scenario-generator.service.spec.ts[2m > [22m[2mSimulationService - AI Scenario Generation (90%+ Coverage)[2m > [22m[2mDifficulty Scaling[2m > [22m[2mshould occasionally age the user
[22m[39mðŸ§¹ Cleaning up after test...

[90mstdout[2m | src/modules/simulation/scenario-generator.service.spec.ts[2m > [22m[2mSimulationService - AI Scenario Generation (90%+ Coverage)[2m > [22m[2mLocalization (vi/en/zh)[2m > [22m[2mshould generate Vietnamese-localized scenario
[22m[39mðŸ§¹ Cleaning up after test...

[90mstdout[2m | src/modules/simulation/scenario-generator.service.spec.ts[2m > [22m[2mSimulationService - AI Scenario Generation (90%+ Coverage)[2m > [22m[2mLocalization (vi/en/zh)[2m > [22m[2mshould generate English-localized scenario
[22m[39mðŸ§¹ Cleaning up after test...

[90mstdout[2m | src/modules/simulation/scenario-generator.service.spec.ts[2m > [22m[2mSimulationService - AI Scenario Generation (90%+ Coverage)[2m > [22m[2mLocalization (vi/en/zh)[2m > [22m[2mshould generate Chinese-localized scenario
[22m[39mðŸ§¹ Cleaning up after test...

[90mstdout[2m | src/modules/simulation/scenario-generator.service.spec.ts[2m > [22m[2mSimulationService - AI Scenario Generation (90%+ Coverage)[2m > [22m[2mLLM Response Mocking[2m > [22m[2mshould handle malformed JSON from LLM gracefully
[22m[39mðŸ§¹ Cleaning up after test...

[90mstdout[2m | src/modules/simulation/scenario-generator.service.spec.ts[2m > [22m[2mSimulationService - AI Scenario Generation (90%+ Coverage)[2m > [22m[2mLLM Response Mocking[2m > [22m[2mshould parse JSON with extra whitespace
[22m[39mðŸ§¹ Cleaning up after test...

[90mstdout[2m | src/modules/simulation/scenario-generator.service.spec.ts[2m > [22m[2mSimulationService - AI Scenario Generation (90%+ Coverage)[2m > [22m[2mLLM Response Mocking[2m > [22m[2mshould handle nested markdown code blocks
[22m[39mðŸ§¹ Cleaning up after test...

[90mstdout[2m | src/modules/simulation/scenario-generator.service.spec.ts[2m > [22m[2mSimulationService - AI Scenario Generation (90%+ Coverage)[2m > [22m[2mLLM Response Mocking[2m > [22m[2mshould mock complex multi-choice scenarios
[22m[39mðŸ§¹ Cleaning up after test...

[90mstdout[2m | src/modules/simulation/scenario-generator.service.spec.ts[2m > [22m[2mSimulationService - AI Scenario Generation (90%+ Coverage)[2m > [22m[2mJSONB Structure Validation[2m > [22m[2mshould validate initial status structure
[22m[39mðŸ§¹ Cleaning up after test...

[90mstdout[2m | src/modules/simulation/scenario-generator.service.spec.ts[2m > [22m[2mSimulationService - AI Scenario Generation (90%+ Coverage)[2m > [22m[2mJSONB Structure Validation[2m > [22m[2mshould validate scenario event structure
[22m[39mðŸ§¹ Cleaning up after test...

[90mstdout[2m | src/modules/simulation/scenario-generator.service.spec.ts[2m > [22m[2mSimulationService - AI Scenario Generation (90%+ Coverage)[2m > [22m[2mJSONB Structure Validation[2m > [22m[2mshould validate decisions array structure
[22m[39mðŸ§¹ Cleaning up after test...

[90mstdout[2m | src/modules/simulation/scenario-generator.service.spec.ts[2m > [22m[2mSimulationService - AI Scenario Generation (90%+ Coverage)[2m > [22m[2mJSONB Structure Validation[2m > [22m[2mshould reject invalid JSONB structure
[22m[39mðŸ§¹ Cleaning up after test...

[90mstdout[2m | src/modules/simulation/scenario-generator.service.spec.ts[2m > [22m[2mSimulationService - AI Scenario Generation (90%+ Coverage)[2m > [22m[2mJSONB Structure Validation[2m > [22m[2mshould preserve all required fields in status updates
[22m[39mðŸ§¹ Cleaning up after test...

[90mstdout[2m | src/modules/simulation/scenario-generator.service.spec.ts[2m > [22m[2mSimulationService - AI Scenario Generation (90%+ Coverage)[2m > [22m[2mNudge Strategy Integration[2m > [22m[2mshould include loss aversion nudge in prompts
[22m[39mðŸ§¹ Cleaning up after test...

[90mstdout[2m | src/modules/simulation/scenario-generator.service.spec.ts[2m > [22m[2mSimulationService - AI Scenario Generation (90%+ Coverage)[2m > [22m[2mNudge Strategy Integration[2m > [22m[2mshould include Hooked strategy trigger
[22m[39mðŸ§¹ Cleaning up after test...

[90mstdout[2m | src/modules/simulation/scenario-generator.service.spec.ts[2m > [22m[2mSimulationService - AI Scenario Generation (90%+ Coverage)[2m > [22m[2mNudge Strategy Integration[2m > [22m[2mshould pass previous choice context to next event
[22m[39mðŸ§¹ Cleaning up after test...

[90mstdout[2m | src/modules/simulation/scenario-generator.service.spec.ts[2m > [22m[2mSimulationService - AI Scenario Generation (90%+ Coverage)[2m > [22m[2mEdge Cases[2m > [22m[2mshould handle zero impact choices
[22m[39mðŸ§¹ Cleaning up after test...

[90mstdout[2m | src/modules/simulation/scenario-generator.service.spec.ts[2m > [22m[2mSimulationService - AI Scenario Generation (90%+ Coverage)[2m > [22m[2mEdge Cases[2m > [22m[2mshould handle negative savings (debt)
[22m[39mðŸ§¹ Cleaning up after test...

 [32mâœ“[39m src/modules/simulation/scenario-generator.service.spec.ts[2m > [22mSimulationService - AI Scenario Generation (90%+ Coverage)[2m > [22mScenario Generation Logic[2m > [22mshould generate initial life scenario with AI
 [32mâœ“[39m src/modules/simulation/scenario-generator.service.spec.ts[2m > [22mSimulationService - AI Scenario Generation (90%+ Coverage)[2m > [22mScenario Generation Logic[2m > [22mshould handle AI response with markdown code blocks
 [31mÃ—[39m src/modules/simulation/scenario-generator.service.spec.ts[2m > [22mSimulationService - AI Scenario Generation (90%+ Coverage)[2m > [22mScenario Generation Logic[2m > [22mshould continue scenario based on previous choice
[31m   â†’ actual value must be number or bigint, received "undefined"[39m
 [32mâœ“[39m src/modules/simulation/scenario-generator.service.spec.ts[2m > [22mSimulationService - AI Scenario Generation (90%+ Coverage)[2m > [22mScenario Generation Logic[2m > [22mshould throw error for invalid choice
 [32mâœ“[39m src/modules/simulation/scenario-generator.service.spec.ts[2m > [22mSimulationService - AI Scenario Generation (90%+ Coverage)[2m > [22mScenario Generation Logic[2m > [22mshould throw error for unauthorized scenario access
 [32mâœ“[39m src/modules/simulation/scenario-generator.service.spec.ts[2m > [22mSimulationService - AI Scenario Generation (90%+ Coverage)[2m > [22mScenario Generation Logic[2m > [22mshould throw error when scenario does not exist
 [32mâœ“[39m src/modules/simulation/scenario-generator.service.spec.ts[2m > [22mSimulationService - AI Scenario Generation (90%+ Coverage)[2m > [22mDifficulty Scaling[2m > [22mshould generate age-appropriate scenarios for young users
 [32mâœ“[39m src/modules/simulation/scenario-generator.service.spec.ts[2m > [22mSimulationService - AI Scenario Generation (90%+ Coverage)[2m > [22mDifficulty Scaling[2m > [22mshould update user status based on choice impact
 [32mâœ“[39m src/modules/simulation/scenario-generator.service.spec.ts[2m > [22mSimulationService - AI Scenario Generation (90%+ Coverage)[2m > [22mDifficulty Scaling[2m > [22mshould occasionally age the user
 [32mâœ“[39m src/modules/simulation/scenario-generator.service.spec.ts[2m > [22mSimulationService - AI Scenario Generation (90%+ Coverage)[2m > [22mLocalization (vi/en/zh)[2m > [22mshould generate Vietnamese-localized scenario
 [32mâœ“[39m src/modules/simulation/scenario-generator.service.spec.ts[2m > [22mSimulationService - AI Scenario Generation (90%+ Coverage)[2m > [22mLocalization (vi/en/zh)[2m > [22mshould generate English-localized scenario
 [32mâœ“[39m src/modules/simulation/scenario-generator.service.spec.ts[2m > [22mSimulationService - AI Scenario Generation (90%+ Coverage)[2m > [22mLocalization (vi/en/zh)[2m > [22mshould generate Chinese-localized scenario
 [32mâœ“[39m src/modules/simulation/scenario-generator.service.spec.ts[2m > [22mSimulationService - AI Scenario Generation (90%+ Coverage)[2m > [22mLLM Response Mocking[2m > [22mshould handle malformed JSON from LLM gracefully
 [32mâœ“[39m src/modules/simulation/scenario-generator.service.spec.ts[2m > [22mSimulationService - AI Scenario Generation (90%+ Coverage)[2m > [22mLLM Response Mocking[2m > [22mshould parse JSON with extra whitespace
 [32mâœ“[39m src/modules/simulation/scenario-generator.service.spec.ts[2m > [22mSimulationService - AI Scenario Generation (90%+ Coverage)[2m > [22mLLM Response Mocking[2m > [22mshould handle nested markdown code blocks
 [32mâœ“[39m src/modules/simulation/scenario-generator.service.spec.ts[2m > [22mSimulationService - AI Scenario Generation (90%+ Coverage)[2m > [22mLLM Response Mocking[2m > [22mshould mock complex multi-choice scenarios
 [32mâœ“[39m src/modules/simulation/scenario-generator.service.spec.ts[2m > [22mSimulationService - AI Scenario Generation (90%+ Coverage)[2m > [22mJSONB Structure Validation[2m > [22mshould validate initial status structure
 [32mâœ“[39m src/modules/simulation/scenario-generator.service.spec.ts[2m > [22mSimulationService - AI Scenario Generation (90%+ Coverage)[2m > [22mJSONB Structure Validation[2m > [22mshould validate scenario event structure
 [32mâœ“[39m src/modules/simulation/scenario-generator.service.spec.ts[2m > [22mSimulationService - AI Scenario Generation (90%+ Coverage)[2m > [22mJSONB Structure Validation[2m > [22mshould validate decisions array structure
 [32mâœ“[39m src/modules/simulation/scenario-generator.service.spec.ts[2m > [22mSimulationService - AI Scenario Generation (90%+ Coverage)[2m > [22mJSONB Structure Validation[2m > [22mshould reject invalid JSONB structure
 [32mâœ“[39m src/modules/simulation/scenario-generator.service.spec.ts[2m > [22mSimulationService - AI Scenario Generation (90%+ Coverage)[2m > [22mJSONB Structure Validation[2m > [22mshould preserve all required fields in status updates
 [32mâœ“[39m src/modules/simulation/scenario-generator.service.spec.ts[2m > [22mSimulationService - AI Scenario Generation (90%+ Coverage)[2m > [22mNudge Strategy Integration[2m > [22mshould include loss aversion nudge in prompts
 [32mâœ“[39m src/modules/simulation/scenario-generator.service.spec.ts[2m > [22mSimulationService - AI Scenario Generation (90%+ Coverage)[2m > [22mNudge Strategy Integration[2m > [22mshould include Hooked strategy trigger
 [32mâœ“[39m src/modules/simulation/scenario-generator.service.spec.ts[2m > [22mSimulationService - AI Scenario Generation (90%+ Coverage)[2m > [22mNudge Strategy Integration[2m > [22mshould pass previous choice context to next event
 [32mâœ“[39m src/modules/simulation/scenario-generator.service.spec.ts[2m > [22mSimulationService - AI Scenario Generation (90%+ Coverage)[2m > [22mEdge Cases[2m > [22mshould handle zero impact choices
 [32mâœ“[39m src/modules/simulation/scenario-generator.service.spec.ts[2m > [22mSimulationService - AI Scenario Generation (90%+ Coverage)[2m > [22mEdge Cases[2m > [22mshould handle negative savings (debt)
 [32mâœ“[39m src/modules/simulation/scenario-generator.service.spec.ts[2m > [22mSimulationService - AI Scenario Generation (90%+ Coverage)[2m > [22mEdge Cases[2m > [22mshould cap happiness at boundaries
[90mstdout[2m | src/modules/simulation/scenario-generator.service.spec.ts[2m > [22m[2mSimulationService - AI Scenario Generation (90%+ Coverage)[2m > [22m[2mEdge Cases[2m > [22m[2mshould cap happiness at boundaries
[22m[39mðŸ§¹ Cleaning up after test...

[90mstdout[2m | src/modules/simulation/scenario-generator.service.spec.ts
[22m[39mðŸ”§ Vitest setup: Starting MSW mock server...
âœ… Vitest teardown complete

[90mstdout[2m | src/modules/nudge/trigger.service.spec.ts[2m > [22m[2mNudge Trigger Service (Comprehensive)[2m > [22m[2mTime-Based Trigger Evaluation[2m > [22m[2mStreak Inactivity Trigger (20-24h)[2m > [22m[2mshould trigger nudge for user inactive for 22 hours
[22m[39mðŸ§¹ Cleaning up after test...

[90mstdout[2m | src/modules/nudge/trigger.service.spec.ts[2m > [22m[2mNudge Trigger Service (Comprehensive)[2m > [22m[2mTime-Based Trigger Evaluation[2m > [22m[2mStreak Inactivity Trigger (20-24h)[2m > [22m[2mshould NOT trigger for user inactive for 19 hours (too early)
[22m[39mðŸ§¹ Cleaning up after test...

[90mstdout[2m | src/modules/nudge/trigger.service.spec.ts[2m > [22m[2mNudge Trigger Service (Comprehensive)[2m > [22m[2mTime-Based Trigger Evaluation[2m > [22m[2mStreak Inactivity Trigger (20-24h)[2m > [22m[2mshould NOT trigger for user inactive for 25 hours (too late)
[22m[39mðŸ§¹ Cleaning up after test...

[90mstdout[2m | src/modules/nudge/trigger.service.spec.ts[2m > [22m[2mNudge Trigger Service (Comprehensive)[2m > [22m[2mTime-Based Trigger Evaluation[2m > [22m[2mStreak Inactivity Trigger (20-24h)[2m > [22m[2mshould trigger for multiple users in the time window
[22m[39mðŸ§¹ Cleaning up after test...

[90mstdout[2m | src/modules/nudge/trigger.service.spec.ts[2m > [22m[2mNudge Trigger Service (Comprehensive)[2m > [22m[2mEvent-Based Trigger Evaluation[2m > [22m[2mInvestment Decision Trigger[2m > [22m[2mshould trigger SOCIAL_PROOF for HUNTER persona
[22m[39mðŸ§¹ Cleaning up after test...

[90mstdout[2m | src/modules/nudge/trigger.service.spec.ts[2m > [22m[2mNudge Trigger Service (Comprehensive)[2m > [22m[2mEvent-Based Trigger Evaluation[2m > [22m[2mInvestment Decision Trigger[2m > [22m[2mshould trigger LOSS_AVERSION for high risk level
[22m[39mðŸ§¹ Cleaning up after test...

[90mstdout[2m | src/modules/nudge/trigger.service.spec.ts[2m > [22m[2mNudge Trigger Service (Comprehensive)[2m > [22m[2mEvent-Based Trigger Evaluation[2m > [22m[2mInvestment Decision Trigger[2m > [22m[2mshould trigger LOSS_AVERSION for SAVER persona regardless of risk
[22m[39mðŸ§¹ Cleaning up after test...

[90mstdout[2m | src/modules/nudge/trigger.service.spec.ts[2m > [22m[2mNudge Trigger Service (Comprehensive)[2m > [22m[2mEvent-Based Trigger Evaluation[2m > [22m[2mInvestment Decision Trigger[2m > [22m[2mshould return default SOCIAL_PROOF for moderate risk
[22m[39mðŸ§¹ Cleaning up after test...

[90mstdout[2m | src/modules/nudge/trigger.service.spec.ts[2m > [22m[2mNudge Trigger Service (Comprehensive)[2m > [22m[2mEvent-Based Trigger Evaluation[2m > [22m[2mBudgeting Trigger[2m > [22m[2mshould trigger GOAL_GRADIENT for SAVER persona
[22m[39mðŸ§¹ Cleaning up after test...

[90mstdout[2m | src/modules/nudge/trigger.service.spec.ts[2m > [22m[2mNudge Trigger Service (Comprehensive)[2m > [22m[2mEvent-Based Trigger Evaluation[2m > [22m[2mBudgeting Trigger[2m > [22m[2mshould trigger SALIENCE with coffee mapping for default persona
[22m[39mðŸ§¹ Cleaning up after test...

[90mstdout[2m | src/modules/nudge/trigger.service.spec.ts[2m > [22m[2mNudge Trigger Service (Comprehensive)[2m > [22m[2mEvent-Based Trigger Evaluation[2m > [22m[2mBudgeting Trigger[2m > [22m[2mshould calculate coffee equivalents correctly
[22m[39mðŸ§¹ Cleaning up after test...

[90mstdout[2m | src/modules/nudge/trigger.service.spec.ts[2m > [22m[2mNudge Trigger Service (Comprehensive)[2m > [22m[2mEvent-Based Trigger Evaluation[2m > [22m[2mMilestone Trigger[2m > [22m[2mshould trigger GOAL_GRADIENT for streak warning
[22m[39mðŸ§¹ Cleaning up after test...

[90mstdout[2m | src/modules/nudge/trigger.service.spec.ts[2m > [22m[2mNudge Trigger Service (Comprehensive)[2m > [22m[2mEvent-Based Trigger Evaluation[2m > [22m[2mRealtime Social Proof Trigger[2m > [22m[2mshould trigger SOCIAL_PROOF when many users active
[22m[39mðŸ§¹ Cleaning up after test...

[90mstdout[2m | src/modules/nudge/trigger.service.spec.ts[2m > [22m[2mNudge Trigger Service (Comprehensive)[2m > [22m[2mEvent-Based Trigger Evaluation[2m > [22m[2mRealtime Social Proof Trigger[2m > [22m[2mshould return null when no active users
[22m[39mðŸ§¹ Cleaning up after test...

[90mstdout[2m | src/modules/nudge/trigger.service.spec.ts[2m > [22m[2mNudge Trigger Service (Comprehensive)[2m > [22m[2mEvent-Based Trigger Evaluation[2m > [22m[2mRealtime Social Proof Trigger[2m > [22m[2mshould query behavioral logs from last 24 hours
[22m[39mðŸ§¹ Cleaning up after test...

[90mstdout[2m | src/modules/nudge/trigger.service.spec.ts[2m > [22m[2mNudge Trigger Service (Comprehensive)[2m > [22m[2mTrigger Conditions[2m > [22m[2mStreak Conditions[2m > [22m[2mshould NOT trigger for frozen streaks
[22m[39mðŸ§¹ Cleaning up after test...

[90mstdout[2m | src/modules/nudge/trigger.service.spec.ts[2m > [22m[2mNudge Trigger Service (Comprehensive)[2m > [22m[2mTrigger Conditions[2m > [22m[2mStreak Conditions[2m > [22m[2mshould NOT trigger for zero streaks
[22m[39mðŸ§¹ Cleaning up after test...

[90mstdout[2m | src/modules/nudge/trigger.service.spec.ts[2m > [22m[2mNudge Trigger Service (Comprehensive)[2m > [22m[2mTrigger Conditions[2m > [22m[2mStreak Conditions[2m > [22m[2mshould trigger for high-value streaks (7+ days)
[22m[39mðŸ§¹ Cleaning up after test...

[90mstdout[2m | src/modules/nudge/trigger.service.spec.ts[2m > [22m[2mNudge Trigger Service (Comprehensive)[2m > [22m[2mTrigger Conditions[2m > [22m[2mInactivity Conditions[2m > [22m[2mshould identify users approaching streak expiration
[22m[39mðŸ§¹ Cleaning up after test...

[90mstdout[2m | src/modules/nudge/trigger.service.spec.ts[2m > [22m[2mNudge Trigger Service (Comprehensive)[2m > [22m[2mTrigger Conditions[2m > [22m[2mInactivity Conditions[2m > [22m[2mshould exclude users with recent activity
[22m[39mðŸ§¹ Cleaning up after test...

[90mstdout[2m | src/modules/nudge/trigger.service.spec.ts[2m > [22m[2mNudge Trigger Service (Comprehensive)[2m > [22m[2mNotification Generation[2m > [22m[2mMulti-language Support[2m > [22m[2mshould generate Vietnamese message
[22m[39mðŸ§¹ Cleaning up after test...

[90mstdout[2m | src/modules/nudge/trigger.service.spec.ts[2m > [22m[2mNudge Trigger Service (Comprehensive)[2m > [22m[2mNotification Generation[2m > [22m[2mMulti-language Support[2m > [22m[2mshould generate English message
[22m[39mðŸ§¹ Cleaning up after test...

[90mstdout[2m | src/modules/nudge/trigger.service.spec.ts[2m > [22m[2mNudge Trigger Service (Comprehensive)[2m > [22m[2mNotification Generation[2m > [22m[2mMulti-language Support[2m > [22m[2mshould generate Chinese message
[22m[39mðŸ§¹ Cleaning up after test...

[90mstdout[2m | src/modules/nudge/trigger.service.spec.ts[2m > [22m[2mNudge Trigger Service (Comprehensive)[2m > [22m[2mNotification Generation[2m > [22m[2mPriority Assignment[2m > [22m[2mshould assign HIGH priority to loss aversion nudges
[22m[39mðŸ§¹ Cleaning up after test...

[90mstdout[2m | src/modules/nudge/trigger.service.spec.ts[2m > [22m[2mNudge Trigger Service (Comprehensive)[2m > [22m[2mNotification Generation[2m > [22m[2mPriority Assignment[2m > [22m[2mshould assign MEDIUM priority to default social proof
[22m[39mðŸ§¹ Cleaning up after test...

[90mstdout[2m | src/modules/nudge/trigger.service.spec.ts[2m > [22m[2mNudge Trigger Service (Comprehensive)[2m > [22m[2mNotification Generation[2m > [22m[2mPriority Assignment[2m > [22m[2mshould assign LOW priority to salience nudges
[22m[39mðŸ§¹ Cleaning up after test...

[90mstdout[2m | src/modules/nudge/trigger.service.spec.ts[2m > [22m[2mNudge Trigger Service (Comprehensive)[2m > [22m[2mNotification Generation[2m > [22m[2mBehavioral Logging[2m > [22m[2mshould log streak nudge to BehaviorLog
[22m[39mðŸ§¹ Cleaning up after test...

[90mstdout[2m | src/modules/nudge/trigger.service.spec.ts[2m > [22m[2mNudge Trigger Service (Comprehensive)[2m > [22m[2mNotification Generation[2m > [22m[2mBehavioral Logging[2m > [22m[2mshould use system session ID for automated nudges
[22m[39mðŸ§¹ Cleaning up after test...

[90mstdout[2m | src/modules/nudge/trigger.service.spec.ts[2m > [22m[2mNudge Trigger Service (Comprehensive)[2m > [22m[2mNotification Generation[2m > [22m[2mBehavioral Logging[2m > [22m[2mshould include correct event type
[22m[39mðŸ§¹ Cleaning up after test...

[90mstdout[2m | src/modules/nudge/trigger.service.spec.ts[2m > [22m[2mNudge Trigger Service (Comprehensive)[2m > [22m[2mMock User Behavior Data[2m > [22m[2mPersona-Based Behavior[2m > [22m[2mshould fetch user persona from analytics
[22m[39mðŸ§¹ Cleaning up after test...

[90mstdout[2m | src/modules/nudge/trigger.service.spec.ts[2m > [22m[2mNudge Trigger Service (Comprehensive)[2m > [22m[2mMock User Behavior Data[2m > [22m[2mPersona-Based Behavior[2m > [22m[2mshould handle OBSERVER persona
[22m[39mðŸ§¹ Cleaning up after test...

[90mstdout[2m | src/modules/nudge/trigger.service.spec.ts[2m > [22m[2mNudge Trigger Service (Comprehensive)[2m > [22m[2mMock User Behavior Data[2m > [22m[2mPersona-Based Behavior[2m > [22m[2mshould handle missing user gracefully
[22m[39mðŸ§¹ Cleaning up after test...

[90mstdout[2m | src/modules/nudge/trigger.service.spec.ts[2m > [22m[2mNudge Trigger Service (Comprehensive)[2m > [22m[2mMock User Behavior Data[2m > [22m[2mActivity Tracking[2m > [22m[2mshould query user activity correctly
[22m[39mðŸ§¹ Cleaning up after test...

[90mstdout[2m | src/modules/nudge/trigger.service.spec.ts[2m > [22m[2mNudge Trigger Service (Comprehensive)[2m > [22m[2mTrigger JSONB Config Validation[2m > [22m[2mInvestment Data Structure[2m > [22m[2mshould handle riskLevel in payload
[22m[39mðŸ§¹ Cleaning up after test...

[90mstdout[2m | src/modules/nudge/trigger.service.spec.ts[2m > [22m[2mNudge Trigger Service (Comprehensive)[2m > [22m[2mTrigger JSONB Config Validation[2m > [22m[2mInvestment Data Structure[2m > [22m[2mshould handle missing riskLevel gracefully
[22m[39mðŸ§¹ Cleaning up after test...

[90mstdout[2m | src/modules/nudge/trigger.service.spec.ts[2m > [22m[2mNudge Trigger Service (Comprehensive)[2m > [22m[2mTrigger JSONB Config Validation[2m > [22m[2mBudgeting Data Structure[2m > [22m[2mshould validate amount field in budgeting context
[22m[39mðŸ§¹ Cleaning up after test...

[90mstdout[2m | src/modules/nudge/trigger.service.spec.ts[2m > [22m[2mNudge Trigger Service (Comprehensive)[2m > [22m[2mTrigger JSONB Config Validation[2m > [22m[2mBudgeting Data Structure[2m > [22m[2mshould calculate coffee mapping from amount
[22m[39mðŸ§¹ Cleaning up after test...

[90mstdout[2m | src/modules/nudge/trigger.service.spec.ts[2m > [22m[2mNudge Trigger Service (Comprehensive)[2m > [22m[2mTrigger JSONB Config Validation[2m > [22m[2mStreak Data Structure[2m > [22m[2mshould validate streak payload in notification
[22m[39mðŸ§¹ Cleaning up after test...

[90mstdout[2m | src/modules/nudge/trigger.service.spec.ts[2m > [22m[2mNudge Trigger Service (Comprehensive)[2m > [22m[2mRealtime Social Proof Action Tracking[2m > [22m[2mshould track action count for specific target
[22m[39mðŸ§¹ Cleaning up after test...

[90mstdout[2m | src/modules/nudge/trigger.service.spec.ts[2m > [22m[2mNudge Trigger Service (Comprehensive)[2m > [22m[2mRealtime Social Proof Action Tracking[2m > [22m[2mshould filter by event type and path
[22m[39mðŸ§¹ Cleaning up after test...

[90mstdout[2m | src/modules/nudge/trigger.service.spec.ts[2m > [22m[2mNudge Trigger Service (Comprehensive)[2m > [22m[2mRealtime Social Proof Action Tracking[2m > [22m[2mshould only count events from last 24 hours
[22m[39mðŸ§¹ Cleaning up after test...

[90mstdout[2m | src/modules/nudge/trigger.service.spec.ts[2m > [22m[2mNudge Trigger Service (Comprehensive)[2m > [22m[2mRealtime Social Proof Action Tracking[2m > [22m[2mshould return zero count when no matching events
[22m[39mðŸ§¹ Cleaning up after test...

[90mstdout[2m | src/modules/nudge/trigger.service.spec.ts[2m > [22m[2mNudge Trigger Service (Comprehensive)[2m > [22m[2mEdge Cases & Error Handling[2m > [22m[2mshould return null for unknown context
[22m[39mðŸ§¹ Cleaning up after test...

[90mstdout[2m | src/modules/nudge/trigger.service.spec.ts[2m > [22m[2mNudge Trigger Service (Comprehensive)[2m > [22m[2mEdge Cases & Error Handling[2m > [22m[2mshould handle empty streak list gracefully
[22m[39mðŸ§¹ Cleaning up after test...

[90mstdout[2m | src/modules/nudge/trigger.service.spec.ts[2m > [22m[2mNudge Trigger Service (Comprehensive)[2m > [22m[2mEdge Cases & Error Handling[2m > [22m[2mshould handle persona fetch failure
[22m[39mðŸ§¹ Cleaning up after test...

[90mstdout[2m | src/modules/nudge/trigger.service.spec.ts[2m > [22m[2mNudge Trigger Service (Comprehensive)[2m > [22m[2mEdge Cases & Error Handling[2m > [22m[2mshould handle database query failure
[22m[39mðŸ§¹ Cleaning up after test...

[90mstdout[2m | src/modules/nudge/trigger.service.spec.ts[2m > [22m[2mNudge Trigger Service (Comprehensive)[2m > [22m[2mEdge Cases & Error Handling[2m > [22m[2mshould handle behavioral log creation failure
[22m[39mðŸ§¹ Cleaning up after test...

[90mstdout[2m | src/modules/nudge/trigger.service.spec.ts[2m > [22m[2mNudge Trigger Service (Comprehensive)[2m > [22m[2mIntegration Scenarios[2m > [22m[2mshould handle complete streak nudge workflow
[22m[39mðŸ§¹ Cleaning up after test...

[90mstdout[2m | src/modules/nudge/trigger.service.spec.ts[2m > [22m[2mNudge Trigger Service (Comprehensive)[2m > [22m[2mIntegration Scenarios[2m > [22m[2mshould handle complete investment decision workflow
[22m[39mðŸ§¹ Cleaning up after test...

 [32mâœ“[39m src/modules/nudge/trigger.service.spec.ts[2m > [22mNudge Trigger Service (Comprehensive)[2m > [22mTime-Based Trigger Evaluation[2m > [22mStreak Inactivity Trigger (20-24h)[2m > [22mshould trigger nudge for user inactive for 22 hours
 [32mâœ“[39m src/modules/nudge/trigger.service.spec.ts[2m > [22mNudge Trigger Service (Comprehensive)[2m > [22mTime-Based Trigger Evaluation[2m > [22mStreak Inactivity Trigger (20-24h)[2m > [22mshould NOT trigger for user inactive for 19 hours (too early)
 [32mâœ“[39m src/modules/nudge/trigger.service.spec.ts[2m > [22mNudge Trigger Service (Comprehensive)[2m > [22mTime-Based Trigger Evaluation[2m > [22mStreak Inactivity Trigger (20-24h)[2m > [22mshould NOT trigger for user inactive for 25 hours (too late)
 [32mâœ“[39m src/modules/nudge/trigger.service.spec.ts[2m > [22mNudge Trigger Service (Comprehensive)[2m > [22mTime-Based Trigger Evaluation[2m > [22mStreak Inactivity Trigger (20-24h)[2m > [22mshould trigger for multiple users in the time window
 [32mâœ“[39m src/modules/nudge/trigger.service.spec.ts[2m > [22mNudge Trigger Service (Comprehensive)[2m > [22mEvent-Based Trigger Evaluation[2m > [22mInvestment Decision Trigger[2m > [22mshould trigger SOCIAL_PROOF for HUNTER persona
 [32mâœ“[39m src/modules/nudge/trigger.service.spec.ts[2m > [22mNudge Trigger Service (Comprehensive)[2m > [22mEvent-Based Trigger Evaluation[2m > [22mInvestment Decision Trigger[2m > [22mshould trigger LOSS_AVERSION for high risk level
 [32mâœ“[39m src/modules/nudge/trigger.service.spec.ts[2m > [22mNudge Trigger Service (Comprehensive)[2m > [22mEvent-Based Trigger Evaluation[2m > [22mInvestment Decision Trigger[2m > [22mshould trigger LOSS_AVERSION for SAVER persona regardless of risk
 [32mâœ“[39m src/modules/nudge/trigger.service.spec.ts[2m > [22mNudge Trigger Service (Comprehensive)[2m > [22mEvent-Based Trigger Evaluation[2m > [22mInvestment Decision Trigger[2m > [22mshould return default SOCIAL_PROOF for moderate risk
 [32mâœ“[39m src/modules/nudge/trigger.service.spec.ts[2m > [22mNudge Trigger Service (Comprehensive)[2m > [22mEvent-Based Trigger Evaluation[2m > [22mBudgeting Trigger[2m > [22mshould trigger GOAL_GRADIENT for SAVER persona
 [32mâœ“[39m src/modules/nudge/trigger.service.spec.ts[2m > [22mNudge Trigger Service (Comprehensive)[2m > [22mEvent-Based Trigger Evaluation[2m > [22mBudgeting Trigger[2m > [22mshould trigger SALIENCE with coffee mapping for default persona
 [32mâœ“[39m src/modules/nudge/trigger.service.spec.ts[2m > [22mNudge Trigger Service (Comprehensive)[2m > [22mEvent-Based Trigger Evaluation[2m > [22mBudgeting Trigger[2m > [22mshould calculate coffee equivalents correctly
 [32mâœ“[39m src/modules/nudge/trigger.service.spec.ts[2m > [22mNudge Trigger Service (Comprehensive)[2m > [22mEvent-Based Trigger Evaluation[2m > [22mMilestone Trigger[2m > [22mshould trigger GOAL_GRADIENT for streak warning
 [32mâœ“[39m src/modules/nudge/trigger.service.spec.ts[2m > [22mNudge Trigger Service (Comprehensive)[2m > [22mEvent-Based Trigger Evaluation[2m > [22mRealtime Social Proof Trigger[2m > [22mshould trigger SOCIAL_PROOF when many users active
 [32mâœ“[39m src/modules/nudge/trigger.service.spec.ts[2m > [22mNudge Trigger Service (Comprehensive)[2m > [22mEvent-Based Trigger Evaluation[2m > [22mRealtime Social Proof Trigger[2m > [22mshould return null when no active users
 [32mâœ“[39m src/modules/nudge/trigger.service.spec.ts[2m > [22mNudge Trigger Service (Comprehensive)[2m > [22mEvent-Based Trigger Evaluation[2m > [22mRealtime Social Proof Trigger[2m > [22mshould query behavioral logs from last 24 hours
 [32mâœ“[39m src/modules/nudge/trigger.service.spec.ts[2m > [22mNudge Trigger Service (Comprehensive)[2m > [22mTrigger Conditions[2m > [22mStreak Conditions[2m > [22mshould NOT trigger for frozen streaks
 [32mâœ“[39m src/modules/nudge/trigger.service.spec.ts[2m > [22mNudge Trigger Service (Comprehensive)[2m > [22mTrigger Conditions[2m > [22mStreak Conditions[2m > [22mshould NOT trigger for zero streaks
 [32mâœ“[39m src/modules/nudge/trigger.service.spec.ts[2m > [22mNudge Trigger Service (Comprehensive)[2m > [22mTrigger Conditions[2m > [22mStreak Conditions[2m > [22mshould trigger for high-value streaks (7+ days)
 [32mâœ“[39m src/modules/nudge/trigger.service.spec.ts[2m > [22mNudge Trigger Service (Comprehensive)[2m > [22mTrigger Conditions[2m > [22mInactivity Conditions[2m > [22mshould identify users approaching streak expiration
 [32mâœ“[39m src/modules/nudge/trigger.service.spec.ts[2m > [22mNudge Trigger Service (Comprehensive)[2m > [22mTrigger Conditions[2m > [22mInactivity Conditions[2m > [22mshould exclude users with recent activity
 [32mâœ“[39m src/modules/nudge/trigger.service.spec.ts[2m > [22mNudge Trigger Service (Comprehensive)[2m > [22mNotification Generation[2m > [22mMulti-language Support[2m > [22mshould generate Vietnamese message
 [32mâœ“[39m src/modules/nudge/trigger.service.spec.ts[2m > [22mNudge Trigger Service (Comprehensive)[2m > [22mNotification Generation[2m > [22mMulti-language Support[2m > [22mshould generate English message
 [32mâœ“[39m src/modules/nudge/trigger.service.spec.ts[2m > [22mNudge Trigger Service (Comprehensive)[2m > [22mNotification Generation[2m > [22mMulti-language Support[2m > [22mshould generate Chinese message
 [32mâœ“[39m src/modules/nudge/trigger.service.spec.ts[2m > [22mNudge Trigger Service (Comprehensive)[2m > [22mNotification Generation[2m > [22mPriority Assignment[2m > [22mshould assign HIGH priority to loss aversion nudges
 [32mâœ“[39m src/modules/nudge/trigger.service.spec.ts[2m > [22mNudge Trigger Service (Comprehensive)[2m > [22mNotification Generation[2m > [22mPriority Assignment[2m > [22mshould assign MEDIUM priority to default social proof
 [32mâœ“[39m src/modules/nudge/trigger.service.spec.ts[2m > [22mNudge Trigger Service (Comprehensive)[2m > [22mNotification Generation[2m > [22mPriority Assignment[2m > [22mshould assign LOW priority to salience nudges
 [32mâœ“[39m src/modules/nudge/trigger.service.spec.ts[2m > [22mNudge Trigger Service (Comprehensive)[2m > [22mNotification Generation[2m > [22mBehavioral Logging[2m > [22mshould log streak nudge to BehaviorLog
 [32mâœ“[39m src/modules/nudge/trigger.service.spec.ts[2m > [22mNudge Trigger Service (Comprehensive)[2m > [22mNotification Generation[2m > [22mBehavioral Logging[2m > [22mshould use system session ID for automated nudges
 [32mâœ“[39m src/modules/nudge/trigger.service.spec.ts[2m > [22mNudge Trigger Service (Comprehensive)[2m > [22mNotification Generation[2m > [22mBehavioral Logging[2m > [22mshould include correct event type
 [32mâœ“[39m src/modules/nudge/trigger.service.spec.ts[2m > [22mNudge Trigger Service (Comprehensive)[2m > [22mMock User Behavior Data[2m > [22mPersona-Based Behavior[2m > [22mshould fetch user persona from analytics
 [32mâœ“[39m src/modules/nudge/trigger.service.spec.ts[2m > [22mNudge Trigger Service (Comprehensive)[2m > [22mMock User Behavior Data[2m > [22mPersona-Based Behavior[2m > [22mshould handle OBSERVER persona
 [32mâœ“[39m src/modules/nudge/trigger.service.spec.ts[2m > [22mNudge Trigger Service (Comprehensive)[2m > [22mMock User Behavior Data[2m > [22mPersona-Based Behavior[2m > [22mshould handle missing user gracefully
 [32mâœ“[39m src/modules/nudge/trigger.service.spec.ts[2m > [22mNudge Trigger Service (Comprehensive)[2m > [22mMock User Behavior Data[2m > [22mActivity Tracking[2m > [22mshould query user activity correctly
 [32mâœ“[39m src/modules/nudge/trigger.service.spec.ts[2m > [22mNudge Trigger Service (Comprehensive)[2m > [22mTrigger JSONB Config Validation[2m > [22mInvestment Data Structure[2m > [22mshould handle riskLevel in payload
 [32mâœ“[39m src/modules/nudge/trigger.service.spec.ts[2m > [22mNudge Trigger Service (Comprehensive)[2m > [22mTrigger JSONB Config Validation[2m > [22mInvestment Data Structure[2m > [22mshould handle missing riskLevel gracefully
 [32mâœ“[39m src/modules/nudge/trigger.service.spec.ts[2m > [22mNudge Trigger Service (Comprehensive)[2m > [22mTrigger JSONB Config Validation[2m > [22mBudgeting Data Structure[2m > [22mshould validate amount field in budgeting context
 [32mâœ“[39m src/modules/nudge/trigger.service.spec.ts[2m > [22mNudge Trigger Service (Comprehensive)[2m > [22mTrigger JSONB Config Validation[2m > [22mBudgeting Data Structure[2m > [22mshould calculate coffee mapping from amount
 [32mâœ“[39m src/modules/nudge/trigger.service.spec.ts[2m > [22mNudge Trigger Service (Comprehensive)[2m > [22mTrigger JSONB Config Validation[2m > [22mStreak Data Structure[2m > [22mshould validate streak payload in notification
 [32mâœ“[39m src/modules/nudge/trigger.service.spec.ts[2m > [22mNudge Trigger Service (Comprehensive)[2m > [22mRealtime Social Proof Action Tracking[2m > [22mshould track action count for specific target
 [32mâœ“[39m src/modules/nudge/trigger.service.spec.ts[2m > [22mNudge Trigger Service (Comprehensive)[2m > [22mRealtime Social Proof Action Tracking[2m > [22mshould filter by event type and path
 [32mâœ“[39m src/modules/nudge/trigger.service.spec.ts[2m > [22mNudge Trigger Service (Comprehensive)[2m > [22mRealtime Social Proof Action Tracking[2m > [22mshould only count events from last 24 hours
 [32mâœ“[39m src/modules/nudge/trigger.service.spec.ts[2m > [22mNudge Trigger Service (Comprehensive)[2m > [22mRealtime Social Proof Action Tracking[2m > [22mshould return zero count when no matching events
 [32mâœ“[39m src/modules/nudge/trigger.service.spec.ts[2m > [22mNudge Trigger Service (Comprehensive)[2m > [22mEdge Cases & Error Handling[2m > [22mshould return null for unknown context
 [32mâœ“[39m src/modules/nudge/trigger.service.spec.ts[2m > [22mNudge Trigger Service (Comprehensive)[2m > [22mEdge Cases & Error Handling[2m > [22mshould handle empty streak list gracefully
 [32mâœ“[39m src/modules/nudge/trigger.service.spec.ts[2m > [22mNudge Trigger Service (Comprehensive)[2m > [22mEdge Cases & Error Handling[2m > [22mshould handle persona fetch failure
 [32mâœ“[39m src/modules/nudge/trigger.service.spec.ts[2m > [22mNudge Trigger Service (Comprehensive)[2m > [22mEdge Cases & Error Handling[2m > [22mshould handle database query failure
 [32mâœ“[39m src/modules/nudge/trigger.service.spec.ts[2m > [22mNudge Trigger Service (Comprehensive)[2m > [22mEdge Cases & Error Handling[2m > [22mshould handle behavioral log creation failure
 [32mâœ“[39m src/modules/nudge/trigger.service.spec.ts[2m > [22mNudge Trigger Service (Comprehensive)[2m > [22mIntegration Scenarios[2m > [22mshould handle complete streak nudge workflow
 [32mâœ“[39m src/modules/nudge/trigger.service.spec.ts[2m > [22mNudge Trigger Service (Comprehensive)[2m > [22mIntegration Scenarios[2m > [22mshould handle complete investment decision workflow
[90mstdout[2m | src/modules/nudge/trigger.service.spec.ts
[22m[39mðŸ”§ Vitest setup: Starting MSW mock server...
âœ… Vitest teardown complete

[90mstdout[2m | src/modules/analytics/ab-testing.service.spec.ts[2m > [22m[2mABTestingService - A/B Testing Framework[2m > [22m[2mExperiment Registration & Validation[2m > [22m[2mshould register a valid experiment
[22m[39mðŸ§¹ Cleaning up after test...

[90mstdout[2m | src/modules/analytics/ab-testing.service.spec.ts[2m > [22m[2mABTestingService - A/B Testing Framework[2m > [22m[2mExperiment Registration & Validation[2m > [22m[2mshould throw error if variant weights do not sum to 100
[22m[39mðŸ§¹ Cleaning up after test...

[90mstdout[2m | src/modules/analytics/ab-testing.service.spec.ts[2m > [22m[2mABTestingService - A/B Testing Framework[2m > [22m[2mExperiment Registration & Validation[2m > [22m[2mshould throw error if traffic allocation is out of range
[22m[39mðŸ§¹ Cleaning up after test...

[90mstdout[2m | src/modules/analytics/ab-testing.service.spec.ts[2m > [22m[2mABTestingService - A/B Testing Framework[2m > [22m[2mExperiment Registration & Validation[2m > [22m[2mshould throw error if experiment has less than 2 variants
[22m[39mðŸ§¹ Cleaning up after test...

[90mstdout[2m | src/modules/analytics/ab-testing.service.spec.ts[2m > [22m[2mABTestingService - A/B Testing Framework[2m > [22m[2mExperiment Registration & Validation[2m > [22m[2mshould handle experiments with multiple variants (A/B/C testing)
[22m[39mðŸ§¹ Cleaning up after test...

[90mstdout[2m | src/modules/analytics/ab-testing.service.spec.ts[2m > [22m[2mABTestingService - A/B Testing Framework[2m > [22m[2mExperiment Registration & Validation[2m > [22m[2mshould retrieve all registered experiments
[22m[39mðŸ§¹ Cleaning up after test...

[90mstdout[2m | src/modules/analytics/ab-testing.service.spec.ts[2m > [22m[2mABTestingService - A/B Testing Framework[2m > [22m[2mVariant Assignment[2m > [22m[2mshould assign variant to new user
[22m[39mðŸ§¹ Cleaning up after test...

[90mstdout[2m | src/modules/analytics/ab-testing.service.spec.ts[2m > [22m[2mABTestingService - A/B Testing Framework[2m > [22m[2mVariant Assignment[2m > [22m[2mshould return existing assignment for returning user
[22m[39mðŸ§¹ Cleaning up after test...

[90mstdout[2m | src/modules/analytics/ab-testing.service.spec.ts[2m > [22m[2mABTestingService - A/B Testing Framework[2m > [22m[2mVariant Assignment[2m > [22m[2mshould return null if experiment is not active
[22m[39mðŸ§¹ Cleaning up after test...

[90mstdout[2m | src/modules/analytics/ab-testing.service.spec.ts[2m > [22m[2mABTestingService - A/B Testing Framework[2m > [22m[2mVariant Assignment[2m > [22m[2mshould return null if experiment does not exist
[22m[39mðŸ§¹ Cleaning up after test...

[90mstdout[2m | src/modules/analytics/ab-testing.service.spec.ts[2m > [22m[2mABTestingService - A/B Testing Framework[2m > [22m[2mVariant Assignment[2m > [22m[2mshould respect traffic allocation percentage
[22m[39mðŸ§¹ Cleaning up after test...

[90mstdout[2m | src/modules/analytics/ab-testing.service.spec.ts[2m > [22m[2mABTestingService - A/B Testing Framework[2m > [22m[2mVariant Assignment[2m > [22m[2mshould assign variants consistently based on user ID hash
[22m[39mðŸ§¹ Cleaning up after test...

[90mstdout[2m | src/modules/analytics/ab-testing.service.spec.ts[2m > [22m[2mABTestingService - A/B Testing Framework[2m > [22m[2mVariant Assignment[2m > [22m[2mshould handle targeted experiments based on user points
[22m[39mðŸ§¹ Cleaning up after test...

[90mstdout[2m | src/modules/analytics/ab-testing.service.spec.ts[2m > [22m[2mABTestingService - A/B Testing Framework[2m > [22m[2mVariant Assignment[2m > [22m[2mshould include user if within target audience range
[22m[39mðŸ§¹ Cleaning up after test...

[90mstdout[2m | src/modules/analytics/ab-testing.service.spec.ts[2m > [22m[2mABTestingService - A/B Testing Framework[2m > [22m[2mVariant Assignment[2m > [22m[2mshould distribute variants according to weight ratios
[22m[39mðŸ§¹ Cleaning up after test...

[90mstdout[2m | src/modules/analytics/ab-testing.service.spec.ts[2m > [22m[2mABTestingService - A/B Testing Framework[2m > [22m[2mConversion Tracking[2m > [22m[2mshould track conversion events
[22m[39mðŸ§¹ Cleaning up after test...

[90mstdout[2m | src/modules/analytics/ab-testing.service.spec.ts[2m > [22m[2mABTestingService - A/B Testing Framework[2m > [22m[2mConversion Tracking[2m > [22m[2mshould track conversions without value
[22m[39mðŸ§¹ Cleaning up after test...

[90mstdout[2m | src/modules/analytics/ab-testing.service.spec.ts[2m > [22m[2mABTestingService - A/B Testing Framework[2m > [22m[2mConversion Tracking[2m > [22m[2mshould handle multiple conversion types
[22m[39mðŸ§¹ Cleaning up after test...

[90mstdout[2m | src/modules/analytics/ab-testing.service.spec.ts[2m > [22m[2mABTestingService - A/B Testing Framework[2m > [22m[2mVariant Performance Tracking[2m > [22m[2mshould calculate performance metrics for each variant
[22m[39mðŸ§¹ Cleaning up after test...

[90mstdout[2m | src/modules/analytics/ab-testing.service.spec.ts[2m > [22m[2mABTestingService - A/B Testing Framework[2m > [22m[2mVariant Performance Tracking[2m > [22m[2mshould handle zero conversions gracefully
[22m[39mðŸ§¹ Cleaning up after test...

[90mstdout[2m | src/modules/analytics/ab-testing.service.spec.ts[2m > [22m[2mABTestingService - A/B Testing Framework[2m > [22m[2mVariant Performance Tracking[2m > [22m[2mshould throw error for non-existent experiment
[22m[39mðŸ§¹ Cleaning up after test...

[90mstdout[2m | src/modules/analytics/ab-testing.service.spec.ts[2m > [22m[2mABTestingService - A/B Testing Framework[2m > [22m[2mVariant Performance Tracking[2m > [22m[2mshould aggregate conversion values correctly
[22m[39mðŸ§¹ Cleaning up after test...

[90mstdout[2m | src/modules/analytics/ab-testing.service.spec.ts[2m > [22m[2mABTestingService - A/B Testing Framework[2m > [22m[2mStatistical Significance Calculations[2m > [22m[2mshould calculate statistical significance with sufficient data
[22m[39mðŸ§¹ Cleaning up after test...

[90mstdout[2m | src/modules/analytics/ab-testing.service.spec.ts[2m > [22m[2mABTestingService - A/B Testing Framework[2m > [22m[2mStatistical Significance Calculations[2m > [22m[2mshould mark results as significant when p-value < 0.05
[22m[39mðŸ§¹ Cleaning up after test...

[90mstdout[2m | src/modules/analytics/ab-testing.service.spec.ts[2m > [22m[2mABTestingService - A/B Testing Framework[2m > [22m[2mStatistical Significance Calculations[2m > [22m[2mshould throw error with insufficient data
[22m[39mðŸ§¹ Cleaning up after test...

[90mstdout[2m | src/modules/analytics/ab-testing.service.spec.ts[2m > [22m[2mABTestingService - A/B Testing Framework[2m > [22m[2mStatistical Significance Calculations[2m > [22m[2mshould throw error for non-existent variants
[22m[39mðŸ§¹ Cleaning up after test...

[90mstdout[2m | src/modules/analytics/ab-testing.service.spec.ts[2m > [22m[2mABTestingService - A/B Testing Framework[2m > [22m[2mStatistical Significance Calculations[2m > [22m[2mshould calculate correct uplift percentage
[22m[39mðŸ§¹ Cleaning up after test...

[90mstdout[2m | src/modules/analytics/ab-testing.service.spec.ts[2m > [22m[2mABTestingService - A/B Testing Framework[2m > [22m[2mStatistical Significance Calculations[2m > [22m[2mshould provide confidence level
[22m[39mðŸ§¹ Cleaning up after test...

[90mstdout[2m | src/modules/analytics/ab-testing.service.spec.ts[2m > [22m[2mABTestingService - A/B Testing Framework[2m > [22m[2mExperiment Lifecycle Management[2m > [22m[2mshould pause an active experiment
[22m[39mðŸ§¹ Cleaning up after test...

[90mstdout[2m | src/modules/analytics/ab-testing.service.spec.ts[2m > [22m[2mABTestingService - A/B Testing Framework[2m > [22m[2mExperiment Lifecycle Management[2m > [22m[2mshould complete an experiment
[22m[39mðŸ§¹ Cleaning up after test...

[90mstdout[2m | src/modules/analytics/ab-testing.service.spec.ts[2m > [22m[2mABTestingService - A/B Testing Framework[2m > [22m[2mExperiment Lifecycle Management[2m > [22m[2mshould not assign variants to paused experiments
[22m[39mðŸ§¹ Cleaning up after test...

[90mstdout[2m | src/modules/analytics/ab-testing.service.spec.ts[2m > [22m[2mABTestingService - A/B Testing Framework[2m > [22m[2mExperiment Lifecycle Management[2m > [22m[2mshould handle experiments with date ranges
[22m[39mðŸ§¹ Cleaning up after test...

[90mstdout[2m | src/modules/analytics/ab-testing.service.spec.ts[2m > [22m[2mABTestingService - A/B Testing Framework[2m > [22m[2mEdge Cases & Error Handling[2m > [22m[2mshould handle user with no points in targeted experiment
[22m[39mðŸ§¹ Cleaning up after test...

[90mstdout[2m | src/modules/analytics/ab-testing.service.spec.ts[2m > [22m[2mABTestingService - A/B Testing Framework[2m > [22m[2mEdge Cases & Error Handling[2m > [22m[2mshould handle experiment with zero traffic allocation
[22m[39mðŸ§¹ Cleaning up after test...

[90mstdout[2m | src/modules/analytics/ab-testing.service.spec.ts[2m > [22m[2mABTestingService - A/B Testing Framework[2m > [22m[2mEdge Cases & Error Handling[2m > [22m[2mshould handle partial traffic allocation correctly
[22m[39mðŸ§¹ Cleaning up after test...

[90mstdout[2m | src/modules/analytics/ab-testing.service.spec.ts[2m > [22m[2mABTestingService - A/B Testing Framework[2m > [22m[2mEdge Cases & Error Handling[2m > [22m[2mshould handle experiments with custom configuration per variant
[22m[39mðŸ§¹ Cleaning up after test...

[90mstdout[2m | src/modules/analytics/ab-testing.service.spec.ts[2m > [22m[2mABTestingService - A/B Testing Framework[2m > [22m[2mEdge Cases & Error Handling[2m > [22m[2mshould maintain consistent hashing across service instances
[22m[39mðŸ§¹ Cleaning up after test...

[90mstdout[2m | src/modules/analytics/ab-testing.service.spec.ts
[22m[39mðŸ”§ Vitest setup: Starting MSW mock server...
âœ… Vitest teardown complete

 [32mâœ“[39m src/modules/analytics/ab-testing.service.spec.ts[2m > [22mABTestingService - A/B Testing Framework[2m > [22mExperiment Registration & Validation[2m > [22mshould register a valid experiment
 [32mâœ“[39m src/modules/analytics/ab-testing.service.spec.ts[2m > [22mABTestingService - A/B Testing Framework[2m > [22mExperiment Registration & Validation[2m > [22mshould throw error if variant weights do not sum to 100
 [32mâœ“[39m src/modules/analytics/ab-testing.service.spec.ts[2m > [22mABTestingService - A/B Testing Framework[2m > [22mExperiment Registration & Validation[2m > [22mshould throw error if traffic allocation is out of range
 [32mâœ“[39m src/modules/analytics/ab-testing.service.spec.ts[2m > [22mABTestingService - A/B Testing Framework[2m > [22mExperiment Registration & Validation[2m > [22mshould throw error if experiment has less than 2 variants
 [32mâœ“[39m src/modules/analytics/ab-testing.service.spec.ts[2m > [22mABTestingService - A/B Testing Framework[2m > [22mExperiment Registration & Validation[2m > [22mshould handle experiments with multiple variants (A/B/C testing)
 [32mâœ“[39m src/modules/analytics/ab-testing.service.spec.ts[2m > [22mABTestingService - A/B Testing Framework[2m > [22mExperiment Registration & Validation[2m > [22mshould retrieve all registered experiments
 [32mâœ“[39m src/modules/analytics/ab-testing.service.spec.ts[2m > [22mABTestingService - A/B Testing Framework[2m > [22mVariant Assignment[2m > [22mshould assign variant to new user
 [32mâœ“[39m src/modules/analytics/ab-testing.service.spec.ts[2m > [22mABTestingService - A/B Testing Framework[2m > [22mVariant Assignment[2m > [22mshould return existing assignment for returning user
 [32mâœ“[39m src/modules/analytics/ab-testing.service.spec.ts[2m > [22mABTestingService - A/B Testing Framework[2m > [22mVariant Assignment[2m > [22mshould return null if experiment is not active
 [32mâœ“[39m src/modules/analytics/ab-testing.service.spec.ts[2m > [22mABTestingService - A/B Testing Framework[2m > [22mVariant Assignment[2m > [22mshould return null if experiment does not exist
 [32mâœ“[39m src/modules/analytics/ab-testing.service.spec.ts[2m > [22mABTestingService - A/B Testing Framework[2m > [22mVariant Assignment[2m > [22mshould respect traffic allocation percentage
 [32mâœ“[39m src/modules/analytics/ab-testing.service.spec.ts[2m > [22mABTestingService - A/B Testing Framework[2m > [22mVariant Assignment[2m > [22mshould assign variants consistently based on user ID hash
 [32mâœ“[39m src/modules/analytics/ab-testing.service.spec.ts[2m > [22mABTestingService - A/B Testing Framework[2m > [22mVariant Assignment[2m > [22mshould handle targeted experiments based on user points
 [32mâœ“[39m src/modules/analytics/ab-testing.service.spec.ts[2m > [22mABTestingService - A/B Testing Framework[2m > [22mVariant Assignment[2m > [22mshould include user if within target audience range
 [31mÃ—[39m src/modules/analytics/ab-testing.service.spec.ts[2m > [22mABTestingService - A/B Testing Framework[2m > [22mVariant Assignment[2m > [22mshould distribute variants according to weight ratios
[31m   â†’ expected 0.882 to be less than 0.75[39m
 [32mâœ“[39m src/modules/analytics/ab-testing.service.spec.ts[2m > [22mABTestingService - A/B Testing Framework[2m > [22mConversion Tracking[2m > [22mshould track conversion events
 [32mâœ“[39m src/modules/analytics/ab-testing.service.spec.ts[2m > [22mABTestingService - A/B Testing Framework[2m > [22mConversion Tracking[2m > [22mshould track conversions without value
 [32mâœ“[39m src/modules/analytics/ab-testing.service.spec.ts[2m > [22mABTestingService - A/B Testing Framework[2m > [22mConversion Tracking[2m > [22mshould handle multiple conversion types
 [32mâœ“[39m src/modules/analytics/ab-testing.service.spec.ts[2m > [22mABTestingService - A/B Testing Framework[2m > [22mVariant Performance Tracking[2m > [22mshould calculate performance metrics for each variant
 [32mâœ“[39m src/modules/analytics/ab-testing.service.spec.ts[2m > [22mABTestingService - A/B Testing Framework[2m > [22mVariant Performance Tracking[2m > [22mshould handle zero conversions gracefully
 [32mâœ“[39m src/modules/analytics/ab-testing.service.spec.ts[2m > [22mABTestingService - A/B Testing Framework[2m > [22mVariant Performance Tracking[2m > [22mshould throw error for non-existent experiment
 [32mâœ“[39m src/modules/analytics/ab-testing.service.spec.ts[2m > [22mABTestingService - A/B Testing Framework[2m > [22mVariant Performance Tracking[2m > [22mshould aggregate conversion values correctly
 [32mâœ“[39m src/modules/analytics/ab-testing.service.spec.ts[2m > [22mABTestingService - A/B Testing Framework[2m > [22mStatistical Significance Calculations[2m > [22mshould calculate statistical significance with sufficient data
 [32mâœ“[39m src/modules/analytics/ab-testing.service.spec.ts[2m > [22mABTestingService - A/B Testing Framework[2m > [22mStatistical Significance Calculations[2m > [22mshould mark results as significant when p-value < 0.05
 [32mâœ“[39m src/modules/analytics/ab-testing.service.spec.ts[2m > [22mABTestingService - A/B Testing Framework[2m > [22mStatistical Significance Calculations[2m > [22mshould throw error with insufficient data
 [32mâœ“[39m src/modules/analytics/ab-testing.service.spec.ts[2m > [22mABTestingService - A/B Testing Framework[2m > [22mStatistical Significance Calculations[2m > [22mshould throw error for non-existent variants
 [32mâœ“[39m src/modules/analytics/ab-testing.service.spec.ts[2m > [22mABTestingService - A/B Testing Framework[2m > [22mStatistical Significance Calculations[2m > [22mshould calculate correct uplift percentage
 [32mâœ“[39m src/modules/analytics/ab-testing.service.spec.ts[2m > [22mABTestingService - A/B Testing Framework[2m > [22mStatistical Significance Calculations[2m > [22mshould provide confidence level
 [32mâœ“[39m src/modules/analytics/ab-testing.service.spec.ts[2m > [22mABTestingService - A/B Testing Framework[2m > [22mExperiment Lifecycle Management[2m > [22mshould pause an active experiment
 [32mâœ“[39m src/modules/analytics/ab-testing.service.spec.ts[2m > [22mABTestingService - A/B Testing Framework[2m > [22mExperiment Lifecycle Management[2m > [22mshould complete an experiment
 [32mâœ“[39m src/modules/analytics/ab-testing.service.spec.ts[2m > [22mABTestingService - A/B Testing Framework[2m > [22mExperiment Lifecycle Management[2m > [22mshould not assign variants to paused experiments
 [32mâœ“[39m src/modules/analytics/ab-testing.service.spec.ts[2m > [22mABTestingService - A/B Testing Framework[2m > [22mExperiment Lifecycle Management[2m > [22mshould handle experiments with date ranges
 [32mâœ“[39m src/modules/analytics/ab-testing.service.spec.ts[2m > [22mABTestingService - A/B Testing Framework[2m > [22mEdge Cases & Error Handling[2m > [22mshould handle user with no points in targeted experiment
 [32mâœ“[39m src/modules/analytics/ab-testing.service.spec.ts[2m > [22mABTestingService - A/B Testing Framework[2m > [22mEdge Cases & Error Handling[2m > [22mshould handle experiment with zero traffic allocation
 [32mâœ“[39m src/modules/analytics/ab-testing.service.spec.ts[2m > [22mABTestingService - A/B Testing Framework[2m > [22mEdge Cases & Error Handling[2m > [22mshould handle partial traffic allocation correctly
 [32mâœ“[39m src/modules/analytics/ab-testing.service.spec.ts[2m > [22mABTestingService - A/B Testing Framework[2m > [22mEdge Cases & Error Handling[2m > [22mshould handle experiments with custom configuration per variant
 [32mâœ“[39m src/modules/analytics/ab-testing.service.spec.ts[2m > [22mABTestingService - A/B Testing Framework[2m > [22mEdge Cases & Error Handling[2m > [22mshould maintain consistent hashing across service instances
[90mstdout[2m | src/modules/analytics/analytics.integration.spec.ts[2m > [22m[2mAnalytics System Integration Tests[2m > [22m[2mEnd-to-End Analytics Flows[2m > [22m[2mUser Behavior Analysis Pipeline[2m > [22m[2mshould analyze user behavior from raw logs to persona classification
[22m[39mðŸ§¹ Cleaning up after test...

[90mstdout[2m | src/modules/analytics/analytics.integration.spec.ts[2m > [22m[2mAnalytics System Integration Tests[2m > [22m[2mEnd-to-End Analytics Flows[2m > [22m[2mUser Behavior Analysis Pipeline[2m > [22m[2mshould handle SAVER persona with commitment-focused behavior
[22m[39mðŸ§¹ Cleaning up after test...

[90mstdout[2m | src/modules/analytics/analytics.integration.spec.ts[2m > [22m[2mAnalytics System Integration Tests[2m > [22m[2mEnd-to-End Analytics Flows[2m > [22m[2mUser Behavior Analysis Pipeline[2m > [22m[2mshould default to OBSERVER for mixed behavior
[22m[39mðŸ§¹ Cleaning up after test...

[90mstdout[2m | src/modules/analytics/analytics.integration.spec.ts[2m > [22m[2mAnalytics System Integration Tests[2m > [22m[2mEnd-to-End Analytics Flows[2m > [22m[2mLearning Habits Analysis[2m > [22m[2mshould identify peak learning hours from activity patterns
[22m[39mðŸ§¹ Cleaning up after test...

[90mstdout[2m | src/modules/analytics/analytics.integration.spec.ts[2m > [22m[2mAnalytics System Integration Tests[2m > [22m[2mEnd-to-End Analytics Flows[2m > [22m[2mLearning Habits Analysis[2m > [22m[2mshould return null for users with no activity
[22m[39mðŸ§¹ Cleaning up after test...

[90mstdout[2m | src/modules/analytics/analytics.integration.spec.ts[2m > [22m[2mAnalytics System Integration Tests[2m > [22m[2mEnd-to-End Analytics Flows[2m > [22m[2mPredictive Analysis Pipeline[2m > [22m[2mshould generate complete financial future simulation with persona context
[22m[39mðŸ§¹ Cleaning up after test...

[90mstdout[2m | src/modules/analytics/analytics.integration.spec.ts[2m > [22m[2mAnalytics System Integration Tests[2m > [22m[2mEnd-to-End Analytics Flows[2m > [22m[2mPredictive Analysis Pipeline[2m > [22m[2mshould predict churn risk based on activity gaps
[22m[39mðŸ§¹ Cleaning up after test...

[90mstdout[2m | src/modules/analytics/analytics.integration.spec.ts[2m > [22m[2mAnalytics System Integration Tests[2m > [22m[2mEnd-to-End Analytics Flows[2m > [22m[2mPredictive Analysis Pipeline[2m > [22m[2mshould return HIGH churn risk for large activity gaps
[22m[39mðŸ§¹ Cleaning up after test...

[90mstdout[2m | src/modules/analytics/analytics.integration.spec.ts[2m > [22m[2mAnalytics System Integration Tests[2m > [22m[2mEnd-to-End Analytics Flows[2m > [22m[2mPredictive Analysis Pipeline[2m > [22m[2mshould return LOW churn risk for consistent daily activity
[22m[39mðŸ§¹ Cleaning up after test...

[90mstdout[2m | src/modules/analytics/analytics.integration.spec.ts[2m > [22m[2mAnalytics System Integration Tests[2m > [22m[2mCross-Service Data Aggregation[2m > [22m[2mMentor Service with Analytics Integration[2m > [22m[2mshould integrate persona, churn risk, and user profile for personalized advice
[22m[39mðŸ§¹ Cleaning up after test...

[90mstdout[2m | src/modules/analytics/analytics.integration.spec.ts[2m > [22m[2mAnalytics System Integration Tests[2m > [22m[2mCross-Service Data Aggregation[2m > [22m[2mMentor Service with Analytics Integration[2m > [22m[2mshould select WISE_SAGE persona for SAVER users
[22m[39mðŸ§¹ Cleaning up after test...

[90mstdout[2m | src/modules/analytics/analytics.integration.spec.ts[2m > [22m[2mAnalytics System Integration Tests[2m > [22m[2mCross-Service Data Aggregation[2m > [22m[2mMentor Service with Analytics Integration[2m > [22m[2mshould include high churn risk warning in AI context
[22m[39mðŸ§¹ Cleaning up after test...

[90mstdout[2m | src/modules/analytics/analytics.integration.spec.ts[2m > [22m[2mAnalytics System Integration Tests[2m > [22m[2mCross-Service Data Aggregation[2m > [22m[2mSystem-Wide Statistics Aggregation[2m > [22m[2mshould aggregate data from multiple Prisma models
[22m[39mðŸ§¹ Cleaning up after test...

[90mstdout[2m | src/modules/analytics/analytics.integration.spec.ts[2m > [22m[2mAnalytics System Integration Tests[2m > [22m[2mCross-Service Data Aggregation[2m > [22m[2mSystem-Wide Statistics Aggregation[2m > [22m[2mshould handle null aggregate values gracefully
[22m[39mðŸ§¹ Cleaning up after test...

[90mstdout[2m | src/modules/analytics/analytics.integration.spec.ts[2m > [22m[2mAnalytics System Integration Tests[2m > [22m[2mReport Generation Pipeline[2m > [22m[2mSystem Health Monitoring[2m > [22m[2mshould execute complete health check workflow
[22m[39mðŸ§¹ Cleaning up after test...

[90mstdout[2m | src/modules/analytics/analytics.integration.spec.ts[2m > [22m[2mAnalytics System Integration Tests[2m > [22m[2mReport Generation Pipeline[2m > [22m[2mSystem Health Monitoring[2m > [22m[2mshould detect and warn about critical error rates
[22m[39mðŸ§¹ Cleaning up after test...

[90mstdout[2m | src/modules/analytics/analytics.integration.spec.ts[2m > [22m[2mAnalytics System Integration Tests[2m > [22m[2mReport Generation Pipeline[2m > [22m[2mSystem Health Monitoring[2m > [22m[2mshould handle database connection failure
[22m[39mðŸ§¹ Cleaning up after test...

[90mstdout[2m | src/modules/analytics/analytics.integration.spec.ts[2m > [22m[2mAnalytics System Integration Tests[2m > [22m[2mReport Generation Pipeline[2m > [22m[2mLog Aggregation and Archiving[2m > [22m[2mshould aggregate and archive behavior logs successfully
[22m[39mðŸ§¹ Cleaning up after test...

[90mstdout[2m | src/modules/analytics/analytics.integration.spec.ts[2m > [22m[2mAnalytics System Integration Tests[2m > [22m[2mReport Generation Pipeline[2m > [22m[2mLog Aggregation and Archiving[2m > [22m[2mshould skip aggregation when no logs exist
[22m[39mðŸ§¹ Cleaning up after test...

[90mstdout[2m | src/modules/analytics/analytics.integration.spec.ts[2m > [22m[2mAnalytics System Integration Tests[2m > [22m[2mReport Generation Pipeline[2m > [22m[2mLog Aggregation and Archiving[2m > [22m[2mshould handle aggregation errors gracefully
[22m[39mðŸ§¹ Cleaning up after test...

[90mstdout[2m | src/modules/analytics/analytics.integration.spec.ts[2m > [22m[2mAnalytics System Integration Tests[2m > [22m[2mReport Generation Pipeline[2m > [22m[2mVariable Reward Distribution[2m > [22m[2mshould award variable rewards based on lesson completion
[22m[39mðŸ§¹ Cleaning up after test...

[90mstdout[2m | src/modules/analytics/analytics.integration.spec.ts[2m > [22m[2mAnalytics System Integration Tests[2m > [22m[2mReport Generation Pipeline[2m > [22m[2mVariable Reward Distribution[2m > [22m[2mshould not award rewards when random threshold not met
[22m[39mðŸ§¹ Cleaning up after test...

[90mstdout[2m | src/modules/analytics/analytics.integration.spec.ts[2m > [22m[2mAnalytics System Integration Tests[2m > [22m[2mReport Generation Pipeline[2m > [22m[2mVariable Reward Distribution[2m > [22m[2mshould include reward notification in AI response context
[22m[39mðŸ§¹ Cleaning up after test...

[90mstdout[2m | src/modules/analytics/analytics.integration.spec.ts[2m > [22m[2mAnalytics System Integration Tests[2m > [22m[2mDependency Mocking and Isolation[2m > [22m[2mshould properly mock all Prisma dependencies
[22m[39mðŸ§¹ Cleaning up after test...

[90mstdout[2m | src/modules/analytics/analytics.integration.spec.ts[2m > [22m[2mAnalytics System Integration Tests[2m > [22m[2mDependency Mocking and Isolation[2m > [22m[2mshould properly mock GeminiService
[22m[39mðŸ§¹ Cleaning up after test...

[90mstdout[2m | src/modules/analytics/analytics.integration.spec.ts[2m > [22m[2mAnalytics System Integration Tests[2m > [22m[2mDependency Mocking and Isolation[2m > [22m[2mshould properly mock EventEmitter2
[22m[39mðŸ§¹ Cleaning up after test...

[90mstdout[2m | src/modules/analytics/analytics.integration.spec.ts[2m > [22m[2mAnalytics System Integration Tests[2m > [22m[2mDependency Mocking and Isolation[2m > [22m[2mshould ensure service dependencies are injected correctly
[22m[39mðŸ§¹ Cleaning up after test...

[90mstdout[2m | src/modules/analytics/analytics.integration.spec.ts[2m > [22m[2mAnalytics System Integration Tests[2m > [22m[2mDependency Mocking and Isolation[2m > [22m[2mshould handle circular dependencies between analytics and predictive services
[22m[39mðŸ§¹ Cleaning up after test...

[90mstdout[2m | src/modules/analytics/analytics.integration.spec.ts[2m > [22m[2mAnalytics System Integration Tests[2m > [22m[2mEdge Cases and Error Handling[2m > [22m[2mshould handle empty user data gracefully
[22m[39mðŸ§¹ Cleaning up after test...

[90mstdout[2m | src/modules/analytics/analytics.integration.spec.ts[2m > [22m[2mAnalytics System Integration Tests[2m > [22m[2mEdge Cases and Error Handling[2m > [22m[2mshould handle invalid date ranges in log queries
[22m[39mðŸ§¹ Cleaning up after test...

[90mstdout[2m | src/modules/analytics/analytics.integration.spec.ts[2m > [22m[2mAnalytics System Integration Tests[2m > [22m[2mEdge Cases and Error Handling[2m > [22m[2mshould handle concurrent health checks without race conditions
[22m[39mðŸ§¹ Cleaning up after test...

[90mstdout[2m | src/modules/analytics/analytics.integration.spec.ts[2m > [22m[2mAnalytics System Integration Tests[2m > [22m[2mEdge Cases and Error Handling[2m > [22m[2mshould maintain data consistency during aggregation failures
[22m[39mðŸ§¹ Cleaning up after test...

[90mstdout[2m | src/modules/analytics/analytics.integration.spec.ts[2m > [22m[2mAnalytics System Integration Tests[2m > [22m[2mPerformance and Scalability[2m > [22m[2mshould efficiently handle large behavior log datasets
[22m[39mðŸ§¹ Cleaning up after test...

 [32mâœ“[39m src/modules/analytics/analytics.integration.spec.ts[2m > [22mAnalytics System Integration Tests[2m > [22mEnd-to-End Analytics Flows[2m > [22mUser Behavior Analysis Pipeline[2m > [22mshould analyze user behavior from raw logs to persona classification
 [32mâœ“[39m src/modules/analytics/analytics.integration.spec.ts[2m > [22mAnalytics System Integration Tests[2m > [22mEnd-to-End Analytics Flows[2m > [22mUser Behavior Analysis Pipeline[2m > [22mshould handle SAVER persona with commitment-focused behavior
 [32mâœ“[39m src/modules/analytics/analytics.integration.spec.ts[2m > [22mAnalytics System Integration Tests[2m > [22mEnd-to-End Analytics Flows[2m > [22mUser Behavior Analysis Pipeline[2m > [22mshould default to OBSERVER for mixed behavior
 [32mâœ“[39m src/modules/analytics/analytics.integration.spec.ts[2m > [22mAnalytics System Integration Tests[2m > [22mEnd-to-End Analytics Flows[2m > [22mLearning Habits Analysis[2m > [22mshould identify peak learning hours from activity patterns
 [32mâœ“[39m src/modules/analytics/analytics.integration.spec.ts[2m > [22mAnalytics System Integration Tests[2m > [22mEnd-to-End Analytics Flows[2m > [22mLearning Habits Analysis[2m > [22mshould return null for users with no activity
 [32mâœ“[39m src/modules/analytics/analytics.integration.spec.ts[2m > [22mAnalytics System Integration Tests[2m > [22mEnd-to-End Analytics Flows[2m > [22mPredictive Analysis Pipeline[2m > [22mshould generate complete financial future simulation with persona context
 [32mâœ“[39m src/modules/analytics/analytics.integration.spec.ts[2m > [22mAnalytics System Integration Tests[2m > [22mEnd-to-End Analytics Flows[2m > [22mPredictive Analysis Pipeline[2m > [22mshould predict churn risk based on activity gaps
 [32mâœ“[39m src/modules/analytics/analytics.integration.spec.ts[2m > [22mAnalytics System Integration Tests[2m > [22mEnd-to-End Analytics Flows[2m > [22mPredictive Analysis Pipeline[2m > [22mshould return HIGH churn risk for large activity gaps
 [32mâœ“[39m src/modules/analytics/analytics.integration.spec.ts[2m > [22mAnalytics System Integration Tests[2m > [22mEnd-to-End Analytics Flows[2m > [22mPredictive Analysis Pipeline[2m > [22mshould return LOW churn risk for consistent daily activity
 [32mâœ“[39m src/modules/analytics/analytics.integration.spec.ts[2m > [22mAnalytics System Integration Tests[2m > [22mCross-Service Data Aggregation[2m > [22mMentor Service with Analytics Integration[2m > [22mshould integrate persona, churn risk, and user profile for personalized advice
 [32mâœ“[39m src/modules/analytics/analytics.integration.spec.ts[2m > [22mAnalytics System Integration Tests[2m > [22mCross-Service Data Aggregation[2m > [22mMentor Service with Analytics Integration[2m > [22mshould select WISE_SAGE persona for SAVER users
 [32mâœ“[39m src/modules/analytics/analytics.integration.spec.ts[2m > [22mAnalytics System Integration Tests[2m > [22mCross-Service Data Aggregation[2m > [22mMentor Service with Analytics Integration[2m > [22mshould include high churn risk warning in AI context
 [32mâœ“[39m src/modules/analytics/analytics.integration.spec.ts[2m > [22mAnalytics System Integration Tests[2m > [22mCross-Service Data Aggregation[2m > [22mSystem-Wide Statistics Aggregation[2m > [22mshould aggregate data from multiple Prisma models
 [32mâœ“[39m src/modules/analytics/analytics.integration.spec.ts[2m > [22mAnalytics System Integration Tests[2m > [22mCross-Service Data Aggregation[2m > [22mSystem-Wide Statistics Aggregation[2m > [22mshould handle null aggregate values gracefully
 [32mâœ“[39m src/modules/analytics/analytics.integration.spec.ts[2m > [22mAnalytics System Integration Tests[2m > [22mReport Generation Pipeline[2m > [22mSystem Health Monitoring[2m > [22mshould execute complete health check workflow
 [32mâœ“[39m src/modules/analytics/analytics.integration.spec.ts[2m > [22mAnalytics System Integration Tests[2m > [22mReport Generation Pipeline[2m > [22mSystem Health Monitoring[2m > [22mshould detect and warn about critical error rates
 [32mâœ“[39m src/modules/analytics/analytics.integration.spec.ts[2m > [22mAnalytics System Integration Tests[2m > [22mReport Generation Pipeline[2m > [22mSystem Health Monitoring[2m > [22mshould handle database connection failure
 [32mâœ“[39m src/modules/analytics/analytics.integration.spec.ts[2m > [22mAnalytics System Integration Tests[2m > [22mReport Generation Pipeline[2m > [22mLog Aggregation and Archiving[2m > [22mshould aggregate and archive behavior logs successfully
 [32mâœ“[39m src/modules/analytics/analytics.integration.spec.ts[2m > [22mAnalytics System Integration Tests[2m > [22mReport Generation Pipeline[2m > [22mLog Aggregation and Archiving[2m > [22mshould skip aggregation when no logs exist
 [32mâœ“[39m src/modules/analytics/analytics.integration.spec.ts[2m > [22mAnalytics System Integration Tests[2m > [22mReport Generation Pipeline[2m > [22mLog Aggregation and Archiving[2m > [22mshould handle aggregation errors gracefully
 [32mâœ“[39m src/modules/analytics/analytics.integration.spec.ts[2m > [22mAnalytics System Integration Tests[2m > [22mReport Generation Pipeline[2m > [22mVariable Reward Distribution[2m > [22mshould award variable rewards based on lesson completion
 [32mâœ“[39m src/modules/analytics/analytics.integration.spec.ts[2m > [22mAnalytics System Integration Tests[2m > [22mReport Generation Pipeline[2m > [22mVariable Reward Distribution[2m > [22mshould not award rewards when random threshold not met
 [32mâœ“[39m src/modules/analytics/analytics.integration.spec.ts[2m > [22mAnalytics System Integration Tests[2m > [22mReport Generation Pipeline[2m > [22mVariable Reward Distribution[2m > [22mshould include reward notification in AI response context
 [32mâœ“[39m src/modules/analytics/analytics.integration.spec.ts[2m > [22mAnalytics System Integration Tests[2m > [22mDependency Mocking and Isolation[2m > [22mshould properly mock all Prisma dependencies
 [32mâœ“[39m src/modules/analytics/analytics.integration.spec.ts[2m > [22mAnalytics System Integration Tests[2m > [22mDependency Mocking and Isolation[2m > [22mshould properly mock GeminiService
 [32mâœ“[39m src/modules/analytics/analytics.integration.spec.ts[2m > [22mAnalytics System Integration Tests[2m > [22mDependency Mocking and Isolation[2m > [22mshould properly mock EventEmitter2
 [32mâœ“[39m src/modules/analytics/analytics.integration.spec.ts[2m > [22mAnalytics System Integration Tests[2m > [22mDependency Mocking and Isolation[2m > [22mshould ensure service dependencies are injected correctly
 [32mâœ“[39m src/modules/analytics/analytics.integration.spec.ts[2m > [22mAnalytics System Integration Tests[2m > [22mDependency Mocking and Isolation[2m > [22mshould handle circular dependencies between analytics and predictive services
 [32mâœ“[39m src/modules/analytics/analytics.integration.spec.ts[2m > [22mAnalytics System Integration Tests[2m > [22mEdge Cases and Error Handling[2m > [22mshould handle empty user data gracefully
 [32mâœ“[39m src/modules/analytics/analytics.integration.spec.ts[2m > [22mAnalytics System Integration Tests[2m > [22mEdge Cases and Error Handling[2m > [22mshould handle invalid date ranges in log queries
 [32mâœ“[39m src/modules/analytics/analytics.integration.spec.ts[2m > [22mAnalytics System Integration Tests[2m > [22mEdge Cases and Error Handling[2m > [22mshould handle concurrent health checks without race conditions
 [32mâœ“[39m src/modules/analytics/analytics.integration.spec.ts[2m > [22mAnalytics System Integration Tests[2m > [22mEdge Cases and Error Handling[2m > [22mshould maintain data consistency during aggregation failures
 [32mâœ“[39m src/modules/analytics/analytics.integration.spec.ts[2m > [22mAnalytics System Integration Tests[2m > [22mPerformance and Scalability[2m > [22mshould efficiently handle large behavior log datasets
 [32mâœ“[39m src/modules/analytics/analytics.integration.spec.ts[2m > [22mAnalytics System Integration Tests[2m > [22mPerformance and Scalability[2m > [22mshould batch process multiple user personas efficiently
[90mstdout[2m | src/modules/analytics/analytics.integration.spec.ts[2m > [22m[2mAnalytics System Integration Tests[2m > [22m[2mPerformance and Scalability[2m > [22m[2mshould batch process multiple user personas efficiently
[22m[39mðŸ§¹ Cleaning up after test...

[90mstdout[2m | src/modules/analytics/analytics.integration.spec.ts
[22m[39mðŸ”§ Vitest setup: Starting MSW mock server...
âœ… Vitest teardown complete

[90mstdout[2m | src/modules/analytics/reports.service.spec.ts[2m > [22m[2mReportsService[2m > [22m[2mgenerateReport[2m > [22m[2mshould generate daily report with correct metrics
[22m[39mðŸ§¹ Cleaning up after test...

[90mstdout[2m | src/modules/analytics/reports.service.spec.ts[2m > [22m[2mReportsService[2m > [22m[2mgenerateReport[2m > [22m[2mshould generate weekly report with aggregated data
[22m[39mðŸ§¹ Cleaning up after test...

[90mstdout[2m | src/modules/analytics/reports.service.spec.ts[2m > [22m[2mReportsService[2m > [22m[2mgenerateReport[2m > [22m[2mshould generate monthly report with top users
[22m[39mðŸ§¹ Cleaning up after test...

[90mstdout[2m | src/modules/analytics/reports.service.spec.ts[2m > [22m[2mReportsService[2m > [22m[2mgenerateReport[2m > [22m[2mshould filter report by userId when provided
[22m[39mðŸ§¹ Cleaning up after test...

[90mstdout[2m | src/modules/analytics/reports.service.spec.ts[2m > [22m[2mReportsService[2m > [22m[2mgenerateReport[2m > [22m[2mshould handle custom date range
[22m[39mðŸ§¹ Cleaning up after test...

[90mstdout[2m | src/modules/analytics/reports.service.spec.ts[2m > [22m[2mReportsService[2m > [22m[2mexportToCSV[2m > [22m[2mshould export report to CSV format in Vietnamese
[22m[39mðŸ§¹ Cleaning up after test...

[90mstdout[2m | src/modules/analytics/reports.service.spec.ts[2m > [22m[2mReportsService[2m > [22m[2mexportToCSV[2m > [22m[2mshould export report to CSV format in English
[22m[39mðŸ§¹ Cleaning up after test...

[90mstdout[2m | src/modules/analytics/reports.service.spec.ts[2m > [22m[2mReportsService[2m > [22m[2mexportToCSV[2m > [22m[2mshould export report to CSV format in Chinese
[22m[39mðŸ§¹ Cleaning up after test...

[90mstdout[2m | src/modules/analytics/reports.service.spec.ts[2m > [22m[2mReportsService[2m > [22m[2mexportToPDF[2m > [22m[2mshould export report to PDF format in Vietnamese
[22m[39mðŸ§¹ Cleaning up after test...

[90mstdout[2m | src/modules/analytics/reports.service.spec.ts[2m > [22m[2mReportsService[2m > [22m[2mexportToPDF[2m > [22m[2mshould export report to PDF format in English
[22m[39mðŸ§¹ Cleaning up after test...

[90mstdout[2m | src/modules/analytics/reports.service.spec.ts[2m > [22m[2mReportsService[2m > [22m[2mexportToPDF[2m > [22m[2mshould export report to PDF format in Chinese
[22m[39mðŸ§¹ Cleaning up after test...

[90mstdout[2m | src/modules/analytics/reports.service.spec.ts[2m > [22m[2mReportsService[2m > [22m[2mprepareVisualizationData[2m > [22m[2mshould prepare data for bar chart visualization
[22m[39mðŸ§¹ Cleaning up after test...

[90mstdout[2m | src/modules/analytics/reports.service.spec.ts[2m > [22m[2mReportsService[2m > [22m[2mprepareVisualizationData[2m > [22m[2mshould prepare data for pie chart (activity distribution)
[22m[39mðŸ§¹ Cleaning up after test...

[90mstdout[2m | src/modules/analytics/reports.service.spec.ts[2m > [22m[2mReportsService[2m > [22m[2mprepareVisualizationData[2m > [22m[2mshould prepare data for horizontal bar chart (top users)
[22m[39mðŸ§¹ Cleaning up after test...

[90mstdout[2m | src/modules/analytics/reports.service.spec.ts[2m > [22m[2mReportsService[2m > [22m[2mprepareVisualizationData[2m > [22m[2mshould prepare data for gauge chart (progress)
[22m[39mðŸ§¹ Cleaning up after test...

[90mstdout[2m | src/modules/analytics/reports.service.spec.ts[2m > [22m[2mReportsService[2m > [22m[2maggregated data mocking[2m > [22m[2mshould handle large datasets efficiently
[22m[39mðŸ§¹ Cleaning up after test...

[90mstdout[2m | src/modules/analytics/reports.service.spec.ts[2m > [22m[2mReportsService[2m > [22m[2maggregated data mocking[2m > [22m[2mshould sort activities by count descending
[22m[39mðŸ§¹ Cleaning up after test...

[90mstdout[2m | src/modules/analytics/reports.service.spec.ts[2m > [22m[2mReportsService[2m > [22m[2maggregated data mocking[2m > [22m[2mshould limit activities to top 10
[22m[39mðŸ§¹ Cleaning up after test...

[90mstdout[2m | src/modules/analytics/reports.service.spec.ts[2m > [22m[2mReportsService[2m > [22m[2medge cases[2m > [22m[2mshould handle zero metrics gracefully
[22m[39mðŸ§¹ Cleaning up after test...

[90mstdout[2m | src/modules/analytics/reports.service.spec.ts[2m > [22m[2mReportsService[2m > [22m[2medge cases[2m > [22m[2mshould handle report with no activities
[22m[39mðŸ§¹ Cleaning up after test...

[90mstdout[2m | src/modules/analytics/reports.service.spec.ts
[22m[39mðŸ”§ Vitest setup: Starting MSW mock server...
âœ… Vitest teardown complete

 [31mÃ—[39m src/modules/analytics/reports.service.spec.ts[2m > [22mReportsService[2m > [22mgenerateReport[2m > [22mshould generate daily report with correct metrics
[31m   â†’ expected 3 to be 2 // Object.is equality[39m
 [32mâœ“[39m src/modules/analytics/reports.service.spec.ts[2m > [22mReportsService[2m > [22mgenerateReport[2m > [22mshould generate weekly report with aggregated data
 [32mâœ“[39m src/modules/analytics/reports.service.spec.ts[2m > [22mReportsService[2m > [22mgenerateReport[2m > [22mshould generate monthly report with top users
 [32mâœ“[39m src/modules/analytics/reports.service.spec.ts[2m > [22mReportsService[2m > [22mgenerateReport[2m > [22mshould filter report by userId when provided
 [32mâœ“[39m src/modules/analytics/reports.service.spec.ts[2m > [22mReportsService[2m > [22mgenerateReport[2m > [22mshould handle custom date range
 [32mâœ“[39m src/modules/analytics/reports.service.spec.ts[2m > [22mReportsService[2m > [22mexportToCSV[2m > [22mshould export report to CSV format in Vietnamese
 [32mâœ“[39m src/modules/analytics/reports.service.spec.ts[2m > [22mReportsService[2m > [22mexportToCSV[2m > [22mshould export report to CSV format in English
 [32mâœ“[39m src/modules/analytics/reports.service.spec.ts[2m > [22mReportsService[2m > [22mexportToCSV[2m > [22mshould export report to CSV format in Chinese
 [32mâœ“[39m src/modules/analytics/reports.service.spec.ts[2m > [22mReportsService[2m > [22mexportToPDF[2m > [22mshould export report to PDF format in Vietnamese
 [32mâœ“[39m src/modules/analytics/reports.service.spec.ts[2m > [22mReportsService[2m > [22mexportToPDF[2m > [22mshould export report to PDF format in English
 [32mâœ“[39m src/modules/analytics/reports.service.spec.ts[2m > [22mReportsService[2m > [22mexportToPDF[2m > [22mshould export report to PDF format in Chinese
 [32mâœ“[39m src/modules/analytics/reports.service.spec.ts[2m > [22mReportsService[2m > [22mprepareVisualizationData[2m > [22mshould prepare data for bar chart visualization
 [32mâœ“[39m src/modules/analytics/reports.service.spec.ts[2m > [22mReportsService[2m > [22mprepareVisualizationData[2m > [22mshould prepare data for pie chart (activity distribution)
 [32mâœ“[39m src/modules/analytics/reports.service.spec.ts[2m > [22mReportsService[2m > [22mprepareVisualizationData[2m > [22mshould prepare data for horizontal bar chart (top users)
 [32mâœ“[39m src/modules/analytics/reports.service.spec.ts[2m > [22mReportsService[2m > [22mprepareVisualizationData[2m > [22mshould prepare data for gauge chart (progress)
 [32mâœ“[39m src/modules/analytics/reports.service.spec.ts[2m > [22mReportsService[2m > [22maggregated data mocking[2m > [22mshould handle large datasets efficiently
 [32mâœ“[39m src/modules/analytics/reports.service.spec.ts[2m > [22mReportsService[2m > [22maggregated data mocking[2m > [22mshould sort activities by count descending
 [32mâœ“[39m src/modules/analytics/reports.service.spec.ts[2m > [22mReportsService[2m > [22maggregated data mocking[2m > [22mshould limit activities to top 10
 [32mâœ“[39m src/modules/analytics/reports.service.spec.ts[2m > [22mReportsService[2m > [22medge cases[2m > [22mshould handle zero metrics gracefully
 [32mâœ“[39m src/modules/analytics/reports.service.spec.ts[2m > [22mReportsService[2m > [22medge cases[2m > [22mshould handle report with no activities
[90mstdout[2m | src/modules/analytics/behavior-tracking.service.spec.ts[2m > [22m[2mBehaviorTrackingService - Comprehensive Tests[2m > [22m[2mEvent Logging - Standard Events[2m > [22m[2mshould log PAGE_VIEW event with correct structure
[22m[39mðŸ§¹ Cleaning up after test...

[90mstdout[2m | src/modules/analytics/behavior-tracking.service.spec.ts[2m > [22m[2mBehaviorTrackingService - Comprehensive Tests[2m > [22m[2mEvent Logging - Standard Events[2m > [22m[2mshould log BUTTON_CLICK event with element metadata
[22m[39mðŸ§¹ Cleaning up after test...

[90mstdout[2m | src/modules/analytics/behavior-tracking.service.spec.ts[2m > [22m[2mBehaviorTrackingService - Comprehensive Tests[2m > [22m[2mEvent Logging - Standard Events[2m > [22m[2mshould log SCROLL event with scroll depth
[22m[39mðŸ§¹ Cleaning up after test...

[90mstdout[2m | src/modules/analytics/behavior-tracking.service.spec.ts[2m > [22m[2mBehaviorTrackingService - Comprehensive Tests[2m > [22m[2mEvent Logging - Standard Events[2m > [22m[2mshould log VIDEO_PLAY event with playback metadata
[22m[39mðŸ§¹ Cleaning up after test...

[90mstdout[2m | src/modules/analytics/behavior-tracking.service.spec.ts[2m > [22m[2mBehaviorTrackingService - Comprehensive Tests[2m > [22m[2mEvent Logging - Standard Events[2m > [22m[2mshould log FORM_SUBMIT event with validation results
[22m[39mðŸ§¹ Cleaning up after test...

[90mstdout[2m | src/modules/analytics/behavior-tracking.service.spec.ts[2m > [22m[2mBehaviorTrackingService - Comprehensive Tests[2m > [22m[2mUser Session Tracking[2m > [22m[2mshould track multiple events within same session
[22m[39mðŸ§¹ Cleaning up after test...

[90mstdout[2m | src/modules/analytics/behavior-tracking.service.spec.ts[2m > [22m[2mBehaviorTrackingService - Comprehensive Tests[2m > [22m[2mUser Session Tracking[2m > [22m[2mshould retrieve all events for a specific session
[22m[39mðŸ§¹ Cleaning up after test...

[90mstdout[2m | src/modules/analytics/behavior-tracking.service.spec.ts[2m > [22m[2mBehaviorTrackingService - Comprehensive Tests[2m > [22m[2mUser Session Tracking[2m > [22m[2mshould count active sessions in time window
[22m[39mðŸ§¹ Cleaning up after test...

[90mstdout[2m | src/modules/analytics/behavior-tracking.service.spec.ts[2m > [22m[2mBehaviorTrackingService - Comprehensive Tests[2m > [22m[2mUser Session Tracking[2m > [22m[2mshould handle session timeout edge cases
[22m[39mðŸ§¹ Cleaning up after test...

[90mstdout[2m | src/modules/analytics/behavior-tracking.service.spec.ts[2m > [22m[2mBehaviorTrackingService - Comprehensive Tests[2m > [22m[2mEvent Aggregation Logic[2m > [22m[2mshould aggregate events by type for date range
[22m[39mðŸ§¹ Cleaning up after test...

[90mstdout[2m | src/modules/analytics/behavior-tracking.service.spec.ts[2m > [22m[2mBehaviorTrackingService - Comprehensive Tests[2m > [22m[2mEvent Aggregation Logic[2m > [22m[2mshould handle empty event set in aggregation
[22m[39mðŸ§¹ Cleaning up after test...

[90mstdout[2m | src/modules/analytics/behavior-tracking.service.spec.ts[2m > [22m[2mBehaviorTrackingService - Comprehensive Tests[2m > [22m[2mEvent Aggregation Logic[2m > [22m[2mshould aggregate events with missing duration
[22m[39mðŸ§¹ Cleaning up after test...

[90mstdout[2m | src/modules/analytics/behavior-tracking.service.spec.ts[2m > [22m[2mBehaviorTrackingService - Comprehensive Tests[2m > [22m[2mJSONB Metadata Structure Validation[2m > [22m[2mshould validate nested JSONB payload structure
[22m[39mðŸ§¹ Cleaning up after test...

[90mstdout[2m | src/modules/analytics/behavior-tracking.service.spec.ts[2m > [22m[2mBehaviorTrackingService - Comprehensive Tests[2m > [22m[2mJSONB Metadata Structure Validation[2m > [22m[2mshould handle multi-locale JSONB content
[22m[39mðŸ§¹ Cleaning up after test...

[90mstdout[2m | src/modules/analytics/behavior-tracking.service.spec.ts[2m > [22m[2mBehaviorTrackingService - Comprehensive Tests[2m > [22m[2mJSONB Metadata Structure Validation[2m > [22m[2mshould preserve deviceInfo JSONB structure
[22m[39mðŸ§¹ Cleaning up after test...

[90mstdout[2m | src/modules/analytics/behavior-tracking.service.spec.ts[2m > [22m[2mBehaviorTrackingService - Comprehensive Tests[2m > [22m[2mJSONB Metadata Structure Validation[2m > [22m[2mshould handle array data in JSONB payload
[22m[39mðŸ§¹ Cleaning up after test...

[90mstdout[2m | src/modules/analytics/behavior-tracking.service.spec.ts[2m > [22m[2mBehaviorTrackingService - Comprehensive Tests[2m > [22m[2mDatabase Operation Mocking[2m > [22m[2mshould handle database create success
[22m[39mðŸ§¹ Cleaning up after test...

[90mstdout[2m | src/modules/analytics/behavior-tracking.service.spec.ts[2m > [22m[2mBehaviorTrackingService - Comprehensive Tests[2m > [22m[2mDatabase Operation Mocking[2m > [22m[2mshould handle database create failure
[22m[39mðŸ§¹ Cleaning up after test...

[90mstdout[2m | src/modules/analytics/behavior-tracking.service.spec.ts[2m > [22m[2mBehaviorTrackingService - Comprehensive Tests[2m > [22m[2mDatabase Operation Mocking[2m > [22m[2mshould handle concurrent database operations
[22m[39mðŸ§¹ Cleaning up after test...

[90mstdout[2m | src/modules/analytics/behavior-tracking.service.spec.ts[2m > [22m[2mBehaviorTrackingService - Comprehensive Tests[2m > [22m[2mDatabase Operation Mocking[2m > [22m[2mshould handle findMany with complex filters
[22m[39mðŸ§¹ Cleaning up after test...

[90mstdout[2m | src/modules/analytics/behavior-tracking.service.spec.ts[2m > [22m[2mBehaviorTrackingService - Comprehensive Tests[2m > [22m[2mDatabase Operation Mocking[2m > [22m[2mshould handle empty result set from database
[22m[39mðŸ§¹ Cleaning up after test...

[90mstdout[2m | src/modules/analytics/behavior-tracking.service.spec.ts[2m > [22m[2mBehaviorTrackingService - Comprehensive Tests[2m > [22m[2mEdge Cases & Error Handling[2m > [22m[2mshould handle undefined userId for anonymous tracking
[22m[39mðŸ§¹ Cleaning up after test...

[90mstdout[2m | src/modules/analytics/behavior-tracking.service.spec.ts[2m > [22m[2mBehaviorTrackingService - Comprehensive Tests[2m > [22m[2mEdge Cases & Error Handling[2m > [22m[2mshould handle null userId for anonymous tracking
[22m[39mðŸ§¹ Cleaning up after test...

[90mstdout[2m | src/modules/analytics/behavior-tracking.service.spec.ts[2m > [22m[2mBehaviorTrackingService - Comprehensive Tests[2m > [22m[2mEdge Cases & Error Handling[2m > [22m[2mshould set default actionCategory when not provided
[22m[39mðŸ§¹ Cleaning up after test...

[90mstdout[2m | src/modules/analytics/behavior-tracking.service.spec.ts[2m > [22m[2mBehaviorTrackingService - Comprehensive Tests[2m > [22m[2mEdge Cases & Error Handling[2m > [22m[2mshould set default duration to 0 when not provided
[22m[39mðŸ§¹ Cleaning up after test...

[90mstdout[2m | src/modules/analytics/behavior-tracking.service.spec.ts[2m > [22m[2mBehaviorTrackingService - Comprehensive Tests[2m > [22m[2mEdge Cases & Error Handling[2m > [22m[2mshould handle extremely large payload data
[22m[39mðŸ§¹ Cleaning up after test...

[90mstdout[2m | src/modules/analytics/behavior-tracking.service.spec.ts[2m > [22m[2mBehaviorTrackingService - Comprehensive Tests[2m > [22m[2mEdge Cases & Error Handling[2m > [22m[2mshould handle special characters in path and eventType
[22m[39mðŸ§¹ Cleaning up after test...

[90mstdout[2m | src/modules/analytics/behavior-tracking.service.spec.ts[2m > [22m[2mBehaviorTrackingService - Comprehensive Tests[2m > [22m[2mPerformance & Scalability[2m > [22m[2mshould handle rapid sequential logging without blocking
[22m[39mðŸ§¹ Cleaning up after test...

[90mstdout[2m | src/modules/analytics/behavior-tracking.service.spec.ts[2m > [22m[2mBehaviorTrackingService - Comprehensive Tests[2m > [22m[2mPerformance & Scalability[2m > [22m[2mshould handle parallel event logging efficiently
[22m[39mðŸ§¹ Cleaning up after test...

 [32mâœ“[39m src/modules/analytics/behavior-tracking.service.spec.ts[2m > [22mBehaviorTrackingService - Comprehensive Tests[2m > [22mEvent Logging - Standard Events[2m > [22mshould log PAGE_VIEW event with correct structure
 [32mâœ“[39m src/modules/analytics/behavior-tracking.service.spec.ts[2m > [22mBehaviorTrackingService - Comprehensive Tests[2m > [22mEvent Logging - Standard Events[2m > [22mshould log BUTTON_CLICK event with element metadata
 [32mâœ“[39m src/modules/analytics/behavior-tracking.service.spec.ts[2m > [22mBehaviorTrackingService - Comprehensive Tests[2m > [22mEvent Logging - Standard Events[2m > [22mshould log SCROLL event with scroll depth
 [32mâœ“[39m src/modules/analytics/behavior-tracking.service.spec.ts[2m > [22mBehaviorTrackingService - Comprehensive Tests[2m > [22mEvent Logging - Standard Events[2m > [22mshould log VIDEO_PLAY event with playback metadata
 [32mâœ“[39m src/modules/analytics/behavior-tracking.service.spec.ts[2m > [22mBehaviorTrackingService - Comprehensive Tests[2m > [22mEvent Logging - Standard Events[2m > [22mshould log FORM_SUBMIT event with validation results
 [32mâœ“[39m src/modules/analytics/behavior-tracking.service.spec.ts[2m > [22mBehaviorTrackingService - Comprehensive Tests[2m > [22mUser Session Tracking[2m > [22mshould track multiple events within same session
 [32mâœ“[39m src/modules/analytics/behavior-tracking.service.spec.ts[2m > [22mBehaviorTrackingService - Comprehensive Tests[2m > [22mUser Session Tracking[2m > [22mshould retrieve all events for a specific session
 [32mâœ“[39m src/modules/analytics/behavior-tracking.service.spec.ts[2m > [22mBehaviorTrackingService - Comprehensive Tests[2m > [22mUser Session Tracking[2m > [22mshould count active sessions in time window
 [32mâœ“[39m src/modules/analytics/behavior-tracking.service.spec.ts[2m > [22mBehaviorTrackingService - Comprehensive Tests[2m > [22mUser Session Tracking[2m > [22mshould handle session timeout edge cases
 [32mâœ“[39m src/modules/analytics/behavior-tracking.service.spec.ts[2m > [22mBehaviorTrackingService - Comprehensive Tests[2m > [22mEvent Aggregation Logic[2m > [22mshould aggregate events by type for date range
 [32mâœ“[39m src/modules/analytics/behavior-tracking.service.spec.ts[2m > [22mBehaviorTrackingService - Comprehensive Tests[2m > [22mEvent Aggregation Logic[2m > [22mshould handle empty event set in aggregation
 [32mâœ“[39m src/modules/analytics/behavior-tracking.service.spec.ts[2m > [22mBehaviorTrackingService - Comprehensive Tests[2m > [22mEvent Aggregation Logic[2m > [22mshould aggregate events with missing duration
 [32mâœ“[39m src/modules/analytics/behavior-tracking.service.spec.ts[2m > [22mBehaviorTrackingService - Comprehensive Tests[2m > [22mJSONB Metadata Structure Validation[2m > [22mshould validate nested JSONB payload structure
 [32mâœ“[39m src/modules/analytics/behavior-tracking.service.spec.ts[2m > [22mBehaviorTrackingService - Comprehensive Tests[2m > [22mJSONB Metadata Structure Validation[2m > [22mshould handle multi-locale JSONB content
 [32mâœ“[39m src/modules/analytics/behavior-tracking.service.spec.ts[2m > [22mBehaviorTrackingService - Comprehensive Tests[2m > [22mJSONB Metadata Structure Validation[2m > [22mshould preserve deviceInfo JSONB structure
 [32mâœ“[39m src/modules/analytics/behavior-tracking.service.spec.ts[2m > [22mBehaviorTrackingService - Comprehensive Tests[2m > [22mJSONB Metadata Structure Validation[2m > [22mshould handle array data in JSONB payload
 [32mâœ“[39m src/modules/analytics/behavior-tracking.service.spec.ts[2m > [22mBehaviorTrackingService - Comprehensive Tests[2m > [22mDatabase Operation Mocking[2m > [22mshould handle database create success
 [32mâœ“[39m src/modules/analytics/behavior-tracking.service.spec.ts[2m > [22mBehaviorTrackingService - Comprehensive Tests[2m > [22mDatabase Operation Mocking[2m > [22mshould handle database create failure
 [32mâœ“[39m src/modules/analytics/behavior-tracking.service.spec.ts[2m > [22mBehaviorTrackingService - Comprehensive Tests[2m > [22mDatabase Operation Mocking[2m > [22mshould handle concurrent database operations
 [32mâœ“[39m src/modules/analytics/behavior-tracking.service.spec.ts[2m > [22mBehaviorTrackingService - Comprehensive Tests[2m > [22mDatabase Operation Mocking[2m > [22mshould handle findMany with complex filters
 [32mâœ“[39m src/modules/analytics/behavior-tracking.service.spec.ts[2m > [22mBehaviorTrackingService - Comprehensive Tests[2m > [22mDatabase Operation Mocking[2m > [22mshould handle empty result set from database
 [32mâœ“[39m src/modules/analytics/behavior-tracking.service.spec.ts[2m > [22mBehaviorTrackingService - Comprehensive Tests[2m > [22mEdge Cases & Error Handling[2m > [22mshould handle undefined userId for anonymous tracking
 [32mâœ“[39m src/modules/analytics/behavior-tracking.service.spec.ts[2m > [22mBehaviorTrackingService - Comprehensive Tests[2m > [22mEdge Cases & Error Handling[2m > [22mshould handle null userId for anonymous tracking
 [32mâœ“[39m src/modules/analytics/behavior-tracking.service.spec.ts[2m > [22mBehaviorTrackingService - Comprehensive Tests[2m > [22mEdge Cases & Error Handling[2m > [22mshould set default actionCategory when not provided
 [32mâœ“[39m src/modules/analytics/behavior-tracking.service.spec.ts[2m > [22mBehaviorTrackingService - Comprehensive Tests[2m > [22mEdge Cases & Error Handling[2m > [22mshould set default duration to 0 when not provided
 [32mâœ“[39m src/modules/analytics/behavior-tracking.service.spec.ts[2m > [22mBehaviorTrackingService - Comprehensive Tests[2m > [22mEdge Cases & Error Handling[2m > [22mshould handle extremely large payload data
 [32mâœ“[39m src/modules/analytics/behavior-tracking.service.spec.ts[2m > [22mBehaviorTrackingService - Comprehensive Tests[2m > [22mEdge Cases & Error Handling[2m > [22mshould handle special characters in path and eventType
 [32mâœ“[39m src/modules/analytics/behavior-tracking.service.spec.ts[2m > [22mBehaviorTrackingService - Comprehensive Tests[2m > [22mPerformance & Scalability[2m > [22mshould handle rapid sequential logging without blocking
 [32mâœ“[39m src/modules/analytics/behavior-tracking.service.spec.ts[2m > [22mBehaviorTrackingService - Comprehensive Tests[2m > [22mPerformance & Scalability[2m > [22mshould handle parallel event logging efficiently
 [32mâœ“[39m src/modules/analytics/behavior-tracking.service.spec.ts[2m > [22mBehaviorTrackingService - Comprehensive Tests[2m > [22mPerformance & Scalability[2m > [22mshould aggregate large datasets efficiently
[90mstdout[2m | src/modules/analytics/behavior-tracking.service.spec.ts[2m > [22m[2mBehaviorTrackingService - Comprehensive Tests[2m > [22m[2mPerformance & Scalability[2m > [22m[2mshould aggregate large datasets efficiently
[22m[39mðŸ§¹ Cleaning up after test...

[90mstdout[2m | src/modules/analytics/behavior-tracking.service.spec.ts
[22m[39mðŸ”§ Vitest setup: Starting MSW mock server...
âœ… Vitest teardown complete

[90mstdout[2m | src/modules/ai/moderation.service.spec.ts[2m > [22m[2mModerationService (AI Content Moderation)[2m > [22m[2mmoderateContent[2m > [22m[2mInappropriate Content Detection[2m > [22m[2mshould detect and flag explicit profanity
[22m[39mðŸ§¹ Cleaning up after test...

[90mstdout[2m | src/modules/ai/moderation.service.spec.ts[2m > [22m[2mModerationService (AI Content Moderation)[2m > [22m[2mmoderateContent[2m > [22m[2mInappropriate Content Detection[2m > [22m[2mshould detect hate speech
[22m[39mðŸ§¹ Cleaning up after test...

[90mstdout[2m | src/modules/ai/moderation.service.spec.ts[2m > [22m[2mModerationService (AI Content Moderation)[2m > [22m[2mmoderateContent[2m > [22m[2mInappropriate Content Detection[2m > [22m[2mshould detect sexual content
[22m[39mðŸ§¹ Cleaning up after test...

[90mstdout[2m | src/modules/ai/moderation.service.spec.ts[2m > [22m[2mModerationService (AI Content Moderation)[2m > [22m[2mmoderateContent[2m > [22m[2mInappropriate Content Detection[2m > [22m[2mshould detect violence and threats
[22m[39mðŸ§¹ Cleaning up after test...

[90mstdout[2m | src/modules/ai/moderation.service.spec.ts[2m > [22m[2mModerationService (AI Content Moderation)[2m > [22m[2mmoderateContent[2m > [22m[2mInappropriate Content Detection[2m > [22m[2mshould detect spam and promotional content
[22m[39mðŸ§¹ Cleaning up after test...

[90mstdout[2m | src/modules/ai/moderation.service.spec.ts[2m > [22m[2mModerationService (AI Content Moderation)[2m > [22m[2mmoderateContent[2m > [22m[2mInappropriate Content Detection[2m > [22m[2mshould allow safe content
[22m[39mðŸ§¹ Cleaning up after test...

[90mstdout[2m | src/modules/ai/moderation.service.spec.ts[2m > [22m[2mModerationService (AI Content Moderation)[2m > [22m[2mmoderateContent[2m > [22m[2mMulti-Language Moderation[2m > [22m[2mshould moderate Vietnamese content
[22m[39mðŸ§¹ Cleaning up after test...

[90mstdout[2m | src/modules/ai/moderation.service.spec.ts[2m > [22m[2mModerationService (AI Content Moderation)[2m > [22m[2mmoderateContent[2m > [22m[2mMulti-Language Moderation[2m > [22m[2mshould moderate English content
[22m[39mðŸ§¹ Cleaning up after test...

[90mstdout[2m | src/modules/ai/moderation.service.spec.ts[2m > [22m[2mModerationService (AI Content Moderation)[2m > [22m[2mmoderateContent[2m > [22m[2mMulti-Language Moderation[2m > [22m[2mshould moderate Chinese content
[22m[39mðŸ§¹ Cleaning up after test...

[90mstdout[2m | src/modules/ai/moderation.service.spec.ts[2m > [22m[2mModerationService (AI Content Moderation)[2m > [22m[2mmoderateContent[2m > [22m[2mMulti-Language Moderation[2m > [22m[2mshould auto-detect language when not specified
[22m[39mðŸ§¹ Cleaning up after test...

[90mstdout[2m | src/modules/ai/moderation.service.spec.ts[2m > [22m[2mModerationService (AI Content Moderation)[2m > [22m[2mmoderateContent[2m > [22m[2mMulti-Language Moderation[2m > [22m[2mshould handle language-specific profanity patterns
[22m[39mðŸ§¹ Cleaning up after test...

[90mstdout[2m | src/modules/ai/moderation.service.spec.ts[2m > [22m[2mModerationService (AI Content Moderation)[2m > [22m[2mmoderateContent[2m > [22m[2mSeverity Classification[2m > [22m[2mshould classify NONE severity for clean content
[22m[39mðŸ§¹ Cleaning up after test...

[90mstdout[2m | src/modules/ai/moderation.service.spec.ts[2m > [22m[2mModerationService (AI Content Moderation)[2m > [22m[2mmoderateContent[2m > [22m[2mSeverity Classification[2m > [22m[2mshould classify LOW severity for minor issues
[22m[39mðŸ§¹ Cleaning up after test...

[90mstdout[2m | src/modules/ai/moderation.service.spec.ts[2m > [22m[2mModerationService (AI Content Moderation)[2m > [22m[2mmoderateContent[2m > [22m[2mSeverity Classification[2m > [22m[2mshould classify MEDIUM severity for moderate issues
[22m[39mðŸ§¹ Cleaning up after test...

[90mstdout[2m | src/modules/ai/moderation.service.spec.ts[2m > [22m[2mModerationService (AI Content Moderation)[2m > [22m[2mmoderateContent[2m > [22m[2mSeverity Classification[2m > [22m[2mshould classify HIGH severity for serious violations
[22m[39mðŸ§¹ Cleaning up after test...

[90mstdout[2m | src/modules/ai/moderation.service.spec.ts[2m > [22m[2mModerationService (AI Content Moderation)[2m > [22m[2mmoderateContent[2m > [22m[2mSeverity Classification[2m > [22m[2mshould classify CRITICAL severity for extreme violations
[22m[39mðŸ§¹ Cleaning up after test...

[90mstdout[2m | src/modules/ai/moderation.service.spec.ts[2m > [22m[2mModerationService (AI Content Moderation)[2m > [22m[2mmoderateContent[2m > [22m[2mSeverity Classification[2m > [22m[2mshould escalate severity based on multiple category violations
[22m[39mðŸ§¹ Cleaning up after test...

[90mstdout[2m | src/modules/ai/moderation.service.spec.ts[2m > [22m[2mModerationService (AI Content Moderation)[2m > [22m[2mmoderateContent[2m > [22m[2mEdge Cases and Error Handling[2m > [22m[2mshould handle empty content
[22m[39mðŸ§¹ Cleaning up after test...

[90mstdout[2m | src/modules/ai/moderation.service.spec.ts[2m > [22m[2mModerationService (AI Content Moderation)[2m > [22m[2mmoderateContent[2m > [22m[2mEdge Cases and Error Handling[2m > [22m[2mshould handle very long content
[22m[39mðŸ§¹ Cleaning up after test...

[90mstdout[2m | src/modules/ai/moderation.service.spec.ts[2m > [22m[2mModerationService (AI Content Moderation)[2m > [22m[2mmoderateContent[2m > [22m[2mEdge Cases and Error Handling[2m > [22m[2mshould handle special characters and emojis
[22m[39mðŸ§¹ Cleaning up after test...

[90mstdout[2m | src/modules/ai/moderation.service.spec.ts[2m > [22m[2mModerationService (AI Content Moderation)[2m > [22m[2mmoderateContent[2m > [22m[2mEdge Cases and Error Handling[2m > [22m[2mshould handle API errors gracefully
[22m[39mðŸ§¹ Cleaning up after test...

[90mstdout[2m | src/modules/ai/moderation.service.spec.ts[2m > [22m[2mModerationService (AI Content Moderation)[2m > [22m[2mmoderateContent[2m > [22m[2mEdge Cases and Error Handling[2m > [22m[2mshould handle rate limiting from API
[22m[39mðŸ§¹ Cleaning up after test...

[90mstdout[2m | src/modules/ai/moderation.service.spec.ts[2m > [22m[2mModerationService (AI Content Moderation)[2m > [22m[2mmoderateContent[2m > [22m[2mEdge Cases and Error Handling[2m > [22m[2mshould handle null/undefined content
[22m[39mðŸ§¹ Cleaning up after test...

[90mstdout[2m | src/modules/ai/moderation.service.spec.ts[2m > [22m[2mModerationService (AI Content Moderation)[2m > [22m[2mmoderateContent[2m > [22m[2mLogging and Auditing[2m > [22m[2mshould log all moderation attempts
[22m[39mðŸ§¹ Cleaning up after test...

[90mstdout[2m | src/modules/ai/moderation.service.spec.ts[2m > [22m[2mModerationService (AI Content Moderation)[2m > [22m[2mmoderateContent[2m > [22m[2mLogging and Auditing[2m > [22m[2mshould log flagged content with detailed metadata
[22m[39mðŸ§¹ Cleaning up after test...

[90mstdout[2m | src/modules/ai/moderation.service.spec.ts[2m > [22m[2mModerationService (AI Content Moderation)[2m > [22m[2mmoderateContent[2m > [22m[2mLogging and Auditing[2m > [22m[2mshould not store full content for privacy (hash only)
[22m[39mðŸ§¹ Cleaning up after test...

[90mstdout[2m | src/modules/ai/moderation.service.spec.ts[2m > [22m[2mModerationService (AI Content Moderation)[2m > [22m[2mmoderateContent[2m > [22m[2mUser Strike System[2m > [22m[2mshould increment strike count for HIGH severity violations
[22m[39mðŸ§¹ Cleaning up after test...

[90mstdout[2m | src/modules/ai/moderation.service.spec.ts[2m > [22m[2mModerationService (AI Content Moderation)[2m > [22m[2mmoderateContent[2m > [22m[2mUser Strike System[2m > [22m[2mshould ban user after 3 CRITICAL violations
[22m[39mðŸ§¹ Cleaning up after test...

[90mstdout[2m | src/modules/ai/moderation.service.spec.ts[2m > [22m[2mModerationService (AI Content Moderation)[2m > [22m[2mmoderateContent[2m > [22m[2mUser Strike System[2m > [22m[2mshould not count LOW severity towards strikes
[22m[39mðŸ§¹ Cleaning up after test...

[90mstdout[2m | src/modules/ai/moderation.service.spec.ts[2m > [22m[2mModerationService (AI Content Moderation)[2m > [22m[2mmoderateContent[2m > [22m[2mContext-Aware Moderation[2m > [22m[2mshould allow educational discussions about sensitive topics
[22m[39mðŸ§¹ Cleaning up after test...

[90mstdout[2m | src/modules/ai/moderation.service.spec.ts[2m > [22m[2mModerationService (AI Content Moderation)[2m > [22m[2mmoderateContent[2m > [22m[2mContext-Aware Moderation[2m > [22m[2mshould be stricter in public forums than private messages
[22m[39mðŸ§¹ Cleaning up after test...

[90mstdout[2m | src/modules/ai/moderation.service.spec.ts[2m > [22m[2mModerationService (AI Content Moderation)[2m > [22m[2mmoderateContent[2m > [22m[2mPerformance and Caching[2m > [22m[2mshould cache moderation results for identical content
[22m[39mðŸ§¹ Cleaning up after test...

[90mstdout[2m | src/modules/ai/moderation.service.spec.ts[2m > [22m[2mModerationService (AI Content Moderation)[2m > [22m[2mmoderateContent[2m > [22m[2mPerformance and Caching[2m > [22m[2mshould handle batch moderation efficiently
[22m[39mðŸ§¹ Cleaning up after test...

[90mstdout[2m | src/modules/ai/moderation.service.spec.ts[2m > [22m[2mModerationService (AI Content Moderation)[2m > [22m[2mmoderateContent[2m > [22m[2mAI API Mocking[2m > [22m[2mshould mock OpenAI Moderation API response
[22m[39mðŸ§¹ Cleaning up after test...

[90mstdout[2m | src/modules/ai/moderation.service.spec.ts[2m > [22m[2mModerationService (AI Content Moderation)[2m > [22m[2mmoderateContent[2m > [22m[2mAI API Mocking[2m > [22m[2mshould mock Google Perspective API response
[22m[39mðŸ§¹ Cleaning up after test...

[90mstdout[2m | src/modules/ai/moderation.service.spec.ts[2m > [22m[2mModerationService (AI Content Moderation)[2m > [22m[2mmoderateContent[2m > [22m[2mAI API Mocking[2m > [22m[2mshould mock custom Gemini Moderation API
[22m[39mðŸ§¹ Cleaning up after test...

[90mstdout[2m | src/modules/ai/moderation.service.spec.ts[2m > [22m[2mModerationService (AI Content Moderation)[2m > [22m[2mmoderateContent[2m > [22m[2mReal-World Scenarios[2m > [22m[2mshould handle financial scam attempts
[22m[39mðŸ§¹ Cleaning up after test...

[90mstdout[2m | src/modules/ai/moderation.service.spec.ts[2m > [22m[2mModerationService (AI Content Moderation)[2m > [22m[2mmoderateContent[2m > [22m[2mReal-World Scenarios[2m > [22m[2mshould handle phishing attempts
[22m[39mðŸ§¹ Cleaning up after test...

[90mstdout[2m | src/modules/ai/moderation.service.spec.ts[2m > [22m[2mModerationService (AI Content Moderation)[2m > [22m[2mmoderateContent[2m > [22m[2mReal-World Scenarios[2m > [22m[2mshould allow legitimate financial discussions
[22m[39mðŸ§¹ Cleaning up after test...

[90mstdout[2m | src/modules/ai/moderation.service.spec.ts
[22m[39mðŸ”§ Vitest setup: Starting MSW mock server...
âœ… Vitest teardown complete

 [32mâœ“[39m src/modules/ai/moderation.service.spec.ts[2m > [22mModerationService (AI Content Moderation)[2m > [22mmoderateContent[2m > [22mInappropriate Content Detection[2m > [22mshould detect and flag explicit profanity
 [32mâœ“[39m src/modules/ai/moderation.service.spec.ts[2m > [22mModerationService (AI Content Moderation)[2m > [22mmoderateContent[2m > [22mInappropriate Content Detection[2m > [22mshould detect hate speech
 [32mâœ“[39m src/modules/ai/moderation.service.spec.ts[2m > [22mModerationService (AI Content Moderation)[2m > [22mmoderateContent[2m > [22mInappropriate Content Detection[2m > [22mshould detect sexual content
 [32mâœ“[39m src/modules/ai/moderation.service.spec.ts[2m > [22mModerationService (AI Content Moderation)[2m > [22mmoderateContent[2m > [22mInappropriate Content Detection[2m > [22mshould detect violence and threats
 [32mâœ“[39m src/modules/ai/moderation.service.spec.ts[2m > [22mModerationService (AI Content Moderation)[2m > [22mmoderateContent[2m > [22mInappropriate Content Detection[2m > [22mshould detect spam and promotional content
 [32mâœ“[39m src/modules/ai/moderation.service.spec.ts[2m > [22mModerationService (AI Content Moderation)[2m > [22mmoderateContent[2m > [22mInappropriate Content Detection[2m > [22mshould allow safe content
 [32mâœ“[39m src/modules/ai/moderation.service.spec.ts[2m > [22mModerationService (AI Content Moderation)[2m > [22mmoderateContent[2m > [22mMulti-Language Moderation[2m > [22mshould moderate Vietnamese content
 [32mâœ“[39m src/modules/ai/moderation.service.spec.ts[2m > [22mModerationService (AI Content Moderation)[2m > [22mmoderateContent[2m > [22mMulti-Language Moderation[2m > [22mshould moderate English content
 [32mâœ“[39m src/modules/ai/moderation.service.spec.ts[2m > [22mModerationService (AI Content Moderation)[2m > [22mmoderateContent[2m > [22mMulti-Language Moderation[2m > [22mshould moderate Chinese content
 [32mâœ“[39m src/modules/ai/moderation.service.spec.ts[2m > [22mModerationService (AI Content Moderation)[2m > [22mmoderateContent[2m > [22mMulti-Language Moderation[2m > [22mshould auto-detect language when not specified
 [32mâœ“[39m src/modules/ai/moderation.service.spec.ts[2m > [22mModerationService (AI Content Moderation)[2m > [22mmoderateContent[2m > [22mMulti-Language Moderation[2m > [22mshould handle language-specific profanity patterns
 [32mâœ“[39m src/modules/ai/moderation.service.spec.ts[2m > [22mModerationService (AI Content Moderation)[2m > [22mmoderateContent[2m > [22mSeverity Classification[2m > [22mshould classify NONE severity for clean content
 [32mâœ“[39m src/modules/ai/moderation.service.spec.ts[2m > [22mModerationService (AI Content Moderation)[2m > [22mmoderateContent[2m > [22mSeverity Classification[2m > [22mshould classify LOW severity for minor issues
 [32mâœ“[39m src/modules/ai/moderation.service.spec.ts[2m > [22mModerationService (AI Content Moderation)[2m > [22mmoderateContent[2m > [22mSeverity Classification[2m > [22mshould classify MEDIUM severity for moderate issues
 [32mâœ“[39m src/modules/ai/moderation.service.spec.ts[2m > [22mModerationService (AI Content Moderation)[2m > [22mmoderateContent[2m > [22mSeverity Classification[2m > [22mshould classify HIGH severity for serious violations
 [32mâœ“[39m src/modules/ai/moderation.service.spec.ts[2m > [22mModerationService (AI Content Moderation)[2m > [22mmoderateContent[2m > [22mSeverity Classification[2m > [22mshould classify CRITICAL severity for extreme violations
 [32mâœ“[39m src/modules/ai/moderation.service.spec.ts[2m > [22mModerationService (AI Content Moderation)[2m > [22mmoderateContent[2m > [22mSeverity Classification[2m > [22mshould escalate severity based on multiple category violations
 [32mâœ“[39m src/modules/ai/moderation.service.spec.ts[2m > [22mModerationService (AI Content Moderation)[2m > [22mmoderateContent[2m > [22mEdge Cases and Error Handling[2m > [22mshould handle empty content
 [32mâœ“[39m src/modules/ai/moderation.service.spec.ts[2m > [22mModerationService (AI Content Moderation)[2m > [22mmoderateContent[2m > [22mEdge Cases and Error Handling[2m > [22mshould handle very long content
 [32mâœ“[39m src/modules/ai/moderation.service.spec.ts[2m > [22mModerationService (AI Content Moderation)[2m > [22mmoderateContent[2m > [22mEdge Cases and Error Handling[2m > [22mshould handle special characters and emojis
 [32mâœ“[39m src/modules/ai/moderation.service.spec.ts[2m > [22mModerationService (AI Content Moderation)[2m > [22mmoderateContent[2m > [22mEdge Cases and Error Handling[2m > [22mshould handle API errors gracefully
 [32mâœ“[39m src/modules/ai/moderation.service.spec.ts[2m > [22mModerationService (AI Content Moderation)[2m > [22mmoderateContent[2m > [22mEdge Cases and Error Handling[2m > [22mshould handle rate limiting from API
 [32mâœ“[39m src/modules/ai/moderation.service.spec.ts[2m > [22mModerationService (AI Content Moderation)[2m > [22mmoderateContent[2m > [22mEdge Cases and Error Handling[2m > [22mshould handle null/undefined content
 [32mâœ“[39m src/modules/ai/moderation.service.spec.ts[2m > [22mModerationService (AI Content Moderation)[2m > [22mmoderateContent[2m > [22mLogging and Auditing[2m > [22mshould log all moderation attempts
 [32mâœ“[39m src/modules/ai/moderation.service.spec.ts[2m > [22mModerationService (AI Content Moderation)[2m > [22mmoderateContent[2m > [22mLogging and Auditing[2m > [22mshould log flagged content with detailed metadata
 [32mâœ“[39m src/modules/ai/moderation.service.spec.ts[2m > [22mModerationService (AI Content Moderation)[2m > [22mmoderateContent[2m > [22mLogging and Auditing[2m > [22mshould not store full content for privacy (hash only)
 [31mÃ—[39m src/modules/ai/moderation.service.spec.ts[2m > [22mModerationService (AI Content Moderation)[2m > [22mmoderateContent[2m > [22mUser Strike System[2m > [22mshould increment strike count for HIGH severity violations
[31m   â†’ Moderation API error[39m
 [31mÃ—[39m src/modules/ai/moderation.service.spec.ts[2m > [22mModerationService (AI Content Moderation)[2m > [22mmoderateContent[2m > [22mUser Strike System[2m > [22mshould ban user after 3 CRITICAL violations
[31m   â†’ expected error to be instance of ForbiddenException[39m
 [31mÃ—[39m src/modules/ai/moderation.service.spec.ts[2m > [22mModerationService (AI Content Moderation)[2m > [22mmoderateContent[2m > [22mUser Strike System[2m > [22mshould not count LOW severity towards strikes
[31m   â†’ Moderation API error[39m
 [32mâœ“[39m src/modules/ai/moderation.service.spec.ts[2m > [22mModerationService (AI Content Moderation)[2m > [22mmoderateContent[2m > [22mContext-Aware Moderation[2m > [22mshould allow educational discussions about sensitive topics
 [32mâœ“[39m src/modules/ai/moderation.service.spec.ts[2m > [22mModerationService (AI Content Moderation)[2m > [22mmoderateContent[2m > [22mContext-Aware Moderation[2m > [22mshould be stricter in public forums than private messages
 [32mâœ“[39m src/modules/ai/moderation.service.spec.ts[2m > [22mModerationService (AI Content Moderation)[2m > [22mmoderateContent[2m > [22mPerformance and Caching[2m > [22mshould cache moderation results for identical content
 [32mâœ“[39m src/modules/ai/moderation.service.spec.ts[2m > [22mModerationService (AI Content Moderation)[2m > [22mmoderateContent[2m > [22mPerformance and Caching[2m > [22mshould handle batch moderation efficiently
 [31mÃ—[39m src/modules/ai/moderation.service.spec.ts[2m > [22mModerationService (AI Content Moderation)[2m > [22mmoderateContent[2m > [22mAI API Mocking[2m > [22mshould mock OpenAI Moderation API response
[31m   â†’ expected undefined to be false // Object.is equality[39m
 [31mÃ—[39m src/modules/ai/moderation.service.spec.ts[2m > [22mModerationService (AI Content Moderation)[2m > [22mmoderateContent[2m > [22mAI API Mocking[2m > [22mshould mock Google Perspective API response
[31m   â†’ expected undefined to be false // Object.is equality[39m
 [31mÃ—[39m src/modules/ai/moderation.service.spec.ts[2m > [22mModerationService (AI Content Moderation)[2m > [22mmoderateContent[2m > [22mAI API Mocking[2m > [22mshould mock custom Gemini Moderation API
[31m   â†’ expected undefined to be false // Object.is equality[39m
 [32mâœ“[39m src/modules/ai/moderation.service.spec.ts[2m > [22mModerationService (AI Content Moderation)[2m > [22mmoderateContent[2m > [22mReal-World Scenarios[2m > [22mshould handle financial scam attempts
 [32mâœ“[39m src/modules/ai/moderation.service.spec.ts[2m > [22mModerationService (AI Content Moderation)[2m > [22mmoderateContent[2m > [22mReal-World Scenarios[2m > [22mshould handle phishing attempts
 [32mâœ“[39m src/modules/ai/moderation.service.spec.ts[2m > [22mModerationService (AI Content Moderation)[2m > [22mmoderateContent[2m > [22mReal-World Scenarios[2m > [22mshould allow legitimate financial discussions
[90mstdout[2m | src/modules/analytics/realtime-dashboard.service.spec.ts[2m > [22m[2mRealtimeDashboardService (Integration)[2m > [22m[2mLive Metric Updates[2m > [22m[2mshould collect real-time metrics from last 10 minutes
[22m[39mðŸ§¹ Cleaning up after test...

[90mstdout[2m | src/modules/analytics/realtime-dashboard.service.spec.ts[2m > [22m[2mRealtimeDashboardService (Integration)[2m > [22m[2mLive Metric Updates[2m > [22m[2mshould handle zero events gracefully
[22m[39mðŸ§¹ Cleaning up after test...

[90mstdout[2m | src/modules/analytics/realtime-dashboard.service.spec.ts[2m > [22m[2mRealtimeDashboardService (Integration)[2m > [22m[2mLive Metric Updates[2m > [22m[2mshould update Prometheus gauges on metrics collection
[22m[39mðŸ§¹ Cleaning up after test...

[90mstdout[2m | src/modules/analytics/realtime-dashboard.service.spec.ts[2m > [22m[2mRealtimeDashboardService (Integration)[2m > [22m[2mLive Metric Updates[2m > [22m[2mshould export metrics in Prometheus format
[22m[39mðŸ§¹ Cleaning up after test...

[90mstdout[2m | src/modules/analytics/realtime-dashboard.service.spec.ts[2m > [22m[2mRealtimeDashboardService (Integration)[2m > [22m[2mWebSocket Event Streaming[2m > [22m[2mshould track active WebSocket connections
[22m[39mðŸ§¹ Cleaning up after test...

[90mstdout[2m | src/modules/analytics/realtime-dashboard.service.spec.ts[2m > [22m[2mRealtimeDashboardService (Integration)[2m > [22m[2mWebSocket Event Streaming[2m > [22m[2mshould broadcast real-time events to all connected clients
[22m[39mðŸ§¹ Cleaning up after test...

[90mstdout[2m | src/modules/analytics/realtime-dashboard.service.spec.ts[2m > [22m[2mRealtimeDashboardService (Integration)[2m > [22m[2mWebSocket Event Streaming[2m > [22m[2mshould send targeted events to specific users
[22m[39mðŸ§¹ Cleaning up after test...

[90mstdout[2m | src/modules/analytics/realtime-dashboard.service.spec.ts[2m > [22m[2mRealtimeDashboardService (Integration)[2m > [22m[2mWebSocket Event Streaming[2m > [22m[2mshould broadcast to groups (rooms)
[22m[39mðŸ§¹ Cleaning up after test...

[90mstdout[2m | src/modules/analytics/realtime-dashboard.service.spec.ts[2m > [22m[2mRealtimeDashboardService (Integration)[2m > [22m[2mWebSocket Event Streaming[2m > [22m[2mshould handle client disconnection and cleanup
[22m[39mðŸ§¹ Cleaning up after test...

[90mstdout[2m | src/modules/analytics/realtime-dashboard.service.spec.ts[2m > [22m[2mRealtimeDashboardService (Integration)[2m > [22m[2mData Aggregation Performance[2m > [22m[2mshould aggregate behavior logs efficiently for daily archival
[22m[39mðŸ§¹ Cleaning up after test...

[90mstdout[2m | src/modules/analytics/realtime-dashboard.service.spec.ts[2m > [22m[2mRealtimeDashboardService (Integration)[2m > [22m[2mData Aggregation Performance[2m > [22m[2mshould perform health check aggregation every hour
[22m[39mðŸ§¹ Cleaning up after test...

[90mstdout[2m | src/modules/analytics/realtime-dashboard.service.spec.ts[2m > [22m[2mRealtimeDashboardService (Integration)[2m > [22m[2mData Aggregation Performance[2m > [22m[2mshould calculate global system stats efficiently
[22m[39mðŸ§¹ Cleaning up after test...

[90mstdout[2m | src/modules/analytics/realtime-dashboard.service.spec.ts[2m > [22m[2mRealtimeDashboardService (Integration)[2m > [22m[2mData Aggregation Performance[2m > [22m[2mshould analyze user learning habits from behavior logs
[22m[39mðŸ§¹ Cleaning up after test...

[90mstdout[2m | src/modules/analytics/realtime-dashboard.service.spec.ts[2m > [22m[2mRealtimeDashboardService (Integration)[2m > [22m[2mData Aggregation Performance[2m > [22m[2mshould handle empty user learning habits
[22m[39mðŸ§¹ Cleaning up after test...

[90mstdout[2m | src/modules/analytics/realtime-dashboard.service.spec.ts[2m > [22m[2mRealtimeDashboardService (Integration)[2m > [22m[2mMock Real-Time Data Sources[2m > [22m[2mshould generate mock behavioral data for stress testing
[22m[39mðŸ§¹ Cleaning up after test...

[90mstdout[2m | src/modules/analytics/realtime-dashboard.service.spec.ts[2m > [22m[2mRealtimeDashboardService (Integration)[2m > [22m[2mMock Real-Time Data Sources[2m > [22m[2mshould run AI stress test with different complexity levels
[22m[39mðŸ§¹ Cleaning up after test...

[90mstdout[2m | src/modules/analytics/realtime-dashboard.service.spec.ts[2m > [22m[2mRealtimeDashboardService (Integration)[2m > [22m[2mMock Real-Time Data Sources[2m > [22m[2mshould handle AI stress test failures gracefully
[22m[39mðŸ§¹ Cleaning up after test...

[90mstdout[2m | src/modules/analytics/realtime-dashboard.service.spec.ts[2m > [22m[2mRealtimeDashboardService (Integration)[2m > [22m[2mMock Real-Time Data Sources[2m > [22m[2mshould simulate complete user flow for integration testing
[22m[39mðŸ§¹ Cleaning up after test...

[90mstdout[2m | src/modules/analytics/realtime-dashboard.service.spec.ts[2m > [22m[2mRealtimeDashboardService (Integration)[2m > [22m[2mFull System Diagnostics Integration[2m > [22m[2mshould run comprehensive diagnostics with all subsystems
[22m[39mðŸ§¹ Cleaning up after test...

[90mstdout[2m | src/modules/analytics/realtime-dashboard.service.spec.ts[2m > [22m[2mRealtimeDashboardService (Integration)[2m > [22m[2mFull System Diagnostics Integration[2m > [22m[2mshould detect database connection failure in diagnostics
[22m[39mðŸ§¹ Cleaning up after test...

[90mstdout[2m | src/modules/analytics/realtime-dashboard.service.spec.ts[2m > [22m[2mRealtimeDashboardService (Integration)[2m > [22m[2mFull System Diagnostics Integration[2m > [22m[2mshould validate JSONB schema integrity
[22m[39mðŸ§¹ Cleaning up after test...

[90mstdout[2m | src/modules/analytics/realtime-dashboard.service.spec.ts[2m > [22m[2mRealtimeDashboardService (Integration)[2m > [22m[2mFull System Diagnostics Integration[2m > [22m[2mshould warn on JSONB schema drift
[22m[39mðŸ§¹ Cleaning up after test...

[90mstdout[2m | src/modules/analytics/realtime-dashboard.service.spec.ts[2m > [22m[2mRealtimeDashboardService (Integration)[2m > [22m[2mPerformance Benchmarks[2m > [22m[2mshould complete metrics collection in under 100ms (mocked)
[22m[39mðŸ§¹ Cleaning up after test...

[90mstdout[2m | src/modules/analytics/realtime-dashboard.service.spec.ts[2m > [22m[2mRealtimeDashboardService (Integration)[2m > [22m[2mPerformance Benchmarks[2m > [22m[2mshould handle high-volume log aggregation efficiently
[22m[39mðŸ§¹ Cleaning up after test...

[90mstdout[2m | src/modules/analytics/realtime-dashboard.service.spec.ts[2m > [22m[2mRealtimeDashboardService (Integration)[2m > [22m[2mUser Persona Classification[2m > [22m[2mshould classify user as HUNTER (risk-taker)
[22m[39mðŸ§¹ Cleaning up after test...

[90mstdout[2m | src/modules/analytics/realtime-dashboard.service.spec.ts[2m > [22m[2mRealtimeDashboardService (Integration)[2m > [22m[2mUser Persona Classification[2m > [22m[2mshould classify user as SAVER (conservative)
[22m[39mðŸ§¹ Cleaning up after test...

 [31mÃ—[39m src/modules/analytics/realtime-dashboard.service.spec.ts[2m > [22mRealtimeDashboardService (Integration)[2m > [22mLive Metric Updates[2m > [22mshould collect real-time metrics from last 10 minutes
[31m   â†’ Nest can't resolve dependencies of the WsJwtGuard (?). Please make sure that the argument JwtService at index [0] is available in the RootTestModule context.

Potential solutions:
- Is RootTestModule a valid NestJS module?
- If JwtService is a provider, is it part of the current RootTestModule?
- If JwtService is exported from a separate @Module, is that module imported within RootTestModule?
  @Module({
    imports: [ /* the Module containing JwtService */ ]
  })

For more common dependency resolution issues, see: https://docs.nestjs.com/faq/common-errors[39m
 [31mÃ—[39m src/modules/analytics/realtime-dashboard.service.spec.ts[2m > [22mRealtimeDashboardService (Integration)[2m > [22mLive Metric Updates[2m > [22mshould handle zero events gracefully
[31m   â†’ Nest can't resolve dependencies of the WsJwtGuard (?). Please make sure that the argument JwtService at index [0] is available in the RootTestModule context.

Potential solutions:
- Is RootTestModule a valid NestJS module?
- If JwtService is a provider, is it part of the current RootTestModule?
- If JwtService is exported from a separate @Module, is that module imported within RootTestModule?
  @Module({
    imports: [ /* the Module containing JwtService */ ]
  })

For more common dependency resolution issues, see: https://docs.nestjs.com/faq/common-errors[39m
 [31mÃ—[39m src/modules/analytics/realtime-dashboard.service.spec.ts[2m > [22mRealtimeDashboardService (Integration)[2m > [22mLive Metric Updates[2m > [22mshould update Prometheus gauges on metrics collection
[31m   â†’ Nest can't resolve dependencies of the WsJwtGuard (?). Please make sure that the argument JwtService at index [0] is available in the RootTestModule context.

Potential solutions:
- Is RootTestModule a valid NestJS module?
- If JwtService is a provider, is it part of the current RootTestModule?
- If JwtService is exported from a separate @Module, is that module imported within RootTestModule?
  @Module({
    imports: [ /* the Module containing JwtService */ ]
  })

For more common dependency resolution issues, see: https://docs.nestjs.com/faq/common-errors[39m
 [31mÃ—[39m src/modules/analytics/realtime-dashboard.service.spec.ts[2m > [22mRealtimeDashboardService (Integration)[2m > [22mLive Metric Updates[2m > [22mshould export metrics in Prometheus format
[31m   â†’ Nest can't resolve dependencies of the WsJwtGuard (?). Please make sure that the argument JwtService at index [0] is available in the RootTestModule context.

Potential solutions:
- Is RootTestModule a valid NestJS module?
- If JwtService is a provider, is it part of the current RootTestModule?
- If JwtService is exported from a separate @Module, is that module imported within RootTestModule?
  @Module({
    imports: [ /* the Module containing JwtService */ ]
  })

For more common dependency resolution issues, see: https://docs.nestjs.com/faq/common-errors[39m
 [31mÃ—[39m src/modules/analytics/realtime-dashboard.service.spec.ts[2m > [22mRealtimeDashboardService (Integration)[2m > [22mWebSocket Event Streaming[2m > [22mshould track active WebSocket connections
[31m   â†’ Nest can't resolve dependencies of the WsJwtGuard (?). Please make sure that the argument JwtService at index [0] is available in the RootTestModule context.

Potential solutions:
- Is RootTestModule a valid NestJS module?
- If JwtService is a provider, is it part of the current RootTestModule?
- If JwtService is exported from a separate @Module, is that module imported within RootTestModule?
  @Module({
    imports: [ /* the Module containing JwtService */ ]
  })

For more common dependency resolution issues, see: https://docs.nestjs.com/faq/common-errors[39m
 [31mÃ—[39m src/modules/analytics/realtime-dashboard.service.spec.ts[2m > [22mRealtimeDashboardService (Integration)[2m > [22mWebSocket Event Streaming[2m > [22mshould broadcast real-time events to all connected clients
[31m   â†’ Nest can't resolve dependencies of the WsJwtGuard (?). Please make sure that the argument JwtService at index [0] is available in the RootTestModule context.

Potential solutions:
- Is RootTestModule a valid NestJS module?
- If JwtService is a provider, is it part of the current RootTestModule?
- If JwtService is exported from a separate @Module, is that module imported within RootTestModule?
  @Module({
    imports: [ /* the Module containing JwtService */ ]
  })

For more common dependency resolution issues, see: https://docs.nestjs.com/faq/common-errors[39m
 [31mÃ—[39m src/modules/analytics/realtime-dashboard.service.spec.ts[2m > [22mRealtimeDashboardService (Integration)[2m > [22mWebSocket Event Streaming[2m > [22mshould send targeted events to specific users
[31m   â†’ Nest can't resolve dependencies of the WsJwtGuard (?). Please make sure that the argument JwtService at index [0] is available in the RootTestModule context.

Potential solutions:
- Is RootTestModule a valid NestJS module?
- If JwtService is a provider, is it part of the current RootTestModule?
- If JwtService is exported from a separate @Module, is that module imported within RootTestModule?
  @Module({
    imports: [ /* the Module containing JwtService */ ]
  })

For more common dependency resolution issues, see: https://docs.nestjs.com/faq/common-errors[39m
 [31mÃ—[39m src/modules/analytics/realtime-dashboard.service.spec.ts[2m > [22mRealtimeDashboardService (Integration)[2m > [22mWebSocket Event Streaming[2m > [22mshould broadcast to groups (rooms)
[31m   â†’ Nest can't resolve dependencies of the WsJwtGuard (?). Please make sure that the argument JwtService at index [0] is available in the RootTestModule context.

Potential solutions:
- Is RootTestModule a valid NestJS module?
- If JwtService is a provider, is it part of the current RootTestModule?
- If JwtService is exported from a separate @Module, is that module imported within RootTestModule?
  @Module({
    imports: [ /* the Module containing JwtService */ ]
  })

For more common dependency resolution issues, see: https://docs.nestjs.com/faq/common-errors[39m
 [31mÃ—[39m src/modules/analytics/realtime-dashboard.service.spec.ts[2m > [22mRealtimeDashboardService (Integration)[2m > [22mWebSocket Event Streaming[2m > [22mshould handle client disconnection and cleanup
[31m   â†’ Nest can't resolve dependencies of the WsJwtGuard (?). Please make sure that the argument JwtService at index [0] is available in the RootTestModule context.

Potential solutions:
- Is RootTestModule a valid NestJS module?
- If JwtService is a provider, is it part of the current RootTestModule?
- If JwtService is exported from a separate @Module, is that module imported within RootTestModule?
  @Module({
    imports: [ /* the Module containing JwtService */ ]
  })

For more common dependency resolution issues, see: https://docs.nestjs.com/faq/common-errors[39m
 [31mÃ—[39m src/modules/analytics/realtime-dashboard.service.spec.ts[2m > [22mRealtimeDashboardService (Integration)[2m > [22mData Aggregation Performance[2m > [22mshould aggregate behavior logs efficiently for daily archival
[31m   â†’ Nest can't resolve dependencies of the WsJwtGuard (?). Please make sure that the argument JwtService at index [0] is available in the RootTestModule context.

Potential solutions:
- Is RootTestModule a valid NestJS module?
- If JwtService is a provider, is it part of the current RootTestModule?
- If JwtService is exported from a separate @Module, is that module imported within RootTestModule?
  @Module({
    imports: [ /* the Module containing JwtService */ ]
  })

For more common dependency resolution issues, see: https://docs.nestjs.com/faq/common-errors[39m
 [31mÃ—[39m src/modules/analytics/realtime-dashboard.service.spec.ts[2m > [22mRealtimeDashboardService (Integration)[2m > [22mData Aggregation Performance[2m > [22mshould perform health check aggregation every hour
[31m   â†’ Nest can't resolve dependencies of the WsJwtGuard (?). Please make sure that the argument JwtService at index [0] is available in the RootTestModule context.

Potential solutions:
- Is RootTestModule a valid NestJS module?
- If JwtService is a provider, is it part of the current RootTestModule?
- If JwtService is exported from a separate @Module, is that module imported within RootTestModule?
  @Module({
    imports: [ /* the Module containing JwtService */ ]
  })

For more common dependency resolution issues, see: https://docs.nestjs.com/faq/common-errors[39m
 [31mÃ—[39m src/modules/analytics/realtime-dashboard.service.spec.ts[2m > [22mRealtimeDashboardService (Integration)[2m > [22mData Aggregation Performance[2m > [22mshould calculate global system stats efficiently
[31m   â†’ Nest can't resolve dependencies of the WsJwtGuard (?). Please make sure that the argument JwtService at index [0] is available in the RootTestModule context.

Potential solutions:
- Is RootTestModule a valid NestJS module?
- If JwtService is a provider, is it part of the current RootTestModule?
- If JwtService is exported from a separate @Module, is that module imported within RootTestModule?
  @Module({
    imports: [ /* the Module containing JwtService */ ]
  })

For more common dependency resolution issues, see: https://docs.nestjs.com/faq/common-errors[39m
 [31mÃ—[39m src/modules/analytics/realtime-dashboard.service.spec.ts[2m > [22mRealtimeDashboardService (Integration)[2m > [22mData Aggregation Performance[2m > [22mshould analyze user learning habits from behavior logs
[31m   â†’ Nest can't resolve dependencies of the WsJwtGuard (?). Please make sure that the argument JwtService at index [0] is available in the RootTestModule context.

Potential solutions:
- Is RootTestModule a valid NestJS module?
- If JwtService is a provider, is it part of the current RootTestModule?
- If JwtService is exported from a separate @Module, is that module imported within RootTestModule?
  @Module({
    imports: [ /* the Module containing JwtService */ ]
  })

For more common dependency resolution issues, see: https://docs.nestjs.com/faq/common-errors[39m
 [31mÃ—[39m src/modules/analytics/realtime-dashboard.service.spec.ts[2m > [22mRealtimeDashboardService (Integration)[2m > [22mData Aggregation Performance[2m > [22mshould handle empty user learning habits
[31m   â†’ Nest can't resolve dependencies of the WsJwtGuard (?). Please make sure that the argument JwtService at index [0] is available in the RootTestModule context.

Potential solutions:
- Is RootTestModule a valid NestJS module?
- If JwtService is a provider, is it part of the current RootTestModule?
- If JwtService is exported from a separate @Module, is that module imported within RootTestModule?
  @Module({
    imports: [ /* the Module containing JwtService */ ]
  })

For more common dependency resolution issues, see: https://docs.nestjs.com/faq/common-errors[39m
 [31mÃ—[39m src/modules/analytics/realtime-dashboard.service.spec.ts[2m > [22mRealtimeDashboardService (Integration)[2m > [22mMock Real-Time Data Sources[2m > [22mshould generate mock behavioral data for stress testing
[31m   â†’ Nest can't resolve dependencies of the WsJwtGuard (?). Please make sure that the argument JwtService at index [0] is available in the RootTestModule context.

Potential solutions:
- Is RootTestModule a valid NestJS module?
- If JwtService is a provider, is it part of the current RootTestModule?
- If JwtService is exported from a separate @Module, is that module imported within RootTestModule?
  @Module({
    imports: [ /* the Module containing JwtService */ ]
  })

For more common dependency resolution issues, see: https://docs.nestjs.com/faq/common-errors[39m
 [31mÃ—[39m src/modules/analytics/realtime-dashboard.service.spec.ts[2m > [22mRealtimeDashboardService (Integration)[2m > [22mMock Real-Time Data Sources[2m > [22mshould run AI stress test with different complexity levels
[31m   â†’ Nest can't resolve dependencies of the WsJwtGuard (?). Please make sure that the argument JwtService at index [0] is available in the RootTestModule context.

Potential solutions:
- Is RootTestModule a valid NestJS module?
- If JwtService is a provider, is it part of the current RootTestModule?
- If JwtService is exported from a separate @Module, is that module imported within RootTestModule?
  @Module({
    imports: [ /* the Module containing JwtService */ ]
  })

For more common dependency resolution issues, see: https://docs.nestjs.com/faq/common-errors[39m
 [31mÃ—[39m src/modules/analytics/realtime-dashboard.service.spec.ts[2m > [22mRealtimeDashboardService (Integration)[2m > [22mMock Real-Time Data Sources[2m > [22mshould handle AI stress test failures gracefully
[31m   â†’ Nest can't resolve dependencies of the WsJwtGuard (?). Please make sure that the argument JwtService at index [0] is available in the RootTestModule context.

Potential solutions:
- Is RootTestModule a valid NestJS module?
- If JwtService is a provider, is it part of the current RootTestModule?
- If JwtService is exported from a separate @Module, is that module imported within RootTestModule?
  @Module({
    imports: [ /* the Module containing JwtService */ ]
  })

For more common dependency resolution issues, see: https://docs.nestjs.com/faq/common-errors[39m
 [31mÃ—[39m src/modules/analytics/realtime-dashboard.service.spec.ts[2m > [22mRealtimeDashboardService (Integration)[2m > [22mMock Real-Time Data Sources[2m > [22mshould simulate complete user flow for integration testing
[31m   â†’ Nest can't resolve dependencies of the WsJwtGuard (?). Please make sure that the argument JwtService at index [0] is available in the RootTestModule context.

Potential solutions:
- Is RootTestModule a valid NestJS module?
- If JwtService is a provider, is it part of the current RootTestModule?
- If JwtService is exported from a separate @Module, is that module imported within RootTestModule?
  @Module({
    imports: [ /* the Module containing JwtService */ ]
  })

For more common dependency resolution issues, see: https://docs.nestjs.com/faq/common-errors[39m
 [31mÃ—[39m src/modules/analytics/realtime-dashboard.service.spec.ts[2m > [22mRealtimeDashboardService (Integration)[2m > [22mFull System Diagnostics Integration[2m > [22mshould run comprehensive diagnostics with all subsystems
[31m   â†’ Nest can't resolve dependencies of the WsJwtGuard (?). Please make sure that the argument JwtService at index [0] is available in the RootTestModule context.

Potential solutions:
- Is RootTestModule a valid NestJS module?
- If JwtService is a provider, is it part of the current RootTestModule?
- If JwtService is exported from a separate @Module, is that module imported within RootTestModule?
  @Module({
    imports: [ /* the Module containing JwtService */ ]
  })

For more common dependency resolution issues, see: https://docs.nestjs.com/faq/common-errors[39m
 [31mÃ—[39m src/modules/analytics/realtime-dashboard.service.spec.ts[2m > [22mRealtimeDashboardService (Integration)[2m > [22mFull System Diagnostics Integration[2m > [22mshould detect database connection failure in diagnostics
[31m   â†’ Nest can't resolve dependencies of the WsJwtGuard (?). Please make sure that the argument JwtService at index [0] is available in the RootTestModule context.

Potential solutions:
- Is RootTestModule a valid NestJS module?
- If JwtService is a provider, is it part of the current RootTestModule?
- If JwtService is exported from a separate @Module, is that module imported within RootTestModule?
  @Module({
    imports: [ /* the Module containing JwtService */ ]
  })

For more common dependency resolution issues, see: https://docs.nestjs.com/faq/common-errors[39m
 [31mÃ—[39m src/modules/analytics/realtime-dashboard.service.spec.ts[2m > [22mRealtimeDashboardService (Integration)[2m > [22mFull System Diagnostics Integration[2m > [22mshould validate JSONB schema integrity
[31m   â†’ Nest can't resolve dependencies of the WsJwtGuard (?). Please make sure that the argument JwtService at index [0] is available in the RootTestModule context.

Potential solutions:
- Is RootTestModule a valid NestJS module?
- If JwtService is a provider, is it part of the current RootTestModule?
- If JwtService is exported from a separate @Module, is that module imported within RootTestModule?
  @Module({
    imports: [ /* the Module containing JwtService */ ]
  })

For more common dependency resolution issues, see: https://docs.nestjs.com/faq/common-errors[39m
 [31mÃ—[39m src/modules/analytics/realtime-dashboard.service.spec.ts[2m > [22mRealtimeDashboardService (Integration)[2m > [22mFull System Diagnostics Integration[2m > [22mshould warn on JSONB schema drift
[31m   â†’ Nest can't resolve dependencies of the WsJwtGuard (?). Please make sure that the argument JwtService at index [0] is available in the RootTestModule context.

Potential solutions:
- Is RootTestModule a valid NestJS module?
- If JwtService is a provider, is it part of the current RootTestModule?
- If JwtService is exported from a separate @Module, is that module imported within RootTestModule?
  @Module({
    imports: [ /* the Module containing JwtService */ ]
  })

For more common dependency resolution issues, see: https://docs.nestjs.com/faq/common-errors[39m
 [31mÃ—[39m src/modules/analytics/realtime-dashboard.service.spec.ts[2m > [22mRealtimeDashboardService (Integration)[2m > [22mPerformance Benchmarks[2m > [22mshould complete metrics collection in under 100ms (mocked)
[31m   â†’ Nest can't resolve dependencies of the WsJwtGuard (?). Please make sure that the argument JwtService at index [0] is available in the RootTestModule context.

Potential solutions:
- Is RootTestModule a valid NestJS module?
- If JwtService is a provider, is it part of the current RootTestModule?
- If JwtService is exported from a separate @Module, is that module imported within RootTestModule?
  @Module({
    imports: [ /* the Module containing JwtService */ ]
  })

For more common dependency resolution issues, see: https://docs.nestjs.com/faq/common-errors[39m
 [31mÃ—[39m src/modules/analytics/realtime-dashboard.service.spec.ts[2m > [22mRealtimeDashboardService (Integration)[2m > [22mPerformance Benchmarks[2m > [22mshould handle high-volume log aggregation efficiently
[31m   â†’ Nest can't resolve dependencies of the WsJwtGuard (?). Please make sure that the argument JwtService at index [0] is available in the RootTestModule context.

Potential solutions:
- Is RootTestModule a valid NestJS module?
- If JwtService is a provider, is it part of the current RootTestModule?
- If JwtService is exported from a separate @Module, is that module imported within RootTestModule?
  @Module({
    imports: [ /* the Module containing JwtService */ ]
  })

For more common dependency resolution issues, see: https://docs.nestjs.com/faq/common-errors[39m
 [31mÃ—[39m src/modules/analytics/realtime-dashboard.service.spec.ts[2m > [22mRealtimeDashboardService (Integration)[2m > [22mUser Persona Classification[2m > [22mshould classify user as HUNTER (risk-taker)
[31m   â†’ Nest can't resolve dependencies of the WsJwtGuard (?). Please make sure that the argument JwtService at index [0] is available in the RootTestModule context.

Potential solutions:
- Is RootTestModule a valid NestJS module?
- If JwtService is a provider, is it part of the current RootTestModule?
- If JwtService is exported from a separate @Module, is that module imported within RootTestModule?
  @Module({
    imports: [ /* the Module containing JwtService */ ]
  })

For more common dependency resolution issues, see: https://docs.nestjs.com/faq/common-errors[39m
 [31mÃ—[39m src/modules/analytics/realtime-dashboard.service.spec.ts[2m > [22mRealtimeDashboardService (Integration)[2m > [22mUser Persona Classification[2m > [22mshould classify user as SAVER (conservative)
[31m   â†’ Nest can't resolve dependencies of the WsJwtGuard (?). Please make sure that the argument JwtService at index [0] is available in the RootTestModule context.

Potential solutions:
- Is RootTestModule a valid NestJS module?
- If JwtService is a provider, is it part of the current RootTestModule?
- If JwtService is exported from a separate @Module, is that module imported within RootTestModule?
  @Module({
    imports: [ /* the Module containing JwtService */ ]
  })

For more common dependency resolution issues, see: https://docs.nestjs.com/faq/common-errors[39m
 [31mÃ—[39m src/modules/analytics/realtime-dashboard.service.spec.ts[2m > [22mRealtimeDashboardService (Integration)[2m > [22mUser Persona Classification[2m > [22mshould classify user as OBSERVER (default)
[31m   â†’ Nest can't resolve dependencies of the WsJwtGuard (?). Please make sure that the argument JwtService at index [0] is available in the RootTestModule context.

Potential solutions:
- Is RootTestModule a valid NestJS module?
- If JwtService is a provider, is it part of the current RootTestModule?
- If JwtService is exported from a separate @Module, is that module imported within RootTestModule?
  @Module({
    imports: [ /* the Module containing JwtService */ ]
  })

For more common dependency resolution issues, see: https://docs.nestjs.com/faq/common-errors[39m
[90mstdout[2m | src/modules/analytics/realtime-dashboard.service.spec.ts[2m > [22m[2mRealtimeDashboardService (Integration)[2m > [22m[2mUser Persona Classification[2m > [22m[2mshould classify user as OBSERVER (default)
[22m[39mðŸ§¹ Cleaning up after test...

[90mstdout[2m | src/modules/analytics/realtime-dashboard.service.spec.ts
[22m[39mðŸ”§ Vitest setup: Starting MSW mock server...
âœ… Vitest teardown complete

[90mstdout[2m | src/modules/nudge/commitment.service.spec.ts[2m > [22m[2mCommitmentService (via SimulationService)[2m > [22m[2mContract Creation[2m > [22m[2mshould create a commitment contract with valid data
[22m[39mðŸ§¹ Cleaning up after test...

[90mstdout[2m | src/modules/nudge/commitment.service.spec.ts[2m > [22m[2mCommitmentService (via SimulationService)[2m > [22m[2mContract Creation[2m > [22m[2mshould reject contract creation with insufficient balance
[22m[39mðŸ§¹ Cleaning up after test...

[90mstdout[2m | src/modules/nudge/commitment.service.spec.ts[2m > [22m[2mCommitmentService (via SimulationService)[2m > [22m[2mContract Creation[2m > [22m[2mshould calculate correct unlock date based on months
[22m[39mðŸ§¹ Cleaning up after test...

[90mstdout[2m | src/modules/nudge/commitment.service.spec.ts[2m > [22m[2mCommitmentService (via SimulationService)[2m > [22m[2mContract Creation[2m > [22m[2mshould create multiple contracts for different goals
[22m[39mðŸ§¹ Cleaning up after test...

[90mstdout[2m | src/modules/nudge/commitment.service.spec.ts[2m > [22m[2mCommitmentService (via SimulationService)[2m > [22m[2mStake Locking[2m > [22m[2mshould lock funds by decrementing portfolio balance
[22m[39mðŸ§¹ Cleaning up after test...

[90mstdout[2m | src/modules/nudge/commitment.service.spec.ts[2m > [22m[2mCommitmentService (via SimulationService)[2m > [22m[2mStake Locking[2m > [22m[2mshould verify locked amount matches commitment record
[22m[39mðŸ§¹ Cleaning up after test...

[90mstdout[2m | src/modules/nudge/commitment.service.spec.ts[2m > [22m[2mCommitmentService (via SimulationService)[2m > [22m[2mStake Locking[2m > [22m[2mshould prevent negative balance after locking
[22m[39mðŸ§¹ Cleaning up after test...

[90mstdout[2m | src/modules/nudge/commitment.service.spec.ts[2m > [22m[2mCommitmentService (via SimulationService)[2m > [22m[2mCompletion Verification[2m > [22m[2mshould successfully withdraw on-time commitment without penalty
[22m[39mðŸ§¹ Cleaning up after test...

[90mstdout[2m | src/modules/nudge/commitment.service.spec.ts[2m > [22m[2mCommitmentService (via SimulationService)[2m > [22m[2mCompletion Verification[2m > [22m[2mshould apply penalty for early withdrawal
[22m[39mðŸ§¹ Cleaning up after test...

[90mstdout[2m | src/modules/nudge/commitment.service.spec.ts[2m > [22m[2mCommitmentService (via SimulationService)[2m > [22m[2mCompletion Verification[2m > [22m[2mshould reject withdrawal for non-existent commitment
[22m[39mðŸ§¹ Cleaning up after test...

[90mstdout[2m | src/modules/nudge/commitment.service.spec.ts[2m > [22m[2mCommitmentService (via SimulationService)[2m > [22m[2mCompletion Verification[2m > [22m[2mshould reject withdrawal by unauthorized user
[22m[39mðŸ§¹ Cleaning up after test...

[90mstdout[2m | src/modules/nudge/commitment.service.spec.ts[2m > [22m[2mCommitmentService (via SimulationService)[2m > [22m[2mMock Financial Data[2m > [22m[2mshould simulate portfolio with realistic balance
[22m[39mðŸ§¹ Cleaning up after test...

[90mstdout[2m | src/modules/nudge/commitment.service.spec.ts[2m > [22m[2mCommitmentService (via SimulationService)[2m > [22m[2mMock Financial Data[2m > [22m[2mshould handle zero balance portfolio gracefully
[22m[39mðŸ§¹ Cleaning up after test...

[90mstdout[2m | src/modules/nudge/commitment.service.spec.ts[2m > [22m[2mCommitmentService (via SimulationService)[2m > [22m[2mMock Financial Data[2m > [22m[2mshould support large commitment amounts
[22m[39mðŸ§¹ Cleaning up after test...

[90mstdout[2m | src/modules/nudge/commitment.service.spec.ts[2m > [22m[2mCommitmentService (via SimulationService)[2m > [22m[2mPenalty Calculation[2m > [22m[2mshould calculate 10% penalty for early withdrawal
[22m[39mðŸ§¹ Cleaning up after test...

[90mstdout[2m | src/modules/nudge/commitment.service.spec.ts[2m > [22m[2mCommitmentService (via SimulationService)[2m > [22m[2mPenalty Calculation[2m > [22m[2mshould calculate penalty with different rates
[22m[39mðŸ§¹ Cleaning up after test...

[90mstdout[2m | src/modules/nudge/commitment.service.spec.ts[2m > [22m[2mCommitmentService (via SimulationService)[2m > [22m[2mPenalty Calculation[2m > [22m[2mshould return full amount when unlockDate is exactly now
[22m[39mðŸ§¹ Cleaning up after test...

[90mstdout[2m | src/modules/nudge/commitment.service.spec.ts[2m > [22m[2mCommitmentService (via SimulationService)[2m > [22m[2mPenalty Calculation[2m > [22m[2mshould log penalty event with correct metadata
[22m[39mðŸ§¹ Cleaning up after test...

[90mstdout[2m | src/modules/nudge/commitment.service.spec.ts[2m > [22m[2mCommitmentService (via SimulationService)[2m > [22m[2mPenalty Calculation[2m > [22m[2mshould handle edge case: zero penalty rate
[22m[39mðŸ§¹ Cleaning up after test...

[90mstdout[2m | src/modules/nudge/commitment.service.spec.ts[2m > [22m[2mCommitmentService (via SimulationService)[2m > [22m[2mIntegration: Full Lifecycle[2m > [22m[2mshould complete full commitment lifecycle: create â†’ withdraw early â†’ log penalty
[22m[39mðŸ§¹ Cleaning up after test...

 [32mâœ“[39m src/modules/nudge/commitment.service.spec.ts[2m > [22mCommitmentService (via SimulationService)[2m > [22mContract Creation[2m > [22mshould create a commitment contract with valid data
 [32mâœ“[39m src/modules/nudge/commitment.service.spec.ts[2m > [22mCommitmentService (via SimulationService)[2m > [22mContract Creation[2m > [22mshould reject contract creation with insufficient balance
 [32mâœ“[39m src/modules/nudge/commitment.service.spec.ts[2m > [22mCommitmentService (via SimulationService)[2m > [22mContract Creation[2m > [22mshould calculate correct unlock date based on months
 [32mâœ“[39m src/modules/nudge/commitment.service.spec.ts[2m > [22mCommitmentService (via SimulationService)[2m > [22mContract Creation[2m > [22mshould create multiple contracts for different goals
 [32mâœ“[39m src/modules/nudge/commitment.service.spec.ts[2m > [22mCommitmentService (via SimulationService)[2m > [22mStake Locking[2m > [22mshould lock funds by decrementing portfolio balance
 [32mâœ“[39m src/modules/nudge/commitment.service.spec.ts[2m > [22mCommitmentService (via SimulationService)[2m > [22mStake Locking[2m > [22mshould verify locked amount matches commitment record
 [32mâœ“[39m src/modules/nudge/commitment.service.spec.ts[2m > [22mCommitmentService (via SimulationService)[2m > [22mStake Locking[2m > [22mshould prevent negative balance after locking
 [32mâœ“[39m src/modules/nudge/commitment.service.spec.ts[2m > [22mCommitmentService (via SimulationService)[2m > [22mCompletion Verification[2m > [22mshould successfully withdraw on-time commitment without penalty
 [32mâœ“[39m src/modules/nudge/commitment.service.spec.ts[2m > [22mCommitmentService (via SimulationService)[2m > [22mCompletion Verification[2m > [22mshould apply penalty for early withdrawal
 [32mâœ“[39m src/modules/nudge/commitment.service.spec.ts[2m > [22mCommitmentService (via SimulationService)[2m > [22mCompletion Verification[2m > [22mshould reject withdrawal for non-existent commitment
 [32mâœ“[39m src/modules/nudge/commitment.service.spec.ts[2m > [22mCommitmentService (via SimulationService)[2m > [22mCompletion Verification[2m > [22mshould reject withdrawal by unauthorized user
 [32mâœ“[39m src/modules/nudge/commitment.service.spec.ts[2m > [22mCommitmentService (via SimulationService)[2m > [22mMock Financial Data[2m > [22mshould simulate portfolio with realistic balance
 [32mâœ“[39m src/modules/nudge/commitment.service.spec.ts[2m > [22mCommitmentService (via SimulationService)[2m > [22mMock Financial Data[2m > [22mshould handle zero balance portfolio gracefully
 [32mâœ“[39m src/modules/nudge/commitment.service.spec.ts[2m > [22mCommitmentService (via SimulationService)[2m > [22mMock Financial Data[2m > [22mshould support large commitment amounts
 [32mâœ“[39m src/modules/nudge/commitment.service.spec.ts[2m > [22mCommitmentService (via SimulationService)[2m > [22mPenalty Calculation[2m > [22mshould calculate 10% penalty for early withdrawal
 [32mâœ“[39m src/modules/nudge/commitment.service.spec.ts[2m > [22mCommitmentService (via SimulationService)[2m > [22mPenalty Calculation[2m > [22mshould calculate penalty with different rates
 [32mâœ“[39m src/modules/nudge/commitment.service.spec.ts[2m > [22mCommitmentService (via SimulationService)[2m > [22mPenalty Calculation[2m > [22mshould return full amount when unlockDate is exactly now
 [32mâœ“[39m src/modules/nudge/commitment.service.spec.ts[2m > [22mCommitmentService (via SimulationService)[2m > [22mPenalty Calculation[2m > [22mshould log penalty event with correct metadata
 [32mâœ“[39m src/modules/nudge/commitment.service.spec.ts[2m > [22mCommitmentService (via SimulationService)[2m > [22mPenalty Calculation[2m > [22mshould handle edge case: zero penalty rate
 [32mâœ“[39m src/modules/nudge/commitment.service.spec.ts[2m > [22mCommitmentService (via SimulationService)[2m > [22mIntegration: Full Lifecycle[2m > [22mshould complete full commitment lifecycle: create â†’ withdraw early â†’ log penalty
 [32mâœ“[39m src/modules/nudge/commitment.service.spec.ts[2m > [22mCommitmentService (via SimulationService)[2m > [22mIntegration: Full Lifecycle[2m > [22mshould handle complete lifecycle: create â†’ wait â†’ withdraw without penalty
[90mstdout[2m | src/modules/nudge/commitment.service.spec.ts[2m > [22m[2mCommitmentService (via SimulationService)[2m > [22m[2mIntegration: Full Lifecycle[2m > [22m[2mshould handle complete lifecycle: create â†’ wait â†’ withdraw without penalty
[22m[39mðŸ§¹ Cleaning up after test...

[90mstdout[2m | src/modules/nudge/commitment.service.spec.ts
[22m[39mðŸ”§ Vitest setup: Starting MSW mock server...
âœ… Vitest teardown complete

[90mstdout[2m | src/modules/analytics/metrics.service.spec.ts[2m > [22m[2mMetricsService[2m > [22m[2mcalculateDAU[2m > [22m[2mshould calculate daily active users correctly
[22m[39mðŸ§¹ Cleaning up after test...

[90mstdout[2m | src/modules/analytics/metrics.service.spec.ts[2m > [22m[2mMetricsService[2m > [22m[2mcalculateDAU[2m > [22m[2mshould handle empty logs
[22m[39mðŸ§¹ Cleaning up after test...

[90mstdout[2m | src/modules/analytics/metrics.service.spec.ts[2m > [22m[2mMetricsService[2m > [22m[2mcalculateDAU[2m > [22m[2mshould deduplicate users within the same day
[22m[39mðŸ§¹ Cleaning up after test...

[90mstdout[2m | src/modules/analytics/metrics.service.spec.ts[2m > [22m[2mMetricsService[2m > [22m[2mcalculateDAU[2m > [22m[2mshould filter out null userId entries
[22m[39mðŸ§¹ Cleaning up after test...

[90mstdout[2m | src/modules/analytics/metrics.service.spec.ts[2m > [22m[2mMetricsService[2m > [22m[2mcalculateWAU[2m > [22m[2mshould calculate weekly active users
[22m[39mðŸ§¹ Cleaning up after test...

[90mstdout[2m | src/modules/analytics/metrics.service.spec.ts[2m > [22m[2mMetricsService[2m > [22m[2mcalculateWAU[2m > [22m[2mshould return 0 for no active users
[22m[39mðŸ§¹ Cleaning up after test...

[90mstdout[2m | src/modules/analytics/metrics.service.spec.ts[2m > [22m[2mMetricsService[2m > [22m[2mcalculateMAU[2m > [22m[2mshould calculate monthly active users for December 2025
[22m[39mðŸ§¹ Cleaning up after test...

[90mstdout[2m | src/modules/analytics/metrics.service.spec.ts[2m > [22m[2mMetricsService[2m > [22m[2mcalculateMAU[2m > [22m[2mshould handle edge case of February
[22m[39mðŸ§¹ Cleaning up after test...

[90mstdout[2m | src/modules/analytics/metrics.service.spec.ts[2m > [22m[2mMetricsService[2m > [22m[2mcalculateRetention[2m > [22m[2mshould calculate cohort retention correctly
[22m[39mðŸ§¹ Cleaning up after test...

[90mstdout[2m | src/modules/analytics/metrics.service.spec.ts[2m > [22m[2mMetricsService[2m > [22m[2mcalculateRetention[2m > [22m[2mshould handle zero retention
[22m[39mðŸ§¹ Cleaning up after test...

[90mstdout[2m | src/modules/analytics/metrics.service.spec.ts[2m > [22m[2mMetricsService[2m > [22m[2mcalculateRetention[2m > [22m[2mshould handle empty cohort
[22m[39mðŸ§¹ Cleaning up after test...

[90mstdout[2m | src/modules/analytics/metrics.service.spec.ts[2m > [22m[2mMetricsService[2m > [22m[2mcalculateEngagement[2m > [22m[2mshould calculate engagement metrics correctly
[22m[39mðŸ§¹ Cleaning up after test...

[90mstdout[2m | src/modules/analytics/metrics.service.spec.ts[2m > [22m[2mMetricsService[2m > [22m[2mcalculateEngagement[2m > [22m[2mshould handle empty logs
[22m[39mðŸ§¹ Cleaning up after test...

[90mstdout[2m | src/modules/analytics/metrics.service.spec.ts[2m > [22m[2mMetricsService[2m > [22m[2mcalculateEngagement[2m > [22m[2mshould calculate 100% bounce rate when all sessions have 1 event
[22m[39mðŸ§¹ Cleaning up after test...

[90mstdout[2m | src/modules/analytics/metrics.service.spec.ts[2m > [22m[2mMetricsService[2m > [22m[2mcalculatePercentile[2m > [22m[2mshould calculate 50th percentile (median) correctly
[22m[39mðŸ§¹ Cleaning up after test...

[90mstdout[2m | src/modules/analytics/metrics.service.spec.ts[2m > [22m[2mMetricsService[2m > [22m[2mcalculatePercentile[2m > [22m[2mshould calculate 95th percentile correctly
[22m[39mðŸ§¹ Cleaning up after test...

[90mstdout[2m | src/modules/analytics/metrics.service.spec.ts[2m > [22m[2mMetricsService[2m > [22m[2mcalculatePercentile[2m > [22m[2mshould calculate 0th percentile (minimum)
[22m[39mðŸ§¹ Cleaning up after test...

[90mstdout[2m | src/modules/analytics/metrics.service.spec.ts[2m > [22m[2mMetricsService[2m > [22m[2mcalculatePercentile[2m > [22m[2mshould calculate 100th percentile (maximum)
[22m[39mðŸ§¹ Cleaning up after test...

[90mstdout[2m | src/modules/analytics/metrics.service.spec.ts[2m > [22m[2mMetricsService[2m > [22m[2mcalculatePercentile[2m > [22m[2mshould handle single value array
[22m[39mðŸ§¹ Cleaning up after test...

[90mstdout[2m | src/modules/analytics/metrics.service.spec.ts[2m > [22m[2mMetricsService[2m > [22m[2mcalculatePercentile[2m > [22m[2mshould return 0 for empty array
[22m[39mðŸ§¹ Cleaning up after test...

[90mstdout[2m | src/modules/analytics/metrics.service.spec.ts[2m > [22m[2mMetricsService[2m > [22m[2mcalculatePercentile[2m > [22m[2mshould throw error for invalid percentile < 0
[22m[39mðŸ§¹ Cleaning up after test...

[90mstdout[2m | src/modules/analytics/metrics.service.spec.ts[2m > [22m[2mMetricsService[2m > [22m[2mcalculatePercentile[2m > [22m[2mshould throw error for invalid percentile > 100
[22m[39mðŸ§¹ Cleaning up after test...

[90mstdout[2m | src/modules/analytics/metrics.service.spec.ts[2m > [22m[2mMetricsService[2m > [22m[2mcalculatePercentile[2m > [22m[2mshould handle unsorted input correctly
[22m[39mðŸ§¹ Cleaning up after test...

[90mstdout[2m | src/modules/analytics/metrics.service.spec.ts[2m > [22m[2mMetricsService[2m > [22m[2mgetUserPointsPercentiles[2m > [22m[2mshould calculate multiple percentiles for user points
[22m[39mðŸ§¹ Cleaning up after test...

[90mstdout[2m | src/modules/analytics/metrics.service.spec.ts[2m > [22m[2mMetricsService[2m > [22m[2mgetUserPointsPercentiles[2m > [22m[2mshould handle users with zero points
[22m[39mðŸ§¹ Cleaning up after test...

[90mstdout[2m | src/modules/analytics/metrics.service.spec.ts[2m > [22m[2mMetricsService[2m > [22m[2mgetUserPointsPercentiles[2m > [22m[2mshould handle empty user list
[22m[39mðŸ§¹ Cleaning up after test...

[90mstdout[2m | src/modules/analytics/metrics.service.spec.ts[2m > [22m[2mMetricsService[2m > [22m[2maggregateTimeSeries[2m > [22m[2mevents metric[2m > [22m[2mshould aggregate events by day
[22m[39mðŸ§¹ Cleaning up after test...

[90mstdout[2m | src/modules/analytics/metrics.service.spec.ts[2m > [22m[2mMetricsService[2m > [22m[2maggregateTimeSeries[2m > [22m[2mevents metric[2m > [22m[2mshould aggregate events by hour
[22m[39mðŸ§¹ Cleaning up after test...

[90mstdout[2m | src/modules/analytics/metrics.service.spec.ts[2m > [22m[2mMetricsService[2m > [22m[2maggregateTimeSeries[2m > [22m[2musers metric[2m > [22m[2mshould aggregate unique users by day
[22m[39mðŸ§¹ Cleaning up after test...

[90mstdout[2m | src/modules/analytics/metrics.service.spec.ts[2m > [22m[2mMetricsService[2m > [22m[2maggregateTimeSeries[2m > [22m[2musers metric[2m > [22m[2mshould filter out null userIds
[22m[39mðŸ§¹ Cleaning up after test...

[90mstdout[2m | src/modules/analytics/metrics.service.spec.ts[2m > [22m[2mMetricsService[2m > [22m[2maggregateTimeSeries[2m > [22m[2msessions metric[2m > [22m[2mshould aggregate unique sessions by day
[22m[39mðŸ§¹ Cleaning up after test...

[90mstdout[2m | src/modules/analytics/metrics.service.spec.ts[2m > [22m[2mMetricsService[2m > [22m[2maggregateTimeSeries[2m > [22m[2mweek interval[2m > [22m[2mshould aggregate by week starting Monday
[22m[39mðŸ§¹ Cleaning up after test...

[90mstdout[2m | src/modules/analytics/metrics.service.spec.ts[2m > [22m[2mMetricsService[2m > [22m[2maggregateTimeSeries[2m > [22m[2mweek interval[2m > [22m[2mshould handle Sunday correctly (week starts Monday)
[22m[39mðŸ§¹ Cleaning up after test...

[90mstdout[2m | src/modules/analytics/metrics.service.spec.ts[2m > [22m[2mMetricsService[2m > [22m[2maggregateTimeSeries[2m > [22m[2mshould return empty array for no logs
[22m[39mðŸ§¹ Cleaning up after test...

[90mstdout[2m | src/modules/analytics/metrics.service.spec.ts[2m > [22m[2mMetricsService[2m > [22m[2maggregateTimeSeries[2m > [22m[2mshould sort results chronologically
[22m[39mðŸ§¹ Cleaning up after test...

[90mstdout[2m | src/modules/analytics/metrics.service.spec.ts[2m > [22m[2mMetricsService[2m > [22m[2mDatabase Integration[2m > [22m[2mshould use correct Prisma query for DAU
[22m[39mðŸ§¹ Cleaning up after test...

[90mstdout[2m | src/modules/analytics/metrics.service.spec.ts[2m > [22m[2mMetricsService[2m > [22m[2mDatabase Integration[2m > [22m[2mshould use distinct query for WAU
[22m[39mðŸ§¹ Cleaning up after test...

[90mstdout[2m | src/modules/analytics/metrics.service.spec.ts[2m > [22m[2mMetricsService[2m > [22m[2mEdge Cases[2m > [22m[2mshould handle timezone differences correctly
[22m[39mðŸ§¹ Cleaning up after test...

[90mstdout[2m | src/modules/analytics/metrics.service.spec.ts[2m > [22m[2mMetricsService[2m > [22m[2mEdge Cases[2m > [22m[2mshould handle large datasets efficiently
[22m[39mðŸ§¹ Cleaning up after test...

[90mstdout[2m | src/modules/analytics/metrics.service.spec.ts
[22m[39mðŸ”§ Vitest setup: Starting MSW mock server...
âœ… Vitest teardown complete

 [32mâœ“[39m src/modules/analytics/metrics.service.spec.ts[2m > [22mMetricsService[2m > [22mcalculateDAU[2m > [22mshould calculate daily active users correctly
 [32mâœ“[39m src/modules/analytics/metrics.service.spec.ts[2m > [22mMetricsService[2m > [22mcalculateDAU[2m > [22mshould handle empty logs
 [32mâœ“[39m src/modules/analytics/metrics.service.spec.ts[2m > [22mMetricsService[2m > [22mcalculateDAU[2m > [22mshould deduplicate users within the same day
 [32mâœ“[39m src/modules/analytics/metrics.service.spec.ts[2m > [22mMetricsService[2m > [22mcalculateDAU[2m > [22mshould filter out null userId entries
 [32mâœ“[39m src/modules/analytics/metrics.service.spec.ts[2m > [22mMetricsService[2m > [22mcalculateWAU[2m > [22mshould calculate weekly active users
 [32mâœ“[39m src/modules/analytics/metrics.service.spec.ts[2m > [22mMetricsService[2m > [22mcalculateWAU[2m > [22mshould return 0 for no active users
 [32mâœ“[39m src/modules/analytics/metrics.service.spec.ts[2m > [22mMetricsService[2m > [22mcalculateMAU[2m > [22mshould calculate monthly active users for December 2025
 [32mâœ“[39m src/modules/analytics/metrics.service.spec.ts[2m > [22mMetricsService[2m > [22mcalculateMAU[2m > [22mshould handle edge case of February
 [32mâœ“[39m src/modules/analytics/metrics.service.spec.ts[2m > [22mMetricsService[2m > [22mcalculateRetention[2m > [22mshould calculate cohort retention correctly
 [32mâœ“[39m src/modules/analytics/metrics.service.spec.ts[2m > [22mMetricsService[2m > [22mcalculateRetention[2m > [22mshould handle zero retention
 [31mÃ—[39m src/modules/analytics/metrics.service.spec.ts[2m > [22mMetricsService[2m > [22mcalculateRetention[2m > [22mshould handle empty cohort
[31m   â†’ Cannot read properties of undefined (reading 'length')[39m
 [32mâœ“[39m src/modules/analytics/metrics.service.spec.ts[2m > [22mMetricsService[2m > [22mcalculateEngagement[2m > [22mshould calculate engagement metrics correctly
 [32mâœ“[39m src/modules/analytics/metrics.service.spec.ts[2m > [22mMetricsService[2m > [22mcalculateEngagement[2m > [22mshould handle empty logs
 [32mâœ“[39m src/modules/analytics/metrics.service.spec.ts[2m > [22mMetricsService[2m > [22mcalculateEngagement[2m > [22mshould calculate 100% bounce rate when all sessions have 1 event
 [32mâœ“[39m src/modules/analytics/metrics.service.spec.ts[2m > [22mMetricsService[2m > [22mcalculatePercentile[2m > [22mshould calculate 50th percentile (median) correctly
 [31mÃ—[39m src/modules/analytics/metrics.service.spec.ts[2m > [22mMetricsService[2m > [22mcalculatePercentile[2m > [22mshould calculate 95th percentile correctly
[31m   â†’ expected 9.549999999999999 to be 9.55 // Object.is equality[39m
 [32mâœ“[39m src/modules/analytics/metrics.service.spec.ts[2m > [22mMetricsService[2m > [22mcalculatePercentile[2m > [22mshould calculate 0th percentile (minimum)
 [32mâœ“[39m src/modules/analytics/metrics.service.spec.ts[2m > [22mMetricsService[2m > [22mcalculatePercentile[2m > [22mshould calculate 100th percentile (maximum)
 [32mâœ“[39m src/modules/analytics/metrics.service.spec.ts[2m > [22mMetricsService[2m > [22mcalculatePercentile[2m > [22mshould handle single value array
 [32mâœ“[39m src/modules/analytics/metrics.service.spec.ts[2m > [22mMetricsService[2m > [22mcalculatePercentile[2m > [22mshould return 0 for empty array
 [32mâœ“[39m src/modules/analytics/metrics.service.spec.ts[2m > [22mMetricsService[2m > [22mcalculatePercentile[2m > [22mshould throw error for invalid percentile < 0
 [32mâœ“[39m src/modules/analytics/metrics.service.spec.ts[2m > [22mMetricsService[2m > [22mcalculatePercentile[2m > [22mshould throw error for invalid percentile > 100
 [32mâœ“[39m src/modules/analytics/metrics.service.spec.ts[2m > [22mMetricsService[2m > [22mcalculatePercentile[2m > [22mshould handle unsorted input correctly
 [32mâœ“[39m src/modules/analytics/metrics.service.spec.ts[2m > [22mMetricsService[2m > [22mgetUserPointsPercentiles[2m > [22mshould calculate multiple percentiles for user points
 [32mâœ“[39m src/modules/analytics/metrics.service.spec.ts[2m > [22mMetricsService[2m > [22mgetUserPointsPercentiles[2m > [22mshould handle users with zero points
 [32mâœ“[39m src/modules/analytics/metrics.service.spec.ts[2m > [22mMetricsService[2m > [22mgetUserPointsPercentiles[2m > [22mshould handle empty user list
 [32mâœ“[39m src/modules/analytics/metrics.service.spec.ts[2m > [22mMetricsService[2m > [22maggregateTimeSeries[2m > [22mevents metric[2m > [22mshould aggregate events by day
 [32mâœ“[39m src/modules/analytics/metrics.service.spec.ts[2m > [22mMetricsService[2m > [22maggregateTimeSeries[2m > [22mevents metric[2m > [22mshould aggregate events by hour
 [32mâœ“[39m src/modules/analytics/metrics.service.spec.ts[2m > [22mMetricsService[2m > [22maggregateTimeSeries[2m > [22musers metric[2m > [22mshould aggregate unique users by day
 [32mâœ“[39m src/modules/analytics/metrics.service.spec.ts[2m > [22mMetricsService[2m > [22maggregateTimeSeries[2m > [22musers metric[2m > [22mshould filter out null userIds
 [32mâœ“[39m src/modules/analytics/metrics.service.spec.ts[2m > [22mMetricsService[2m > [22maggregateTimeSeries[2m > [22msessions metric[2m > [22mshould aggregate unique sessions by day
 [32mâœ“[39m src/modules/analytics/metrics.service.spec.ts[2m > [22mMetricsService[2m > [22maggregateTimeSeries[2m > [22mweek interval[2m > [22mshould aggregate by week starting Monday
 [32mâœ“[39m src/modules/analytics/metrics.service.spec.ts[2m > [22mMetricsService[2m > [22maggregateTimeSeries[2m > [22mweek interval[2m > [22mshould handle Sunday correctly (week starts Monday)
 [32mâœ“[39m src/modules/analytics/metrics.service.spec.ts[2m > [22mMetricsService[2m > [22maggregateTimeSeries[2m > [22mshould return empty array for no logs
 [32mâœ“[39m src/modules/analytics/metrics.service.spec.ts[2m > [22mMetricsService[2m > [22maggregateTimeSeries[2m > [22mshould sort results chronologically
 [32mâœ“[39m src/modules/analytics/metrics.service.spec.ts[2m > [22mMetricsService[2m > [22mDatabase Integration[2m > [22mshould use correct Prisma query for DAU
 [32mâœ“[39m src/modules/analytics/metrics.service.spec.ts[2m > [22mMetricsService[2m > [22mDatabase Integration[2m > [22mshould use distinct query for WAU
 [32mâœ“[39m src/modules/analytics/metrics.service.spec.ts[2m > [22mMetricsService[2m > [22mEdge Cases[2m > [22mshould handle timezone differences correctly
 [32mâœ“[39m src/modules/analytics/metrics.service.spec.ts[2m > [22mMetricsService[2m > [22mEdge Cases[2m > [22mshould handle large datasets efficiently
[90mstdout[2m | src/modules/ai/utils/ai.utils.spec.ts[2m > [22m[2mAI Utility Functions[2m > [22m[2mTokenization Helpers[2m > [22m[2mshould estimate tokens correctly (1 token ~ 4 chars)
[22m[39mðŸ§¹ Cleaning up after test...

[90mstdout[2m | src/modules/ai/utils/ai.utils.spec.ts[2m > [22m[2mAI Utility Functions[2m > [22m[2mTokenization Helpers[2m > [22m[2mshould estimate multipart tokens
[22m[39mðŸ§¹ Cleaning up after test...

[90mstdout[2m | src/modules/ai/utils/ai.utils.spec.ts[2m > [22m[2mAI Utility Functions[2m > [22m[2mTokenization Helpers[2m > [22m[2mshould handle empty array in multipart estimation
[22m[39mðŸ§¹ Cleaning up after test...

[90mstdout[2m | src/modules/ai/utils/ai.utils.spec.ts[2m > [22m[2mAI Utility Functions[2m > [22m[2mTokenization Helpers[2m > [22m[2mshould truncate text to token budget
[22m[39mðŸ§¹ Cleaning up after test...

[90mstdout[2m | src/modules/ai/utils/ai.utils.spec.ts[2m > [22m[2mAI Utility Functions[2m > [22m[2mTokenization Helpers[2m > [22m[2mshould not truncate if within budget
[22m[39mðŸ§¹ Cleaning up after test...

[90mstdout[2m | src/modules/ai/utils/ai.utils.spec.ts[2m > [22m[2mAI Utility Functions[2m > [22m[2mTokenization Helpers[2m > [22m[2mshould validate token budget
[22m[39mðŸ§¹ Cleaning up after test...

[90mstdout[2m | src/modules/ai/utils/ai.utils.spec.ts[2m > [22m[2mAI Utility Functions[2m > [22m[2mPII Masking Helpers[2m > [22m[2mshould mask email addresses
[22m[39mðŸ§¹ Cleaning up after test...

[90mstdout[2m | src/modules/ai/utils/ai.utils.spec.ts[2m > [22m[2mAI Utility Functions[2m > [22m[2mPII Masking Helpers[2m > [22m[2mshould mask displayName
[22m[39mðŸ§¹ Cleaning up after test...

[90mstdout[2m | src/modules/ai/utils/ai.utils.spec.ts[2m > [22m[2mAI Utility Functions[2m > [22m[2mPII Masking Helpers[2m > [22m[2mshould mask phone numbers
[22m[39mðŸ§¹ Cleaning up after test...

[90mstdout[2m | src/modules/ai/utils/ai.utils.spec.ts[2m > [22m[2mAI Utility Functions[2m > [22m[2mPII Masking Helpers[2m > [22m[2mshould handle short strings
[22m[39mðŸ§¹ Cleaning up after test...

[90mstdout[2m | src/modules/ai/utils/ai.utils.spec.ts[2m > [22m[2mAI Utility Functions[2m > [22m[2mPII Masking Helpers[2m > [22m[2mshould recursively mask nested objects
[22m[39mðŸ§¹ Cleaning up after test...

[90mstdout[2m | src/modules/ai/utils/ai.utils.spec.ts[2m > [22m[2mAI Utility Functions[2m > [22m[2mPII Masking Helpers[2m > [22m[2mshould handle null and undefined
[22m[39mðŸ§¹ Cleaning up after test...

[90mstdout[2m | src/modules/ai/utils/ai.utils.spec.ts[2m > [22m[2mAI Utility Functions[2m > [22m[2mPII Masking Helpers[2m > [22m[2mshould not mask non-PII fields
[22m[39mðŸ§¹ Cleaning up after test...

[90mstdout[2m | src/modules/ai/utils/ai.utils.spec.ts[2m > [22m[2mAI Utility Functions[2m > [22m[2mPrompt Template Builders[2m > [22m[2mshould build course advice prompt for low progress
[22m[39mðŸ§¹ Cleaning up after test...

[90mstdout[2m | src/modules/ai/utils/ai.utils.spec.ts[2m > [22m[2mAI Utility Functions[2m > [22m[2mPrompt Template Builders[2m > [22m[2mshould build course advice prompt for medium progress
[22m[39mðŸ§¹ Cleaning up after test...

[90mstdout[2m | src/modules/ai/utils/ai.utils.spec.ts[2m > [22m[2mAI Utility Functions[2m > [22m[2mPrompt Template Builders[2m > [22m[2mshould build course advice prompt for high progress
[22m[39mðŸ§¹ Cleaning up after test...

[90mstdout[2m | src/modules/ai/utils/ai.utils.spec.ts[2m > [22m[2mAI Utility Functions[2m > [22m[2mPrompt Template Builders[2m > [22m[2mshould build persona prompt for WISE_SAGE
[22m[39mðŸ§¹ Cleaning up after test...

[90mstdout[2m | src/modules/ai/utils/ai.utils.spec.ts[2m > [22m[2mAI Utility Functions[2m > [22m[2mPrompt Template Builders[2m > [22m[2mshould build persona prompt for STRICT_COACH
[22m[39mðŸ§¹ Cleaning up after test...

[90mstdout[2m | src/modules/ai/utils/ai.utils.spec.ts[2m > [22m[2mAI Utility Functions[2m > [22m[2mPrompt Template Builders[2m > [22m[2mshould include group streak context when high
[22m[39mðŸ§¹ Cleaning up after test...

[90mstdout[2m | src/modules/ai/utils/ai.utils.spec.ts[2m > [22m[2mAI Utility Functions[2m > [22m[2mPrompt Template Builders[2m > [22m[2mshould build system instruction with all context
[22m[39mðŸ§¹ Cleaning up after test...

[90mstdout[2m | src/modules/ai/utils/ai.utils.spec.ts[2m > [22m[2mAI Utility Functions[2m > [22m[2mResponse Parsing Utilities[2m > [22m[2mshould parse action cards from response
[22m[39mðŸ§¹ Cleaning up after test...

[90mstdout[2m | src/modules/ai/utils/ai.utils.spec.ts[2m > [22m[2mAI Utility Functions[2m > [22m[2mResponse Parsing Utilities[2m > [22m[2mshould handle response without action cards
[22m[39mðŸ§¹ Cleaning up after test...

[90mstdout[2m | src/modules/ai/utils/ai.utils.spec.ts[2m > [22m[2mAI Utility Functions[2m > [22m[2mResponse Parsing Utilities[2m > [22m[2mshould handle malformed action card JSON
[22m[39mðŸ§¹ Cleaning up after test...

[90mstdout[2m | src/modules/ai/utils/ai.utils.spec.ts[2m > [22m[2mAI Utility Functions[2m > [22m[2mResponse Parsing Utilities[2m > [22m[2mshould extract JSON from markdown
[22m[39mðŸ§¹ Cleaning up after test...

[90mstdout[2m | src/modules/ai/utils/ai.utils.spec.ts[2m > [22m[2mAI Utility Functions[2m > [22m[2mResponse Parsing Utilities[2m > [22m[2mshould throw on invalid JSON
[22m[39mðŸ§¹ Cleaning up after test...

[90mstdout[2m | src/modules/ai/utils/ai.utils.spec.ts[2m > [22m[2mAI Utility Functions[2m > [22m[2mResponse Parsing Utilities[2m > [22m[2mshould parse valid course advice response
[22m[39mðŸ§¹ Cleaning up after test...

[90mstdout[2m | src/modules/ai/utils/ai.utils.spec.ts[2m > [22m[2mAI Utility Functions[2m > [22m[2mResponse Parsing Utilities[2m > [22m[2mshould return fallback for invalid course advice response
[22m[39mðŸ§¹ Cleaning up after test...

[90mstdout[2m | src/modules/ai/utils/ai.utils.spec.ts[2m > [22m[2mAI Utility Functions[2m > [22m[2mCache Key Generation[2m > [22m[2mshould generate consistent cache keys
[22m[39mðŸ§¹ Cleaning up after test...

[90mstdout[2m | src/modules/ai/utils/ai.utils.spec.ts[2m > [22m[2mAI Utility Functions[2m > [22m[2mCache Key Generation[2m > [22m[2mshould be case-insensitive
[22m[39mðŸ§¹ Cleaning up after test...

[90mstdout[2m | src/modules/ai/utils/ai.utils.spec.ts[2m > [22m[2mAI Utility Functions[2m > [22m[2mCache Key Generation[2m > [22m[2mshould trim whitespace
[22m[39mðŸ§¹ Cleaning up after test...

[90mstdout[2m | src/modules/ai/utils/ai.utils.spec.ts[2m > [22m[2mAI Utility Functions[2m > [22m[2mCache Key Generation[2m > [22m[2mshould start with ai_response prefix
[22m[39mðŸ§¹ Cleaning up after test...

[90mstdout[2m | src/modules/ai/utils/ai.utils.spec.ts[2m > [22m[2mAI Utility Functions[2m > [22m[2mIntent Classification[2m > [22m[2mshould classify FAQ intents (Vietnamese)
[22m[39mðŸ§¹ Cleaning up after test...

[90mstdout[2m | src/modules/ai/utils/ai.utils.spec.ts[2m > [22m[2mAI Utility Functions[2m > [22m[2mIntent Classification[2m > [22m[2mshould classify FAQ intents (English)
[22m[39mðŸ§¹ Cleaning up after test...

[90mstdout[2m | src/modules/ai/utils/ai.utils.spec.ts[2m > [22m[2mAI Utility Functions[2m > [22m[2mIntent Classification[2m > [22m[2mshould classify personalized advice intents
[22m[39mðŸ§¹ Cleaning up after test...

[90mstdout[2m | src/modules/ai/utils/ai.utils.spec.ts[2m > [22m[2mAI Utility Functions[2m > [22m[2mIntent Classification[2m > [22m[2mshould handle v-edfinance specific questions
[22m[39mðŸ§¹ Cleaning up after test...

[90mstdout[2m | src/modules/ai/utils/ai.utils.spec.ts[2m > [22m[2mAI Utility Functions[2m > [22m[2mIntent Classification[2m > [22m[2mshould be case-insensitive
[22m[39mðŸ§¹ Cleaning up after test...

[90mstdout[2m | src/modules/ai/utils/ai.utils.spec.ts[2m > [22m[2mAI Utility Functions[2m > [22m[2mError Handling Helpers[2m > [22m[2mshould create fallback response for Vietnamese
[22m[39mðŸ§¹ Cleaning up after test...

[90mstdout[2m | src/modules/ai/utils/ai.utils.spec.ts[2m > [22m[2mAI Utility Functions[2m > [22m[2mError Handling Helpers[2m > [22m[2mshould create fallback response for English
[22m[39mðŸ§¹ Cleaning up after test...

[90mstdout[2m | src/modules/ai/utils/ai.utils.spec.ts[2m > [22m[2mAI Utility Functions[2m > [22m[2mError Handling Helpers[2m > [22m[2mshould create fallback response for Chinese
[22m[39mðŸ§¹ Cleaning up after test...

[90mstdout[2m | src/modules/ai/utils/ai.utils.spec.ts[2m > [22m[2mAI Utility Functions[2m > [22m[2mError Handling Helpers[2m > [22m[2mshould default to English for unknown locale
[22m[39mðŸ§¹ Cleaning up after test...

[90mstdout[2m | src/modules/ai/utils/ai.utils.spec.ts[2m > [22m[2mAI Utility Functions[2m > [22m[2mError Handling Helpers[2m > [22m[2mshould handle AI errors with context
[22m[39mðŸ§¹ Cleaning up after test...

 [32mâœ“[39m src/modules/ai/utils/ai.utils.spec.ts[2m > [22mAI Utility Functions[2m > [22mTokenization Helpers[2m > [22mshould estimate tokens correctly (1 token ~ 4 chars)
 [32mâœ“[39m src/modules/ai/utils/ai.utils.spec.ts[2m > [22mAI Utility Functions[2m > [22mTokenization Helpers[2m > [22mshould estimate multipart tokens
 [32mâœ“[39m src/modules/ai/utils/ai.utils.spec.ts[2m > [22mAI Utility Functions[2m > [22mTokenization Helpers[2m > [22mshould handle empty array in multipart estimation
 [32mâœ“[39m src/modules/ai/utils/ai.utils.spec.ts[2m > [22mAI Utility Functions[2m > [22mTokenization Helpers[2m > [22mshould truncate text to token budget
 [32mâœ“[39m src/modules/ai/utils/ai.utils.spec.ts[2m > [22mAI Utility Functions[2m > [22mTokenization Helpers[2m > [22mshould not truncate if within budget
 [32mâœ“[39m src/modules/ai/utils/ai.utils.spec.ts[2m > [22mAI Utility Functions[2m > [22mTokenization Helpers[2m > [22mshould validate token budget
 [32mâœ“[39m src/modules/ai/utils/ai.utils.spec.ts[2m > [22mAI Utility Functions[2m > [22mPII Masking Helpers[2m > [22mshould mask email addresses
 [32mâœ“[39m src/modules/ai/utils/ai.utils.spec.ts[2m > [22mAI Utility Functions[2m > [22mPII Masking Helpers[2m > [22mshould mask displayName
 [32mâœ“[39m src/modules/ai/utils/ai.utils.spec.ts[2m > [22mAI Utility Functions[2m > [22mPII Masking Helpers[2m > [22mshould mask phone numbers
 [32mâœ“[39m src/modules/ai/utils/ai.utils.spec.ts[2m > [22mAI Utility Functions[2m > [22mPII Masking Helpers[2m > [22mshould handle short strings
 [32mâœ“[39m src/modules/ai/utils/ai.utils.spec.ts[2m > [22mAI Utility Functions[2m > [22mPII Masking Helpers[2m > [22mshould recursively mask nested objects
 [32mâœ“[39m src/modules/ai/utils/ai.utils.spec.ts[2m > [22mAI Utility Functions[2m > [22mPII Masking Helpers[2m > [22mshould handle null and undefined
 [32mâœ“[39m src/modules/ai/utils/ai.utils.spec.ts[2m > [22mAI Utility Functions[2m > [22mPII Masking Helpers[2m > [22mshould not mask non-PII fields
 [32mâœ“[39m src/modules/ai/utils/ai.utils.spec.ts[2m > [22mAI Utility Functions[2m > [22mPrompt Template Builders[2m > [22mshould build course advice prompt for low progress
 [32mâœ“[39m src/modules/ai/utils/ai.utils.spec.ts[2m > [22mAI Utility Functions[2m > [22mPrompt Template Builders[2m > [22mshould build course advice prompt for medium progress
 [32mâœ“[39m src/modules/ai/utils/ai.utils.spec.ts[2m > [22mAI Utility Functions[2m > [22mPrompt Template Builders[2m > [22mshould build course advice prompt for high progress
 [32mâœ“[39m src/modules/ai/utils/ai.utils.spec.ts[2m > [22mAI Utility Functions[2m > [22mPrompt Template Builders[2m > [22mshould build persona prompt for WISE_SAGE
 [32mâœ“[39m src/modules/ai/utils/ai.utils.spec.ts[2m > [22mAI Utility Functions[2m > [22mPrompt Template Builders[2m > [22mshould build persona prompt for STRICT_COACH
 [32mâœ“[39m src/modules/ai/utils/ai.utils.spec.ts[2m > [22mAI Utility Functions[2m > [22mPrompt Template Builders[2m > [22mshould include group streak context when high
 [32mâœ“[39m src/modules/ai/utils/ai.utils.spec.ts[2m > [22mAI Utility Functions[2m > [22mPrompt Template Builders[2m > [22mshould build system instruction with all context
 [32mâœ“[39m src/modules/ai/utils/ai.utils.spec.ts[2m > [22mAI Utility Functions[2m > [22mResponse Parsing Utilities[2m > [22mshould parse action cards from response
 [32mâœ“[39m src/modules/ai/utils/ai.utils.spec.ts[2m > [22mAI Utility Functions[2m > [22mResponse Parsing Utilities[2m > [22mshould handle response without action cards
 [32mâœ“[39m src/modules/ai/utils/ai.utils.spec.ts[2m > [22mAI Utility Functions[2m > [22mResponse Parsing Utilities[2m > [22mshould handle malformed action card JSON
 [32mâœ“[39m src/modules/ai/utils/ai.utils.spec.ts[2m > [22mAI Utility Functions[2m > [22mResponse Parsing Utilities[2m > [22mshould extract JSON from markdown
 [32mâœ“[39m src/modules/ai/utils/ai.utils.spec.ts[2m > [22mAI Utility Functions[2m > [22mResponse Parsing Utilities[2m > [22mshould throw on invalid JSON
 [32mâœ“[39m src/modules/ai/utils/ai.utils.spec.ts[2m > [22mAI Utility Functions[2m > [22mResponse Parsing Utilities[2m > [22mshould parse valid course advice response
 [32mâœ“[39m src/modules/ai/utils/ai.utils.spec.ts[2m > [22mAI Utility Functions[2m > [22mResponse Parsing Utilities[2m > [22mshould return fallback for invalid course advice response
 [32mâœ“[39m src/modules/ai/utils/ai.utils.spec.ts[2m > [22mAI Utility Functions[2m > [22mCache Key Generation[2m > [22mshould generate consistent cache keys
 [32mâœ“[39m src/modules/ai/utils/ai.utils.spec.ts[2m > [22mAI Utility Functions[2m > [22mCache Key Generation[2m > [22mshould be case-insensitive
 [32mâœ“[39m src/modules/ai/utils/ai.utils.spec.ts[2m > [22mAI Utility Functions[2m > [22mCache Key Generation[2m > [22mshould trim whitespace
 [32mâœ“[39m src/modules/ai/utils/ai.utils.spec.ts[2m > [22mAI Utility Functions[2m > [22mCache Key Generation[2m > [22mshould start with ai_response prefix
 [32mâœ“[39m src/modules/ai/utils/ai.utils.spec.ts[2m > [22mAI Utility Functions[2m > [22mIntent Classification[2m > [22mshould classify FAQ intents (Vietnamese)
 [32mâœ“[39m src/modules/ai/utils/ai.utils.spec.ts[2m > [22mAI Utility Functions[2m > [22mIntent Classification[2m > [22mshould classify FAQ intents (English)
 [32mâœ“[39m src/modules/ai/utils/ai.utils.spec.ts[2m > [22mAI Utility Functions[2m > [22mIntent Classification[2m > [22mshould classify personalized advice intents
 [32mâœ“[39m src/modules/ai/utils/ai.utils.spec.ts[2m > [22mAI Utility Functions[2m > [22mIntent Classification[2m > [22mshould handle v-edfinance specific questions
 [32mâœ“[39m src/modules/ai/utils/ai.utils.spec.ts[2m > [22mAI Utility Functions[2m > [22mIntent Classification[2m > [22mshould be case-insensitive
 [32mâœ“[39m src/modules/ai/utils/ai.utils.spec.ts[2m > [22mAI Utility Functions[2m > [22mError Handling Helpers[2m > [22mshould create fallback response for Vietnamese
 [32mâœ“[39m src/modules/ai/utils/ai.utils.spec.ts[2m > [22mAI Utility Functions[2m > [22mError Handling Helpers[2m > [22mshould create fallback response for English
 [32mâœ“[39m src/modules/ai/utils/ai.utils.spec.ts[2m > [22mAI Utility Functions[2m > [22mError Handling Helpers[2m > [22mshould create fallback response for Chinese
 [32mâœ“[39m src/modules/ai/utils/ai.utils.spec.ts[2m > [22mAI Utility Functions[2m > [22mError Handling Helpers[2m > [22mshould default to English for unknown locale
 [32mâœ“[39m src/modules/ai/utils/ai.utils.spec.ts[2m > [22mAI Utility Functions[2m > [22mError Handling Helpers[2m > [22mshould handle AI errors with context
 [32mâœ“[39m src/modules/ai/utils/ai.utils.spec.ts[2m > [22mAI Utility Functions[2m > [22mError Handling Helpers[2m > [22mshould handle AI errors without context
 [32mâœ“[39m src/modules/ai/utils/ai.utils.spec.ts[2m > [22mAI Utility Functions[2m > [22mEdge Cases & Integration[2m > [22mshould handle empty strings in all utilities
 [32mâœ“[39m src/modules/ai/utils/ai.utils.spec.ts[2m > [22mAI Utility Functions[2m > [22mEdge Cases & Integration[2m > [22mshould handle very long texts
 [32mâœ“[39m src/modules/ai/utils/ai.utils.spec.ts[2m > [22mAI Utility Functions[2m > [22mEdge Cases & Integration[2m > [22mshould handle special characters in prompts
 [32mâœ“[39m src/modules/ai/utils/ai.utils.spec.ts[2m > [22mAI Utility Functions[2m > [22mEdge Cases & Integration[2m > [22mshould maintain type safety in metadata parsing
[90mstdout[2m | src/modules/ai/utils/ai.utils.spec.ts[2m > [22m[2mAI Utility Functions[2m > [22m[2mError Handling Helpers[2m > [22m[2mshould handle AI errors without context
[22m[39mðŸ§¹ Cleaning up after test...

[90mstdout[2m | src/modules/ai/utils/ai.utils.spec.ts[2m > [22m[2mAI Utility Functions[2m > [22m[2mEdge Cases & Integration[2m > [22m[2mshould handle empty strings in all utilities
[22m[39mðŸ§¹ Cleaning up after test...

[90mstdout[2m | src/modules/ai/utils/ai.utils.spec.ts[2m > [22m[2mAI Utility Functions[2m > [22m[2mEdge Cases & Integration[2m > [22m[2mshould handle very long texts
[22m[39mðŸ§¹ Cleaning up after test...

[90mstdout[2m | src/modules/ai/utils/ai.utils.spec.ts[2m > [22m[2mAI Utility Functions[2m > [22m[2mEdge Cases & Integration[2m > [22m[2mshould handle special characters in prompts
[22m[39mðŸ§¹ Cleaning up after test...

[90mstdout[2m | src/modules/ai/utils/ai.utils.spec.ts[2m > [22m[2mAI Utility Functions[2m > [22m[2mEdge Cases & Integration[2m > [22m[2mshould maintain type safety in metadata parsing
[22m[39mðŸ§¹ Cleaning up after test...

[90mstdout[2m | src/modules/ai/utils/ai.utils.spec.ts
[22m[39mðŸ”§ Vitest setup: Starting MSW mock server...
âœ… Vitest teardown complete

 [2m[90mâ†“[39m[22m src/ai/ai.integration.spec.ts[2m > [22mAI Module - Integration Tests[2m > [22mThread Management Flow[2m > [22mshould create thread â†’ save messages â†’ retrieve thread history
 [2m[90mâ†“[39m[22m src/ai/ai.integration.spec.ts[2m > [22mAI Module - Integration Tests[2m > [22mThread Management Flow[2m > [22mshould handle multiple threads per user
 [2m[90mâ†“[39m[22m src/ai/ai.integration.spec.ts[2m > [22mAI Module - Integration Tests[2m > [22mAI Response Generation Flow (E2E)[2m > [22mshould generate personalized response and save to database
 [2m[90mâ†“[39m[22m src/ai/ai.integration.spec.ts[2m > [22mAI Module - Integration Tests[2m > [22mAI Response Generation Flow (E2E)[2m > [22mshould parse and extract action cards from AI response
 [2m[90mâ†“[39m[22m src/ai/ai.integration.spec.ts[2m > [22mAI Module - Integration Tests[2m > [22mAI Response Generation Flow (E2E)[2m > [22mshould use cache for FAQ questions (second call)
 [2m[90mâ†“[39m[22m src/ai/ai.integration.spec.ts[2m > [22mAI Module - Integration Tests[2m > [22mAI Response Generation Flow (E2E)[2m > [22mshould handle conversation context with history
 [2m[90mâ†“[39m[22m src/ai/ai.integration.spec.ts[2m > [22mAI Module - Integration Tests[2m > [22mRate Limiting & Token Budget[2m > [22mshould enforce rate limiting (max calls per minute)
 [2m[90mâ†“[39m[22m src/ai/ai.integration.spec.ts[2m > [22mAI Module - Integration Tests[2m > [22mRate Limiting & Token Budget[2m > [22mshould enforce monthly token budget
 [2m[90mâ†“[39m[22m src/ai/ai.integration.spec.ts[2m > [22mAI Module - Integration Tests[2m > [22mRate Limiting & Token Budget[2m > [22mshould allow requests within rate and budget limits
 [2m[90mâ†“[39m[22m src/ai/ai.integration.spec.ts[2m > [22mAI Module - Integration Tests[2m > [22mCourse Advice Generation[2m > [22mshould generate personalized course advice with nudge theory
 [2m[90mâ†“[39m[22m src/ai/ai.integration.spec.ts[2m > [22mAI Module - Integration Tests[2m > [22mCourse Advice Generation[2m > [22mshould adapt advice based on user progress
 [2m[90mâ†“[39m[22m src/ai/ai.integration.spec.ts[2m > [22mAI Module - Integration Tests[2m > [22mData Privacy & Security[2m > [22mshould mask PII before sending to external API
 [2m[90mâ†“[39m[22m src/ai/ai.integration.spec.ts[2m > [22mAI Module - Integration Tests[2m > [22mData Privacy & Security[2m > [22mshould not expose sensitive data in error messages
 [2m[90mâ†“[39m[22m src/ai/ai.integration.spec.ts[2m > [22mAI Module - Integration Tests[2m > [22mService Interactions[2m > [22mshould integrate with User, Course, and Progress data
 [2m[90mâ†“[39m[22m src/ai/ai.integration.spec.ts[2m > [22mAI Module - Integration Tests[2m > [22mService Interactions[2m > [22mshould track behavior logs during AI interactions
 [2m[90mâ†“[39m[22m src/ai/ai.integration.spec.ts[2m > [22mAI Module - Integration Tests[2m > [22mContext Window & Summarization[2m > [22mshould summarize conversation when history exceeds threshold
 [2m[90mâ†“[39m[22m src/ai/ai.integration.spec.ts[2m > [22mAI Module - Integration Tests[2m > [22mError Handling[2m > [22mshould handle thread not found gracefully
 [2m[90mâ†“[39m[22m src/ai/ai.integration.spec.ts[2m > [22mAI Module - Integration Tests[2m > [22mError Handling[2m > [22mshould provide fallback when AI response parsing fails
[90mstdout[2m | src/ai/ai.integration.spec.ts
[22m[39mðŸ”§ Vitest setup: Starting MSW mock server...
âœ… Vitest teardown complete

[90mstdout[2m | src/modules/nudge/nudge.controller.spec.ts[2m > [22m[2mNudgeController[2m > [22m[2mshould be defined
[22m[39mðŸ§¹ Cleaning up after test...

[90mstdout[2m | src/modules/nudge/nudge.controller.spec.ts[2m > [22m[2mNudgeController[2m > [22m[2mcheckNudge[2m > [22m[2mshould generate nudge with provided context and data
[22m[39mðŸ§¹ Cleaning up after test...

[90mstdout[2m | src/modules/nudge/nudge.controller.spec.ts[2m > [22m[2mNudgeController[2m > [22m[2mcheckNudge[2m > [22m[2mshould use default context "GENERAL" when context not provided
[22m[39mðŸ§¹ Cleaning up after test...

[90mstdout[2m | src/modules/nudge/nudge.controller.spec.ts[2m > [22m[2mNudgeController[2m > [22m[2mcheckNudge[2m > [22m[2mshould use empty object for data when data not provided
[22m[39mðŸ§¹ Cleaning up after test...

[90mstdout[2m | src/modules/nudge/nudge.controller.spec.ts[2m > [22m[2mNudgeController[2m > [22m[2mcheckNudge[2m > [22m[2mshould use defaults when body is empty
[22m[39mðŸ§¹ Cleaning up after test...

[90mstdout[2m | src/modules/nudge/nudge.controller.spec.ts[2m > [22m[2mNudgeController[2m > [22m[2mcheckNudge[2m > [22m[2mshould return null when no nudge is applicable
[22m[39mðŸ§¹ Cleaning up after test...

[90mstdout[2m | src/modules/nudge/nudge.controller.spec.ts[2m > [22m[2mNudgeController[2m > [22m[2mcheckNudge[2m > [22m[2mshould handle loss aversion nudge
[22m[39mðŸ§¹ Cleaning up after test...

[90mstdout[2m | src/modules/nudge/nudge.controller.spec.ts[2m > [22m[2mNudgeController[2m > [22m[2mcheckNudge[2m > [22m[2mshould propagate service errors
[22m[39mðŸ§¹ Cleaning up after test...

[90mstdout[2m | src/modules/nudge/nudge.controller.spec.ts[2m > [22m[2mNudgeController[2m > [22m[2mcheckNudge[2m > [22m[2mshould extract userId from nested request object
[22m[39mðŸ§¹ Cleaning up after test...

[90mstdout[2m | src/modules/nudge/nudge.controller.spec.ts[2m > [22m[2mNudgeController[2m > [22m[2mcheckNudge[2m > [22m[2mshould handle complex data objects
[22m[39mðŸ§¹ Cleaning up after test...

[90mstdout[2m | src/modules/nudge/nudge.controller.spec.ts[2m > [22m[2mNudgeController[2m > [22m[2mgetDashboardNudges[2m > [22m[2mshould return multiple nudges for dashboard
[22m[39mðŸ§¹ Cleaning up after test...

[90mstdout[2m | src/modules/nudge/nudge.controller.spec.ts[2m > [22m[2mNudgeController[2m > [22m[2mgetDashboardNudges[2m > [22m[2mshould filter out null nudges
[22m[39mðŸ§¹ Cleaning up after test...

[90mstdout[2m | src/modules/nudge/nudge.controller.spec.ts[2m > [22m[2mNudgeController[2m > [22m[2mgetDashboardNudges[2m > [22m[2mshould return empty array when all nudges are null
[22m[39mðŸ§¹ Cleaning up after test...

[90mstdout[2m | src/modules/nudge/nudge.controller.spec.ts[2m > [22m[2mNudgeController[2m > [22m[2mgetDashboardNudges[2m > [22m[2mshould extract userId from request object
[22m[39mðŸ§¹ Cleaning up after test...

[90mstdout[2m | src/modules/nudge/nudge.controller.spec.ts[2m > [22m[2mNudgeController[2m > [22m[2mgetDashboardNudges[2m > [22m[2mshould propagate service errors from first nudge call
[22m[39mðŸ§¹ Cleaning up after test...

[90mstdout[2m | src/modules/nudge/nudge.controller.spec.ts[2m > [22m[2mNudgeController[2m > [22m[2mgetDashboardNudges[2m > [22m[2mshould propagate service errors from second nudge call
[22m[39mðŸ§¹ Cleaning up after test...

[90mstdout[2m | src/modules/nudge/nudge.controller.spec.ts[2m > [22m[2mNudgeController[2m > [22m[2mgetDashboardNudges[2m > [22m[2mshould handle concurrent nudge generation
[22m[39mðŸ§¹ Cleaning up after test...

[90mstdout[2m | src/modules/nudge/nudge.controller.spec.ts[2m > [22m[2mNudgeController[2m > [22m[2mgetSocialProof[2m > [22m[2mshould return social proof for specific action and target
[22m[39mðŸ§¹ Cleaning up after test...

[90mstdout[2m | src/modules/nudge/nudge.controller.spec.ts[2m > [22m[2mNudgeController[2m > [22m[2mgetSocialProof[2m > [22m[2mshould handle quiz start action
[22m[39mðŸ§¹ Cleaning up after test...

[90mstdout[2m | src/modules/nudge/nudge.controller.spec.ts[2m > [22m[2mNudgeController[2m > [22m[2mgetSocialProof[2m > [22m[2mshould handle lesson view action
[22m[39mðŸ§¹ Cleaning up after test...

[90mstdout[2m | src/modules/nudge/nudge.controller.spec.ts[2m > [22m[2mNudgeController[2m > [22m[2mgetSocialProof[2m > [22m[2mshould return null when no social proof data available
[22m[39mðŸ§¹ Cleaning up after test...

[90mstdout[2m | src/modules/nudge/nudge.controller.spec.ts[2m > [22m[2mNudgeController[2m > [22m[2mgetSocialProof[2m > [22m[2mshould handle empty action string
[22m[39mðŸ§¹ Cleaning up after test...

[90mstdout[2m | src/modules/nudge/nudge.controller.spec.ts[2m > [22m[2mNudgeController[2m > [22m[2mgetSocialProof[2m > [22m[2mshould handle empty targetId string
[22m[39mðŸ§¹ Cleaning up after test...

[90mstdout[2m | src/modules/nudge/nudge.controller.spec.ts[2m > [22m[2mNudgeController[2m > [22m[2mgetSocialProof[2m > [22m[2mshould handle special characters in action parameter
[22m[39mðŸ§¹ Cleaning up after test...

[90mstdout[2m | src/modules/nudge/nudge.controller.spec.ts[2m > [22m[2mNudgeController[2m > [22m[2mgetSocialProof[2m > [22m[2mshould handle special characters in targetId parameter
[22m[39mðŸ§¹ Cleaning up after test...

[90mstdout[2m | src/modules/nudge/nudge.controller.spec.ts[2m > [22m[2mNudgeController[2m > [22m[2mgetSocialProof[2m > [22m[2mshould propagate service errors
[22m[39mðŸ§¹ Cleaning up after test...

[90mstdout[2m | src/modules/nudge/nudge.controller.spec.ts[2m > [22m[2mNudgeController[2m > [22m[2mgetSocialProof[2m > [22m[2mshould handle undefined query parameters gracefully
[22m[39mðŸ§¹ Cleaning up after test...

[90mstdout[2m | src/modules/nudge/nudge.controller.spec.ts[2m > [22m[2mNudgeController[2m > [22m[2mgetSocialProof[2m > [22m[2mshould support various action types
[22m[39mðŸ§¹ Cleaning up after test...

[90mstdout[2m | src/modules/nudge/nudge.controller.spec.ts[2m > [22m[2mNudgeController[2m > [22m[2mGuards and Authentication[2m > [22m[2mshould have JwtAuthGuard on checkNudge endpoint
[22m[39mðŸ§¹ Cleaning up after test...

[90mstdout[2m | src/modules/nudge/nudge.controller.spec.ts[2m > [22m[2mNudgeController[2m > [22m[2mGuards and Authentication[2m > [22m[2mshould have JwtAuthGuard on getDashboardNudges endpoint
[22m[39mðŸ§¹ Cleaning up after test...

[90mstdout[2m | src/modules/nudge/nudge.controller.spec.ts[2m > [22m[2mNudgeController[2m > [22m[2mGuards and Authentication[2m > [22m[2mshould not have JwtAuthGuard on getSocialProof endpoint
[22m[39mðŸ§¹ Cleaning up after test...

[90mstdout[2m | src/modules/nudge/nudge.controller.spec.ts[2m > [22m[2mNudgeController[2m > [22m[2mGuards and Authentication[2m > [22m[2mshould have ApiBearerAuth decorator on checkNudge
[22m[39mðŸ§¹ Cleaning up after test...

[90mstdout[2m | src/modules/nudge/nudge.controller.spec.ts[2m > [22m[2mNudgeController[2m > [22m[2mGuards and Authentication[2m > [22m[2mshould have ApiBearerAuth decorator on getDashboardNudges
[22m[39mðŸ§¹ Cleaning up after test...

[90mstdout[2m | src/modules/nudge/nudge.controller.spec.ts[2m > [22m[2mNudgeController[2m > [22m[2mError Handling[2m > [22m[2mshould handle malformed request object in checkNudge
[22m[39mðŸ§¹ Cleaning up after test...

[90mstdout[2m | src/modules/nudge/nudge.controller.spec.ts[2m > [22m[2mNudgeController[2m > [22m[2mError Handling[2m > [22m[2mshould handle malformed request object in getDashboardNudges
[22m[39mðŸ§¹ Cleaning up after test...

[90mstdout[2m | src/modules/nudge/nudge.controller.spec.ts[2m > [22m[2mNudgeController[2m > [22m[2mError Handling[2m > [22m[2mshould handle missing userId in request
[22m[39mðŸ§¹ Cleaning up after test...

[90mstdout[2m | src/modules/nudge/nudge.controller.spec.ts[2m > [22m[2mNudgeController[2m > [22m[2mError Handling[2m > [22m[2mshould handle service timeout errors
[22m[39mðŸ§¹ Cleaning up after test...

[90mstdout[2m | src/modules/nudge/nudge.controller.spec.ts[2m > [22m[2mNudgeController[2m > [22m[2mError Handling[2m > [22m[2mshould handle database errors gracefully
[22m[39mðŸ§¹ Cleaning up after test...

[90mstdout[2m | src/modules/nudge/nudge.controller.spec.ts[2m > [22m[2mNudgeController[2m > [22m[2mIntegration with NudgeEngineService[2m > [22m[2mshould correctly pass all parameters to generateNudge
[22m[39mðŸ§¹ Cleaning up after test...

[90mstdout[2m | src/modules/nudge/nudge.controller.spec.ts[2m > [22m[2mNudgeController[2m > [22m[2mIntegration with NudgeEngineService[2m > [22m[2mshould correctly pass parameters to getRealtimeSocialProof
[22m[39mðŸ§¹ Cleaning up after test...

[90mstdout[2m | src/modules/nudge/nudge.controller.spec.ts[2m > [22m[2mNudgeController[2m > [22m[2mIntegration with NudgeEngineService[2m > [22m[2mshould handle multiple sequential calls to checkNudge
[22m[39mðŸ§¹ Cleaning up after test...

[90mstdout[2m | src/modules/nudge/nudge.controller.spec.ts[2m > [22m[2mNudgeController[2m > [22m[2mInput Validation Edge Cases[2m > [22m[2mshould handle null body in checkNudge
[22m[39mðŸ§¹ Cleaning up after test...

[90mstdout[2m | src/modules/nudge/nudge.controller.spec.ts[2m > [22m[2mNudgeController[2m > [22m[2mInput Validation Edge Cases[2m > [22m[2mshould handle undefined body in checkNudge
[22m[39mðŸ§¹ Cleaning up after test...

[90mstdout[2m | src/modules/nudge/nudge.controller.spec.ts[2m > [22m[2mNudgeController[2m > [22m[2mInput Validation Edge Cases[2m > [22m[2mshould handle very long context strings
[22m[39mðŸ§¹ Cleaning up after test...

[90mstdout[2m | src/modules/nudge/nudge.controller.spec.ts[2m > [22m[2mNudgeController[2m > [22m[2mInput Validation Edge Cases[2m > [22m[2mshould handle special characters in context
[22m[39mðŸ§¹ Cleaning up after test...

[90mstdout[2m | src/modules/nudge/nudge.controller.spec.ts[2m > [22m[2mNudgeController[2m > [22m[2mInput Validation Edge Cases[2m > [22m[2mshould handle array data in body
[22m[39mðŸ§¹ Cleaning up after test...

[90mstdout[2m | src/modules/nudge/nudge.controller.spec.ts[2m > [22m[2mNudgeController[2m > [22m[2mInput Validation Edge Cases[2m > [22m[2mshould handle nested object data in body
[22m[39mðŸ§¹ Cleaning up after test...

[90mstdout[2m | src/modules/nudge/nudge.controller.spec.ts
[22m[39mðŸ”§ Vitest setup: Starting MSW mock server...
âœ… Vitest teardown complete

 [32mâœ“[39m src/modules/nudge/nudge.controller.spec.ts[2m > [22mNudgeController[2m > [22mshould be defined
 [32mâœ“[39m src/modules/nudge/nudge.controller.spec.ts[2m > [22mNudgeController[2m > [22mcheckNudge[2m > [22mshould generate nudge with provided context and data
 [32mâœ“[39m src/modules/nudge/nudge.controller.spec.ts[2m > [22mNudgeController[2m > [22mcheckNudge[2m > [22mshould use default context "GENERAL" when context not provided
 [32mâœ“[39m src/modules/nudge/nudge.controller.spec.ts[2m > [22mNudgeController[2m > [22mcheckNudge[2m > [22mshould use empty object for data when data not provided
 [32mâœ“[39m src/modules/nudge/nudge.controller.spec.ts[2m > [22mNudgeController[2m > [22mcheckNudge[2m > [22mshould use defaults when body is empty
 [32mâœ“[39m src/modules/nudge/nudge.controller.spec.ts[2m > [22mNudgeController[2m > [22mcheckNudge[2m > [22mshould return null when no nudge is applicable
 [32mâœ“[39m src/modules/nudge/nudge.controller.spec.ts[2m > [22mNudgeController[2m > [22mcheckNudge[2m > [22mshould handle loss aversion nudge
 [32mâœ“[39m src/modules/nudge/nudge.controller.spec.ts[2m > [22mNudgeController[2m > [22mcheckNudge[2m > [22mshould propagate service errors
 [32mâœ“[39m src/modules/nudge/nudge.controller.spec.ts[2m > [22mNudgeController[2m > [22mcheckNudge[2m > [22mshould extract userId from nested request object
 [32mâœ“[39m src/modules/nudge/nudge.controller.spec.ts[2m > [22mNudgeController[2m > [22mcheckNudge[2m > [22mshould handle complex data objects
 [32mâœ“[39m src/modules/nudge/nudge.controller.spec.ts[2m > [22mNudgeController[2m > [22mgetDashboardNudges[2m > [22mshould return multiple nudges for dashboard
 [32mâœ“[39m src/modules/nudge/nudge.controller.spec.ts[2m > [22mNudgeController[2m > [22mgetDashboardNudges[2m > [22mshould filter out null nudges
 [32mâœ“[39m src/modules/nudge/nudge.controller.spec.ts[2m > [22mNudgeController[2m > [22mgetDashboardNudges[2m > [22mshould return empty array when all nudges are null
 [32mâœ“[39m src/modules/nudge/nudge.controller.spec.ts[2m > [22mNudgeController[2m > [22mgetDashboardNudges[2m > [22mshould extract userId from request object
 [32mâœ“[39m src/modules/nudge/nudge.controller.spec.ts[2m > [22mNudgeController[2m > [22mgetDashboardNudges[2m > [22mshould propagate service errors from first nudge call
 [32mâœ“[39m src/modules/nudge/nudge.controller.spec.ts[2m > [22mNudgeController[2m > [22mgetDashboardNudges[2m > [22mshould propagate service errors from second nudge call
 [32mâœ“[39m src/modules/nudge/nudge.controller.spec.ts[2m > [22mNudgeController[2m > [22mgetDashboardNudges[2m > [22mshould handle concurrent nudge generation
 [32mâœ“[39m src/modules/nudge/nudge.controller.spec.ts[2m > [22mNudgeController[2m > [22mgetSocialProof[2m > [22mshould return social proof for specific action and target
 [32mâœ“[39m src/modules/nudge/nudge.controller.spec.ts[2m > [22mNudgeController[2m > [22mgetSocialProof[2m > [22mshould handle quiz start action
 [32mâœ“[39m src/modules/nudge/nudge.controller.spec.ts[2m > [22mNudgeController[2m > [22mgetSocialProof[2m > [22mshould handle lesson view action
 [32mâœ“[39m src/modules/nudge/nudge.controller.spec.ts[2m > [22mNudgeController[2m > [22mgetSocialProof[2m > [22mshould return null when no social proof data available
 [32mâœ“[39m src/modules/nudge/nudge.controller.spec.ts[2m > [22mNudgeController[2m > [22mgetSocialProof[2m > [22mshould handle empty action string
 [32mâœ“[39m src/modules/nudge/nudge.controller.spec.ts[2m > [22mNudgeController[2m > [22mgetSocialProof[2m > [22mshould handle empty targetId string
 [32mâœ“[39m src/modules/nudge/nudge.controller.spec.ts[2m > [22mNudgeController[2m > [22mgetSocialProof[2m > [22mshould handle special characters in action parameter
 [32mâœ“[39m src/modules/nudge/nudge.controller.spec.ts[2m > [22mNudgeController[2m > [22mgetSocialProof[2m > [22mshould handle special characters in targetId parameter
 [32mâœ“[39m src/modules/nudge/nudge.controller.spec.ts[2m > [22mNudgeController[2m > [22mgetSocialProof[2m > [22mshould propagate service errors
 [32mâœ“[39m src/modules/nudge/nudge.controller.spec.ts[2m > [22mNudgeController[2m > [22mgetSocialProof[2m > [22mshould handle undefined query parameters gracefully
 [32mâœ“[39m src/modules/nudge/nudge.controller.spec.ts[2m > [22mNudgeController[2m > [22mgetSocialProof[2m > [22mshould support various action types
 [32mâœ“[39m src/modules/nudge/nudge.controller.spec.ts[2m > [22mNudgeController[2m > [22mGuards and Authentication[2m > [22mshould have JwtAuthGuard on checkNudge endpoint
 [32mâœ“[39m src/modules/nudge/nudge.controller.spec.ts[2m > [22mNudgeController[2m > [22mGuards and Authentication[2m > [22mshould have JwtAuthGuard on getDashboardNudges endpoint
 [32mâœ“[39m src/modules/nudge/nudge.controller.spec.ts[2m > [22mNudgeController[2m > [22mGuards and Authentication[2m > [22mshould not have JwtAuthGuard on getSocialProof endpoint
 [32mâœ“[39m src/modules/nudge/nudge.controller.spec.ts[2m > [22mNudgeController[2m > [22mGuards and Authentication[2m > [22mshould have ApiBearerAuth decorator on checkNudge
 [32mâœ“[39m src/modules/nudge/nudge.controller.spec.ts[2m > [22mNudgeController[2m > [22mGuards and Authentication[2m > [22mshould have ApiBearerAuth decorator on getDashboardNudges
 [32mâœ“[39m src/modules/nudge/nudge.controller.spec.ts[2m > [22mNudgeController[2m > [22mError Handling[2m > [22mshould handle malformed request object in checkNudge
 [32mâœ“[39m src/modules/nudge/nudge.controller.spec.ts[2m > [22mNudgeController[2m > [22mError Handling[2m > [22mshould handle malformed request object in getDashboardNudges
 [32mâœ“[39m src/modules/nudge/nudge.controller.spec.ts[2m > [22mNudgeController[2m > [22mError Handling[2m > [22mshould handle missing userId in request
 [32mâœ“[39m src/modules/nudge/nudge.controller.spec.ts[2m > [22mNudgeController[2m > [22mError Handling[2m > [22mshould handle service timeout errors
 [32mâœ“[39m src/modules/nudge/nudge.controller.spec.ts[2m > [22mNudgeController[2m > [22mError Handling[2m > [22mshould handle database errors gracefully
 [32mâœ“[39m src/modules/nudge/nudge.controller.spec.ts[2m > [22mNudgeController[2m > [22mIntegration with NudgeEngineService[2m > [22mshould correctly pass all parameters to generateNudge
 [32mâœ“[39m src/modules/nudge/nudge.controller.spec.ts[2m > [22mNudgeController[2m > [22mIntegration with NudgeEngineService[2m > [22mshould correctly pass parameters to getRealtimeSocialProof
 [32mâœ“[39m src/modules/nudge/nudge.controller.spec.ts[2m > [22mNudgeController[2m > [22mIntegration with NudgeEngineService[2m > [22mshould handle multiple sequential calls to checkNudge
 [32mâœ“[39m src/modules/nudge/nudge.controller.spec.ts[2m > [22mNudgeController[2m > [22mInput Validation Edge Cases[2m > [22mshould handle null body in checkNudge
 [32mâœ“[39m src/modules/nudge/nudge.controller.spec.ts[2m > [22mNudgeController[2m > [22mInput Validation Edge Cases[2m > [22mshould handle undefined body in checkNudge
 [32mâœ“[39m src/modules/nudge/nudge.controller.spec.ts[2m > [22mNudgeController[2m > [22mInput Validation Edge Cases[2m > [22mshould handle very long context strings
 [32mâœ“[39m src/modules/nudge/nudge.controller.spec.ts[2m > [22mNudgeController[2m > [22mInput Validation Edge Cases[2m > [22mshould handle special characters in context
 [32mâœ“[39m src/modules/nudge/nudge.controller.spec.ts[2m > [22mNudgeController[2m > [22mInput Validation Edge Cases[2m > [22mshould handle array data in body
 [32mâœ“[39m src/modules/nudge/nudge.controller.spec.ts[2m > [22mNudgeController[2m > [22mInput Validation Edge Cases[2m > [22mshould handle nested object data in body
[90mstdout[2m | src/modules/nudge/social-proof.service.spec.ts[2m > [22m[2mSocialProofService[2m > [22m[2mshould be defined
[22m[39mðŸ§¹ Cleaning up after test...

[90mstdout[2m | src/modules/nudge/social-proof.service.spec.ts[2m > [22m[2mSocialProofService[2m > [22m[2mgenerateCohortMessage - "X% of users like you"[2m > [22m[2mshould generate high-percentage cohort message for popular action
[22m[39mðŸ§¹ Cleaning up after test...

[90mstdout[2m | src/modules/nudge/social-proof.service.spec.ts[2m > [22m[2mSocialProofService[2m > [22m[2mgenerateCohortMessage - "X% of users like you"[2m > [22m[2mshould generate medium-priority message for moderate adoption
[22m[39mðŸ§¹ Cleaning up after test...

[90mstdout[2m | src/modules/nudge/social-proof.service.spec.ts[2m > [22m[2mSocialProofService[2m > [22m[2mgenerateCohortMessage - "X% of users like you"[2m > [22m[2mshould generate low-priority message for low adoption
[22m[39mðŸ§¹ Cleaning up after test...

[90mstdout[2m | src/modules/nudge/social-proof.service.spec.ts[2m > [22m[2mSocialProofService[2m > [22m[2mgenerateCohortMessage - "X% of users like you"[2m > [22m[2mshould return null if user not found
[22m[39mðŸ§¹ Cleaning up after test...

[90mstdout[2m | src/modules/nudge/social-proof.service.spec.ts[2m > [22m[2mSocialProofService[2m > [22m[2mgenerateCohortMessage - "X% of users like you"[2m > [22m[2mshould return null if cohort has zero users
[22m[39mðŸ§¹ Cleaning up after test...

[90mstdout[2m | src/modules/nudge/social-proof.service.spec.ts[2m > [22m[2mSocialProofService[2m > [22m[2mgenerateCohortMessage - "X% of users like you"[2m > [22m[2mshould handle action without targetId
[22m[39mðŸ§¹ Cleaning up after test...

[90mstdout[2m | src/modules/nudge/social-proof.service.spec.ts[2m > [22m[2mSocialProofService[2m > [22m[2mgeneratePeerComparison - Peer ranking logic[2m > [22m[2mshould generate congratulatory message when user is above average
[22m[39mðŸ§¹ Cleaning up after test...

[90mstdout[2m | src/modules/nudge/social-proof.service.spec.ts[2m > [22m[2mSocialProofService[2m > [22m[2mgeneratePeerComparison - Peer ranking logic[2m > [22m[2mshould generate motivational message when user is below average
[22m[39mðŸ§¹ Cleaning up after test...

[90mstdout[2m | src/modules/nudge/social-proof.service.spec.ts[2m > [22m[2mSocialProofService[2m > [22m[2mgeneratePeerComparison - Peer ranking logic[2m > [22m[2mshould handle middle-ranked user
[22m[39mðŸ§¹ Cleaning up after test...

[90mstdout[2m | src/modules/nudge/social-proof.service.spec.ts[2m > [22m[2mSocialProofService[2m > [22m[2mgeneratePeerComparison - Peer ranking logic[2m > [22m[2mshould return null if user not found
[22m[39mðŸ§¹ Cleaning up after test...

[90mstdout[2m | src/modules/nudge/social-proof.service.spec.ts[2m > [22m[2mSocialProofService[2m > [22m[2mgeneratePeerComparison - Peer ranking logic[2m > [22m[2mshould handle edge case with no peers
[22m[39mðŸ§¹ Cleaning up after test...

[90mstdout[2m | src/modules/nudge/social-proof.service.spec.ts[2m > [22m[2mSocialProofService[2m > [22m[2mgenerateSocialNorm - Social norm framing[2m > [22m[2mshould generate positive message when user is aligned with norm
[22m[39mðŸ§¹ Cleaning up after test...

[90mstdout[2m | src/modules/nudge/social-proof.service.spec.ts[2m > [22m[2mSocialProofService[2m > [22m[2mgenerateSocialNorm - Social norm framing[2m > [22m[2mshould generate motivational message when user is NOT aligned
[22m[39mðŸ§¹ Cleaning up after test...

[90mstdout[2m | src/modules/nudge/social-proof.service.spec.ts[2m > [22m[2mSocialProofService[2m > [22m[2mgenerateSocialNorm - Social norm framing[2m > [22m[2mshould handle different behavior types
[22m[39mðŸ§¹ Cleaning up after test...

[90mstdout[2m | src/modules/nudge/social-proof.service.spec.ts[2m > [22m[2mSocialProofService[2m > [22m[2mgenerateSocialNorm - Social norm framing[2m > [22m[2mshould return null if no social norm data available
[22m[39mðŸ§¹ Cleaning up after test...

[90mstdout[2m | src/modules/nudge/social-proof.service.spec.ts[2m > [22m[2mSocialProofService[2m > [22m[2mgetRealtimeActivity - Real-time social proof[2m > [22m[2mshould get activity count for last 24 hours by default
[22m[39mðŸ§¹ Cleaning up after test...

[90mstdout[2m | src/modules/nudge/social-proof.service.spec.ts[2m > [22m[2mSocialProofService[2m > [22m[2mgetRealtimeActivity - Real-time social proof[2m > [22m[2mshould support custom time windows
[22m[39mðŸ§¹ Cleaning up after test...

[90mstdout[2m | src/modules/nudge/social-proof.service.spec.ts[2m > [22m[2mSocialProofService[2m > [22m[2mgetRealtimeActivity - Real-time social proof[2m > [22m[2mshould handle zero activity
[22m[39mðŸ§¹ Cleaning up after test...

[90mstdout[2m | src/modules/nudge/social-proof.service.spec.ts[2m > [22m[2mSocialProofService[2m > [22m[2mMessage localization[2m > [22m[2mshould provide messages in all three locales (vi, en, zh)
[22m[39mðŸ§¹ Cleaning up after test...

[90mstdout[2m | src/modules/nudge/social-proof.service.spec.ts[2m > [22m[2mSocialProofService[2m > [22m[2mMessage localization[2m > [22m[2mshould use appropriate language-specific terminology
[22m[39mðŸ§¹ Cleaning up after test...

[90mstdout[2m | src/modules/nudge/social-proof.service.spec.ts[2m > [22m[2mSocialProofService[2m > [22m[2mEdge cases and error handling[2m > [22m[2mshould handle database errors gracefully
[22m[39mðŸ§¹ Cleaning up after test...

[90mstdout[2m | src/modules/nudge/social-proof.service.spec.ts[2m > [22m[2mSocialProofService[2m > [22m[2mEdge cases and error handling[2m > [22m[2mshould handle missing investment profile
[22m[39mðŸ§¹ Cleaning up after test...

[90mstdout[2m | src/modules/nudge/social-proof.service.spec.ts[2m > [22m[2mSocialProofService[2m > [22m[2mEdge cases and error handling[2m > [22m[2mshould round percentages correctly
[22m[39mðŸ§¹ Cleaning up after test...

[90mstdout[2m | src/modules/nudge/social-proof.service.spec.ts[2m > [22m[2mSocialProofService[2m > [22m[2mEdge cases and error handling[2m > [22m[2mshould handle very small cohorts
[22m[39mðŸ§¹ Cleaning up after test...

[90mstdout[2m | src/modules/nudge/social-proof.service.spec.ts[2m > [22m[2mSocialProofService[2m > [22m[2mPriority calculation[2m > [22m[2mshould assign HIGH priority for >= 75%
[22m[39mðŸ§¹ Cleaning up after test...

[90mstdout[2m | src/modules/nudge/social-proof.service.spec.ts[2m > [22m[2mSocialProofService[2m > [22m[2mPriority calculation[2m > [22m[2mshould assign MEDIUM priority for 50-74%
[22m[39mðŸ§¹ Cleaning up after test...

[90mstdout[2m | src/modules/nudge/social-proof.service.spec.ts[2m > [22m[2mSocialProofService[2m > [22m[2mPriority calculation[2m > [22m[2mshould assign LOW priority for < 50%
[22m[39mðŸ§¹ Cleaning up after test...

[90mstdout[2m | src/modules/nudge/social-proof.service.spec.ts[2m > [22m[2mSocialProofService[2m > [22m[2mMetadata accuracy[2m > [22m[2mshould include accurate cohort metadata
[22m[39mðŸ§¹ Cleaning up after test...

[90mstdout[2m | src/modules/nudge/social-proof.service.spec.ts[2m > [22m[2mSocialProofService[2m > [22m[2mMetadata accuracy[2m > [22m[2mshould include accurate peer metadata
[22m[39mðŸ§¹ Cleaning up after test...

 [32mâœ“[39m src/modules/nudge/social-proof.service.spec.ts[2m > [22mSocialProofService[2m > [22mshould be defined
 [32mâœ“[39m src/modules/nudge/social-proof.service.spec.ts[2m > [22mSocialProofService[2m > [22mgenerateCohortMessage - "X% of users like you"[2m > [22mshould generate high-percentage cohort message for popular action
 [32mâœ“[39m src/modules/nudge/social-proof.service.spec.ts[2m > [22mSocialProofService[2m > [22mgenerateCohortMessage - "X% of users like you"[2m > [22mshould generate medium-priority message for moderate adoption
 [32mâœ“[39m src/modules/nudge/social-proof.service.spec.ts[2m > [22mSocialProofService[2m > [22mgenerateCohortMessage - "X% of users like you"[2m > [22mshould generate low-priority message for low adoption
 [32mâœ“[39m src/modules/nudge/social-proof.service.spec.ts[2m > [22mSocialProofService[2m > [22mgenerateCohortMessage - "X% of users like you"[2m > [22mshould return null if user not found
 [31mÃ—[39m src/modules/nudge/social-proof.service.spec.ts[2m > [22mSocialProofService[2m > [22mgenerateCohortMessage - "X% of users like you"[2m > [22mshould return null if cohort has zero users
[31m   â†’ expected { type: 'SOCIAL_PROOF', â€¦(3) } to be null[39m
 [32mâœ“[39m src/modules/nudge/social-proof.service.spec.ts[2m > [22mSocialProofService[2m > [22mgenerateCohortMessage - "X% of users like you"[2m > [22mshould handle action without targetId
 [31mÃ—[39m src/modules/nudge/social-proof.service.spec.ts[2m > [22mSocialProofService[2m > [22mgeneratePeerComparison - Peer ranking logic[2m > [22mshould generate congratulatory message when user is above average
[31m   â†’ expected '100% ngÆ°á»i dÃ¹ng Ä‘ang dáº«n trÆ°á»›c báº¡n vá»â€¦' to contain 'vÆ°á»£t trá»™i'[39m
 [31mÃ—[39m src/modules/nudge/social-proof.service.spec.ts[2m > [22mSocialProofService[2m > [22mgeneratePeerComparison - Peer ranking logic[2m > [22mshould generate motivational message when user is below average
[31m   â†’ expected 'MEDIUM' to be 'HIGH' // Object.is equality[39m
 [32mâœ“[39m src/modules/nudge/social-proof.service.spec.ts[2m > [22mSocialProofService[2m > [22mgeneratePeerComparison - Peer ranking logic[2m > [22mshould handle middle-ranked user
 [32mâœ“[39m src/modules/nudge/social-proof.service.spec.ts[2m > [22mSocialProofService[2m > [22mgeneratePeerComparison - Peer ranking logic[2m > [22mshould return null if user not found
 [32mâœ“[39m src/modules/nudge/social-proof.service.spec.ts[2m > [22mSocialProofService[2m > [22mgeneratePeerComparison - Peer ranking logic[2m > [22mshould handle edge case with no peers
 [32mâœ“[39m src/modules/nudge/social-proof.service.spec.ts[2m > [22mSocialProofService[2m > [22mgenerateSocialNorm - Social norm framing[2m > [22mshould generate positive message when user is aligned with norm
 [32mâœ“[39m src/modules/nudge/social-proof.service.spec.ts[2m > [22mSocialProofService[2m > [22mgenerateSocialNorm - Social norm framing[2m > [22mshould generate motivational message when user is NOT aligned
 [32mâœ“[39m src/modules/nudge/social-proof.service.spec.ts[2m > [22mSocialProofService[2m > [22mgenerateSocialNorm - Social norm framing[2m > [22mshould handle different behavior types
 [32mâœ“[39m src/modules/nudge/social-proof.service.spec.ts[2m > [22mSocialProofService[2m > [22mgenerateSocialNorm - Social norm framing[2m > [22mshould return null if no social norm data available
 [32mâœ“[39m src/modules/nudge/social-proof.service.spec.ts[2m > [22mSocialProofService[2m > [22mgetRealtimeActivity - Real-time social proof[2m > [22mshould get activity count for last 24 hours by default
 [32mâœ“[39m src/modules/nudge/social-proof.service.spec.ts[2m > [22mSocialProofService[2m > [22mgetRealtimeActivity - Real-time social proof[2m > [22mshould support custom time windows
 [32mâœ“[39m src/modules/nudge/social-proof.service.spec.ts[2m > [22mSocialProofService[2m > [22mgetRealtimeActivity - Real-time social proof[2m > [22mshould handle zero activity
 [32mâœ“[39m src/modules/nudge/social-proof.service.spec.ts[2m > [22mSocialProofService[2m > [22mMessage localization[2m > [22mshould provide messages in all three locales (vi, en, zh)
 [32mâœ“[39m src/modules/nudge/social-proof.service.spec.ts[2m > [22mSocialProofService[2m > [22mMessage localization[2m > [22mshould use appropriate language-specific terminology
 [32mâœ“[39m src/modules/nudge/social-proof.service.spec.ts[2m > [22mSocialProofService[2m > [22mEdge cases and error handling[2m > [22mshould handle database errors gracefully
 [32mâœ“[39m src/modules/nudge/social-proof.service.spec.ts[2m > [22mSocialProofService[2m > [22mEdge cases and error handling[2m > [22mshould handle missing investment profile
 [32mâœ“[39m src/modules/nudge/social-proof.service.spec.ts[2m > [22mSocialProofService[2m > [22mEdge cases and error handling[2m > [22mshould round percentages correctly
 [32mâœ“[39m src/modules/nudge/social-proof.service.spec.ts[2m > [22mSocialProofService[2m > [22mEdge cases and error handling[2m > [22mshould handle very small cohorts
 [32mâœ“[39m src/modules/nudge/social-proof.service.spec.ts[2m > [22mSocialProofService[2m > [22mPriority calculation[2m > [22mshould assign HIGH priority for >= 75%
 [32mâœ“[39m src/modules/nudge/social-proof.service.spec.ts[2m > [22mSocialProofService[2m > [22mPriority calculation[2m > [22mshould assign MEDIUM priority for 50-74%
 [32mâœ“[39m src/modules/nudge/social-proof.service.spec.ts[2m > [22mSocialProofService[2m > [22mPriority calculation[2m > [22mshould assign LOW priority for < 50%
 [32mâœ“[39m src/modules/nudge/social-proof.service.spec.ts[2m > [22mSocialProofService[2m > [22mMetadata accuracy[2m > [22mshould include accurate cohort metadata
 [32mâœ“[39m src/modules/nudge/social-proof.service.spec.ts[2m > [22mSocialProofService[2m > [22mMetadata accuracy[2m > [22mshould include accurate peer metadata
 [32mâœ“[39m src/modules/nudge/social-proof.service.spec.ts[2m > [22mSocialProofService[2m > [22mMetadata accuracy[2m > [22mshould include accurate social norm metadata
[90mstdout[2m | src/modules/nudge/social-proof.service.spec.ts[2m > [22m[2mSocialProofService[2m > [22m[2mMetadata accuracy[2m > [22m[2mshould include accurate social norm metadata
[22m[39mðŸ§¹ Cleaning up after test...

[90mstdout[2m | src/modules/nudge/social-proof.service.spec.ts
[22m[39mðŸ”§ Vitest setup: Starting MSW mock server...
âœ… Vitest teardown complete

[90mstdout[2m | src/modules/analytics/funnel-analysis.service.spec.ts[2m > [22m[2mFunnelAnalysisService[2m > [22m[2mgetConversionFunnel[2m > [22m[2mshould calculate conversion funnel with correct drop-off rates
[22m[39mðŸ§¹ Cleaning up after test...

[90mstdout[2m | src/modules/analytics/funnel-analysis.service.spec.ts[2m > [22m[2mFunnelAnalysisService[2m > [22m[2mgetConversionFunnel[2m > [22m[2mshould handle empty funnel data
[22m[39mðŸ§¹ Cleaning up after test...

[90mstdout[2m | src/modules/analytics/funnel-analysis.service.spec.ts[2m > [22m[2mFunnelAnalysisService[2m > [22m[2mgetConversionFunnel[2m > [22m[2mshould calculate average time to next stage
[22m[39mðŸ§¹ Cleaning up after test...

[90mstdout[2m | src/modules/analytics/funnel-analysis.service.spec.ts[2m > [22m[2mFunnelAnalysisService[2m > [22m[2mgetConversionFunnel[2m > [22m[2mshould handle users who never complete next stage
[22m[39mðŸ§¹ Cleaning up after test...

[90mstdout[2m | src/modules/analytics/funnel-analysis.service.spec.ts[2m > [22m[2mFunnelAnalysisService[2m > [22m[2mdetectDropOffPoints[2m > [22m[2mshould identify critical drop-off points above threshold
[22m[39mðŸ§¹ Cleaning up after test...

[90mstdout[2m | src/modules/analytics/funnel-analysis.service.spec.ts[2m > [22m[2mFunnelAnalysisService[2m > [22m[2mdetectDropOffPoints[2m > [22m[2mshould return severe reasons for high drop-off rates
[22m[39mðŸ§¹ Cleaning up after test...

[90mstdout[2m | src/modules/analytics/funnel-analysis.service.spec.ts[2m > [22m[2mFunnelAnalysisService[2m > [22m[2mdetectDropOffPoints[2m > [22m[2mshould return empty array when no critical drop-offs exist
[22m[39mðŸ§¹ Cleaning up after test...

[90mstdout[2m | src/modules/analytics/funnel-analysis.service.spec.ts[2m > [22m[2mFunnelAnalysisService[2m > [22m[2mdetectDropOffPoints[2m > [22m[2mshould use custom threshold for detection
[22m[39mðŸ§¹ Cleaning up after test...

[90mstdout[2m | src/modules/analytics/funnel-analysis.service.spec.ts[2m > [22m[2mFunnelAnalysisService[2m > [22m[2manalyzeCohort[2m > [22m[2mshould analyze cohort retention across stages
[22m[39mðŸ§¹ Cleaning up after test...

[90mstdout[2m | src/modules/analytics/funnel-analysis.service.spec.ts[2m > [22m[2mFunnelAnalysisService[2m > [22m[2manalyzeCohort[2m > [22m[2mshould calculate average completion time for cohort
[22m[39mðŸ§¹ Cleaning up after test...

[90mstdout[2m | src/modules/analytics/funnel-analysis.service.spec.ts[2m > [22m[2mFunnelAnalysisService[2m > [22m[2manalyzeCohort[2m > [22m[2mshould handle cohort with no users
[22m[39mðŸ§¹ Cleaning up after test...

[90mstdout[2m | src/modules/analytics/funnel-analysis.service.spec.ts[2m > [22m[2mFunnelAnalysisService[2m > [22m[2manalyzeCohort[2m > [22m[2mshould track week-over-week cohort performance
[22m[39mðŸ§¹ Cleaning up after test...

[90mstdout[2m | src/modules/analytics/funnel-analysis.service.spec.ts[2m > [22m[2mFunnelAnalysisService[2m > [22m[2mtrackUserJourney[2m > [22m[2mshould track complete user journey with all stages
[22m[39mðŸ§¹ Cleaning up after test...

[90mstdout[2m | src/modules/analytics/funnel-analysis.service.spec.ts[2m > [22m[2mFunnelAnalysisService[2m > [22m[2mtrackUserJourney[2m > [22m[2mshould mark journey as incomplete when no completion events
[22m[39mðŸ§¹ Cleaning up after test...

[90mstdout[2m | src/modules/analytics/funnel-analysis.service.spec.ts[2m > [22m[2mFunnelAnalysisService[2m > [22m[2mtrackUserJourney[2m > [22m[2mshould return empty journey for new users
[22m[39mðŸ§¹ Cleaning up after test...

[90mstdout[2m | src/modules/analytics/funnel-analysis.service.spec.ts[2m > [22m[2mFunnelAnalysisService[2m > [22m[2mtrackUserJourney[2m > [22m[2mshould calculate journey duration in seconds
[22m[39mðŸ§¹ Cleaning up after test...

[90mstdout[2m | src/modules/analytics/funnel-analysis.service.spec.ts[2m > [22m[2mFunnelAnalysisService[2m > [22m[2mtrackUserJourney[2m > [22m[2mshould preserve timestamp order for journey reconstruction
[22m[39mðŸ§¹ Cleaning up after test...

[90mstdout[2m | src/modules/analytics/funnel-analysis.service.spec.ts[2m > [22m[2mFunnelAnalysisService[2m > [22m[2mEdge Cases and Error Handling[2m > [22m[2mshould handle single-stage funnel
[22m[39mðŸ§¹ Cleaning up after test...

[90mstdout[2m | src/modules/analytics/funnel-analysis.service.spec.ts[2m > [22m[2mFunnelAnalysisService[2m > [22m[2mEdge Cases and Error Handling[2m > [22m[2mshould handle null userId in cohort analysis
[22m[39mðŸ§¹ Cleaning up after test...

[90mstdout[2m | src/modules/analytics/funnel-analysis.service.spec.ts[2m > [22m[2mFunnelAnalysisService[2m > [22m[2mEdge Cases and Error Handling[2m > [22m[2mshould handle concurrent user sessions in time calculation
[22m[39mðŸ§¹ Cleaning up after test...

[90mstdout[2m | src/modules/analytics/funnel-analysis.service.spec.ts[2m > [22m[2mFunnelAnalysisService[2m > [22m[2mEdge Cases and Error Handling[2m > [22m[2mshould handle users with incomplete journeys in cohort
[22m[39mðŸ§¹ Cleaning up after test...

[90mstdout[2m | src/modules/analytics/funnel-analysis.service.spec.ts[2m > [22m[2mFunnelAnalysisService[2m > [22m[2mEdge Cases and Error Handling[2m > [22m[2mshould handle zero division in conversion rate calculation
[22m[39mðŸ§¹ Cleaning up after test...

[90mstdout[2m | src/modules/analytics/funnel-analysis.service.spec.ts[2m > [22m[2mFunnelAnalysisService[2m > [22m[2mComplex Funnel Scenarios[2m > [22m[2mshould analyze multi-step onboarding funnel
[22m[39mðŸ§¹ Cleaning up after test...

[90mstdout[2m | src/modules/analytics/funnel-analysis.service.spec.ts[2m > [22m[2mFunnelAnalysisService[2m > [22m[2mComplex Funnel Scenarios[2m > [22m[2mshould identify multiple drop-off points in complex funnel
[22m[39mðŸ§¹ Cleaning up after test...

[90mstdout[2m | src/modules/analytics/funnel-analysis.service.spec.ts[2m > [22m[2mFunnelAnalysisService[2m > [22m[2mComplex Funnel Scenarios[2m > [22m[2mshould compare cohort performance across different time periods
[22m[39mðŸ§¹ Cleaning up after test...

[90mstdout[2m | src/modules/analytics/funnel-analysis.service.spec.ts[2m > [22m[2mFunnelAnalysisService[2m > [22m[2mPerformance and Optimization[2m > [22m[2mshould handle large dataset efficiently
[22m[39mðŸ§¹ Cleaning up after test...

 [32mâœ“[39m src/modules/analytics/funnel-analysis.service.spec.ts[2m > [22mFunnelAnalysisService[2m > [22mgetConversionFunnel[2m > [22mshould calculate conversion funnel with correct drop-off rates
 [32mâœ“[39m src/modules/analytics/funnel-analysis.service.spec.ts[2m > [22mFunnelAnalysisService[2m > [22mgetConversionFunnel[2m > [22mshould handle empty funnel data
 [32mâœ“[39m src/modules/analytics/funnel-analysis.service.spec.ts[2m > [22mFunnelAnalysisService[2m > [22mgetConversionFunnel[2m > [22mshould calculate average time to next stage
 [32mâœ“[39m src/modules/analytics/funnel-analysis.service.spec.ts[2m > [22mFunnelAnalysisService[2m > [22mgetConversionFunnel[2m > [22mshould handle users who never complete next stage
 [32mâœ“[39m src/modules/analytics/funnel-analysis.service.spec.ts[2m > [22mFunnelAnalysisService[2m > [22mdetectDropOffPoints[2m > [22mshould identify critical drop-off points above threshold
 [32mâœ“[39m src/modules/analytics/funnel-analysis.service.spec.ts[2m > [22mFunnelAnalysisService[2m > [22mdetectDropOffPoints[2m > [22mshould return severe reasons for high drop-off rates
 [32mâœ“[39m src/modules/analytics/funnel-analysis.service.spec.ts[2m > [22mFunnelAnalysisService[2m > [22mdetectDropOffPoints[2m > [22mshould return empty array when no critical drop-offs exist
 [32mâœ“[39m src/modules/analytics/funnel-analysis.service.spec.ts[2m > [22mFunnelAnalysisService[2m > [22mdetectDropOffPoints[2m > [22mshould use custom threshold for detection
 [32mâœ“[39m src/modules/analytics/funnel-analysis.service.spec.ts[2m > [22mFunnelAnalysisService[2m > [22manalyzeCohort[2m > [22mshould analyze cohort retention across stages
 [32mâœ“[39m src/modules/analytics/funnel-analysis.service.spec.ts[2m > [22mFunnelAnalysisService[2m > [22manalyzeCohort[2m > [22mshould calculate average completion time for cohort
 [32mâœ“[39m src/modules/analytics/funnel-analysis.service.spec.ts[2m > [22mFunnelAnalysisService[2m > [22manalyzeCohort[2m > [22mshould handle cohort with no users
 [32mâœ“[39m src/modules/analytics/funnel-analysis.service.spec.ts[2m > [22mFunnelAnalysisService[2m > [22manalyzeCohort[2m > [22mshould track week-over-week cohort performance
 [32mâœ“[39m src/modules/analytics/funnel-analysis.service.spec.ts[2m > [22mFunnelAnalysisService[2m > [22mtrackUserJourney[2m > [22mshould track complete user journey with all stages
 [32mâœ“[39m src/modules/analytics/funnel-analysis.service.spec.ts[2m > [22mFunnelAnalysisService[2m > [22mtrackUserJourney[2m > [22mshould mark journey as incomplete when no completion events
 [32mâœ“[39m src/modules/analytics/funnel-analysis.service.spec.ts[2m > [22mFunnelAnalysisService[2m > [22mtrackUserJourney[2m > [22mshould return empty journey for new users
 [32mâœ“[39m src/modules/analytics/funnel-analysis.service.spec.ts[2m > [22mFunnelAnalysisService[2m > [22mtrackUserJourney[2m > [22mshould calculate journey duration in seconds
 [32mâœ“[39m src/modules/analytics/funnel-analysis.service.spec.ts[2m > [22mFunnelAnalysisService[2m > [22mtrackUserJourney[2m > [22mshould preserve timestamp order for journey reconstruction
 [32mâœ“[39m src/modules/analytics/funnel-analysis.service.spec.ts[2m > [22mFunnelAnalysisService[2m > [22mEdge Cases and Error Handling[2m > [22mshould handle single-stage funnel
 [32mâœ“[39m src/modules/analytics/funnel-analysis.service.spec.ts[2m > [22mFunnelAnalysisService[2m > [22mEdge Cases and Error Handling[2m > [22mshould handle null userId in cohort analysis
 [32mâœ“[39m src/modules/analytics/funnel-analysis.service.spec.ts[2m > [22mFunnelAnalysisService[2m > [22mEdge Cases and Error Handling[2m > [22mshould handle concurrent user sessions in time calculation
 [32mâœ“[39m src/modules/analytics/funnel-analysis.service.spec.ts[2m > [22mFunnelAnalysisService[2m > [22mEdge Cases and Error Handling[2m > [22mshould handle users with incomplete journeys in cohort
 [32mâœ“[39m src/modules/analytics/funnel-analysis.service.spec.ts[2m > [22mFunnelAnalysisService[2m > [22mEdge Cases and Error Handling[2m > [22mshould handle zero division in conversion rate calculation
 [32mâœ“[39m src/modules/analytics/funnel-analysis.service.spec.ts[2m > [22mFunnelAnalysisService[2m > [22mComplex Funnel Scenarios[2m > [22mshould analyze multi-step onboarding funnel
 [32mâœ“[39m src/modules/analytics/funnel-analysis.service.spec.ts[2m > [22mFunnelAnalysisService[2m > [22mComplex Funnel Scenarios[2m > [22mshould identify multiple drop-off points in complex funnel
 [32mâœ“[39m src/modules/analytics/funnel-analysis.service.spec.ts[2m > [22mFunnelAnalysisService[2m > [22mComplex Funnel Scenarios[2m > [22mshould compare cohort performance across different time periods
 [32mâœ“[39m src/modules/analytics/funnel-analysis.service.spec.ts[2m > [22mFunnelAnalysisService[2m > [22mPerformance and Optimization[2m > [22mshould handle large dataset efficiently
 [32mâœ“[39m src/modules/analytics/funnel-analysis.service.spec.ts[2m > [22mFunnelAnalysisService[2m > [22mPerformance and Optimization[2m > [22mshould batch process funnel stages
[90mstdout[2m | src/modules/analytics/funnel-analysis.service.spec.ts[2m > [22m[2mFunnelAnalysisService[2m > [22m[2mPerformance and Optimization[2m > [22m[2mshould batch process funnel stages
[22m[39mðŸ§¹ Cleaning up after test...

[90mstdout[2m | src/modules/analytics/funnel-analysis.service.spec.ts
[22m[39mðŸ”§ Vitest setup: Starting MSW mock server...
âœ… Vitest teardown complete

[90mstdout[2m | src/modules/ai/persona-analysis.service.spec.ts[2m > [22m[2mPersonaAnalysisService (via AnalyticsService)[2m > [22m[2mUser Behavior Analysis[2m > [22m[2mshould analyze behavior patterns from BehaviorLog data
[22m[39mðŸ§¹ Cleaning up after test...

[90mstdout[2m | src/modules/ai/persona-analysis.service.spec.ts[2m > [22m[2mPersonaAnalysisService (via AnalyticsService)[2m > [22m[2mUser Behavior Analysis[2m > [22m[2mshould handle empty behavior log gracefully
[22m[39mðŸ§¹ Cleaning up after test...

[90mstdout[2m | src/modules/ai/persona-analysis.service.spec.ts[2m > [22m[2mPersonaAnalysisService (via AnalyticsService)[2m > [22m[2mUser Behavior Analysis[2m > [22m[2mshould prioritize recent behavior (last 50 logs)
[22m[39mðŸ§¹ Cleaning up after test...

[90mstdout[2m | src/modules/ai/persona-analysis.service.spec.ts[2m > [22m[2mPersonaAnalysisService (via AnalyticsService)[2m > [22m[2mUser Behavior Analysis[2m > [22m[2mshould analyze mixed behavior patterns accurately
[22m[39mðŸ§¹ Cleaning up after test...

[90mstdout[2m | src/modules/ai/persona-analysis.service.spec.ts[2m > [22m[2mPersonaAnalysisService (via AnalyticsService)[2m > [22m[2mPersona Classification Logic[2m > [22m[2mshould classify as HUNTER for dominant risk-taking behavior (>5 events)
[22m[39mðŸ§¹ Cleaning up after test...

[90mstdout[2m | src/modules/ai/persona-analysis.service.spec.ts[2m > [22m[2mPersonaAnalysisService (via AnalyticsService)[2m > [22m[2mPersona Classification Logic[2m > [22m[2mshould classify as SAVER for dominant commitment behavior (>5 events)
[22m[39mðŸ§¹ Cleaning up after test...

[90mstdout[2m | src/modules/ai/persona-analysis.service.spec.ts[2m > [22m[2mPersonaAnalysisService (via AnalyticsService)[2m > [22m[2mPersona Classification Logic[2m > [22m[2mshould classify as OBSERVER when risk-taking events â‰¤5
[22m[39mðŸ§¹ Cleaning up after test...

[90mstdout[2m | src/modules/ai/persona-analysis.service.spec.ts[2m > [22m[2mPersonaAnalysisService (via AnalyticsService)[2m > [22m[2mPersona Classification Logic[2m > [22m[2mshould classify as OBSERVER when saving events â‰¤5
[22m[39mðŸ§¹ Cleaning up after test...

[90mstdout[2m | src/modules/ai/persona-analysis.service.spec.ts[2m > [22m[2mPersonaAnalysisService (via AnalyticsService)[2m > [22m[2mPersona Classification Logic[2m > [22m[2mshould classify as OBSERVER when behaviors are balanced
[22m[39mðŸ§¹ Cleaning up after test...

[90mstdout[2m | src/modules/ai/persona-analysis.service.spec.ts[2m > [22m[2mPersonaAnalysisService (via AnalyticsService)[2m > [22m[2mPersona Classification Logic[2m > [22m[2mshould handle edge case: exactly 5 risk-taking events
[22m[39mðŸ§¹ Cleaning up after test...

[90mstdout[2m | src/modules/ai/persona-analysis.service.spec.ts[2m > [22m[2mPersonaAnalysisService (via AnalyticsService)[2m > [22m[2mPersona Classification Logic[2m > [22m[2mshould classify as HUNTER when exactly 6 risk-taking events
[22m[39mðŸ§¹ Cleaning up after test...

[90mstdout[2m | src/modules/ai/persona-analysis.service.spec.ts[2m > [22m[2mPersonaAnalysisService (via AnalyticsService)[2m > [22m[2mPsychological Profiling[2m > [22m[2mshould identify HUNTER profile: high risk tolerance
[22m[39mðŸ§¹ Cleaning up after test...

[90mstdout[2m | src/modules/ai/persona-analysis.service.spec.ts[2m > [22m[2mPersonaAnalysisService (via AnalyticsService)[2m > [22m[2mPsychological Profiling[2m > [22m[2mshould identify SAVER profile: commitment-focused
[22m[39mðŸ§¹ Cleaning up after test...

[90mstdout[2m | src/modules/ai/persona-analysis.service.spec.ts[2m > [22m[2mPersonaAnalysisService (via AnalyticsService)[2m > [22m[2mPsychological Profiling[2m > [22m[2mshould identify OBSERVER profile: passive engagement
[22m[39mðŸ§¹ Cleaning up after test...

[90mstdout[2m | src/modules/ai/persona-analysis.service.spec.ts[2m > [22m[2mPersonaAnalysisService (via AnalyticsService)[2m > [22m[2mPsychological Profiling[2m > [22m[2mshould profile based on event frequency distribution
[22m[39mðŸ§¹ Cleaning up after test...

[90mstdout[2m | src/modules/ai/persona-analysis.service.spec.ts[2m > [22m[2mPersonaAnalysisService (via AnalyticsService)[2m > [22m[2mPsychological Profiling[2m > [22m[2mshould analyze behavioral consistency over time
[22m[39mðŸ§¹ Cleaning up after test...

[90mstdout[2m | src/modules/ai/persona-analysis.service.spec.ts[2m > [22m[2mPersonaAnalysisService (via AnalyticsService)[2m > [22m[2mMock BehaviorLog Data Handling[2m > [22m[2mshould process various event types correctly
[22m[39mðŸ§¹ Cleaning up after test...

[90mstdout[2m | src/modules/ai/persona-analysis.service.spec.ts[2m > [22m[2mPersonaAnalysisService (via AnalyticsService)[2m > [22m[2mMock BehaviorLog Data Handling[2m > [22m[2mshould handle malformed log data gracefully
[22m[39mðŸ§¹ Cleaning up after test...

[90mstdout[2m | src/modules/ai/persona-analysis.service.spec.ts[2m > [22m[2mPersonaAnalysisService (via AnalyticsService)[2m > [22m[2mMock BehaviorLog Data Handling[2m > [22m[2mshould process logs with complete metadata
[22m[39mðŸ§¹ Cleaning up after test...

[90mstdout[2m | src/modules/ai/persona-analysis.service.spec.ts[2m > [22m[2mPersonaAnalysisService (via AnalyticsService)[2m > [22m[2mMock BehaviorLog Data Handling[2m > [22m[2mshould handle database query errors gracefully
[22m[39mðŸ§¹ Cleaning up after test...

[90mstdout[2m | src/modules/ai/persona-analysis.service.spec.ts[2m > [22m[2mPersonaAnalysisService (via AnalyticsService)[2m > [22m[2mMock BehaviorLog Data Handling[2m > [22m[2mshould respect the 50-log limit
[22m[39mðŸ§¹ Cleaning up after test...

[90mstdout[2m | src/modules/ai/persona-analysis.service.spec.ts[2m > [22m[2mPersonaAnalysisService (via AnalyticsService)[2m > [22m[2mPersona Recommendations Validation[2m > [22m[2mshould recommend HUNTER persona for aggressive investors
[22m[39mðŸ§¹ Cleaning up after test...

[90mstdout[2m | src/modules/ai/persona-analysis.service.spec.ts[2m > [22m[2mPersonaAnalysisService (via AnalyticsService)[2m > [22m[2mPersona Recommendations Validation[2m > [22m[2mshould recommend SAVER persona for conservative users
[22m[39mðŸ§¹ Cleaning up after test...

[90mstdout[2m | src/modules/ai/persona-analysis.service.spec.ts[2m > [22m[2mPersonaAnalysisService (via AnalyticsService)[2m > [22m[2mPersona Recommendations Validation[2m > [22m[2mshould recommend OBSERVER persona for new users
[22m[39mðŸ§¹ Cleaning up after test...

[90mstdout[2m | src/modules/ai/persona-analysis.service.spec.ts[2m > [22m[2mPersonaAnalysisService (via AnalyticsService)[2m > [22m[2mPersona Recommendations Validation[2m > [22m[2mshould validate persona transitions over time
[22m[39mðŸ§¹ Cleaning up after test...

[90mstdout[2m | src/modules/ai/persona-analysis.service.spec.ts[2m > [22m[2mPersonaAnalysisService (via AnalyticsService)[2m > [22m[2mPersona Recommendations Validation[2m > [22m[2mshould handle persona ambiguity with default to OBSERVER
[22m[39mðŸ§¹ Cleaning up after test...

[90mstdout[2m | src/modules/ai/persona-analysis.service.spec.ts[2m > [22m[2mPersonaAnalysisService (via AnalyticsService)[2m > [22m[2mPersona Recommendations Validation[2m > [22m[2mshould provide consistent recommendations for similar behavior
[22m[39mðŸ§¹ Cleaning up after test...

[90mstdout[2m | src/modules/ai/persona-analysis.service.spec.ts[2m > [22m[2mPersonaAnalysisService (via AnalyticsService)[2m > [22m[2mEdge Cases & Boundary Conditions[2m > [22m[2mshould handle single behavior log entry
[22m[39mðŸ§¹ Cleaning up after test...

[90mstdout[2m | src/modules/ai/persona-analysis.service.spec.ts[2m > [22m[2mPersonaAnalysisService (via AnalyticsService)[2m > [22m[2mEdge Cases & Boundary Conditions[2m > [22m[2mshould handle exactly threshold behaviors (boundary)
[22m[39mðŸ§¹ Cleaning up after test...

[90mstdout[2m | src/modules/ai/persona-analysis.service.spec.ts[2m > [22m[2mPersonaAnalysisService (via AnalyticsService)[2m > [22m[2mEdge Cases & Boundary Conditions[2m > [22m[2mshould handle maximum logs (50 entries)
[22m[39mðŸ§¹ Cleaning up after test...

[90mstdout[2m | src/modules/ai/persona-analysis.service.spec.ts[2m > [22m[2mPersonaAnalysisService (via AnalyticsService)[2m > [22m[2mEdge Cases & Boundary Conditions[2m > [22m[2mshould handle mixed event types with unknown events
[22m[39mðŸ§¹ Cleaning up after test...

[90mstdout[2m | src/modules/ai/persona-analysis.service.spec.ts[2m > [22m[2mPersonaAnalysisService (via AnalyticsService)[2m > [22m[2mEdge Cases & Boundary Conditions[2m > [22m[2mshould return consistent results for multiple calls
[22m[39mðŸ§¹ Cleaning up after test...

[90mstdout[2m | src/modules/ai/persona-analysis.service.spec.ts[2m > [22m[2mPersonaAnalysisService (via AnalyticsService)[2m > [22m[2mPerformance & Data Quality[2m > [22m[2mshould handle large datasets efficiently
[22m[39mðŸ§¹ Cleaning up after test...

 [32mâœ“[39m src/modules/ai/persona-analysis.service.spec.ts[2m > [22mPersonaAnalysisService (via AnalyticsService)[2m > [22mUser Behavior Analysis[2m > [22mshould analyze behavior patterns from BehaviorLog data
 [32mâœ“[39m src/modules/ai/persona-analysis.service.spec.ts[2m > [22mPersonaAnalysisService (via AnalyticsService)[2m > [22mUser Behavior Analysis[2m > [22mshould handle empty behavior log gracefully
 [32mâœ“[39m src/modules/ai/persona-analysis.service.spec.ts[2m > [22mPersonaAnalysisService (via AnalyticsService)[2m > [22mUser Behavior Analysis[2m > [22mshould prioritize recent behavior (last 50 logs)
 [32mâœ“[39m src/modules/ai/persona-analysis.service.spec.ts[2m > [22mPersonaAnalysisService (via AnalyticsService)[2m > [22mUser Behavior Analysis[2m > [22mshould analyze mixed behavior patterns accurately
 [32mâœ“[39m src/modules/ai/persona-analysis.service.spec.ts[2m > [22mPersonaAnalysisService (via AnalyticsService)[2m > [22mPersona Classification Logic[2m > [22mshould classify as HUNTER for dominant risk-taking behavior (>5 events)
 [32mâœ“[39m src/modules/ai/persona-analysis.service.spec.ts[2m > [22mPersonaAnalysisService (via AnalyticsService)[2m > [22mPersona Classification Logic[2m > [22mshould classify as SAVER for dominant commitment behavior (>5 events)
 [32mâœ“[39m src/modules/ai/persona-analysis.service.spec.ts[2m > [22mPersonaAnalysisService (via AnalyticsService)[2m > [22mPersona Classification Logic[2m > [22mshould classify as OBSERVER when risk-taking events â‰¤5
 [32mâœ“[39m src/modules/ai/persona-analysis.service.spec.ts[2m > [22mPersonaAnalysisService (via AnalyticsService)[2m > [22mPersona Classification Logic[2m > [22mshould classify as OBSERVER when saving events â‰¤5
 [32mâœ“[39m src/modules/ai/persona-analysis.service.spec.ts[2m > [22mPersonaAnalysisService (via AnalyticsService)[2m > [22mPersona Classification Logic[2m > [22mshould classify as OBSERVER when behaviors are balanced
 [32mâœ“[39m src/modules/ai/persona-analysis.service.spec.ts[2m > [22mPersonaAnalysisService (via AnalyticsService)[2m > [22mPersona Classification Logic[2m > [22mshould handle edge case: exactly 5 risk-taking events
 [32mâœ“[39m src/modules/ai/persona-analysis.service.spec.ts[2m > [22mPersonaAnalysisService (via AnalyticsService)[2m > [22mPersona Classification Logic[2m > [22mshould classify as HUNTER when exactly 6 risk-taking events
 [32mâœ“[39m src/modules/ai/persona-analysis.service.spec.ts[2m > [22mPersonaAnalysisService (via AnalyticsService)[2m > [22mPsychological Profiling[2m > [22mshould identify HUNTER profile: high risk tolerance
 [32mâœ“[39m src/modules/ai/persona-analysis.service.spec.ts[2m > [22mPersonaAnalysisService (via AnalyticsService)[2m > [22mPsychological Profiling[2m > [22mshould identify SAVER profile: commitment-focused
 [32mâœ“[39m src/modules/ai/persona-analysis.service.spec.ts[2m > [22mPersonaAnalysisService (via AnalyticsService)[2m > [22mPsychological Profiling[2m > [22mshould identify OBSERVER profile: passive engagement
 [32mâœ“[39m src/modules/ai/persona-analysis.service.spec.ts[2m > [22mPersonaAnalysisService (via AnalyticsService)[2m > [22mPsychological Profiling[2m > [22mshould profile based on event frequency distribution
 [32mâœ“[39m src/modules/ai/persona-analysis.service.spec.ts[2m > [22mPersonaAnalysisService (via AnalyticsService)[2m > [22mPsychological Profiling[2m > [22mshould analyze behavioral consistency over time
 [32mâœ“[39m src/modules/ai/persona-analysis.service.spec.ts[2m > [22mPersonaAnalysisService (via AnalyticsService)[2m > [22mMock BehaviorLog Data Handling[2m > [22mshould process various event types correctly
 [32mâœ“[39m src/modules/ai/persona-analysis.service.spec.ts[2m > [22mPersonaAnalysisService (via AnalyticsService)[2m > [22mMock BehaviorLog Data Handling[2m > [22mshould handle malformed log data gracefully
 [32mâœ“[39m src/modules/ai/persona-analysis.service.spec.ts[2m > [22mPersonaAnalysisService (via AnalyticsService)[2m > [22mMock BehaviorLog Data Handling[2m > [22mshould process logs with complete metadata
 [32mâœ“[39m src/modules/ai/persona-analysis.service.spec.ts[2m > [22mPersonaAnalysisService (via AnalyticsService)[2m > [22mMock BehaviorLog Data Handling[2m > [22mshould handle database query errors gracefully
 [32mâœ“[39m src/modules/ai/persona-analysis.service.spec.ts[2m > [22mPersonaAnalysisService (via AnalyticsService)[2m > [22mMock BehaviorLog Data Handling[2m > [22mshould respect the 50-log limit
 [32mâœ“[39m src/modules/ai/persona-analysis.service.spec.ts[2m > [22mPersonaAnalysisService (via AnalyticsService)[2m > [22mPersona Recommendations Validation[2m > [22mshould recommend HUNTER persona for aggressive investors
 [32mâœ“[39m src/modules/ai/persona-analysis.service.spec.ts[2m > [22mPersonaAnalysisService (via AnalyticsService)[2m > [22mPersona Recommendations Validation[2m > [22mshould recommend SAVER persona for conservative users
 [32mâœ“[39m src/modules/ai/persona-analysis.service.spec.ts[2m > [22mPersonaAnalysisService (via AnalyticsService)[2m > [22mPersona Recommendations Validation[2m > [22mshould recommend OBSERVER persona for new users
 [32mâœ“[39m src/modules/ai/persona-analysis.service.spec.ts[2m > [22mPersonaAnalysisService (via AnalyticsService)[2m > [22mPersona Recommendations Validation[2m > [22mshould validate persona transitions over time
 [32mâœ“[39m src/modules/ai/persona-analysis.service.spec.ts[2m > [22mPersonaAnalysisService (via AnalyticsService)[2m > [22mPersona Recommendations Validation[2m > [22mshould handle persona ambiguity with default to OBSERVER
 [32mâœ“[39m src/modules/ai/persona-analysis.service.spec.ts[2m > [22mPersonaAnalysisService (via AnalyticsService)[2m > [22mPersona Recommendations Validation[2m > [22mshould provide consistent recommendations for similar behavior
 [32mâœ“[39m src/modules/ai/persona-analysis.service.spec.ts[2m > [22mPersonaAnalysisService (via AnalyticsService)[2m > [22mEdge Cases & Boundary Conditions[2m > [22mshould handle single behavior log entry
 [32mâœ“[39m src/modules/ai/persona-analysis.service.spec.ts[2m > [22mPersonaAnalysisService (via AnalyticsService)[2m > [22mEdge Cases & Boundary Conditions[2m > [22mshould handle exactly threshold behaviors (boundary)
 [32mâœ“[39m src/modules/ai/persona-analysis.service.spec.ts[2m > [22mPersonaAnalysisService (via AnalyticsService)[2m > [22mEdge Cases & Boundary Conditions[2m > [22mshould handle maximum logs (50 entries)
 [32mâœ“[39m src/modules/ai/persona-analysis.service.spec.ts[2m > [22mPersonaAnalysisService (via AnalyticsService)[2m > [22mEdge Cases & Boundary Conditions[2m > [22mshould handle mixed event types with unknown events
 [32mâœ“[39m src/modules/ai/persona-analysis.service.spec.ts[2m > [22mPersonaAnalysisService (via AnalyticsService)[2m > [22mEdge Cases & Boundary Conditions[2m > [22mshould return consistent results for multiple calls
 [32mâœ“[39m src/modules/ai/persona-analysis.service.spec.ts[2m > [22mPersonaAnalysisService (via AnalyticsService)[2m > [22mPerformance & Data Quality[2m > [22mshould handle large datasets efficiently
 [32mâœ“[39m src/modules/ai/persona-analysis.service.spec.ts[2m > [22mPersonaAnalysisService (via AnalyticsService)[2m > [22mPerformance & Data Quality[2m > [22mshould validate data integrity of behavior logs
[90mstdout[2m | src/modules/ai/persona-analysis.service.spec.ts[2m > [22m[2mPersonaAnalysisService (via AnalyticsService)[2m > [22m[2mPerformance & Data Quality[2m > [22m[2mshould validate data integrity of behavior logs
[22m[39mðŸ§¹ Cleaning up after test...

[90mstdout[2m | src/modules/ai/persona-analysis.service.spec.ts
[22m[39mðŸ”§ Vitest setup: Starting MSW mock server...
âœ… Vitest teardown complete

 [31mÃ—[39m src/modules/nudge/personalization.service.spec.ts[2m > [22mNudgeEngineService - Personalization[2m > [22mPersona-Based Nudging[2m > [22mHUNTER Persona (Risk-Taker)[2m > [22mshould deliver SOCIAL_PROOF nudge emphasizing competition
[31m   â†’ jest is not defined[39m
[31m   â†’ jest is not defined[39m
 [31mÃ—[39m src/modules/nudge/personalization.service.spec.ts[2m > [22mNudgeEngineService - Personalization[2m > [22mPersona-Based Nudging[2m > [22mHUNTER Persona (Risk-Taker)[2m > [22mshould maintain high engagement for HUNTER persona
[31m   â†’ jest is not defined[39m
[31m   â†’ jest is not defined[39m
 [31mÃ—[39m src/modules/nudge/personalization.service.spec.ts[2m > [22mNudgeEngineService - Personalization[2m > [22mPersona-Based Nudging[2m > [22mHUNTER Persona (Risk-Taker)[2m > [22mshould use competitive language for HUNTER
[31m   â†’ jest is not defined[39m
[31m   â†’ jest is not defined[39m
 [31mÃ—[39m src/modules/nudge/personalization.service.spec.ts[2m > [22mNudgeEngineService - Personalization[2m > [22mPersona-Based Nudging[2m > [22mSAVER Persona (Conservative)[2m > [22mshould deliver LOSS_AVERSION nudge for high-risk scenarios
[31m   â†’ jest is not defined[39m
[31m   â†’ jest is not defined[39m
 [31mÃ—[39m src/modules/nudge/personalization.service.spec.ts[2m > [22mNudgeEngineService - Personalization[2m > [22mPersona-Based Nudging[2m > [22mSAVER Persona (Conservative)[2m > [22mshould prioritize GOAL_GRADIENT for budgeting context
[31m   â†’ jest is not defined[39m
[31m   â†’ jest is not defined[39m
 [31mÃ—[39m src/modules/nudge/personalization.service.spec.ts[2m > [22mNudgeEngineService - Personalization[2m > [22mPersona-Based Nudging[2m > [22mSAVER Persona (Conservative)[2m > [22mshould emphasize security and caution for SAVER
[31m   â†’ jest is not defined[39m
[31m   â†’ jest is not defined[39m
 [31mÃ—[39m src/modules/nudge/personalization.service.spec.ts[2m > [22mNudgeEngineService - Personalization[2m > [22mPersona-Based Nudging[2m > [22mSAVER Persona (Conservative)[2m > [22mshould calculate progress correctly for SAVER budgeting
[31m   â†’ jest is not defined[39m
[31m   â†’ jest is not defined[39m
 [31mÃ—[39m src/modules/nudge/personalization.service.spec.ts[2m > [22mNudgeEngineService - Personalization[2m > [22mPersona-Based Nudging[2m > [22mOBSERVER Persona (Passive)[2m > [22mshould deliver default SOCIAL_PROOF nudge
[31m   â†’ jest is not defined[39m
[31m   â†’ jest is not defined[39m
 [31mÃ—[39m src/modules/nudge/personalization.service.spec.ts[2m > [22mNudgeEngineService - Personalization[2m > [22mPersona-Based Nudging[2m > [22mOBSERVER Persona (Passive)[2m > [22mshould use neutral language for OBSERVER
[31m   â†’ jest is not defined[39m
[31m   â†’ jest is not defined[39m
 [31mÃ—[39m src/modules/nudge/personalization.service.spec.ts[2m > [22mNudgeEngineService - Personalization[2m > [22mPersona-Based Nudging[2m > [22mOBSERVER Persona (Passive)[2m > [22mshould provide informative mapping for OBSERVER budgeting
[31m   â†’ jest is not defined[39m
[31m   â†’ jest is not defined[39m
 [31mÃ—[39m src/modules/nudge/personalization.service.spec.ts[2m > [22mNudgeEngineService - Personalization[2m > [22mBehavior-Adaptive Messaging[2m > [22mshould adapt message based on risk level threshold
[31m   â†’ jest is not defined[39m
[31m   â†’ jest is not defined[39m
 [31mÃ—[39m src/modules/nudge/personalization.service.spec.ts[2m > [22mNudgeEngineService - Personalization[2m > [22mBehavior-Adaptive Messaging[2m > [22mshould calculate real-world value mapping correctly
[31m   â†’ jest is not defined[39m
[31m   â†’ jest is not defined[39m
 [31mÃ—[39m src/modules/nudge/personalization.service.spec.ts[2m > [22mNudgeEngineService - Personalization[2m > [22mBehavior-Adaptive Messaging[2m > [22mshould override persona logic when risk is critically high
[31m   â†’ jest is not defined[39m
[31m   â†’ jest is not defined[39m
 [31mÃ—[39m src/modules/nudge/personalization.service.spec.ts[2m > [22mNudgeEngineService - Personalization[2m > [22mBehavior-Adaptive Messaging[2m > [22mshould maintain persona preference when risk is moderate
[31m   â†’ jest is not defined[39m
[31m   â†’ jest is not defined[39m
 [31mÃ—[39m src/modules/nudge/personalization.service.spec.ts[2m > [22mNudgeEngineService - Personalization[2m > [22mContext-Specific Triggers[2m > [22mshould handle INVESTMENT_DECISION context
[31m   â†’ jest is not defined[39m
[31m   â†’ jest is not defined[39m
 [31mÃ—[39m src/modules/nudge/personalization.service.spec.ts[2m > [22mNudgeEngineService - Personalization[2m > [22mContext-Specific Triggers[2m > [22mshould handle BUDGETING context
[31m   â†’ jest is not defined[39m
[31m   â†’ jest is not defined[39m
 [31mÃ—[39m src/modules/nudge/personalization.service.spec.ts[2m > [22mNudgeEngineService - Personalization[2m > [22mContext-Specific Triggers[2m > [22mshould handle STREAK_WARNING context
[31m   â†’ jest is not defined[39m
[31m   â†’ jest is not defined[39m
 [31mÃ—[39m src/modules/nudge/personalization.service.spec.ts[2m > [22mNudgeEngineService - Personalization[2m > [22mContext-Specific Triggers[2m > [22mshould handle SOCIAL_PROOF_REALTIME context
[31m   â†’ jest is not defined[39m
[31m   â†’ jest is not defined[39m
 [31mÃ—[39m src/modules/nudge/personalization.service.spec.ts[2m > [22mNudgeEngineService - Personalization[2m > [22mContext-Specific Triggers[2m > [22mshould return null for unknown context
[31m   â†’ jest is not defined[39m
[31m   â†’ jest is not defined[39m
 [31mÃ—[39m src/modules/nudge/personalization.service.spec.ts[2m > [22mNudgeEngineService - Personalization[2m > [22mEngagement Optimization[2m > [22mshould prioritize HIGH for streak-critical situations
[31m   â†’ jest is not defined[39m
[31m   â†’ jest is not defined[39m
 [31mÃ—[39m src/modules/nudge/personalization.service.spec.ts[2m > [22mNudgeEngineService - Personalization[2m > [22mEngagement Optimization[2m > [22mshould prioritize HIGH for HUNTER investment decisions
[31m   â†’ jest is not defined[39m
[31m   â†’ jest is not defined[39m
 [31mÃ—[39m src/modules/nudge/personalization.service.spec.ts[2m > [22mNudgeEngineService - Personalization[2m > [22mEngagement Optimization[2m > [22mshould prioritize HIGH for SAVER loss aversion
[31m   â†’ jest is not defined[39m
[31m   â†’ jest is not defined[39m
 [31mÃ—[39m src/modules/nudge/personalization.service.spec.ts[2m > [22mNudgeEngineService - Personalization[2m > [22mEngagement Optimization[2m > [22mshould prioritize MEDIUM for default social proof
[31m   â†’ jest is not defined[39m
[31m   â†’ jest is not defined[39m
 [31mÃ—[39m src/modules/nudge/personalization.service.spec.ts[2m > [22mNudgeEngineService - Personalization[2m > [22mEngagement Optimization[2m > [22mshould prioritize LOW for OBSERVER budgeting nudges
[31m   â†’ jest is not defined[39m
[31m   â†’ jest is not defined[39m
 [31mÃ—[39m src/modules/nudge/personalization.service.spec.ts[2m > [22mNudgeEngineService - Personalization[2m > [22mRealtime Social Proof[2m > [22mshould fetch realtime social proof data
[31m   â†’ jest is not defined[39m
[31m   â†’ jest is not defined[39m
 [31mÃ—[39m src/modules/nudge/personalization.service.spec.ts[2m > [22mNudgeEngineService - Personalization[2m > [22mRealtime Social Proof[2m > [22mshould query behavior logs from last 24 hours
[31m   â†’ jest is not defined[39m
[31m   â†’ jest is not defined[39m
 [31mÃ—[39m src/modules/nudge/personalization.service.spec.ts[2m > [22mNudgeEngineService - Personalization[2m > [22mRealtime Social Proof[2m > [22mshould generate realtime social nudge when users are active
[31m   â†’ jest is not defined[39m
[31m   â†’ jest is not defined[39m
 [31mÃ—[39m src/modules/nudge/personalization.service.spec.ts[2m > [22mNudgeEngineService - Personalization[2m > [22mRealtime Social Proof[2m > [22mshould return null when no active users in last 24h
[31m   â†’ jest is not defined[39m
[31m   â†’ jest is not defined[39m
 [31mÃ—[39m src/modules/nudge/personalization.service.spec.ts[2m > [22mNudgeEngineService - Personalization[2m > [22mMulti-Language Support[2m > [22mshould provide Vietnamese translations
[31m   â†’ jest is not defined[39m
[31m   â†’ jest is not defined[39m
 [31mÃ—[39m src/modules/nudge/personalization.service.spec.ts[2m > [22mNudgeEngineService - Personalization[2m > [22mMulti-Language Support[2m > [22mshould provide English translations
[31m   â†’ jest is not defined[39m
[31m   â†’ jest is not defined[39m
 [31mÃ—[39m src/modules/nudge/personalization.service.spec.ts[2m > [22mNudgeEngineService - Personalization[2m > [22mMulti-Language Support[2m > [22mshould provide Chinese translations
[31m   â†’ jest is not defined[39m
[31m   â†’ jest is not defined[39m
 [31mÃ—[39m src/modules/nudge/personalization.service.spec.ts[2m > [22mNudgeEngineService - Personalization[2m > [22mEdge Cases[2m > [22mshould handle missing user gracefully
[31m   â†’ jest is not defined[39m
[31m   â†’ jest is not defined[39m
 [31mÃ—[39m src/modules/nudge/personalization.service.spec.ts[2m > [22mNudgeEngineService - Personalization[2m > [22mEdge Cases[2m > [22mshould handle zero amount in budgeting
[31m   â†’ jest is not defined[39m
[31m   â†’ jest is not defined[39m
 [31mÃ—[39m src/modules/nudge/personalization.service.spec.ts[2m > [22mNudgeEngineService - Personalization[2m > [22mEdge Cases[2m > [22mshould handle very large amounts in budgeting
[31m   â†’ jest is not defined[39m
[31m   â†’ jest is not defined[39m
 [31mÃ—[39m src/modules/nudge/personalization.service.spec.ts[2m > [22mNudgeEngineService - Personalization[2m > [22mEdge Cases[2m > [22mshould handle missing data object
[31m   â†’ jest is not defined[39m
[31m   â†’ jest is not defined[39m
 [31mÃ—[39m src/modules/nudge/personalization.service.spec.ts[2m > [22mNudgeEngineService - Personalization[2m > [22mEdge Cases[2m > [22mshould handle undefined risk level
[31m   â†’ jest is not defined[39m
[31m   â†’ jest is not defined[39m
 [31mÃ—[39m src/modules/nudge/personalization.service.spec.ts[2m > [22mNudgeEngineService - Personalization[2m > [22mIntegration Scenarios[2m > [22mshould deliver cohesive persona journey for HUNTER
[31m   â†’ jest is not defined[39m
[31m   â†’ jest is not defined[39m
 [31mÃ—[39m src/modules/nudge/personalization.service.spec.ts[2m > [22mNudgeEngineService - Personalization[2m > [22mIntegration Scenarios[2m > [22mshould deliver cohesive persona journey for SAVER
[31m   â†’ jest is not defined[39m
[31m   â†’ jest is not defined[39m
 [31mÃ—[39m src/modules/nudge/personalization.service.spec.ts[2m > [22mNudgeEngineService - Personalization[2m > [22mIntegration Scenarios[2m > [22mshould adapt dynamically to changing user behavior
[31m   â†’ jest is not defined[39m
[31m   â†’ jest is not defined[39m
[90mstdout[2m | src/modules/nudge/personalization.service.spec.ts
[22m[39mðŸ”§ Vitest setup: Starting MSW mock server...
âœ… Vitest teardown complete

[90mstdout[2m | src/modules/ai/ai-cache.service.spec.ts[2m > [22m[2mAiService - Cache Layer[2m > [22m[2mCache Hit/Miss Logic[2m > [22m[2mshould return cached response on cache hit for GENERAL_FAQ
[22m[39mðŸ§¹ Cleaning up after test...

[90mstdout[2m | src/modules/ai/ai-cache.service.spec.ts[2m > [22m[2mAiService - Cache Layer[2m > [22m[2mCache Hit/Miss Logic[2m > [22m[2mshould make AI call on cache miss for GENERAL_FAQ
[22m[39mðŸ§¹ Cleaning up after test...

[90mstdout[2m | src/modules/ai/ai-cache.service.spec.ts[2m > [22m[2mAiService - Cache Layer[2m > [22m[2mCache Hit/Miss Logic[2m > [22m[2mshould skip cache for PERSONALIZED_ADVICE queries
[22m[39mðŸ§¹ Cleaning up after test...

[90mstdout[2m | src/modules/ai/ai-cache.service.spec.ts[2m > [22m[2mAiService - Cache Layer[2m > [22m[2mCache Hit/Miss Logic[2m > [22m[2mshould generate consistent cache keys for identical prompts
[22m[39mðŸ§¹ Cleaning up after test...

[90mstdout[2m | src/modules/ai/ai-cache.service.spec.ts[2m > [22m[2mAiService - Cache Layer[2m > [22m[2mCache Hit/Miss Logic[2m > [22m[2mshould generate different cache keys for different prompts
[22m[39mðŸ§¹ Cleaning up after test...

[90mstdout[2m | src/modules/ai/ai-cache.service.spec.ts[2m > [22m[2mAiService - Cache Layer[2m > [22m[2mTTL Expiration[2m > [22m[2mshould set cache with 24-hour TTL for FAQ responses
[22m[39mðŸ§¹ Cleaning up after test...

[90mstdout[2m | src/modules/ai/ai-cache.service.spec.ts[2m > [22m[2mAiService - Cache Layer[2m > [22m[2mTTL Expiration[2m > [22m[2mshould handle expired cache gracefully (cache miss scenario)
[22m[39mðŸ§¹ Cleaning up after test...

[90mstdout[2m | src/modules/ai/ai-cache.service.spec.ts[2m > [22m[2mAiService - Cache Layer[2m > [22m[2mCache Invalidation[2m > [22m[2mshould allow manual cache deletion via cache manager
[22m[39mðŸ§¹ Cleaning up after test...

[90mstdout[2m | src/modules/ai/ai-cache.service.spec.ts[2m > [22m[2mAiService - Cache Layer[2m > [22m[2mCache Invalidation[2m > [22m[2mshould handle cache reset operation
[22m[39mðŸ§¹ Cleaning up after test...

[90mstdout[2m | src/modules/ai/ai-cache.service.spec.ts[2m > [22m[2mAiService - Cache Layer[2m > [22m[2mCache Invalidation[2m > [22m[2mshould re-cache response after invalidation
[22m[39mðŸ§¹ Cleaning up after test...

[90mstdout[2m | src/modules/ai/ai-cache.service.spec.ts[2m > [22m[2mAiService - Cache Layer[2m > [22m[2mMemory Usage & Rate Limiting[2m > [22m[2mshould enforce rate limit (20 requests per minute)
[22m[39mðŸ§¹ Cleaning up after test...

[90mstdout[2m | src/modules/ai/ai-cache.service.spec.ts[2m > [22m[2mAiService - Cache Layer[2m > [22m[2mMemory Usage & Rate Limiting[2m > [22m[2mshould allow requests under rate limit
[22m[39mðŸ§¹ Cleaning up after test...

[90mstdout[2m | src/modules/ai/ai-cache.service.spec.ts[2m > [22m[2mAiService - Cache Layer[2m > [22m[2mMemory Usage & Rate Limiting[2m > [22m[2mshould enforce monthly token budget (50,000 tokens)
[22m[39mðŸ§¹ Cleaning up after test...

[90mstdout[2m | src/modules/ai/ai-cache.service.spec.ts[2m > [22m[2mAiService - Cache Layer[2m > [22m[2mMemory Usage & Rate Limiting[2m > [22m[2mshould calculate token usage from behavior logs
[22m[39mðŸ§¹ Cleaning up after test...

[90mstdout[2m | src/modules/ai/ai-cache.service.spec.ts[2m > [22m[2mAiService - Cache Layer[2m > [22m[2mMemory Usage & Rate Limiting[2m > [22m[2mshould handle missing tokensUsed in payload gracefully
[22m[39mðŸ§¹ Cleaning up after test...

[90mstdout[2m | src/modules/ai/ai-cache.service.spec.ts[2m > [22m[2mAiService - Cache Layer[2m > [22m[2mIntent Classification (Cache Eligibility)[2m > [22m[2mshould classify FAQ queries correctly
[22m[39mðŸ§¹ Cleaning up after test...

[90mstdout[2m | src/modules/ai/ai-cache.service.spec.ts[2m > [22m[2mAiService - Cache Layer[2m > [22m[2mIntent Classification (Cache Eligibility)[2m > [22m[2mshould classify personalized queries correctly
[22m[39mðŸ§¹ Cleaning up after test...

[90mstdout[2m | src/modules/ai/ai-cache.service.spec.ts[2m > [22m[2mAiService - Cache Layer[2m > [22m[2mIntent Classification (Cache Eligibility)[2m > [22m[2mshould be case-insensitive for intent classification
[22m[39mðŸ§¹ Cleaning up after test...

[90mstdout[2m | src/modules/ai/ai-cache.service.spec.ts[2m > [22m[2mAiService - Cache Layer[2m > [22m[2mEdge Cases & Error Handling[2m > [22m[2mshould handle thread not found error
[22m[39mðŸ§¹ Cleaning up after test...

[90mstdout[2m | src/modules/ai/ai-cache.service.spec.ts[2m > [22m[2mAiService - Cache Layer[2m > [22m[2mEdge Cases & Error Handling[2m > [22m[2mshould save both user and assistant messages when cache hit occurs
[22m[39mðŸ§¹ Cleaning up after test...

[90mstdout[2m | src/modules/ai/ai-cache.service.spec.ts[2m > [22m[2mAiService - Cache Layer[2m > [22m[2mEdge Cases & Error Handling[2m > [22m[2mshould handle cache manager errors gracefully
[22m[39mðŸ§¹ Cleaning up after test...

 [31mÃ—[39m src/modules/ai/ai-cache.service.spec.ts[2m > [22mAiService - Cache Layer[2m > [22mCache Hit/Miss Logic[2m > [22mshould return cached response on cache hit for GENERAL_FAQ
[31m   â†’ this.prisma.$transaction is not a function[39m
 [31mÃ—[39m src/modules/ai/ai-cache.service.spec.ts[2m > [22mAiService - Cache Layer[2m > [22mCache Hit/Miss Logic[2m > [22mshould make AI call on cache miss for GENERAL_FAQ
[31m   â†’ this.prisma.$transaction is not a function[39m
 [31mÃ—[39m src/modules/ai/ai-cache.service.spec.ts[2m > [22mAiService - Cache Layer[2m > [22mCache Hit/Miss Logic[2m > [22mshould skip cache for PERSONALIZED_ADVICE queries
[31m   â†’ this.prisma.$transaction is not a function[39m
 [32mâœ“[39m src/modules/ai/ai-cache.service.spec.ts[2m > [22mAiService - Cache Layer[2m > [22mCache Hit/Miss Logic[2m > [22mshould generate consistent cache keys for identical prompts
 [32mâœ“[39m src/modules/ai/ai-cache.service.spec.ts[2m > [22mAiService - Cache Layer[2m > [22mCache Hit/Miss Logic[2m > [22mshould generate different cache keys for different prompts
 [31mÃ—[39m src/modules/ai/ai-cache.service.spec.ts[2m > [22mAiService - Cache Layer[2m > [22mTTL Expiration[2m > [22mshould set cache with 24-hour TTL for FAQ responses
[31m   â†’ this.prisma.$transaction is not a function[39m
 [31mÃ—[39m src/modules/ai/ai-cache.service.spec.ts[2m > [22mAiService - Cache Layer[2m > [22mTTL Expiration[2m > [22mshould handle expired cache gracefully (cache miss scenario)
[31m   â†’ this.prisma.$transaction is not a function[39m
 [32mâœ“[39m src/modules/ai/ai-cache.service.spec.ts[2m > [22mAiService - Cache Layer[2m > [22mCache Invalidation[2m > [22mshould allow manual cache deletion via cache manager
 [32mâœ“[39m src/modules/ai/ai-cache.service.spec.ts[2m > [22mAiService - Cache Layer[2m > [22mCache Invalidation[2m > [22mshould handle cache reset operation
 [31mÃ—[39m src/modules/ai/ai-cache.service.spec.ts[2m > [22mAiService - Cache Layer[2m > [22mCache Invalidation[2m > [22mshould re-cache response after invalidation
[31m   â†’ this.prisma.$transaction is not a function[39m
 [32mâœ“[39m src/modules/ai/ai-cache.service.spec.ts[2m > [22mAiService - Cache Layer[2m > [22mMemory Usage & Rate Limiting[2m > [22mshould enforce rate limit (20 requests per minute)
 [32mâœ“[39m src/modules/ai/ai-cache.service.spec.ts[2m > [22mAiService - Cache Layer[2m > [22mMemory Usage & Rate Limiting[2m > [22mshould allow requests under rate limit
 [32mâœ“[39m src/modules/ai/ai-cache.service.spec.ts[2m > [22mAiService - Cache Layer[2m > [22mMemory Usage & Rate Limiting[2m > [22mshould enforce monthly token budget (50,000 tokens)
 [32mâœ“[39m src/modules/ai/ai-cache.service.spec.ts[2m > [22mAiService - Cache Layer[2m > [22mMemory Usage & Rate Limiting[2m > [22mshould calculate token usage from behavior logs
 [32mâœ“[39m src/modules/ai/ai-cache.service.spec.ts[2m > [22mAiService - Cache Layer[2m > [22mMemory Usage & Rate Limiting[2m > [22mshould handle missing tokensUsed in payload gracefully
 [32mâœ“[39m src/modules/ai/ai-cache.service.spec.ts[2m > [22mAiService - Cache Layer[2m > [22mIntent Classification (Cache Eligibility)[2m > [22mshould classify FAQ queries correctly
 [32mâœ“[39m src/modules/ai/ai-cache.service.spec.ts[2m > [22mAiService - Cache Layer[2m > [22mIntent Classification (Cache Eligibility)[2m > [22mshould classify personalized queries correctly
 [32mâœ“[39m src/modules/ai/ai-cache.service.spec.ts[2m > [22mAiService - Cache Layer[2m > [22mIntent Classification (Cache Eligibility)[2m > [22mshould be case-insensitive for intent classification
 [32mâœ“[39m src/modules/ai/ai-cache.service.spec.ts[2m > [22mAiService - Cache Layer[2m > [22mEdge Cases & Error Handling[2m > [22mshould handle thread not found error
 [31mÃ—[39m src/modules/ai/ai-cache.service.spec.ts[2m > [22mAiService - Cache Layer[2m > [22mEdge Cases & Error Handling[2m > [22mshould save both user and assistant messages when cache hit occurs
[31m   â†’ this.prisma.$transaction is not a function[39m
 [32mâœ“[39m src/modules/ai/ai-cache.service.spec.ts[2m > [22mAiService - Cache Layer[2m > [22mEdge Cases & Error Handling[2m > [22mshould handle cache manager errors gracefully
 [31mÃ—[39m src/modules/ai/ai-cache.service.spec.ts[2m > [22mAiService - Cache Layer[2m > [22mEdge Cases & Error Handling[2m > [22mshould track token usage in behavior logs after AI call
[31m   â†’ this.prisma.$transaction is not a function[39m
[90mstdout[2m | src/modules/ai/ai-cache.service.spec.ts[2m > [22m[2mAiService - Cache Layer[2m > [22m[2mEdge Cases & Error Handling[2m > [22m[2mshould track token usage in behavior logs after AI call
[22m[39mðŸ§¹ Cleaning up after test...

[90mstdout[2m | src/modules/ai/ai-cache.service.spec.ts
[22m[39mðŸ”§ Vitest setup: Starting MSW mock server...
âœ… Vitest teardown complete

[90mstdout[2m | src/modules/nudge/nudge.integration.spec.ts[2m > [22m[2mNudge System Integration Tests[2m > [22m[2mEnd-to-End Nudge Flows[2m > [22m[2mshould complete full streak warning flow: trigger â†’ nudge â†’ log
[22m[39mðŸ§¹ Cleaning up after test...

[90mstdout[2m | src/modules/nudge/nudge.integration.spec.ts[2m > [22m[2mNudge System Integration Tests[2m > [22m[2mEnd-to-End Nudge Flows[2m > [22m[2mshould complete investment decision flow: request â†’ persona analysis â†’ nudge generation
[22m[39mðŸ§¹ Cleaning up after test...

[90mstdout[2m | src/modules/nudge/nudge.integration.spec.ts[2m > [22m[2mNudge System Integration Tests[2m > [22m[2mEnd-to-End Nudge Flows[2m > [22m[2mshould complete budgeting flow with SAVER persona: context â†’ persona â†’ mapping nudge
[22m[39mðŸ§¹ Cleaning up after test...

[90mstdout[2m | src/modules/nudge/nudge.integration.spec.ts[2m > [22m[2mNudge System Integration Tests[2m > [22m[2mEnd-to-End Nudge Flows[2m > [22m[2mshould complete social proof flow with realtime data aggregation
[22m[39mðŸ§¹ Cleaning up after test...

[90mstdout[2m | src/modules/nudge/nudge.integration.spec.ts[2m > [22m[2mNudge System Integration Tests[2m > [22m[2mTrigger â†’ Reward â†’ Notification Pipeline[2m > [22m[2mshould process points.earned event â†’ generate nudge â†’ log behavior
[22m[39mðŸ§¹ Cleaning up after test...

[90mstdout[2m | src/modules/nudge/nudge.integration.spec.ts[2m > [22m[2mNudge System Integration Tests[2m > [22m[2mTrigger â†’ Reward â†’ Notification Pipeline[2m > [22m[2mshould handle nudge.request event â†’ generate personalized nudge
[22m[39mðŸ§¹ Cleaning up after test...

[90mstdout[2m | src/modules/nudge/nudge.integration.spec.ts[2m > [22m[2mNudge System Integration Tests[2m > [22m[2mTrigger â†’ Reward â†’ Notification Pipeline[2m > [22m[2mshould handle points.deduct event â†’ call gamification service
[22m[39mðŸ§¹ Cleaning up after test...

[90mstdout[2m | src/modules/nudge/nudge.integration.spec.ts[2m > [22m[2mNudge System Integration Tests[2m > [22m[2mTrigger â†’ Reward â†’ Notification Pipeline[2m > [22m[2mshould handle failed point deduction gracefully
[22m[39mðŸ§¹ Cleaning up after test...

[90mstdout[2m | src/modules/nudge/nudge.integration.spec.ts[2m > [22m[2mNudge System Integration Tests[2m > [22m[2mCross-Service Integration[2m > [22m[2mshould integrate with Analytics service for persona-driven nudges
[22m[39mðŸ§¹ Cleaning up after test...

[90mstdout[2m | src/modules/nudge/nudge.integration.spec.ts[2m > [22m[2mNudge System Integration Tests[2m > [22m[2mCross-Service Integration[2m > [22m[2mshould integrate with Prisma for streak data retrieval and logging
[22m[39mðŸ§¹ Cleaning up after test...

[90mstdout[2m | src/modules/nudge/nudge.integration.spec.ts[2m > [22m[2mNudge System Integration Tests[2m > [22m[2mCross-Service Integration[2m > [22m[2mshould integrate with Gamification service for point adjustments
[22m[39mðŸ§¹ Cleaning up after test...

[90mstdout[2m | src/modules/nudge/nudge.integration.spec.ts[2m > [22m[2mNudge System Integration Tests[2m > [22m[2mMock Dependencies Validation[2m > [22m[2mshould mock PrismaService correctly
[22m[39mðŸ§¹ Cleaning up after test...

[90mstdout[2m | src/modules/nudge/nudge.integration.spec.ts[2m > [22m[2mNudge System Integration Tests[2m > [22m[2mMock Dependencies Validation[2m > [22m[2mshould mock AnalyticsService correctly
[22m[39mðŸ§¹ Cleaning up after test...

[90mstdout[2m | src/modules/nudge/nudge.integration.spec.ts[2m > [22m[2mNudge System Integration Tests[2m > [22m[2mMock Dependencies Validation[2m > [22m[2mshould mock GamificationService correctly
[22m[39mðŸ§¹ Cleaning up after test...

[90mstdout[2m | src/modules/nudge/nudge.integration.spec.ts[2m > [22m[2mNudge System Integration Tests[2m > [22m[2mError Handling and Edge Cases[2m > [22m[2mshould handle user not found in database
[22m[39mðŸ§¹ Cleaning up after test...

[90mstdout[2m | src/modules/nudge/nudge.integration.spec.ts[2m > [22m[2mNudge System Integration Tests[2m > [22m[2mError Handling and Edge Cases[2m > [22m[2mshould handle invalid nudge context gracefully
[22m[39mðŸ§¹ Cleaning up after test...

[90mstdout[2m | src/modules/nudge/nudge.integration.spec.ts[2m > [22m[2mNudge System Integration Tests[2m > [22m[2mError Handling and Edge Cases[2m > [22m[2mshould handle failed behavior logging without crashing
[22m[39mðŸ§¹ Cleaning up after test...

[90mstdout[2m | src/modules/nudge/nudge.integration.spec.ts[2m > [22m[2mNudge System Integration Tests[2m > [22m[2mError Handling and Edge Cases[2m > [22m[2mshould skip nudge generation if simulation flag is false
[22m[39mðŸ§¹ Cleaning up after test...

[90mstdout[2m | src/modules/nudge/nudge.integration.spec.ts[2m > [22m[2mNudge System Integration Tests[2m > [22m[2mError Handling and Edge Cases[2m > [22m[2mshould handle high-risk investment with SAVER persona
[22m[39mðŸ§¹ Cleaning up after test...

[90mstdout[2m | src/modules/nudge/nudge.integration.spec.ts[2m > [22m[2mNudge System Integration Tests[2m > [22m[2mError Handling and Edge Cases[2m > [22m[2mshould handle empty streak list without errors
[22m[39mðŸ§¹ Cleaning up after test...

[90mstdout[2m | src/modules/nudge/nudge.integration.spec.ts[2m > [22m[2mNudge System Integration Tests[2m > [22m[2mMulti-Language Support[2m > [22m[2mshould return nudges with all three language variants
[22m[39mðŸ§¹ Cleaning up after test...

[90mstdout[2m | src/modules/nudge/nudge.integration.spec.ts[2m > [22m[2mNudge System Integration Tests[2m > [22m[2mMulti-Language Support[2m > [22m[2mshould provide localized budgeting nudges
[22m[39mðŸ§¹ Cleaning up after test...

[90mstdout[2m | src/modules/nudge/nudge.integration.spec.ts[2m > [22m[2mNudge System Integration Tests[2m > [22m[2mBehavioral Psychology Tactics[2m > [22m[2mshould apply Social Proof tactic for HUNTER persona
[22m[39mðŸ§¹ Cleaning up after test...

[90mstdout[2m | src/modules/nudge/nudge.integration.spec.ts[2m > [22m[2mNudge System Integration Tests[2m > [22m[2mBehavioral Psychology Tactics[2m > [22m[2mshould apply Loss Aversion tactic for high-risk scenarios
[22m[39mðŸ§¹ Cleaning up after test...

[90mstdout[2m | src/modules/nudge/nudge.integration.spec.ts[2m > [22m[2mNudge System Integration Tests[2m > [22m[2mBehavioral Psychology Tactics[2m > [22m[2mshould apply Goal Gradient tactic for streak warnings
[22m[39mðŸ§¹ Cleaning up after test...

[90mstdout[2m | src/modules/nudge/nudge.integration.spec.ts[2m > [22m[2mNudge System Integration Tests[2m > [22m[2mBehavioral Psychology Tactics[2m > [22m[2mshould apply Salience tactic with mapping for budgeting
[22m[39mðŸ§¹ Cleaning up after test...

[90mstdout[2m | src/modules/nudge/nudge.integration.spec.ts[2m > [22m[2mNudge System Integration Tests[2m > [22m[2mRealtime Social Proof Integration[2m > [22m[2mshould aggregate activity counts for social proof nudge
[22m[39mðŸ§¹ Cleaning up after test...

 [32mâœ“[39m src/modules/nudge/nudge.integration.spec.ts[2m > [22mNudge System Integration Tests[2m > [22mEnd-to-End Nudge Flows[2m > [22mshould complete full streak warning flow: trigger â†’ nudge â†’ log
 [32mâœ“[39m src/modules/nudge/nudge.integration.spec.ts[2m > [22mNudge System Integration Tests[2m > [22mEnd-to-End Nudge Flows[2m > [22mshould complete investment decision flow: request â†’ persona analysis â†’ nudge generation
 [32mâœ“[39m src/modules/nudge/nudge.integration.spec.ts[2m > [22mNudge System Integration Tests[2m > [22mEnd-to-End Nudge Flows[2m > [22mshould complete budgeting flow with SAVER persona: context â†’ persona â†’ mapping nudge
 [32mâœ“[39m src/modules/nudge/nudge.integration.spec.ts[2m > [22mNudge System Integration Tests[2m > [22mEnd-to-End Nudge Flows[2m > [22mshould complete social proof flow with realtime data aggregation
 [32mâœ“[39m src/modules/nudge/nudge.integration.spec.ts[2m > [22mNudge System Integration Tests[2m > [22mTrigger â†’ Reward â†’ Notification Pipeline[2m > [22mshould process points.earned event â†’ generate nudge â†’ log behavior
 [32mâœ“[39m src/modules/nudge/nudge.integration.spec.ts[2m > [22mNudge System Integration Tests[2m > [22mTrigger â†’ Reward â†’ Notification Pipeline[2m > [22mshould handle nudge.request event â†’ generate personalized nudge
 [32mâœ“[39m src/modules/nudge/nudge.integration.spec.ts[2m > [22mNudge System Integration Tests[2m > [22mTrigger â†’ Reward â†’ Notification Pipeline[2m > [22mshould handle points.deduct event â†’ call gamification service
 [32mâœ“[39m src/modules/nudge/nudge.integration.spec.ts[2m > [22mNudge System Integration Tests[2m > [22mTrigger â†’ Reward â†’ Notification Pipeline[2m > [22mshould handle failed point deduction gracefully
 [32mâœ“[39m src/modules/nudge/nudge.integration.spec.ts[2m > [22mNudge System Integration Tests[2m > [22mCross-Service Integration[2m > [22mshould integrate with Analytics service for persona-driven nudges
 [32mâœ“[39m src/modules/nudge/nudge.integration.spec.ts[2m > [22mNudge System Integration Tests[2m > [22mCross-Service Integration[2m > [22mshould integrate with Prisma for streak data retrieval and logging
 [32mâœ“[39m src/modules/nudge/nudge.integration.spec.ts[2m > [22mNudge System Integration Tests[2m > [22mCross-Service Integration[2m > [22mshould integrate with Gamification service for point adjustments
 [32mâœ“[39m src/modules/nudge/nudge.integration.spec.ts[2m > [22mNudge System Integration Tests[2m > [22mMock Dependencies Validation[2m > [22mshould mock PrismaService correctly
 [32mâœ“[39m src/modules/nudge/nudge.integration.spec.ts[2m > [22mNudge System Integration Tests[2m > [22mMock Dependencies Validation[2m > [22mshould mock AnalyticsService correctly
 [32mâœ“[39m src/modules/nudge/nudge.integration.spec.ts[2m > [22mNudge System Integration Tests[2m > [22mMock Dependencies Validation[2m > [22mshould mock GamificationService correctly
 [32mâœ“[39m src/modules/nudge/nudge.integration.spec.ts[2m > [22mNudge System Integration Tests[2m > [22mError Handling and Edge Cases[2m > [22mshould handle user not found in database
 [32mâœ“[39m src/modules/nudge/nudge.integration.spec.ts[2m > [22mNudge System Integration Tests[2m > [22mError Handling and Edge Cases[2m > [22mshould handle invalid nudge context gracefully
 [32mâœ“[39m src/modules/nudge/nudge.integration.spec.ts[2m > [22mNudge System Integration Tests[2m > [22mError Handling and Edge Cases[2m > [22mshould handle failed behavior logging without crashing
 [32mâœ“[39m src/modules/nudge/nudge.integration.spec.ts[2m > [22mNudge System Integration Tests[2m > [22mError Handling and Edge Cases[2m > [22mshould skip nudge generation if simulation flag is false
 [32mâœ“[39m src/modules/nudge/nudge.integration.spec.ts[2m > [22mNudge System Integration Tests[2m > [22mError Handling and Edge Cases[2m > [22mshould handle high-risk investment with SAVER persona
 [32mâœ“[39m src/modules/nudge/nudge.integration.spec.ts[2m > [22mNudge System Integration Tests[2m > [22mError Handling and Edge Cases[2m > [22mshould handle empty streak list without errors
 [32mâœ“[39m src/modules/nudge/nudge.integration.spec.ts[2m > [22mNudge System Integration Tests[2m > [22mMulti-Language Support[2m > [22mshould return nudges with all three language variants
 [32mâœ“[39m src/modules/nudge/nudge.integration.spec.ts[2m > [22mNudge System Integration Tests[2m > [22mMulti-Language Support[2m > [22mshould provide localized budgeting nudges
 [32mâœ“[39m src/modules/nudge/nudge.integration.spec.ts[2m > [22mNudge System Integration Tests[2m > [22mBehavioral Psychology Tactics[2m > [22mshould apply Social Proof tactic for HUNTER persona
 [32mâœ“[39m src/modules/nudge/nudge.integration.spec.ts[2m > [22mNudge System Integration Tests[2m > [22mBehavioral Psychology Tactics[2m > [22mshould apply Loss Aversion tactic for high-risk scenarios
 [32mâœ“[39m src/modules/nudge/nudge.integration.spec.ts[2m > [22mNudge System Integration Tests[2m > [22mBehavioral Psychology Tactics[2m > [22mshould apply Goal Gradient tactic for streak warnings
 [32mâœ“[39m src/modules/nudge/nudge.integration.spec.ts[2m > [22mNudge System Integration Tests[2m > [22mBehavioral Psychology Tactics[2m > [22mshould apply Salience tactic with mapping for budgeting
 [32mâœ“[39m src/modules/nudge/nudge.integration.spec.ts[2m > [22mNudge System Integration Tests[2m > [22mRealtime Social Proof Integration[2m > [22mshould aggregate activity counts for social proof nudge
 [32mâœ“[39m src/modules/nudge/nudge.integration.spec.ts[2m > [22mNudge System Integration Tests[2m > [22mRealtime Social Proof Integration[2m > [22mshould return null if no active users found
[90mstdout[2m | src/modules/nudge/nudge.integration.spec.ts[2m > [22m[2mNudge System Integration Tests[2m > [22m[2mRealtime Social Proof Integration[2m > [22m[2mshould return null if no active users found
[22m[39mðŸ§¹ Cleaning up after test...

[90mstdout[2m | src/modules/nudge/nudge.integration.spec.ts
[22m[39mðŸ”§ Vitest setup: Starting MSW mock server...
âœ… Vitest teardown complete

[90mstdout[2m | src/modules/nudge/framing.service.spec.ts[2m > [22m[2mFramingService - Message Framing with Nudge Theory[2m > [22m[2mshould be defined
[22m[39mðŸ§¹ Cleaning up after test...

[90mstdout[2m | src/modules/nudge/framing.service.spec.ts[2m > [22m[2mFramingService - Message Framing with Nudge Theory[2m > [22m[2mGain vs Loss Framing[2m > [22m[2mshould generate GAIN-framed message with positive outcome emphasis
[22m[39mðŸ§¹ Cleaning up after test...

[90mstdout[2m | src/modules/nudge/framing.service.spec.ts[2m > [22m[2mFramingService - Message Framing with Nudge Theory[2m > [22m[2mGain vs Loss Framing[2m > [22m[2mshould generate LOSS-framed message with loss aversion emphasis
[22m[39mðŸ§¹ Cleaning up after test...

[90mstdout[2m | src/modules/nudge/framing.service.spec.ts[2m > [22m[2mFramingService - Message Framing with Nudge Theory[2m > [22m[2mGain vs Loss Framing[2m > [22m[2mshould use GAIN framing for opportunity contexts
[22m[39mðŸ§¹ Cleaning up after test...

[90mstdout[2m | src/modules/nudge/framing.service.spec.ts[2m > [22m[2mFramingService - Message Framing with Nudge Theory[2m > [22m[2mGain vs Loss Framing[2m > [22m[2mshould use LOSS framing for risk scenarios
[22m[39mðŸ§¹ Cleaning up after test...

[90mstdout[2m | src/modules/nudge/framing.service.spec.ts[2m > [22m[2mFramingService - Message Framing with Nudge Theory[2m > [22m[2mDefault Effect Logic[2m > [22m[2mshould default to LOSS framing for streak contexts
[22m[39mðŸ§¹ Cleaning up after test...

[90mstdout[2m | src/modules/nudge/framing.service.spec.ts[2m > [22m[2mFramingService - Message Framing with Nudge Theory[2m > [22m[2mDefault Effect Logic[2m > [22m[2mshould default to LOSS framing for risk contexts
[22m[39mðŸ§¹ Cleaning up after test...

[90mstdout[2m | src/modules/nudge/framing.service.spec.ts[2m > [22m[2mFramingService - Message Framing with Nudge Theory[2m > [22m[2mDefault Effect Logic[2m > [22m[2mshould default to GAIN framing for opportunity contexts
[22m[39mðŸ§¹ Cleaning up after test...

[90mstdout[2m | src/modules/nudge/framing.service.spec.ts[2m > [22m[2mFramingService - Message Framing with Nudge Theory[2m > [22m[2mDefault Effect Logic[2m > [22m[2mshould default to LOSS for SAVER persona (risk-averse)
[22m[39mðŸ§¹ Cleaning up after test...

[90mstdout[2m | src/modules/nudge/framing.service.spec.ts[2m > [22m[2mFramingService - Message Framing with Nudge Theory[2m > [22m[2mDefault Effect Logic[2m > [22m[2mshould default to GAIN for HUNTER persona in neutral contexts
[22m[39mðŸ§¹ Cleaning up after test...

[90mstdout[2m | src/modules/nudge/framing.service.spec.ts[2m > [22m[2mFramingService - Message Framing with Nudge Theory[2m > [22m[2mDefault Effect Logic[2m > [22m[2mshould apply DEFAULT framing and select based on context
[22m[39mðŸ§¹ Cleaning up after test...

[90mstdout[2m | src/modules/nudge/framing.service.spec.ts[2m > [22m[2mFramingService - Message Framing with Nudge Theory[2m > [22m[2mLocalization (vi/en/zh)[2m > [22m[2mshould generate Vietnamese framed message
[22m[39mðŸ§¹ Cleaning up after test...

[90mstdout[2m | src/modules/nudge/framing.service.spec.ts[2m > [22m[2mFramingService - Message Framing with Nudge Theory[2m > [22m[2mLocalization (vi/en/zh)[2m > [22m[2mshould generate English framed message
[22m[39mðŸ§¹ Cleaning up after test...

[90mstdout[2m | src/modules/nudge/framing.service.spec.ts[2m > [22m[2mFramingService - Message Framing with Nudge Theory[2m > [22m[2mLocalization (vi/en/zh)[2m > [22m[2mshould generate Chinese framed message
[22m[39mðŸ§¹ Cleaning up after test...

[90mstdout[2m | src/modules/nudge/framing.service.spec.ts[2m > [22m[2mFramingService - Message Framing with Nudge Theory[2m > [22m[2mLocalization (vi/en/zh)[2m > [22m[2mshould fallback to Vietnamese if locale is invalid
[22m[39mðŸ§¹ Cleaning up after test...

[90mstdout[2m | src/modules/nudge/framing.service.spec.ts[2m > [22m[2mFramingService - Message Framing with Nudge Theory[2m > [22m[2mLocalization (vi/en/zh)[2m > [22m[2mshould get all localized templates for a context
[22m[39mðŸ§¹ Cleaning up after test...

[90mstdout[2m | src/modules/nudge/framing.service.spec.ts[2m > [22m[2mFramingService - Message Framing with Nudge Theory[2m > [22m[2mLocalization (vi/en/zh)[2m > [22m[2mshould handle parameter interpolation in all locales
[22m[39mðŸ§¹ Cleaning up after test...

[90mstdout[2m | src/modules/nudge/framing.service.spec.ts[2m > [22m[2mFramingService - Message Framing with Nudge Theory[2m > [22m[2mMessage Template Mocking[2m > [22m[2mshould correctly interpolate amount parameter
[22m[39mðŸ§¹ Cleaning up after test...

[90mstdout[2m | src/modules/nudge/framing.service.spec.ts[2m > [22m[2mFramingService - Message Framing with Nudge Theory[2m > [22m[2mMessage Template Mocking[2m > [22m[2mshould correctly interpolate days parameter
[22m[39mðŸ§¹ Cleaning up after test...

[90mstdout[2m | src/modules/nudge/framing.service.spec.ts[2m > [22m[2mFramingService - Message Framing with Nudge Theory[2m > [22m[2mMessage Template Mocking[2m > [22m[2mshould correctly interpolate count parameter
[22m[39mðŸ§¹ Cleaning up after test...

[90mstdout[2m | src/modules/nudge/framing.service.spec.ts[2m > [22m[2mFramingService - Message Framing with Nudge Theory[2m > [22m[2mMessage Template Mocking[2m > [22m[2mshould handle multiple parameters in template
[22m[39mðŸ§¹ Cleaning up after test...

[90mstdout[2m | src/modules/nudge/framing.service.spec.ts[2m > [22m[2mFramingService - Message Framing with Nudge Theory[2m > [22m[2mA/B Testing Integration[2m > [22m[2mshould assign variant from A/B test when experimentId is provided
[22m[39mðŸ§¹ Cleaning up after test...

[90mstdout[2m | src/modules/nudge/framing.service.spec.ts[2m > [22m[2mFramingService - Message Framing with Nudge Theory[2m > [22m[2mA/B Testing Integration[2m > [22m[2mshould use original framing if no A/B test assignment
[22m[39mðŸ§¹ Cleaning up after test...

[90mstdout[2m | src/modules/nudge/framing.service.spec.ts[2m > [22m[2mFramingService - Message Framing with Nudge Theory[2m > [22m[2mA/B Testing Integration[2m > [22m[2mshould work without experimentId (no A/B testing)
[22m[39mðŸ§¹ Cleaning up after test...

[90mstdout[2m | src/modules/nudge/framing.service.spec.ts[2m > [22m[2mFramingService - Message Framing with Nudge Theory[2m > [22m[2mA/B Testing Integration[2m > [22m[2mshould track variant assignment for analytics
[22m[39mðŸ§¹ Cleaning up after test...

[90mstdout[2m | src/modules/nudge/framing.service.spec.ts[2m > [22m[2mFramingService - Message Framing with Nudge Theory[2m > [22m[2mA/B Testing Integration[2m > [22m[2mshould handle A/B test error gracefully
[22m[39mðŸ§¹ Cleaning up after test...

[90mstdout[2m | src/modules/nudge/framing.service.spec.ts[2m > [22m[2mFramingService - Message Framing with Nudge Theory[2m > [22m[2mEdge Cases & Error Handling[2m > [22m[2mshould handle missing parameters gracefully
[22m[39mðŸ§¹ Cleaning up after test...

[90mstdout[2m | src/modules/nudge/framing.service.spec.ts[2m > [22m[2mFramingService - Message Framing with Nudge Theory[2m > [22m[2mEdge Cases & Error Handling[2m > [22m[2mshould handle empty locale with fallback
[22m[39mðŸ§¹ Cleaning up after test...

[90mstdout[2m | src/modules/nudge/framing.service.spec.ts[2m > [22m[2mFramingService - Message Framing with Nudge Theory[2m > [22m[2mEdge Cases & Error Handling[2m > [22m[2mshould return valid message key when translation not found
[22m[39mðŸ§¹ Cleaning up after test...

[90mstdout[2m | src/modules/nudge/framing.service.spec.ts[2m > [22m[2mFramingService - Message Framing with Nudge Theory[2m > [22m[2mCoverage Edge Cases (85%+ Target)[2m > [22m[2mshould handle undefined userProfile in getDefaultFraming
[22m[39mðŸ§¹ Cleaning up after test...

[90mstdout[2m | src/modules/nudge/framing.service.spec.ts[2m > [22m[2mFramingService - Message Framing with Nudge Theory[2m > [22m[2mCoverage Edge Cases (85%+ Target)[2m > [22m[2mshould handle null params in generateFramedMessage
[22m[39mðŸ§¹ Cleaning up after test...

[90mstdout[2m | src/modules/nudge/framing.service.spec.ts[2m > [22m[2mFramingService - Message Framing with Nudge Theory[2m > [22m[2mCoverage Edge Cases (85%+ Target)[2m > [22m[2mshould correctly identify multiple loss context keywords
[22m[39mðŸ§¹ Cleaning up after test...

[90mstdout[2m | src/modules/nudge/framing.service.spec.ts[2m > [22m[2mFramingService - Message Framing with Nudge Theory[2m > [22m[2mCoverage Edge Cases (85%+ Target)[2m > [22m[2mshould generate consistent messages for same inputs
[22m[39mðŸ§¹ Cleaning up after test...

 [32mâœ“[39m src/modules/nudge/framing.service.spec.ts[2m > [22mFramingService - Message Framing with Nudge Theory[2m > [22mshould be defined
 [31mÃ—[39m src/modules/nudge/framing.service.spec.ts[2m > [22mFramingService - Message Framing with Nudge Theory[2m > [22mGain vs Loss Framing[2m > [22mshould generate GAIN-framed message with positive outcome emphasis
[31m   â†’ Cannot read properties of undefined (reading 'translate')[39m
 [31mÃ—[39m src/modules/nudge/framing.service.spec.ts[2m > [22mFramingService - Message Framing with Nudge Theory[2m > [22mGain vs Loss Framing[2m > [22mshould generate LOSS-framed message with loss aversion emphasis
[31m   â†’ Cannot read properties of undefined (reading 'translate')[39m
 [31mÃ—[39m src/modules/nudge/framing.service.spec.ts[2m > [22mFramingService - Message Framing with Nudge Theory[2m > [22mGain vs Loss Framing[2m > [22mshould use GAIN framing for opportunity contexts
[31m   â†’ Cannot read properties of undefined (reading 'translate')[39m
 [31mÃ—[39m src/modules/nudge/framing.service.spec.ts[2m > [22mFramingService - Message Framing with Nudge Theory[2m > [22mGain vs Loss Framing[2m > [22mshould use LOSS framing for risk scenarios
[31m   â†’ Cannot read properties of undefined (reading 'translate')[39m
 [32mâœ“[39m src/modules/nudge/framing.service.spec.ts[2m > [22mFramingService - Message Framing with Nudge Theory[2m > [22mDefault Effect Logic[2m > [22mshould default to LOSS framing for streak contexts
 [32mâœ“[39m src/modules/nudge/framing.service.spec.ts[2m > [22mFramingService - Message Framing with Nudge Theory[2m > [22mDefault Effect Logic[2m > [22mshould default to LOSS framing for risk contexts
 [32mâœ“[39m src/modules/nudge/framing.service.spec.ts[2m > [22mFramingService - Message Framing with Nudge Theory[2m > [22mDefault Effect Logic[2m > [22mshould default to GAIN framing for opportunity contexts
 [32mâœ“[39m src/modules/nudge/framing.service.spec.ts[2m > [22mFramingService - Message Framing with Nudge Theory[2m > [22mDefault Effect Logic[2m > [22mshould default to LOSS for SAVER persona (risk-averse)
 [32mâœ“[39m src/modules/nudge/framing.service.spec.ts[2m > [22mFramingService - Message Framing with Nudge Theory[2m > [22mDefault Effect Logic[2m > [22mshould default to GAIN for HUNTER persona in neutral contexts
 [31mÃ—[39m src/modules/nudge/framing.service.spec.ts[2m > [22mFramingService - Message Framing with Nudge Theory[2m > [22mDefault Effect Logic[2m > [22mshould apply DEFAULT framing and select based on context
[31m   â†’ Cannot read properties of undefined (reading 'translate')[39m
 [31mÃ—[39m src/modules/nudge/framing.service.spec.ts[2m > [22mFramingService - Message Framing with Nudge Theory[2m > [22mLocalization (vi/en/zh)[2m > [22mshould generate Vietnamese framed message
[31m   â†’ Cannot read properties of undefined (reading 'translate')[39m
 [31mÃ—[39m src/modules/nudge/framing.service.spec.ts[2m > [22mFramingService - Message Framing with Nudge Theory[2m > [22mLocalization (vi/en/zh)[2m > [22mshould generate English framed message
[31m   â†’ Cannot read properties of undefined (reading 'translate')[39m
 [31mÃ—[39m src/modules/nudge/framing.service.spec.ts[2m > [22mFramingService - Message Framing with Nudge Theory[2m > [22mLocalization (vi/en/zh)[2m > [22mshould generate Chinese framed message
[31m   â†’ Cannot read properties of undefined (reading 'translate')[39m
 [31mÃ—[39m src/modules/nudge/framing.service.spec.ts[2m > [22mFramingService - Message Framing with Nudge Theory[2m > [22mLocalization (vi/en/zh)[2m > [22mshould fallback to Vietnamese if locale is invalid
[31m   â†’ Cannot read properties of undefined (reading 'translate')[39m
 [31mÃ—[39m src/modules/nudge/framing.service.spec.ts[2m > [22mFramingService - Message Framing with Nudge Theory[2m > [22mLocalization (vi/en/zh)[2m > [22mshould get all localized templates for a context
[31m   â†’ Cannot read properties of undefined (reading 'translate')[39m
 [31mÃ—[39m src/modules/nudge/framing.service.spec.ts[2m > [22mFramingService - Message Framing with Nudge Theory[2m > [22mLocalization (vi/en/zh)[2m > [22mshould handle parameter interpolation in all locales
[31m   â†’ Cannot read properties of undefined (reading 'translate')[39m
 [31mÃ—[39m src/modules/nudge/framing.service.spec.ts[2m > [22mFramingService - Message Framing with Nudge Theory[2m > [22mMessage Template Mocking[2m > [22mshould correctly interpolate amount parameter
[31m   â†’ Cannot read properties of undefined (reading 'translate')[39m
 [31mÃ—[39m src/modules/nudge/framing.service.spec.ts[2m > [22mFramingService - Message Framing with Nudge Theory[2m > [22mMessage Template Mocking[2m > [22mshould correctly interpolate days parameter
[31m   â†’ Cannot read properties of undefined (reading 'translate')[39m
 [31mÃ—[39m src/modules/nudge/framing.service.spec.ts[2m > [22mFramingService - Message Framing with Nudge Theory[2m > [22mMessage Template Mocking[2m > [22mshould correctly interpolate count parameter
[31m   â†’ Cannot read properties of undefined (reading 'translate')[39m
 [31mÃ—[39m src/modules/nudge/framing.service.spec.ts[2m > [22mFramingService - Message Framing with Nudge Theory[2m > [22mMessage Template Mocking[2m > [22mshould handle multiple parameters in template
[31m   â†’ Cannot read properties of undefined (reading 'translate')[39m
 [31mÃ—[39m src/modules/nudge/framing.service.spec.ts[2m > [22mFramingService - Message Framing with Nudge Theory[2m > [22mA/B Testing Integration[2m > [22mshould assign variant from A/B test when experimentId is provided
[31m   â†’ Cannot read properties of undefined (reading 'assignVariant')[39m
 [31mÃ—[39m src/modules/nudge/framing.service.spec.ts[2m > [22mFramingService - Message Framing with Nudge Theory[2m > [22mA/B Testing Integration[2m > [22mshould use original framing if no A/B test assignment
[31m   â†’ Cannot read properties of undefined (reading 'assignVariant')[39m
 [31mÃ—[39m src/modules/nudge/framing.service.spec.ts[2m > [22mFramingService - Message Framing with Nudge Theory[2m > [22mA/B Testing Integration[2m > [22mshould work without experimentId (no A/B testing)
[31m   â†’ Cannot read properties of undefined (reading 'translate')[39m
 [31mÃ—[39m src/modules/nudge/framing.service.spec.ts[2m > [22mFramingService - Message Framing with Nudge Theory[2m > [22mA/B Testing Integration[2m > [22mshould track variant assignment for analytics
[31m   â†’ Cannot read properties of undefined (reading 'assignVariant')[39m
 [31mÃ—[39m src/modules/nudge/framing.service.spec.ts[2m > [22mFramingService - Message Framing with Nudge Theory[2m > [22mA/B Testing Integration[2m > [22mshould handle A/B test error gracefully
[31m   â†’ expected [Function] to throw error including 'DB connection lost' but got 'Cannot read properties of undefined (â€¦'[39m
 [31mÃ—[39m src/modules/nudge/framing.service.spec.ts[2m > [22mFramingService - Message Framing with Nudge Theory[2m > [22mEdge Cases & Error Handling[2m > [22mshould handle missing parameters gracefully
[31m   â†’ Cannot read properties of undefined (reading 'translate')[39m
 [31mÃ—[39m src/modules/nudge/framing.service.spec.ts[2m > [22mFramingService - Message Framing with Nudge Theory[2m > [22mEdge Cases & Error Handling[2m > [22mshould handle empty locale with fallback
[31m   â†’ Cannot read properties of undefined (reading 'translate')[39m
 [31mÃ—[39m src/modules/nudge/framing.service.spec.ts[2m > [22mFramingService - Message Framing with Nudge Theory[2m > [22mEdge Cases & Error Handling[2m > [22mshould return valid message key when translation not found
[31m   â†’ Cannot read properties of undefined (reading 'translate')[39m
 [32mâœ“[39m src/modules/nudge/framing.service.spec.ts[2m > [22mFramingService - Message Framing with Nudge Theory[2m > [22mCoverage Edge Cases (85%+ Target)[2m > [22mshould handle undefined userProfile in getDefaultFraming
 [31mÃ—[39m src/modules/nudge/framing.service.spec.ts[2m > [22mFramingService - Message Framing with Nudge Theory[2m > [22mCoverage Edge Cases (85%+ Target)[2m > [22mshould handle null params in generateFramedMessage
[31m   â†’ Cannot read properties of undefined (reading 'translate')[39m
 [32mâœ“[39m src/modules/nudge/framing.service.spec.ts[2m > [22mFramingService - Message Framing with Nudge Theory[2m > [22mCoverage Edge Cases (85%+ Target)[2m > [22mshould correctly identify multiple loss context keywords
 [31mÃ—[39m src/modules/nudge/framing.service.spec.ts[2m > [22mFramingService - Message Framing with Nudge Theory[2m > [22mCoverage Edge Cases (85%+ Target)[2m > [22mshould generate consistent messages for same inputs
[31m   â†’ Cannot read properties of undefined (reading 'translate')[39m
 [31mÃ—[39m src/modules/nudge/framing.service.spec.ts[2m > [22mFramingService - Message Framing with Nudge Theory[2m > [22mCoverage Edge Cases (85%+ Target)[2m > [22mshould handle concurrent framing requests
[31m   â†’ Cannot read properties of undefined (reading 'translate')[39m
[90mstdout[2m | src/modules/nudge/framing.service.spec.ts[2m > [22m[2mFramingService - Message Framing with Nudge Theory[2m > [22m[2mCoverage Edge Cases (85%+ Target)[2m > [22m[2mshould handle concurrent framing requests
[22m[39mðŸ§¹ Cleaning up after test...

[90mstdout[2m | src/modules/nudge/framing.service.spec.ts
[22m[39mðŸ”§ Vitest setup: Starting MSW mock server...
âœ… Vitest teardown complete

[90mstdout[2m | src/modules/analytics/user-segmentation.service.spec.ts[2m > [22m[2mUserSegmentationService[2m > [22m[2mSegment Definition[2m > [22m[2mshould define a new segment with criteria
[22m[39mðŸ§¹ Cleaning up after test...

[90mstdout[2m | src/modules/analytics/user-segmentation.service.spec.ts[2m > [22m[2mUserSegmentationService[2m > [22m[2mSegment Definition[2m > [22m[2mshould define segment with behavior type criteria
[22m[39mðŸ§¹ Cleaning up after test...

[90mstdout[2m | src/modules/analytics/user-segmentation.service.spec.ts[2m > [22m[2mUserSegmentationService[2m > [22m[2mSegment Definition[2m > [22m[2mshould define segment with locale criteria
[22m[39mðŸ§¹ Cleaning up after test...

[90mstdout[2m | src/modules/analytics/user-segmentation.service.spec.ts[2m > [22m[2mUserSegmentationService[2m > [22m[2mDynamic Segment Updates[2m > [22m[2mshould update segment with matching users
[22m[39mðŸ§¹ Cleaning up after test...

[90mstdout[2m | src/modules/analytics/user-segmentation.service.spec.ts[2m > [22m[2mUserSegmentationService[2m > [22m[2mDynamic Segment Updates[2m > [22m[2mshould return null when updating non-existent segment
[22m[39mðŸ§¹ Cleaning up after test...

[90mstdout[2m | src/modules/analytics/user-segmentation.service.spec.ts[2m > [22m[2mUserSegmentationService[2m > [22m[2mDynamic Segment Updates[2m > [22m[2mshould filter users by age range
[22m[39mðŸ§¹ Cleaning up after test...

[90mstdout[2m | src/modules/analytics/user-segmentation.service.spec.ts[2m > [22m[2mUserSegmentationService[2m > [22m[2mDynamic Segment Updates[2m > [22m[2mshould filter users by completed lessons minimum
[22m[39mðŸ§¹ Cleaning up after test...

[90mstdout[2m | src/modules/analytics/user-segmentation.service.spec.ts[2m > [22m[2mUserSegmentationService[2m > [22m[2mDynamic Segment Updates[2m > [22m[2mshould filter by LOW engagement level
[22m[39mðŸ§¹ Cleaning up after test...

[90mstdout[2m | src/modules/analytics/user-segmentation.service.spec.ts[2m > [22m[2mUserSegmentationService[2m > [22m[2mDynamic Segment Updates[2m > [22m[2mshould filter by MEDIUM engagement level
[22m[39mðŸ§¹ Cleaning up after test...

[90mstdout[2m | src/modules/analytics/user-segmentation.service.spec.ts[2m > [22m[2mUserSegmentationService[2m > [22m[2mDynamic Segment Updates[2m > [22m[2mshould filter by HIGH engagement level
[22m[39mðŸ§¹ Cleaning up after test...

[90mstdout[2m | src/modules/analytics/user-segmentation.service.spec.ts[2m > [22m[2mUserSegmentationService[2m > [22m[2mDynamic Segment Updates[2m > [22m[2mshould filter by HUNTER behavior type
[22m[39mðŸ§¹ Cleaning up after test...

[90mstdout[2m | src/modules/analytics/user-segmentation.service.spec.ts[2m > [22m[2mUserSegmentationService[2m > [22m[2mDynamic Segment Updates[2m > [22m[2mshould filter by SAVER behavior type
[22m[39mðŸ§¹ Cleaning up after test...

[90mstdout[2m | src/modules/analytics/user-segmentation.service.spec.ts[2m > [22m[2mUserSegmentationService[2m > [22m[2mDynamic Segment Updates[2m > [22m[2mshould filter by OBSERVER behavior type
[22m[39mðŸ§¹ Cleaning up after test...

[90mstdout[2m | src/modules/analytics/user-segmentation.service.spec.ts[2m > [22m[2mUserSegmentationService[2m > [22m[2mDynamic Segment Updates[2m > [22m[2mshould filter by locale criteria
[22m[39mðŸ§¹ Cleaning up after test...

[90mstdout[2m | src/modules/analytics/user-segmentation.service.spec.ts[2m > [22m[2mUserSegmentationService[2m > [22m[2mSegment Targeting[2m > [22m[2mshould target segment with message
[22m[39mðŸ§¹ Cleaning up after test...

[90mstdout[2m | src/modules/analytics/user-segmentation.service.spec.ts[2m > [22m[2mUserSegmentationService[2m > [22m[2mSegment Targeting[2m > [22m[2mshould return false when targeting non-existent segment
[22m[39mðŸ§¹ Cleaning up after test...

[90mstdout[2m | src/modules/analytics/user-segmentation.service.spec.ts[2m > [22m[2mUserSegmentationService[2m > [22m[2mSegment Targeting[2m > [22m[2mshould return false when targeting empty segment
[22m[39mðŸ§¹ Cleaning up after test...

[90mstdout[2m | src/modules/analytics/user-segmentation.service.spec.ts[2m > [22m[2mUserSegmentationService[2m > [22m[2mUser Demographics[2m > [22m[2mshould return user demographics with all fields
[22m[39mðŸ§¹ Cleaning up after test...

[90mstdout[2m | src/modules/analytics/user-segmentation.service.spec.ts[2m > [22m[2mUserSegmentationService[2m > [22m[2mUser Demographics[2m > [22m[2mshould classify user as SAVER based on behavior
[22m[39mðŸ§¹ Cleaning up after test...

[90mstdout[2m | src/modules/analytics/user-segmentation.service.spec.ts[2m > [22m[2mUserSegmentationService[2m > [22m[2mUser Demographics[2m > [22m[2mshould classify user as OBSERVER when no strong behavior
[22m[39mðŸ§¹ Cleaning up after test...

[90mstdout[2m | src/modules/analytics/user-segmentation.service.spec.ts[2m > [22m[2mUserSegmentationService[2m > [22m[2mUser Demographics[2m > [22m[2mshould return null when user not found
[22m[39mðŸ§¹ Cleaning up after test...

[90mstdout[2m | src/modules/analytics/user-segmentation.service.spec.ts[2m > [22m[2mUserSegmentationService[2m > [22m[2mUser Demographics[2m > [22m[2mshould return null when user has no date of birth
[22m[39mðŸ§¹ Cleaning up after test...

[90mstdout[2m | src/modules/analytics/user-segmentation.service.spec.ts[2m > [22m[2mUserSegmentationService[2m > [22m[2mUser Demographics[2m > [22m[2mshould default to "vi" locale when user has no preferred language
[22m[39mðŸ§¹ Cleaning up after test...

[90mstdout[2m | src/modules/analytics/user-segmentation.service.spec.ts[2m > [22m[2mUserSegmentationService[2m > [22m[2mSegment Retrieval & Management[2m > [22m[2mshould retrieve segment by ID
[22m[39mðŸ§¹ Cleaning up after test...

[90mstdout[2m | src/modules/analytics/user-segmentation.service.spec.ts[2m > [22m[2mUserSegmentationService[2m > [22m[2mSegment Retrieval & Management[2m > [22m[2mshould return null for non-existent segment
[22m[39mðŸ§¹ Cleaning up after test...

[90mstdout[2m | src/modules/analytics/user-segmentation.service.spec.ts[2m > [22m[2mUserSegmentationService[2m > [22m[2mSegment Retrieval & Management[2m > [22m[2mshould get all segments
[22m[39mðŸ§¹ Cleaning up after test...

[90mstdout[2m | src/modules/analytics/user-segmentation.service.spec.ts[2m > [22m[2mUserSegmentationService[2m > [22m[2mSegment Retrieval & Management[2m > [22m[2mshould delete segment successfully
[22m[39mðŸ§¹ Cleaning up after test...

[90mstdout[2m | src/modules/analytics/user-segmentation.service.spec.ts[2m > [22m[2mUserSegmentationService[2m > [22m[2mSegment Retrieval & Management[2m > [22m[2mshould return false when deleting non-existent segment
[22m[39mðŸ§¹ Cleaning up after test...

[90mstdout[2m | src/modules/analytics/user-segmentation.service.spec.ts[2m > [22m[2mUserSegmentationService[2m > [22m[2mComplex Multi-Criteria Filtering[2m > [22m[2mshould apply multiple criteria filters together
[22m[39mðŸ§¹ Cleaning up after test...

[90mstdout[2m | src/modules/analytics/user-segmentation.service.spec.ts[2m > [22m[2mUserSegmentationService[2m > [22m[2mComplex Multi-Criteria Filtering[2m > [22m[2mshould handle empty result when no users match all criteria
[22m[39mðŸ§¹ Cleaning up after test...

[90mstdout[2m | src/modules/analytics/user-segmentation.service.spec.ts[2m > [22m[2mUserSegmentationService[2m > [22m[2mAge Calculation Edge Cases[2m > [22m[2mshould calculate age correctly for birthday today
[22m[39mðŸ§¹ Cleaning up after test...

[90mstdout[2m | src/modules/analytics/user-segmentation.service.spec.ts[2m > [22m[2mUserSegmentationService[2m > [22m[2mAge Calculation Edge Cases[2m > [22m[2mshould calculate age correctly for birthday tomorrow
[22m[39mðŸ§¹ Cleaning up after test...

[90mstdout[2m | src/modules/analytics/user-segmentation.service.spec.ts
[22m[39mðŸ”§ Vitest setup: Starting MSW mock server...
âœ… Vitest teardown complete

 [32mâœ“[39m src/modules/analytics/user-segmentation.service.spec.ts[2m > [22mUserSegmentationService[2m > [22mSegment Definition[2m > [22mshould define a new segment with criteria
 [32mâœ“[39m src/modules/analytics/user-segmentation.service.spec.ts[2m > [22mUserSegmentationService[2m > [22mSegment Definition[2m > [22mshould define segment with behavior type criteria
 [32mâœ“[39m src/modules/analytics/user-segmentation.service.spec.ts[2m > [22mUserSegmentationService[2m > [22mSegment Definition[2m > [22mshould define segment with locale criteria
 [32mâœ“[39m src/modules/analytics/user-segmentation.service.spec.ts[2m > [22mUserSegmentationService[2m > [22mDynamic Segment Updates[2m > [22mshould update segment with matching users
 [32mâœ“[39m src/modules/analytics/user-segmentation.service.spec.ts[2m > [22mUserSegmentationService[2m > [22mDynamic Segment Updates[2m > [22mshould return null when updating non-existent segment
 [32mâœ“[39m src/modules/analytics/user-segmentation.service.spec.ts[2m > [22mUserSegmentationService[2m > [22mDynamic Segment Updates[2m > [22mshould filter users by age range
 [32mâœ“[39m src/modules/analytics/user-segmentation.service.spec.ts[2m > [22mUserSegmentationService[2m > [22mDynamic Segment Updates[2m > [22mshould filter users by completed lessons minimum
 [32mâœ“[39m src/modules/analytics/user-segmentation.service.spec.ts[2m > [22mUserSegmentationService[2m > [22mDynamic Segment Updates[2m > [22mshould filter by LOW engagement level
 [32mâœ“[39m src/modules/analytics/user-segmentation.service.spec.ts[2m > [22mUserSegmentationService[2m > [22mDynamic Segment Updates[2m > [22mshould filter by MEDIUM engagement level
 [32mâœ“[39m src/modules/analytics/user-segmentation.service.spec.ts[2m > [22mUserSegmentationService[2m > [22mDynamic Segment Updates[2m > [22mshould filter by HIGH engagement level
 [32mâœ“[39m src/modules/analytics/user-segmentation.service.spec.ts[2m > [22mUserSegmentationService[2m > [22mDynamic Segment Updates[2m > [22mshould filter by HUNTER behavior type
 [32mâœ“[39m src/modules/analytics/user-segmentation.service.spec.ts[2m > [22mUserSegmentationService[2m > [22mDynamic Segment Updates[2m > [22mshould filter by SAVER behavior type
 [32mâœ“[39m src/modules/analytics/user-segmentation.service.spec.ts[2m > [22mUserSegmentationService[2m > [22mDynamic Segment Updates[2m > [22mshould filter by OBSERVER behavior type
 [32mâœ“[39m src/modules/analytics/user-segmentation.service.spec.ts[2m > [22mUserSegmentationService[2m > [22mDynamic Segment Updates[2m > [22mshould filter by locale criteria
 [32mâœ“[39m src/modules/analytics/user-segmentation.service.spec.ts[2m > [22mUserSegmentationService[2m > [22mSegment Targeting[2m > [22mshould target segment with message
 [32mâœ“[39m src/modules/analytics/user-segmentation.service.spec.ts[2m > [22mUserSegmentationService[2m > [22mSegment Targeting[2m > [22mshould return false when targeting non-existent segment
 [32mâœ“[39m src/modules/analytics/user-segmentation.service.spec.ts[2m > [22mUserSegmentationService[2m > [22mSegment Targeting[2m > [22mshould return false when targeting empty segment
 [32mâœ“[39m src/modules/analytics/user-segmentation.service.spec.ts[2m > [22mUserSegmentationService[2m > [22mUser Demographics[2m > [22mshould return user demographics with all fields
 [32mâœ“[39m src/modules/analytics/user-segmentation.service.spec.ts[2m > [22mUserSegmentationService[2m > [22mUser Demographics[2m > [22mshould classify user as SAVER based on behavior
 [32mâœ“[39m src/modules/analytics/user-segmentation.service.spec.ts[2m > [22mUserSegmentationService[2m > [22mUser Demographics[2m > [22mshould classify user as OBSERVER when no strong behavior
 [32mâœ“[39m src/modules/analytics/user-segmentation.service.spec.ts[2m > [22mUserSegmentationService[2m > [22mUser Demographics[2m > [22mshould return null when user not found
 [32mâœ“[39m src/modules/analytics/user-segmentation.service.spec.ts[2m > [22mUserSegmentationService[2m > [22mUser Demographics[2m > [22mshould return null when user has no date of birth
 [32mâœ“[39m src/modules/analytics/user-segmentation.service.spec.ts[2m > [22mUserSegmentationService[2m > [22mUser Demographics[2m > [22mshould default to "vi" locale when user has no preferred language
 [32mâœ“[39m src/modules/analytics/user-segmentation.service.spec.ts[2m > [22mUserSegmentationService[2m > [22mSegment Retrieval & Management[2m > [22mshould retrieve segment by ID
 [32mâœ“[39m src/modules/analytics/user-segmentation.service.spec.ts[2m > [22mUserSegmentationService[2m > [22mSegment Retrieval & Management[2m > [22mshould return null for non-existent segment
 [32mâœ“[39m src/modules/analytics/user-segmentation.service.spec.ts[2m > [22mUserSegmentationService[2m > [22mSegment Retrieval & Management[2m > [22mshould get all segments
 [32mâœ“[39m src/modules/analytics/user-segmentation.service.spec.ts[2m > [22mUserSegmentationService[2m > [22mSegment Retrieval & Management[2m > [22mshould delete segment successfully
 [32mâœ“[39m src/modules/analytics/user-segmentation.service.spec.ts[2m > [22mUserSegmentationService[2m > [22mSegment Retrieval & Management[2m > [22mshould return false when deleting non-existent segment
 [32mâœ“[39m src/modules/analytics/user-segmentation.service.spec.ts[2m > [22mUserSegmentationService[2m > [22mComplex Multi-Criteria Filtering[2m > [22mshould apply multiple criteria filters together
 [31mÃ—[39m src/modules/analytics/user-segmentation.service.spec.ts[2m > [22mUserSegmentationService[2m > [22mComplex Multi-Criteria Filtering[2m > [22mshould handle empty result when no users match all criteria
[31m   â†’ activityCounts is not iterable[39m
 [32mâœ“[39m src/modules/analytics/user-segmentation.service.spec.ts[2m > [22mUserSegmentationService[2m > [22mAge Calculation Edge Cases[2m > [22mshould calculate age correctly for birthday today
 [32mâœ“[39m src/modules/analytics/user-segmentation.service.spec.ts[2m > [22mUserSegmentationService[2m > [22mAge Calculation Edge Cases[2m > [22mshould calculate age correctly for birthday tomorrow
[90mstdout[2m | src/modules/analytics/heatmap.service.spec.ts[2m > [22m[2mHeatmapService[2m > [22m[2mtrackClickCoordinate[2m > [22m[2mshould track click coordinates with all parameters
[22m[39mðŸ§¹ Cleaning up after test...

[90mstdout[2m | src/modules/analytics/heatmap.service.spec.ts[2m > [22m[2mHeatmapService[2m > [22m[2mtrackClickCoordinate[2m > [22m[2mshould track click without elementId
[22m[39mðŸ§¹ Cleaning up after test...

[90mstdout[2m | src/modules/analytics/heatmap.service.spec.ts[2m > [22m[2mHeatmapService[2m > [22m[2mtrackClickCoordinate[2m > [22m[2mshould handle anonymous users
[22m[39mðŸ§¹ Cleaning up after test...

[90mstdout[2m | src/modules/analytics/heatmap.service.spec.ts[2m > [22m[2mHeatmapService[2m > [22m[2mtrackClickCoordinate[2m > [22m[2mshould track negative coordinates
[22m[39mðŸ§¹ Cleaning up after test...

[90mstdout[2m | src/modules/analytics/heatmap.service.spec.ts[2m > [22m[2mHeatmapService[2m > [22m[2mtrackScrollDepth[2m > [22m[2mshould track scroll depth with percentage calculation
[22m[39mðŸ§¹ Cleaning up after test...

[90mstdout[2m | src/modules/analytics/heatmap.service.spec.ts[2m > [22m[2mHeatmapService[2m > [22m[2mtrackScrollDepth[2m > [22m[2mshould handle 100% scroll depth
[22m[39mðŸ§¹ Cleaning up after test...

[90mstdout[2m | src/modules/analytics/heatmap.service.spec.ts[2m > [22m[2mHeatmapService[2m > [22m[2mtrackScrollDepth[2m > [22m[2mshould handle zero scroll depth
[22m[39mðŸ§¹ Cleaning up after test...

[90mstdout[2m | src/modules/analytics/heatmap.service.spec.ts[2m > [22m[2mHeatmapService[2m > [22m[2mgenerateHeatmap[2m > [22m[2mshould generate heatmap grid from click data
[22m[39mðŸ§¹ Cleaning up after test...

[90mstdout[2m | src/modules/analytics/heatmap.service.spec.ts[2m > [22m[2mHeatmapService[2m > [22m[2mgenerateHeatmap[2m > [22m[2mshould normalize intensity to 0-1 range
[22m[39mðŸ§¹ Cleaning up after test...

[90mstdout[2m | src/modules/analytics/heatmap.service.spec.ts[2m > [22m[2mHeatmapService[2m > [22m[2mgenerateHeatmap[2m > [22m[2mshould handle empty click data
[22m[39mðŸ§¹ Cleaning up after test...

[90mstdout[2m | src/modules/analytics/heatmap.service.spec.ts[2m > [22m[2mHeatmapService[2m > [22m[2mgenerateHeatmap[2m > [22m[2mshould skip invalid coordinates
[22m[39mðŸ§¹ Cleaning up after test...

[90mstdout[2m | src/modules/analytics/heatmap.service.spec.ts[2m > [22m[2mHeatmapService[2m > [22m[2mgenerateHeatmap[2m > [22m[2mshould use custom grid size
[22m[39mðŸ§¹ Cleaning up after test...

[90mstdout[2m | src/modules/analytics/heatmap.service.spec.ts[2m > [22m[2mHeatmapService[2m > [22m[2mgenerateHeatmap[2m > [22m[2mshould aggregate clicks in same grid cell
[22m[39mðŸ§¹ Cleaning up after test...

[90mstdout[2m | src/modules/analytics/heatmap.service.spec.ts[2m > [22m[2mHeatmapService[2m > [22m[2manalyzeScrollDepth[2m > [22m[2mshould calculate average and max scroll depth
[22m[39mðŸ§¹ Cleaning up after test...

[90mstdout[2m | src/modules/analytics/heatmap.service.spec.ts[2m > [22m[2mHeatmapService[2m > [22m[2manalyzeScrollDepth[2m > [22m[2mshould handle no scroll events
[22m[39mðŸ§¹ Cleaning up after test...

[90mstdout[2m | src/modules/analytics/heatmap.service.spec.ts[2m > [22m[2mHeatmapService[2m > [22m[2manalyzeScrollDepth[2m > [22m[2mshould skip events without scrollPercentage
[22m[39mðŸ§¹ Cleaning up after test...

[90mstdout[2m | src/modules/analytics/heatmap.service.spec.ts[2m > [22m[2mHeatmapService[2m > [22m[2manalyzeScrollDepth[2m > [22m[2mshould find maximum scroll depth correctly
[22m[39mðŸ§¹ Cleaning up after test...

[90mstdout[2m | src/modules/analytics/heatmap.service.spec.ts[2m > [22m[2mHeatmapService[2m > [22m[2mgetClickPatterns[2m > [22m[2mshould retrieve user click patterns
[22m[39mðŸ§¹ Cleaning up after test...

[90mstdout[2m | src/modules/analytics/heatmap.service.spec.ts[2m > [22m[2mHeatmapService[2m > [22m[2mgetClickPatterns[2m > [22m[2mshould filter out invalid coordinates
[22m[39mðŸ§¹ Cleaning up after test...

[90mstdout[2m | src/modules/analytics/heatmap.service.spec.ts[2m > [22m[2mHeatmapService[2m > [22m[2mgetClickPatterns[2m > [22m[2mshould respect limit parameter
[22m[39mðŸ§¹ Cleaning up after test...

[90mstdout[2m | src/modules/analytics/heatmap.service.spec.ts[2m > [22m[2mHeatmapService[2m > [22m[2mgetHotspots[2m > [22m[2mshould filter cells by intensity threshold
[22m[39mðŸ§¹ Cleaning up after test...

[90mstdout[2m | src/modules/analytics/heatmap.service.spec.ts[2m > [22m[2mHeatmapService[2m > [22m[2mgetHotspots[2m > [22m[2mshould return empty array if no hotspots meet threshold
[22m[39mðŸ§¹ Cleaning up after test...

[90mstdout[2m | src/modules/analytics/heatmap.service.spec.ts[2m > [22m[2mHeatmapService[2m > [22m[2mgetHotspots[2m > [22m[2mshould use default threshold of 0.7
[22m[39mðŸ§¹ Cleaning up after test...

[90mstdout[2m | src/modules/analytics/heatmap.service.spec.ts[2m > [22m[2mHeatmapService[2m > [22m[2manalyzeUserEngagement[2m > [22m[2mshould calculate comprehensive engagement metrics
[22m[39mðŸ§¹ Cleaning up after test...

[90mstdout[2m | src/modules/analytics/heatmap.service.spec.ts[2m > [22m[2mHeatmapService[2m > [22m[2manalyzeUserEngagement[2m > [22m[2mshould handle user with no activity
[22m[39mðŸ§¹ Cleaning up after test...

[90mstdout[2m | src/modules/analytics/heatmap.service.spec.ts[2m > [22m[2mHeatmapService[2m > [22m[2manalyzeUserEngagement[2m > [22m[2mshould limit most visited pages to top 5
[22m[39mðŸ§¹ Cleaning up after test...

[90mstdout[2m | src/modules/analytics/heatmap.service.spec.ts[2m > [22m[2mHeatmapService[2m > [22m[2manalyzeUserEngagement[2m > [22m[2mshould aggregate session durations correctly
[22m[39mðŸ§¹ Cleaning up after test...

 [32mâœ“[39m src/modules/analytics/heatmap.service.spec.ts[2m > [22mHeatmapService[2m > [22mtrackClickCoordinate[2m > [22mshould track click coordinates with all parameters
 [32mâœ“[39m src/modules/analytics/heatmap.service.spec.ts[2m > [22mHeatmapService[2m > [22mtrackClickCoordinate[2m > [22mshould track click without elementId
 [32mâœ“[39m src/modules/analytics/heatmap.service.spec.ts[2m > [22mHeatmapService[2m > [22mtrackClickCoordinate[2m > [22mshould handle anonymous users
 [32mâœ“[39m src/modules/analytics/heatmap.service.spec.ts[2m > [22mHeatmapService[2m > [22mtrackClickCoordinate[2m > [22mshould track negative coordinates
 [32mâœ“[39m src/modules/analytics/heatmap.service.spec.ts[2m > [22mHeatmapService[2m > [22mtrackScrollDepth[2m > [22mshould track scroll depth with percentage calculation
 [32mâœ“[39m src/modules/analytics/heatmap.service.spec.ts[2m > [22mHeatmapService[2m > [22mtrackScrollDepth[2m > [22mshould handle 100% scroll depth
 [32mâœ“[39m src/modules/analytics/heatmap.service.spec.ts[2m > [22mHeatmapService[2m > [22mtrackScrollDepth[2m > [22mshould handle zero scroll depth
 [32mâœ“[39m src/modules/analytics/heatmap.service.spec.ts[2m > [22mHeatmapService[2m > [22mgenerateHeatmap[2m > [22mshould generate heatmap grid from click data
 [32mâœ“[39m src/modules/analytics/heatmap.service.spec.ts[2m > [22mHeatmapService[2m > [22mgenerateHeatmap[2m > [22mshould normalize intensity to 0-1 range
 [32mâœ“[39m src/modules/analytics/heatmap.service.spec.ts[2m > [22mHeatmapService[2m > [22mgenerateHeatmap[2m > [22mshould handle empty click data
 [32mâœ“[39m src/modules/analytics/heatmap.service.spec.ts[2m > [22mHeatmapService[2m > [22mgenerateHeatmap[2m > [22mshould skip invalid coordinates
 [32mâœ“[39m src/modules/analytics/heatmap.service.spec.ts[2m > [22mHeatmapService[2m > [22mgenerateHeatmap[2m > [22mshould use custom grid size
 [32mâœ“[39m src/modules/analytics/heatmap.service.spec.ts[2m > [22mHeatmapService[2m > [22mgenerateHeatmap[2m > [22mshould aggregate clicks in same grid cell
 [32mâœ“[39m src/modules/analytics/heatmap.service.spec.ts[2m > [22mHeatmapService[2m > [22manalyzeScrollDepth[2m > [22mshould calculate average and max scroll depth
 [32mâœ“[39m src/modules/analytics/heatmap.service.spec.ts[2m > [22mHeatmapService[2m > [22manalyzeScrollDepth[2m > [22mshould handle no scroll events
 [31mÃ—[39m src/modules/analytics/heatmap.service.spec.ts[2m > [22mHeatmapService[2m > [22manalyzeScrollDepth[2m > [22mshould skip events without scrollPercentage
[31m   â†’ expected 32.5 to be 65 // Object.is equality[39m
 [32mâœ“[39m src/modules/analytics/heatmap.service.spec.ts[2m > [22mHeatmapService[2m > [22manalyzeScrollDepth[2m > [22mshould find maximum scroll depth correctly
 [32mâœ“[39m src/modules/analytics/heatmap.service.spec.ts[2m > [22mHeatmapService[2m > [22mgetClickPatterns[2m > [22mshould retrieve user click patterns
 [32mâœ“[39m src/modules/analytics/heatmap.service.spec.ts[2m > [22mHeatmapService[2m > [22mgetClickPatterns[2m > [22mshould filter out invalid coordinates
 [32mâœ“[39m src/modules/analytics/heatmap.service.spec.ts[2m > [22mHeatmapService[2m > [22mgetClickPatterns[2m > [22mshould respect limit parameter
 [32mâœ“[39m src/modules/analytics/heatmap.service.spec.ts[2m > [22mHeatmapService[2m > [22mgetHotspots[2m > [22mshould filter cells by intensity threshold
 [32mâœ“[39m src/modules/analytics/heatmap.service.spec.ts[2m > [22mHeatmapService[2m > [22mgetHotspots[2m > [22mshould return empty array if no hotspots meet threshold
 [32mâœ“[39m src/modules/analytics/heatmap.service.spec.ts[2m > [22mHeatmapService[2m > [22mgetHotspots[2m > [22mshould use default threshold of 0.7
 [31mÃ—[39m src/modules/analytics/heatmap.service.spec.ts[2m > [22mHeatmapService[2m > [22manalyzeUserEngagement[2m > [22mshould calculate comprehensive engagement metrics
[31m   â†’ expected { totalClicks: 50, â€¦(3) } to deeply equal { totalClicks: 50, â€¦(3) }[39m
 [32mâœ“[39m src/modules/analytics/heatmap.service.spec.ts[2m > [22mHeatmapService[2m > [22manalyzeUserEngagement[2m > [22mshould handle user with no activity
 [32mâœ“[39m src/modules/analytics/heatmap.service.spec.ts[2m > [22mHeatmapService[2m > [22manalyzeUserEngagement[2m > [22mshould limit most visited pages to top 5
 [32mâœ“[39m src/modules/analytics/heatmap.service.spec.ts[2m > [22mHeatmapService[2m > [22manalyzeUserEngagement[2m > [22mshould aggregate session durations correctly
 [32mâœ“[39m src/modules/analytics/heatmap.service.spec.ts[2m > [22mHeatmapService[2m > [22manalyzeUserEngagement[2m > [22mshould sort pages by visit count
[90mstdout[2m | src/modules/analytics/heatmap.service.spec.ts[2m > [22m[2mHeatmapService[2m > [22m[2manalyzeUserEngagement[2m > [22m[2mshould sort pages by visit count
[22m[39mðŸ§¹ Cleaning up after test...

[90mstdout[2m | src/modules/analytics/heatmap.service.spec.ts
[22m[39mðŸ”§ Vitest setup: Starting MSW mock server...
âœ… Vitest teardown complete

[90mstdout[2m | src/modules/nudge/loss-aversion.service.spec.ts[2m > [22m[2mLossAversionService (85%+ Coverage)[2m > [22m[2mgenerateStreakLossWarning[2m > [22m[2mshould return CRITICAL warning for high-value streak (>= 7 days) about to expire
[22m[39mðŸ§¹ Cleaning up after test...

[90mstdout[2m | src/modules/nudge/loss-aversion.service.spec.ts[2m > [22m[2mLossAversionService (85%+ Coverage)[2m > [22m[2mgenerateStreakLossWarning[2m > [22m[2mshould return HIGH priority for low-value streak (< 7 days) about to expire
[22m[39mðŸ§¹ Cleaning up after test...

[90mstdout[2m | src/modules/nudge/loss-aversion.service.spec.ts[2m > [22m[2mLossAversionService (85%+ Coverage)[2m > [22m[2mgenerateStreakLossWarning[2m > [22m[2mshould return null when streak is already expired (>24 hours)
[22m[39mðŸ§¹ Cleaning up after test...

[90mstdout[2m | src/modules/nudge/loss-aversion.service.spec.ts[2m > [22m[2mLossAversionService (85%+ Coverage)[2m > [22m[2mgenerateStreakLossWarning[2m > [22m[2mshould return null when activity is too recent (<20 hours)
[22m[39mðŸ§¹ Cleaning up after test...

[90mstdout[2m | src/modules/nudge/loss-aversion.service.spec.ts[2m > [22m[2mLossAversionService (85%+ Coverage)[2m > [22m[2mgenerateStreakLossWarning[2m > [22m[2mshould return null when user has no streak
[22m[39mðŸ§¹ Cleaning up after test...

[90mstdout[2m | src/modules/nudge/loss-aversion.service.spec.ts[2m > [22m[2mLossAversionService (85%+ Coverage)[2m > [22m[2mgenerateStreakLossWarning[2m > [22m[2mshould return null when streak data does not exist
[22m[39mðŸ§¹ Cleaning up after test...

[90mstdout[2m | src/modules/nudge/loss-aversion.service.spec.ts[2m > [22m[2mLossAversionService (85%+ Coverage)[2m > [22m[2mgenerateStreakLossWarning[2m > [22m[2mshould calculate hours remaining correctly at exact 20-hour mark
[22m[39mðŸ§¹ Cleaning up after test...

[90mstdout[2m | src/modules/nudge/loss-aversion.service.spec.ts[2m > [22m[2mLossAversionService (85%+ Coverage)[2m > [22m[2mgenerateAboutToLoseNudge[2m > [22m[2mshould generate CRITICAL nudge when progress is 90%+
[22m[39mðŸ§¹ Cleaning up after test...

[90mstdout[2m | src/modules/nudge/loss-aversion.service.spec.ts[2m > [22m[2mLossAversionService (85%+ Coverage)[2m > [22m[2mgenerateAboutToLoseNudge[2m > [22m[2mshould generate HIGH nudge when progress is 70-89%
[22m[39mðŸ§¹ Cleaning up after test...

[90mstdout[2m | src/modules/nudge/loss-aversion.service.spec.ts[2m > [22m[2mLossAversionService (85%+ Coverage)[2m > [22m[2mgenerateAboutToLoseNudge[2m > [22m[2mshould return null when progress is below 70%
[22m[39mðŸ§¹ Cleaning up after test...

[90mstdout[2m | src/modules/nudge/loss-aversion.service.spec.ts[2m > [22m[2mLossAversionService (85%+ Coverage)[2m > [22m[2mgenerateAboutToLoseNudge[2m > [22m[2mshould return null when progress is already 100%
[22m[39mðŸ§¹ Cleaning up after test...

[90mstdout[2m | src/modules/nudge/loss-aversion.service.spec.ts[2m > [22m[2mLossAversionService (85%+ Coverage)[2m > [22m[2mgenerateAboutToLoseNudge[2m > [22m[2mshould handle edge case at exactly 70% threshold
[22m[39mðŸ§¹ Cleaning up after test...

[90mstdout[2m | src/modules/nudge/loss-aversion.service.spec.ts[2m > [22m[2mLossAversionService (85%+ Coverage)[2m > [22m[2mgenerateAboutToLoseNudge[2m > [22m[2mshould handle multi-language goal names correctly
[22m[39mðŸ§¹ Cleaning up after test...

[90mstdout[2m | src/modules/nudge/loss-aversion.service.spec.ts[2m > [22m[2mLossAversionService (85%+ Coverage)[2m > [22m[2mgenerateCommitmentContract[2m > [22m[2mshould generate commitment contract with penalty warning
[22m[39mðŸ§¹ Cleaning up after test...

[90mstdout[2m | src/modules/nudge/loss-aversion.service.spec.ts[2m > [22m[2mLossAversionService (85%+ Coverage)[2m > [22m[2mgenerateCommitmentContract[2m > [22m[2mshould format large amounts correctly
[22m[39mðŸ§¹ Cleaning up after test...

[90mstdout[2m | src/modules/nudge/loss-aversion.service.spec.ts[2m > [22m[2mLossAversionService (85%+ Coverage)[2m > [22m[2mgenerateCommitmentContract[2m > [22m[2mshould return null when user does not exist
[22m[39mðŸ§¹ Cleaning up after test...

[90mstdout[2m | src/modules/nudge/loss-aversion.service.spec.ts[2m > [22m[2mLossAversionService (85%+ Coverage)[2m > [22m[2mgenerateCommitmentContract[2m > [22m[2mshould handle small amounts correctly
[22m[39mðŸ§¹ Cleaning up after test...

[90mstdout[2m | src/modules/nudge/loss-aversion.service.spec.ts[2m > [22m[2mLossAversionService (85%+ Coverage)[2m > [22m[2mgenerateCommitmentContract[2m > [22m[2mshould include all three language translations
[22m[39mðŸ§¹ Cleaning up after test...

[90mstdout[2m | src/modules/nudge/loss-aversion.service.spec.ts[2m > [22m[2mLossAversionService (85%+ Coverage)[2m > [22m[2mgenerateFramingNudge[2m > [22m[2mshould frame as LOSS with HIGH priority
[22m[39mðŸ§¹ Cleaning up after test...

[90mstdout[2m | src/modules/nudge/loss-aversion.service.spec.ts[2m > [22m[2mLossAversionService (85%+ Coverage)[2m > [22m[2mgenerateFramingNudge[2m > [22m[2mshould frame as GAIN with MEDIUM priority
[22m[39mðŸ§¹ Cleaning up after test...

[90mstdout[2m | src/modules/nudge/loss-aversion.service.spec.ts[2m > [22m[2mLossAversionService (85%+ Coverage)[2m > [22m[2mgenerateFramingNudge[2m > [22m[2mshould include inflation context in loss framing
[22m[39mðŸ§¹ Cleaning up after test...

[90mstdout[2m | src/modules/nudge/loss-aversion.service.spec.ts[2m > [22m[2mLossAversionService (85%+ Coverage)[2m > [22m[2mgenerateFramingNudge[2m > [22m[2mshould emphasize action in gain framing
[22m[39mðŸ§¹ Cleaning up after test...

[90mstdout[2m | src/modules/nudge/loss-aversion.service.spec.ts[2m > [22m[2mLossAversionService (85%+ Coverage)[2m > [22m[2mgenerateFramingNudge[2m > [22m[2mshould handle edge case with zero amount
[22m[39mðŸ§¹ Cleaning up after test...

[90mstdout[2m | src/modules/nudge/loss-aversion.service.spec.ts[2m > [22m[2mLossAversionService (85%+ Coverage)[2m > [22m[2mcheckMultipleUsers[2m > [22m[2mshould process multiple users and return nudges for each
[22m[39mðŸ§¹ Cleaning up after test...

[90mstdout[2m | src/modules/nudge/loss-aversion.service.spec.ts[2m > [22m[2mLossAversionService (85%+ Coverage)[2m > [22m[2mcheckMultipleUsers[2m > [22m[2mshould return empty arrays for users without warnings
[22m[39mðŸ§¹ Cleaning up after test...

[90mstdout[2m | src/modules/nudge/loss-aversion.service.spec.ts[2m > [22m[2mLossAversionService (85%+ Coverage)[2m > [22m[2mcheckMultipleUsers[2m > [22m[2mshould handle empty user list
[22m[39mðŸ§¹ Cleaning up after test...

[90mstdout[2m | src/modules/nudge/loss-aversion.service.spec.ts[2m > [22m[2mLossAversionService (85%+ Coverage)[2m > [22m[2mcheckMultipleUsers[2m > [22m[2mshould process users independently even if one fails
[22m[39mðŸ§¹ Cleaning up after test...

[90mstdout[2m | src/modules/nudge/loss-aversion.service.spec.ts[2m > [22m[2mLossAversionService (85%+ Coverage)[2m > [22m[2mEdge Cases & Robustness[2m > [22m[2mshould handle future dates gracefully in streak calculation
[22m[39mðŸ§¹ Cleaning up after test...

[90mstdout[2m | src/modules/nudge/loss-aversion.service.spec.ts[2m > [22m[2mLossAversionService (85%+ Coverage)[2m > [22m[2mEdge Cases & Robustness[2m > [22m[2mshould handle very large streak numbers
[22m[39mðŸ§¹ Cleaning up after test...

[90mstdout[2m | src/modules/nudge/loss-aversion.service.spec.ts[2m > [22m[2mLossAversionService (85%+ Coverage)[2m > [22m[2mEdge Cases & Robustness[2m > [22m[2mshould handle progress percentage edge cases
[22m[39mðŸ§¹ Cleaning up after test...

[90mstdout[2m | src/modules/nudge/loss-aversion.service.spec.ts[2m > [22m[2mLossAversionService (85%+ Coverage)[2m > [22m[2mEdge Cases & Robustness[2m > [22m[2mshould handle very small commitment amounts
[22m[39mðŸ§¹ Cleaning up after test...

[90mstdout[2m | src/modules/nudge/loss-aversion.service.spec.ts[2m > [22m[2mLossAversionService (85%+ Coverage)[2m > [22m[2mEdge Cases & Robustness[2m > [22m[2mshould handle very large commitment durations
[22m[39mðŸ§¹ Cleaning up after test...

[90mstdout[2m | src/modules/nudge/loss-aversion.service.spec.ts[2m > [22m[2mLossAversionService (85%+ Coverage)[2m > [22m[2mMessage Quality & Localization[2m > [22m[2mshould ensure all messages contain required emoji/icons
[22m[39mðŸ§¹ Cleaning up after test...

 [32mâœ“[39m src/modules/nudge/loss-aversion.service.spec.ts[2m > [22mLossAversionService (85%+ Coverage)[2m > [22mgenerateStreakLossWarning[2m > [22mshould return CRITICAL warning for high-value streak (>= 7 days) about to expire
 [32mâœ“[39m src/modules/nudge/loss-aversion.service.spec.ts[2m > [22mLossAversionService (85%+ Coverage)[2m > [22mgenerateStreakLossWarning[2m > [22mshould return HIGH priority for low-value streak (< 7 days) about to expire
 [32mâœ“[39m src/modules/nudge/loss-aversion.service.spec.ts[2m > [22mLossAversionService (85%+ Coverage)[2m > [22mgenerateStreakLossWarning[2m > [22mshould return null when streak is already expired (>24 hours)
 [32mâœ“[39m src/modules/nudge/loss-aversion.service.spec.ts[2m > [22mLossAversionService (85%+ Coverage)[2m > [22mgenerateStreakLossWarning[2m > [22mshould return null when activity is too recent (<20 hours)
 [32mâœ“[39m src/modules/nudge/loss-aversion.service.spec.ts[2m > [22mLossAversionService (85%+ Coverage)[2m > [22mgenerateStreakLossWarning[2m > [22mshould return null when user has no streak
 [32mâœ“[39m src/modules/nudge/loss-aversion.service.spec.ts[2m > [22mLossAversionService (85%+ Coverage)[2m > [22mgenerateStreakLossWarning[2m > [22mshould return null when streak data does not exist
 [32mâœ“[39m src/modules/nudge/loss-aversion.service.spec.ts[2m > [22mLossAversionService (85%+ Coverage)[2m > [22mgenerateStreakLossWarning[2m > [22mshould calculate hours remaining correctly at exact 20-hour mark
 [32mâœ“[39m src/modules/nudge/loss-aversion.service.spec.ts[2m > [22mLossAversionService (85%+ Coverage)[2m > [22mgenerateAboutToLoseNudge[2m > [22mshould generate CRITICAL nudge when progress is 90%+
 [32mâœ“[39m src/modules/nudge/loss-aversion.service.spec.ts[2m > [22mLossAversionService (85%+ Coverage)[2m > [22mgenerateAboutToLoseNudge[2m > [22mshould generate HIGH nudge when progress is 70-89%
 [32mâœ“[39m src/modules/nudge/loss-aversion.service.spec.ts[2m > [22mLossAversionService (85%+ Coverage)[2m > [22mgenerateAboutToLoseNudge[2m > [22mshould return null when progress is below 70%
 [32mâœ“[39m src/modules/nudge/loss-aversion.service.spec.ts[2m > [22mLossAversionService (85%+ Coverage)[2m > [22mgenerateAboutToLoseNudge[2m > [22mshould return null when progress is already 100%
 [32mâœ“[39m src/modules/nudge/loss-aversion.service.spec.ts[2m > [22mLossAversionService (85%+ Coverage)[2m > [22mgenerateAboutToLoseNudge[2m > [22mshould handle edge case at exactly 70% threshold
 [32mâœ“[39m src/modules/nudge/loss-aversion.service.spec.ts[2m > [22mLossAversionService (85%+ Coverage)[2m > [22mgenerateAboutToLoseNudge[2m > [22mshould handle multi-language goal names correctly
 [32mâœ“[39m src/modules/nudge/loss-aversion.service.spec.ts[2m > [22mLossAversionService (85%+ Coverage)[2m > [22mgenerateCommitmentContract[2m > [22mshould generate commitment contract with penalty warning
 [32mâœ“[39m src/modules/nudge/loss-aversion.service.spec.ts[2m > [22mLossAversionService (85%+ Coverage)[2m > [22mgenerateCommitmentContract[2m > [22mshould format large amounts correctly
 [32mâœ“[39m src/modules/nudge/loss-aversion.service.spec.ts[2m > [22mLossAversionService (85%+ Coverage)[2m > [22mgenerateCommitmentContract[2m > [22mshould return null when user does not exist
 [32mâœ“[39m src/modules/nudge/loss-aversion.service.spec.ts[2m > [22mLossAversionService (85%+ Coverage)[2m > [22mgenerateCommitmentContract[2m > [22mshould handle small amounts correctly
 [32mâœ“[39m src/modules/nudge/loss-aversion.service.spec.ts[2m > [22mLossAversionService (85%+ Coverage)[2m > [22mgenerateCommitmentContract[2m > [22mshould include all three language translations
 [32mâœ“[39m src/modules/nudge/loss-aversion.service.spec.ts[2m > [22mLossAversionService (85%+ Coverage)[2m > [22mgenerateFramingNudge[2m > [22mshould frame as LOSS with HIGH priority
 [32mâœ“[39m src/modules/nudge/loss-aversion.service.spec.ts[2m > [22mLossAversionService (85%+ Coverage)[2m > [22mgenerateFramingNudge[2m > [22mshould frame as GAIN with MEDIUM priority
 [32mâœ“[39m src/modules/nudge/loss-aversion.service.spec.ts[2m > [22mLossAversionService (85%+ Coverage)[2m > [22mgenerateFramingNudge[2m > [22mshould include inflation context in loss framing
 [32mâœ“[39m src/modules/nudge/loss-aversion.service.spec.ts[2m > [22mLossAversionService (85%+ Coverage)[2m > [22mgenerateFramingNudge[2m > [22mshould emphasize action in gain framing
 [32mâœ“[39m src/modules/nudge/loss-aversion.service.spec.ts[2m > [22mLossAversionService (85%+ Coverage)[2m > [22mgenerateFramingNudge[2m > [22mshould handle edge case with zero amount
 [32mâœ“[39m src/modules/nudge/loss-aversion.service.spec.ts[2m > [22mLossAversionService (85%+ Coverage)[2m > [22mcheckMultipleUsers[2m > [22mshould process multiple users and return nudges for each
 [32mâœ“[39m src/modules/nudge/loss-aversion.service.spec.ts[2m > [22mLossAversionService (85%+ Coverage)[2m > [22mcheckMultipleUsers[2m > [22mshould return empty arrays for users without warnings
 [32mâœ“[39m src/modules/nudge/loss-aversion.service.spec.ts[2m > [22mLossAversionService (85%+ Coverage)[2m > [22mcheckMultipleUsers[2m > [22mshould handle empty user list
 [32mâœ“[39m src/modules/nudge/loss-aversion.service.spec.ts[2m > [22mLossAversionService (85%+ Coverage)[2m > [22mcheckMultipleUsers[2m > [22mshould process users independently even if one fails
 [32mâœ“[39m src/modules/nudge/loss-aversion.service.spec.ts[2m > [22mLossAversionService (85%+ Coverage)[2m > [22mEdge Cases & Robustness[2m > [22mshould handle future dates gracefully in streak calculation
 [32mâœ“[39m src/modules/nudge/loss-aversion.service.spec.ts[2m > [22mLossAversionService (85%+ Coverage)[2m > [22mEdge Cases & Robustness[2m > [22mshould handle very large streak numbers
 [32mâœ“[39m src/modules/nudge/loss-aversion.service.spec.ts[2m > [22mLossAversionService (85%+ Coverage)[2m > [22mEdge Cases & Robustness[2m > [22mshould handle progress percentage edge cases
 [32mâœ“[39m src/modules/nudge/loss-aversion.service.spec.ts[2m > [22mLossAversionService (85%+ Coverage)[2m > [22mEdge Cases & Robustness[2m > [22mshould handle very small commitment amounts
 [32mâœ“[39m src/modules/nudge/loss-aversion.service.spec.ts[2m > [22mLossAversionService (85%+ Coverage)[2m > [22mEdge Cases & Robustness[2m > [22mshould handle very large commitment durations
 [32mâœ“[39m src/modules/nudge/loss-aversion.service.spec.ts[2m > [22mLossAversionService (85%+ Coverage)[2m > [22mMessage Quality & Localization[2m > [22mshould ensure all messages contain required emoji/icons
 [32mâœ“[39m src/modules/nudge/loss-aversion.service.spec.ts[2m > [22mLossAversionService (85%+ Coverage)[2m > [22mMessage Quality & Localization[2m > [22mshould ensure message consistency across all three languages
[90mstdout[2m | src/modules/nudge/loss-aversion.service.spec.ts[2m > [22m[2mLossAversionService (85%+ Coverage)[2m > [22m[2mMessage Quality & Localization[2m > [22m[2mshould ensure message consistency across all three languages
[22m[39mðŸ§¹ Cleaning up after test...

[90mstdout[2m | src/modules/nudge/loss-aversion.service.spec.ts
[22m[39mðŸ”§ Vitest setup: Starting MSW mock server...
âœ… Vitest teardown complete

[90mstdout[2m | src/modules/ai/adaptive-difficulty.service.spec.ts[2m > [22m[2mAdaptiveDifficultyService[2m > [22m[2mDifficulty Adjustment Algorithms[2m > [22m[2madjustLearningPath[2m > [22m[2mshould recommend LEVEL_UP for high score (>80)
[22m[39mðŸ§¹ Cleaning up after test...

[90mstdout[2m | src/modules/ai/adaptive-difficulty.service.spec.ts[2m > [22m[2mAdaptiveDifficultyService[2m > [22m[2mDifficulty Adjustment Algorithms[2m > [22m[2madjustLearningPath[2m > [22m[2mshould recommend REINFORCE for low score (<50)
[22m[39mðŸ§¹ Cleaning up after test...

[90mstdout[2m | src/modules/ai/adaptive-difficulty.service.spec.ts[2m > [22m[2mAdaptiveDifficultyService[2m > [22m[2mDifficulty Adjustment Algorithms[2m > [22m[2madjustLearningPath[2m > [22m[2mshould recommend STAY for medium score (50-80)
[22m[39mðŸ§¹ Cleaning up after test...

[90mstdout[2m | src/modules/ai/adaptive-difficulty.service.spec.ts[2m > [22m[2mAdaptiveDifficultyService[2m > [22m[2mDifficulty Adjustment Algorithms[2m > [22m[2madjustLearningPath[2m > [22m[2mshould handle edge case: score exactly 80
[22m[39mðŸ§¹ Cleaning up after test...

[90mstdout[2m | src/modules/ai/adaptive-difficulty.service.spec.ts[2m > [22m[2mAdaptiveDifficultyService[2m > [22m[2mDifficulty Adjustment Algorithms[2m > [22m[2madjustLearningPath[2m > [22m[2mshould handle edge case: score exactly 50
[22m[39mðŸ§¹ Cleaning up after test...

[90mstdout[2m | src/modules/ai/adaptive-difficulty.service.spec.ts[2m > [22m[2mAdaptiveDifficultyService[2m > [22m[2mDifficulty Adjustment Algorithms[2m > [22m[2madjustLearningPath[2m > [22m[2mshould handle missing score gracefully
[22m[39mðŸ§¹ Cleaning up after test...

[90mstdout[2m | src/modules/ai/adaptive-difficulty.service.spec.ts[2m > [22m[2mAdaptiveDifficultyService[2m > [22m[2mDifficulty Adjustment Algorithms[2m > [22m[2madjustLearningPath[2m > [22m[2mshould handle score of 0
[22m[39mðŸ§¹ Cleaning up after test...

[90mstdout[2m | src/modules/ai/adaptive-difficulty.service.spec.ts[2m > [22m[2mAdaptiveDifficultyService[2m > [22m[2mDifficulty Adjustment Algorithms[2m > [22m[2madjustLearningPath[2m > [22m[2mshould handle perfect score (100)
[22m[39mðŸ§¹ Cleaning up after test...

[90mstdout[2m | src/modules/ai/adaptive-difficulty.service.spec.ts[2m > [22m[2mAdaptiveDifficultyService[2m > [22m[2mUser Success Rate Tracking[2m > [22m[2mshould log behavior for performance tracking
[22m[39mðŸ§¹ Cleaning up after test...

[90mstdout[2m | src/modules/ai/adaptive-difficulty.service.spec.ts[2m > [22m[2mAdaptiveDifficultyService[2m > [22m[2mUser Success Rate Tracking[2m > [22m[2mshould track lesson completion metadata
[22m[39mðŸ§¹ Cleaning up after test...

[90mstdout[2m | src/modules/ai/adaptive-difficulty.service.spec.ts[2m > [22m[2mAdaptiveDifficultyService[2m > [22m[2mUser Success Rate Tracking[2m > [22m[2mshould maintain consistent session tracking
[22m[39mðŸ§¹ Cleaning up after test...

[90mstdout[2m | src/modules/ai/adaptive-difficulty.service.spec.ts[2m > [22m[2mAdaptiveDifficultyService[2m > [22m[2mFlow State Optimization[2m > [22m[2mshould optimize for Flow State with quick high-score completion
[22m[39mðŸ§¹ Cleaning up after test...

[90mstdout[2m | src/modules/ai/adaptive-difficulty.service.spec.ts[2m > [22m[2mAdaptiveDifficultyService[2m > [22m[2mFlow State Optimization[2m > [22m[2mshould detect struggle with long time + low score
[22m[39mðŸ§¹ Cleaning up after test...

[90mstdout[2m | src/modules/ai/adaptive-difficulty.service.spec.ts[2m > [22m[2mAdaptiveDifficultyService[2m > [22m[2mFlow State Optimization[2m > [22m[2mshould maintain engagement with moderate performance
[22m[39mðŸ§¹ Cleaning up after test...

[90mstdout[2m | src/modules/ai/adaptive-difficulty.service.spec.ts[2m > [22m[2mAdaptiveDifficultyService[2m > [22m[2mFlow State Optimization[2m > [22m[2mshould handle zero time spent edge case
[22m[39mðŸ§¹ Cleaning up after test...

[90mstdout[2m | src/modules/ai/adaptive-difficulty.service.spec.ts[2m > [22m[2mAdaptiveDifficultyService[2m > [22m[2mMock Performance Data Scenarios[2m > [22m[2mshould handle beginner user progression
[22m[39mðŸ§¹ Cleaning up after test...

[90mstdout[2m | src/modules/ai/adaptive-difficulty.service.spec.ts[2m > [22m[2mAdaptiveDifficultyService[2m > [22m[2mMock Performance Data Scenarios[2m > [22m[2mshould handle advanced user performance
[22m[39mðŸ§¹ Cleaning up after test...

[90mstdout[2m | src/modules/ai/adaptive-difficulty.service.spec.ts[2m > [22m[2mAdaptiveDifficultyService[2m > [22m[2mMock Performance Data Scenarios[2m > [22m[2mshould handle user without investment profile
[22m[39mðŸ§¹ Cleaning up after test...

[90mstdout[2m | src/modules/ai/adaptive-difficulty.service.spec.ts[2m > [22m[2mAdaptiveDifficultyService[2m > [22m[2mMock Performance Data Scenarios[2m > [22m[2mshould process multiple rapid adjustments
[22m[39mðŸ§¹ Cleaning up after test...

[90mstdout[2m | src/modules/ai/adaptive-difficulty.service.spec.ts[2m > [22m[2mAdaptiveDifficultyService[2m > [22m[2mEdge Cases and Error Handling[2m > [22m[2mshould handle negative score gracefully
[22m[39mðŸ§¹ Cleaning up after test...

[90mstdout[2m | src/modules/ai/adaptive-difficulty.service.spec.ts[2m > [22m[2mAdaptiveDifficultyService[2m > [22m[2mEdge Cases and Error Handling[2m > [22m[2mshould handle score over 100
[22m[39mðŸ§¹ Cleaning up after test...

[90mstdout[2m | src/modules/ai/adaptive-difficulty.service.spec.ts[2m > [22m[2mAdaptiveDifficultyService[2m > [22m[2mEdge Cases and Error Handling[2m > [22m[2mshould return correct response structure
[22m[39mðŸ§¹ Cleaning up after test...

[90mstdout[2m | src/modules/ai/adaptive-difficulty.service.spec.ts[2m > [22m[2mAdaptiveDifficultyService[2m > [22m[2mEdge Cases and Error Handling[2m > [22m[2mshould handle very large timeSpent values
[22m[39mðŸ§¹ Cleaning up after test...

[90mstdout[2m | src/modules/ai/adaptive-difficulty.service.spec.ts[2m > [22m[2mAdaptiveDifficultyService[2m > [22m[2mEdge Cases and Error Handling[2m > [22m[2mshould handle different user IDs correctly
[22m[39mðŸ§¹ Cleaning up after test...

[90mstdout[2m | src/modules/ai/adaptive-difficulty.service.spec.ts[2m > [22m[2mAdaptiveDifficultyService[2m > [22m[2mEdge Cases and Error Handling[2m > [22m[2mshould handle different lesson IDs correctly
[22m[39mðŸ§¹ Cleaning up after test...

[90mstdout[2m | src/modules/ai/adaptive-difficulty.service.spec.ts[2m > [22m[2mAdaptiveDifficultyService[2m > [22m[2mIntegration with User Profile[2m > [22m[2mshould fetch user with investment profile
[22m[39mðŸ§¹ Cleaning up after test...

[90mstdout[2m | src/modules/ai/adaptive-difficulty.service.spec.ts[2m > [22m[2mAdaptiveDifficultyService[2m > [22m[2mIntegration with User Profile[2m > [22m[2mshould work with users having different risk tolerances
[22m[39mðŸ§¹ Cleaning up after test...

[90mstdout[2m | src/modules/ai/adaptive-difficulty.service.spec.ts
[22m[39mðŸ”§ Vitest setup: Starting MSW mock server...
âœ… Vitest teardown complete

 [32mâœ“[39m src/modules/ai/adaptive-difficulty.service.spec.ts[2m > [22mAdaptiveDifficultyService[2m > [22mDifficulty Adjustment Algorithms[2m > [22madjustLearningPath[2m > [22mshould recommend LEVEL_UP for high score (>80)
 [32mâœ“[39m src/modules/ai/adaptive-difficulty.service.spec.ts[2m > [22mAdaptiveDifficultyService[2m > [22mDifficulty Adjustment Algorithms[2m > [22madjustLearningPath[2m > [22mshould recommend REINFORCE for low score (<50)
 [32mâœ“[39m src/modules/ai/adaptive-difficulty.service.spec.ts[2m > [22mAdaptiveDifficultyService[2m > [22mDifficulty Adjustment Algorithms[2m > [22madjustLearningPath[2m > [22mshould recommend STAY for medium score (50-80)
 [32mâœ“[39m src/modules/ai/adaptive-difficulty.service.spec.ts[2m > [22mAdaptiveDifficultyService[2m > [22mDifficulty Adjustment Algorithms[2m > [22madjustLearningPath[2m > [22mshould handle edge case: score exactly 80
 [32mâœ“[39m src/modules/ai/adaptive-difficulty.service.spec.ts[2m > [22mAdaptiveDifficultyService[2m > [22mDifficulty Adjustment Algorithms[2m > [22madjustLearningPath[2m > [22mshould handle edge case: score exactly 50
 [32mâœ“[39m src/modules/ai/adaptive-difficulty.service.spec.ts[2m > [22mAdaptiveDifficultyService[2m > [22mDifficulty Adjustment Algorithms[2m > [22madjustLearningPath[2m > [22mshould handle missing score gracefully
 [31mÃ—[39m src/modules/ai/adaptive-difficulty.service.spec.ts[2m > [22mAdaptiveDifficultyService[2m > [22mDifficulty Adjustment Algorithms[2m > [22madjustLearningPath[2m > [22mshould handle score of 0
[31m   â†’ expected 'STAY' to be 'REINFORCE' // Object.is equality[39m
 [32mâœ“[39m src/modules/ai/adaptive-difficulty.service.spec.ts[2m > [22mAdaptiveDifficultyService[2m > [22mDifficulty Adjustment Algorithms[2m > [22madjustLearningPath[2m > [22mshould handle perfect score (100)
 [32mâœ“[39m src/modules/ai/adaptive-difficulty.service.spec.ts[2m > [22mAdaptiveDifficultyService[2m > [22mUser Success Rate Tracking[2m > [22mshould log behavior for performance tracking
 [32mâœ“[39m src/modules/ai/adaptive-difficulty.service.spec.ts[2m > [22mAdaptiveDifficultyService[2m > [22mUser Success Rate Tracking[2m > [22mshould track lesson completion metadata
 [32mâœ“[39m src/modules/ai/adaptive-difficulty.service.spec.ts[2m > [22mAdaptiveDifficultyService[2m > [22mUser Success Rate Tracking[2m > [22mshould maintain consistent session tracking
 [32mâœ“[39m src/modules/ai/adaptive-difficulty.service.spec.ts[2m > [22mAdaptiveDifficultyService[2m > [22mFlow State Optimization[2m > [22mshould optimize for Flow State with quick high-score completion
 [32mâœ“[39m src/modules/ai/adaptive-difficulty.service.spec.ts[2m > [22mAdaptiveDifficultyService[2m > [22mFlow State Optimization[2m > [22mshould detect struggle with long time + low score
 [32mâœ“[39m src/modules/ai/adaptive-difficulty.service.spec.ts[2m > [22mAdaptiveDifficultyService[2m > [22mFlow State Optimization[2m > [22mshould maintain engagement with moderate performance
 [32mâœ“[39m src/modules/ai/adaptive-difficulty.service.spec.ts[2m > [22mAdaptiveDifficultyService[2m > [22mFlow State Optimization[2m > [22mshould handle zero time spent edge case
 [32mâœ“[39m src/modules/ai/adaptive-difficulty.service.spec.ts[2m > [22mAdaptiveDifficultyService[2m > [22mMock Performance Data Scenarios[2m > [22mshould handle beginner user progression
 [32mâœ“[39m src/modules/ai/adaptive-difficulty.service.spec.ts[2m > [22mAdaptiveDifficultyService[2m > [22mMock Performance Data Scenarios[2m > [22mshould handle advanced user performance
 [32mâœ“[39m src/modules/ai/adaptive-difficulty.service.spec.ts[2m > [22mAdaptiveDifficultyService[2m > [22mMock Performance Data Scenarios[2m > [22mshould handle user without investment profile
 [32mâœ“[39m src/modules/ai/adaptive-difficulty.service.spec.ts[2m > [22mAdaptiveDifficultyService[2m > [22mMock Performance Data Scenarios[2m > [22mshould process multiple rapid adjustments
 [32mâœ“[39m src/modules/ai/adaptive-difficulty.service.spec.ts[2m > [22mAdaptiveDifficultyService[2m > [22mEdge Cases and Error Handling[2m > [22mshould handle negative score gracefully
 [32mâœ“[39m src/modules/ai/adaptive-difficulty.service.spec.ts[2m > [22mAdaptiveDifficultyService[2m > [22mEdge Cases and Error Handling[2m > [22mshould handle score over 100
 [32mâœ“[39m src/modules/ai/adaptive-difficulty.service.spec.ts[2m > [22mAdaptiveDifficultyService[2m > [22mEdge Cases and Error Handling[2m > [22mshould return correct response structure
 [32mâœ“[39m src/modules/ai/adaptive-difficulty.service.spec.ts[2m > [22mAdaptiveDifficultyService[2m > [22mEdge Cases and Error Handling[2m > [22mshould handle very large timeSpent values
 [32mâœ“[39m src/modules/ai/adaptive-difficulty.service.spec.ts[2m > [22mAdaptiveDifficultyService[2m > [22mEdge Cases and Error Handling[2m > [22mshould handle different user IDs correctly
 [32mâœ“[39m src/modules/ai/adaptive-difficulty.service.spec.ts[2m > [22mAdaptiveDifficultyService[2m > [22mEdge Cases and Error Handling[2m > [22mshould handle different lesson IDs correctly
 [32mâœ“[39m src/modules/ai/adaptive-difficulty.service.spec.ts[2m > [22mAdaptiveDifficultyService[2m > [22mIntegration with User Profile[2m > [22mshould fetch user with investment profile
 [32mâœ“[39m src/modules/ai/adaptive-difficulty.service.spec.ts[2m > [22mAdaptiveDifficultyService[2m > [22mIntegration with User Profile[2m > [22mshould work with users having different risk tolerances
[90mstdout[2m | src/modules/analytics/analytics.controller.spec.ts[2m > [22m[2mAnalyticsController[2m > [22m[2mshould be defined
[22m[39mðŸ§¹ Cleaning up after test...

[90mstdout[2m | src/modules/analytics/analytics.controller.spec.ts[2m > [22m[2mAnalyticsController[2m > [22m[2mgetMyHabits[2m > [22m[2mshould return user learning habits
[22m[39mðŸ§¹ Cleaning up after test...

[90mstdout[2m | src/modules/analytics/analytics.controller.spec.ts[2m > [22m[2mAnalyticsController[2m > [22m[2mgetMyHabits[2m > [22m[2mshould return null if no habits found
[22m[39mðŸ§¹ Cleaning up after test...

[90mstdout[2m | src/modules/analytics/analytics.controller.spec.ts[2m > [22m[2mAnalyticsController[2m > [22m[2mgetMyHabits[2m > [22m[2mshould extract user id from request object
[22m[39mðŸ§¹ Cleaning up after test...

[90mstdout[2m | src/modules/analytics/analytics.controller.spec.ts[2m > [22m[2mAnalyticsController[2m > [22m[2mgetFutureSimulation[2m > [22m[2mshould return financial future simulation
[22m[39mðŸ§¹ Cleaning up after test...

[90mstdout[2m | src/modules/analytics/analytics.controller.spec.ts[2m > [22m[2mAnalyticsController[2m > [22m[2mgetFutureSimulation[2m > [22m[2mshould handle empty simulation results
[22m[39mðŸ§¹ Cleaning up after test...

[90mstdout[2m | src/modules/analytics/analytics.controller.spec.ts[2m > [22m[2mAnalyticsController[2m > [22m[2mgetFutureSimulation[2m > [22m[2mshould propagate service errors
[22m[39mðŸ§¹ Cleaning up after test...

[90mstdout[2m | src/modules/analytics/analytics.controller.spec.ts[2m > [22m[2mAnalyticsController[2m > [22m[2maskMentor[2m > [22m[2mshould return personalized advice with all parameters
[22m[39mðŸ§¹ Cleaning up after test...

[90mstdout[2m | src/modules/analytics/analytics.controller.spec.ts[2m > [22m[2mAnalyticsController[2m > [22m[2maskMentor[2m > [22m[2mshould use default values for missing module and lesson
[22m[39mðŸ§¹ Cleaning up after test...

[90mstdout[2m | src/modules/analytics/analytics.controller.spec.ts[2m > [22m[2mAnalyticsController[2m > [22m[2maskMentor[2m > [22m[2mshould default to "vi" locale if user has no preferredLocale
[22m[39mðŸ§¹ Cleaning up after test...

[90mstdout[2m | src/modules/analytics/analytics.controller.spec.ts[2m > [22m[2mAnalyticsController[2m > [22m[2maskMentor[2m > [22m[2mshould handle empty query string
[22m[39mðŸ§¹ Cleaning up after test...

[90mstdout[2m | src/modules/analytics/analytics.controller.spec.ts[2m > [22m[2mAnalyticsController[2m > [22m[2maskMentor[2m > [22m[2mshould support Chinese locale
[22m[39mðŸ§¹ Cleaning up after test...

[90mstdout[2m | src/modules/analytics/analytics.controller.spec.ts[2m > [22m[2mAnalyticsController[2m > [22m[2maskMentor[2m > [22m[2mshould propagate mentor service errors
[22m[39mðŸ§¹ Cleaning up after test...

[90mstdout[2m | src/modules/analytics/analytics.controller.spec.ts[2m > [22m[2mAnalyticsController[2m > [22m[2mgetSystemStats[2m > [22m[2mshould return global system statistics for admin
[22m[39mðŸ§¹ Cleaning up after test...

[90mstdout[2m | src/modules/analytics/analytics.controller.spec.ts[2m > [22m[2mAnalyticsController[2m > [22m[2mgetSystemStats[2m > [22m[2mshould handle empty stats gracefully
[22m[39mðŸ§¹ Cleaning up after test...

[90mstdout[2m | src/modules/analytics/analytics.controller.spec.ts[2m > [22m[2mAnalyticsController[2m > [22m[2mgetSystemStats[2m > [22m[2mshould propagate analytics service errors
[22m[39mðŸ§¹ Cleaning up after test...

[90mstdout[2m | src/modules/analytics/analytics.controller.spec.ts[2m > [22m[2mAnalyticsController[2m > [22m[2mGuards and Decorators[2m > [22m[2mshould have JwtAuthGuard on controller level
[22m[39mðŸ§¹ Cleaning up after test...

[90mstdout[2m | src/modules/analytics/analytics.controller.spec.ts[2m > [22m[2mAnalyticsController[2m > [22m[2mGuards and Decorators[2m > [22m[2mshould have RolesGuard and ADMIN role on getSystemStats
[22m[39mðŸ§¹ Cleaning up after test...

[90mstdout[2m | src/modules/analytics/analytics.controller.spec.ts[2m > [22m[2mAnalyticsController[2m > [22m[2mGuards and Decorators[2m > [22m[2mshould not have RolesGuard on regular user endpoints
[22m[39mðŸ§¹ Cleaning up after test...

[90mstdout[2m | src/modules/analytics/analytics.controller.spec.ts[2m > [22m[2mAnalyticsController[2m > [22m[2mError Handling[2m > [22m[2mshould handle malformed request objects in getMyHabits
[22m[39mðŸ§¹ Cleaning up after test...

[90mstdout[2m | src/modules/analytics/analytics.controller.spec.ts[2m > [22m[2mAnalyticsController[2m > [22m[2mError Handling[2m > [22m[2mshould handle service timeout errors
[22m[39mðŸ§¹ Cleaning up after test...

[90mstdout[2m | src/modules/analytics/analytics.controller.spec.ts[2m > [22m[2mAnalyticsController[2m > [22m[2mError Handling[2m > [22m[2mshould handle database connection errors in getSystemStats
[22m[39mðŸ§¹ Cleaning up after test...

[90mstdout[2m | src/modules/analytics/analytics.controller.spec.ts[2m > [22m[2mAnalyticsController[2m > [22m[2mRequest Parameter Validation[2m > [22m[2mshould accept valid mentor chat request
[22m[39mðŸ§¹ Cleaning up after test...

[90mstdout[2m | src/modules/analytics/analytics.controller.spec.ts[2m > [22m[2mAnalyticsController[2m > [22m[2mRequest Parameter Validation[2m > [22m[2mshould handle very long query strings
[22m[39mðŸ§¹ Cleaning up after test...

[90mstdout[2m | src/modules/analytics/analytics.controller.spec.ts[2m > [22m[2mAnalyticsController[2m > [22m[2mRequest Parameter Validation[2m > [22m[2mshould handle special characters in query
[22m[39mðŸ§¹ Cleaning up after test...

[90mstdout[2m | src/modules/analytics/analytics.controller.spec.ts[2m > [22m[2mAnalyticsController[2m > [22m[2mIntegration with Services[2m > [22m[2mshould correctly chain analytics service calls
[22m[39mðŸ§¹ Cleaning up after test...

[90mstdout[2m | src/modules/analytics/analytics.controller.spec.ts[2m > [22m[2mAnalyticsController[2m > [22m[2mIntegration with Services[2m > [22m[2mshould correctly chain predictive service calls
[22m[39mðŸ§¹ Cleaning up after test...

 [32mâœ“[39m src/modules/analytics/analytics.controller.spec.ts[2m > [22mAnalyticsController[2m > [22mshould be defined
 [32mâœ“[39m src/modules/analytics/analytics.controller.spec.ts[2m > [22mAnalyticsController[2m > [22mgetMyHabits[2m > [22mshould return user learning habits
 [32mâœ“[39m src/modules/analytics/analytics.controller.spec.ts[2m > [22mAnalyticsController[2m > [22mgetMyHabits[2m > [22mshould return null if no habits found
 [32mâœ“[39m src/modules/analytics/analytics.controller.spec.ts[2m > [22mAnalyticsController[2m > [22mgetMyHabits[2m > [22mshould extract user id from request object
 [32mâœ“[39m src/modules/analytics/analytics.controller.spec.ts[2m > [22mAnalyticsController[2m > [22mgetFutureSimulation[2m > [22mshould return financial future simulation
 [32mâœ“[39m src/modules/analytics/analytics.controller.spec.ts[2m > [22mAnalyticsController[2m > [22mgetFutureSimulation[2m > [22mshould handle empty simulation results
 [32mâœ“[39m src/modules/analytics/analytics.controller.spec.ts[2m > [22mAnalyticsController[2m > [22mgetFutureSimulation[2m > [22mshould propagate service errors
 [32mâœ“[39m src/modules/analytics/analytics.controller.spec.ts[2m > [22mAnalyticsController[2m > [22maskMentor[2m > [22mshould return personalized advice with all parameters
 [32mâœ“[39m src/modules/analytics/analytics.controller.spec.ts[2m > [22mAnalyticsController[2m > [22maskMentor[2m > [22mshould use default values for missing module and lesson
 [32mâœ“[39m src/modules/analytics/analytics.controller.spec.ts[2m > [22mAnalyticsController[2m > [22maskMentor[2m > [22mshould default to "vi" locale if user has no preferredLocale
 [32mâœ“[39m src/modules/analytics/analytics.controller.spec.ts[2m > [22mAnalyticsController[2m > [22maskMentor[2m > [22mshould handle empty query string
 [32mâœ“[39m src/modules/analytics/analytics.controller.spec.ts[2m > [22mAnalyticsController[2m > [22maskMentor[2m > [22mshould support Chinese locale
 [32mâœ“[39m src/modules/analytics/analytics.controller.spec.ts[2m > [22mAnalyticsController[2m > [22maskMentor[2m > [22mshould propagate mentor service errors
 [32mâœ“[39m src/modules/analytics/analytics.controller.spec.ts[2m > [22mAnalyticsController[2m > [22mgetSystemStats[2m > [22mshould return global system statistics for admin
 [32mâœ“[39m src/modules/analytics/analytics.controller.spec.ts[2m > [22mAnalyticsController[2m > [22mgetSystemStats[2m > [22mshould handle empty stats gracefully
 [32mâœ“[39m src/modules/analytics/analytics.controller.spec.ts[2m > [22mAnalyticsController[2m > [22mgetSystemStats[2m > [22mshould propagate analytics service errors
 [32mâœ“[39m src/modules/analytics/analytics.controller.spec.ts[2m > [22mAnalyticsController[2m > [22mGuards and Decorators[2m > [22mshould have JwtAuthGuard on controller level
 [32mâœ“[39m src/modules/analytics/analytics.controller.spec.ts[2m > [22mAnalyticsController[2m > [22mGuards and Decorators[2m > [22mshould have RolesGuard and ADMIN role on getSystemStats
 [32mâœ“[39m src/modules/analytics/analytics.controller.spec.ts[2m > [22mAnalyticsController[2m > [22mGuards and Decorators[2m > [22mshould not have RolesGuard on regular user endpoints
 [32mâœ“[39m src/modules/analytics/analytics.controller.spec.ts[2m > [22mAnalyticsController[2m > [22mError Handling[2m > [22mshould handle malformed request objects in getMyHabits
 [32mâœ“[39m src/modules/analytics/analytics.controller.spec.ts[2m > [22mAnalyticsController[2m > [22mError Handling[2m > [22mshould handle service timeout errors
 [32mâœ“[39m src/modules/analytics/analytics.controller.spec.ts[2m > [22mAnalyticsController[2m > [22mError Handling[2m > [22mshould handle database connection errors in getSystemStats
 [32mâœ“[39m src/modules/analytics/analytics.controller.spec.ts[2m > [22mAnalyticsController[2m > [22mRequest Parameter Validation[2m > [22mshould accept valid mentor chat request
 [32mâœ“[39m src/modules/analytics/analytics.controller.spec.ts[2m > [22mAnalyticsController[2m > [22mRequest Parameter Validation[2m > [22mshould handle very long query strings
 [32mâœ“[39m src/modules/analytics/analytics.controller.spec.ts[2m > [22mAnalyticsController[2m > [22mRequest Parameter Validation[2m > [22mshould handle special characters in query
 [32mâœ“[39m src/modules/analytics/analytics.controller.spec.ts[2m > [22mAnalyticsController[2m > [22mIntegration with Services[2m > [22mshould correctly chain analytics service calls
 [32mâœ“[39m src/modules/analytics/analytics.controller.spec.ts[2m > [22mAnalyticsController[2m > [22mIntegration with Services[2m > [22mshould correctly chain predictive service calls
 [32mâœ“[39m src/modules/analytics/analytics.controller.spec.ts[2m > [22mAnalyticsController[2m > [22mIntegration with Services[2m > [22mshould correctly chain mentor service calls
[90mstdout[2m | src/modules/analytics/analytics.controller.spec.ts[2m > [22m[2mAnalyticsController[2m > [22m[2mIntegration with Services[2m > [22m[2mshould correctly chain mentor service calls
[22m[39mðŸ§¹ Cleaning up after test...

[90mstdout[2m | src/modules/analytics/analytics.controller.spec.ts
[22m[39mðŸ”§ Vitest setup: Starting MSW mock server...
âœ… Vitest teardown complete

[90mstdout[2m | src/ai/ai.controller.spec.ts[2m > [22m[2mAiController[2m > [22m[2mshould be defined
[22m[39mðŸ§¹ Cleaning up after test...

[90mstdout[2m | src/ai/ai.controller.spec.ts[2m > [22m[2mAiController[2m > [22m[2mPOST /ai/threads - createThread[2m > [22m[2mshould create a new thread with title only
[22m[39mðŸ§¹ Cleaning up after test...

[90mstdout[2m | src/ai/ai.controller.spec.ts[2m > [22m[2mAiController[2m > [22m[2mPOST /ai/threads - createThread[2m > [22m[2mshould create a new thread with title and module
[22m[39mðŸ§¹ Cleaning up after test...

[90mstdout[2m | src/ai/ai.controller.spec.ts[2m > [22m[2mAiController[2m > [22m[2mPOST /ai/threads - createThread[2m > [22m[2mshould handle service errors when creating thread
[22m[39mðŸ§¹ Cleaning up after test...

[90mstdout[2m | src/ai/ai.controller.spec.ts[2m > [22m[2mAiController[2m > [22m[2mPOST /ai/threads - createThread[2m > [22m[2mshould require authentication (JwtAuthGuard)
[22m[39mðŸ§¹ Cleaning up after test...

[90mstdout[2m | src/ai/ai.controller.spec.ts[2m > [22m[2mAiController[2m > [22m[2mGET /ai/threads - getThreads[2m > [22m[2mshould return all threads for authenticated user
[22m[39mðŸ§¹ Cleaning up after test...

[90mstdout[2m | src/ai/ai.controller.spec.ts[2m > [22m[2mAiController[2m > [22m[2mGET /ai/threads - getThreads[2m > [22m[2mshould return empty array when user has no threads
[22m[39mðŸ§¹ Cleaning up after test...

[90mstdout[2m | src/ai/ai.controller.spec.ts[2m > [22m[2mAiController[2m > [22m[2mGET /ai/threads - getThreads[2m > [22m[2mshould handle service errors when fetching threads
[22m[39mðŸ§¹ Cleaning up after test...

[90mstdout[2m | src/ai/ai.controller.spec.ts[2m > [22m[2mAiController[2m > [22m[2mGET /ai/threads/:id/messages - getMessages[2m > [22m[2mshould return all messages for a thread
[22m[39mðŸ§¹ Cleaning up after test...

[90mstdout[2m | src/ai/ai.controller.spec.ts[2m > [22m[2mAiController[2m > [22m[2mGET /ai/threads/:id/messages - getMessages[2m > [22m[2mshould return empty array for thread with no messages
[22m[39mðŸ§¹ Cleaning up after test...

[90mstdout[2m | src/ai/ai.controller.spec.ts[2m > [22m[2mAiController[2m > [22m[2mGET /ai/threads/:id/messages - getMessages[2m > [22m[2mshould handle non-existent thread
[22m[39mðŸ§¹ Cleaning up after test...

[90mstdout[2m | src/ai/ai.controller.spec.ts[2m > [22m[2mAiController[2m > [22m[2mGET /ai/threads/:id/messages - getMessages[2m > [22m[2mshould handle service errors when fetching messages
[22m[39mðŸ§¹ Cleaning up after test...

[90mstdout[2m | src/ai/ai.controller.spec.ts[2m > [22m[2mAiController[2m > [22m[2mPOST /ai/threads/:id/chat - chat[2m > [22m[2mshould generate AI response for user prompt
[22m[39mðŸ§¹ Cleaning up after test...

[90mstdout[2m | src/ai/ai.controller.spec.ts[2m > [22m[2mAiController[2m > [22m[2mPOST /ai/threads/:id/chat - chat[2m > [22m[2mshould handle empty prompt
[22m[39mðŸ§¹ Cleaning up after test...

[90mstdout[2m | src/ai/ai.controller.spec.ts[2m > [22m[2mAiController[2m > [22m[2mPOST /ai/threads/:id/chat - chat[2m > [22m[2mshould handle rate limit exceeded
[22m[39mðŸ§¹ Cleaning up after test...

[90mstdout[2m | src/ai/ai.controller.spec.ts[2m > [22m[2mAiController[2m > [22m[2mPOST /ai/threads/:id/chat - chat[2m > [22m[2mshould handle monthly budget exceeded
[22m[39mðŸ§¹ Cleaning up after test...

[90mstdout[2m | src/ai/ai.controller.spec.ts[2m > [22m[2mAiController[2m > [22m[2mPOST /ai/threads/:id/chat - chat[2m > [22m[2mshould handle non-existent thread in chat
[22m[39mðŸ§¹ Cleaning up after test...

[90mstdout[2m | src/ai/ai.controller.spec.ts[2m > [22m[2mAiController[2m > [22m[2mPOST /ai/threads/:id/chat - chat[2m > [22m[2mshould handle unauthorized access to thread
[22m[39mðŸ§¹ Cleaning up after test...

[90mstdout[2m | src/ai/ai.controller.spec.ts[2m > [22m[2mAiController[2m > [22m[2mPOST /ai/threads/:id/chat - chat[2m > [22m[2mshould handle AI service errors
[22m[39mðŸ§¹ Cleaning up after test...

[90mstdout[2m | src/ai/ai.controller.spec.ts[2m > [22m[2mAiController[2m > [22m[2mInput Validation[2m > [22m[2mshould validate title is required for createThread
[22m[39mðŸ§¹ Cleaning up after test...

[90mstdout[2m | src/ai/ai.controller.spec.ts[2m > [22m[2mAiController[2m > [22m[2mInput Validation[2m > [22m[2mshould validate prompt is required for chat
[22m[39mðŸ§¹ Cleaning up after test...

[90mstdout[2m | src/ai/ai.controller.spec.ts[2m > [22m[2mAiController[2m > [22m[2mInput Validation[2m > [22m[2mshould handle invalid threadId format
[22m[39mðŸ§¹ Cleaning up after test...

[90mstdout[2m | src/ai/ai.controller.spec.ts[2m > [22m[2mAiController[2m > [22m[2mAuthentication Guards[2m > [22m[2mshould protect createThread with JwtAuthGuard
[22m[39mðŸ§¹ Cleaning up after test...

[90mstdout[2m | src/ai/ai.controller.spec.ts[2m > [22m[2mAiController[2m > [22m[2mAuthentication Guards[2m > [22m[2mshould protect getThreads with JwtAuthGuard
[22m[39mðŸ§¹ Cleaning up after test...

[90mstdout[2m | src/ai/ai.controller.spec.ts[2m > [22m[2mAiController[2m > [22m[2mAuthentication Guards[2m > [22m[2mshould protect getMessages with JwtAuthGuard
[22m[39mðŸ§¹ Cleaning up after test...

[90mstdout[2m | src/ai/ai.controller.spec.ts[2m > [22m[2mAiController[2m > [22m[2mAuthentication Guards[2m > [22m[2mshould protect chat with JwtAuthGuard
[22m[39mðŸ§¹ Cleaning up after test...

[90mstdout[2m | src/ai/ai.controller.spec.ts[2m > [22m[2mAiController[2m > [22m[2mError Response Handling[2m > [22m[2mshould propagate service exceptions to client
[22m[39mðŸ§¹ Cleaning up after test...

[90mstdout[2m | src/ai/ai.controller.spec.ts[2m > [22m[2mAiController[2m > [22m[2mError Response Handling[2m > [22m[2mshould handle unexpected errors
[22m[39mðŸ§¹ Cleaning up after test...

[90mstdout[2m | src/ai/ai.controller.spec.ts[2m > [22m[2mAiController[2m > [22m[2mEdge Cases[2m > [22m[2mshould handle very long thread titles
[22m[39mðŸ§¹ Cleaning up after test...

[90mstdout[2m | src/ai/ai.controller.spec.ts[2m > [22m[2mAiController[2m > [22m[2mEdge Cases[2m > [22m[2mshould handle very long prompts
[22m[39mðŸ§¹ Cleaning up after test...

[90mstdout[2m | src/ai/ai.controller.spec.ts[2m > [22m[2mAiController[2m > [22m[2mEdge Cases[2m > [22m[2mshould handle special characters in title
[22m[39mðŸ§¹ Cleaning up after test...

 [32mâœ“[39m src/ai/ai.controller.spec.ts[2m > [22mAiController[2m > [22mshould be defined
 [32mâœ“[39m src/ai/ai.controller.spec.ts[2m > [22mAiController[2m > [22mPOST /ai/threads - createThread[2m > [22mshould create a new thread with title only
 [32mâœ“[39m src/ai/ai.controller.spec.ts[2m > [22mAiController[2m > [22mPOST /ai/threads - createThread[2m > [22mshould create a new thread with title and module
 [32mâœ“[39m src/ai/ai.controller.spec.ts[2m > [22mAiController[2m > [22mPOST /ai/threads - createThread[2m > [22mshould handle service errors when creating thread
 [32mâœ“[39m src/ai/ai.controller.spec.ts[2m > [22mAiController[2m > [22mPOST /ai/threads - createThread[2m > [22mshould require authentication (JwtAuthGuard)
 [32mâœ“[39m src/ai/ai.controller.spec.ts[2m > [22mAiController[2m > [22mGET /ai/threads - getThreads[2m > [22mshould return all threads for authenticated user
 [32mâœ“[39m src/ai/ai.controller.spec.ts[2m > [22mAiController[2m > [22mGET /ai/threads - getThreads[2m > [22mshould return empty array when user has no threads
 [32mâœ“[39m src/ai/ai.controller.spec.ts[2m > [22mAiController[2m > [22mGET /ai/threads - getThreads[2m > [22mshould handle service errors when fetching threads
 [32mâœ“[39m src/ai/ai.controller.spec.ts[2m > [22mAiController[2m > [22mGET /ai/threads/:id/messages - getMessages[2m > [22mshould return all messages for a thread
 [32mâœ“[39m src/ai/ai.controller.spec.ts[2m > [22mAiController[2m > [22mGET /ai/threads/:id/messages - getMessages[2m > [22mshould return empty array for thread with no messages
 [32mâœ“[39m src/ai/ai.controller.spec.ts[2m > [22mAiController[2m > [22mGET /ai/threads/:id/messages - getMessages[2m > [22mshould handle non-existent thread
 [32mâœ“[39m src/ai/ai.controller.spec.ts[2m > [22mAiController[2m > [22mGET /ai/threads/:id/messages - getMessages[2m > [22mshould handle service errors when fetching messages
 [32mâœ“[39m src/ai/ai.controller.spec.ts[2m > [22mAiController[2m > [22mPOST /ai/threads/:id/chat - chat[2m > [22mshould generate AI response for user prompt
 [32mâœ“[39m src/ai/ai.controller.spec.ts[2m > [22mAiController[2m > [22mPOST /ai/threads/:id/chat - chat[2m > [22mshould handle empty prompt
 [32mâœ“[39m src/ai/ai.controller.spec.ts[2m > [22mAiController[2m > [22mPOST /ai/threads/:id/chat - chat[2m > [22mshould handle rate limit exceeded
 [32mâœ“[39m src/ai/ai.controller.spec.ts[2m > [22mAiController[2m > [22mPOST /ai/threads/:id/chat - chat[2m > [22mshould handle monthly budget exceeded
 [32mâœ“[39m src/ai/ai.controller.spec.ts[2m > [22mAiController[2m > [22mPOST /ai/threads/:id/chat - chat[2m > [22mshould handle non-existent thread in chat
 [32mâœ“[39m src/ai/ai.controller.spec.ts[2m > [22mAiController[2m > [22mPOST /ai/threads/:id/chat - chat[2m > [22mshould handle unauthorized access to thread
 [32mâœ“[39m src/ai/ai.controller.spec.ts[2m > [22mAiController[2m > [22mPOST /ai/threads/:id/chat - chat[2m > [22mshould handle AI service errors
 [32mâœ“[39m src/ai/ai.controller.spec.ts[2m > [22mAiController[2m > [22mInput Validation[2m > [22mshould validate title is required for createThread
 [32mâœ“[39m src/ai/ai.controller.spec.ts[2m > [22mAiController[2m > [22mInput Validation[2m > [22mshould validate prompt is required for chat
 [32mâœ“[39m src/ai/ai.controller.spec.ts[2m > [22mAiController[2m > [22mInput Validation[2m > [22mshould handle invalid threadId format
 [32mâœ“[39m src/ai/ai.controller.spec.ts[2m > [22mAiController[2m > [22mAuthentication Guards[2m > [22mshould protect createThread with JwtAuthGuard
 [32mâœ“[39m src/ai/ai.controller.spec.ts[2m > [22mAiController[2m > [22mAuthentication Guards[2m > [22mshould protect getThreads with JwtAuthGuard
 [32mâœ“[39m src/ai/ai.controller.spec.ts[2m > [22mAiController[2m > [22mAuthentication Guards[2m > [22mshould protect getMessages with JwtAuthGuard
 [32mâœ“[39m src/ai/ai.controller.spec.ts[2m > [22mAiController[2m > [22mAuthentication Guards[2m > [22mshould protect chat with JwtAuthGuard
 [32mâœ“[39m src/ai/ai.controller.spec.ts[2m > [22mAiController[2m > [22mError Response Handling[2m > [22mshould propagate service exceptions to client
 [32mâœ“[39m src/ai/ai.controller.spec.ts[2m > [22mAiController[2m > [22mError Response Handling[2m > [22mshould handle unexpected errors
 [32mâœ“[39m src/ai/ai.controller.spec.ts[2m > [22mAiController[2m > [22mEdge Cases[2m > [22mshould handle very long thread titles
 [32mâœ“[39m src/ai/ai.controller.spec.ts[2m > [22mAiController[2m > [22mEdge Cases[2m > [22mshould handle very long prompts
 [32mâœ“[39m src/ai/ai.controller.spec.ts[2m > [22mAiController[2m > [22mEdge Cases[2m > [22mshould handle special characters in title
 [32mâœ“[39m src/ai/ai.controller.spec.ts[2m > [22mAiController[2m > [22mEdge Cases[2m > [22mshould handle special characters in prompt
[90mstdout[2m | src/ai/ai.controller.spec.ts[2m > [22m[2mAiController[2m > [22m[2mEdge Cases[2m > [22m[2mshould handle special characters in prompt
[22m[39mðŸ§¹ Cleaning up after test...

[90mstdout[2m | src/ai/ai.controller.spec.ts
[22m[39mðŸ”§ Vitest setup: Starting MSW mock server...
âœ… Vitest teardown complete

 [32mâœ“[39m src/modules/social/social.service.spec.ts[2m > [22mSocialService[2m > [22mcreatePost[2m > [22mshould create a post and broadcast it
 [32mâœ“[39m src/modules/social/social.service.spec.ts[2m > [22mSocialService[2m > [22mjoinGroup[2m > [22mshould allow a user to join a group and create a welcome post
 [32mâœ“[39m src/modules/social/social.service.spec.ts[2m > [22mSocialService[2m > [22mjoinGroup[2m > [22mshould throw error if group is full
 [32mâœ“[39m src/modules/social/social.service.spec.ts[2m > [22mSocialService[2m > [22mupdateGroupStreak[2m > [22mshould increment group streak if all members are active
 [32mâœ“[39m src/modules/social/social.service.spec.ts[2m > [22mSocialService[2m > [22mupdateGroupStreak[2m > [22mshould nudge group if some members are inactive
 [32mâœ“[39m src/modules/social/social.service.spec.ts[2m > [22mSocialService[2m > [22mcheckChallengeProgress[2m > [22mshould complete challenge and reward members if target reached
 [32mâœ“[39m src/modules/social/social.service.spec.ts[2m > [22mSocialService[2m > [22mcheckChallengeProgress[2m > [22mshould fail challenge if expired and target not reached
 [32mâœ“[39m src/modules/social/social.service.spec.ts[2m > [22mSocialService[2m > [22mgenerateCompetitiveNudge[2m > [22mshould generate nudge for the user in second place
 [32mâœ“[39m src/modules/social/social.service.spec.ts[2m > [22mSocialService[2m > [22mgetFeed[2m > [22mshould return posts for user groups and public posts
 [32mâœ“[39m src/modules/social/social.service.spec.ts[2m > [22mSocialService[2m > [22mcreateGroup[2m > [22mshould create a group and add the creator as leader
 [32mâœ“[39m src/modules/social/social.service.spec.ts[2m > [22mSocialService[2m > [22mgetGroupDetails[2m > [22mshould return group with members and challenges
 [32mâœ“[39m src/modules/social/social.service.spec.ts[2m > [22mSocialService[2m > [22mgetRecommendedGroups[2m > [22mshould return fallback groups if user has no profile
 [32mâœ“[39m src/modules/social/social.service.spec.ts[2m > [22mSocialService[2m > [22mgetRecommendedGroups[2m > [22mshould return learning groups for beginners
 [32mâœ“[39m src/modules/social/social.service.spec.ts[2m > [22mSocialService[2m > [22mcreateGroupChallenge[2m > [22mshould create a challenge and announce it
[90mstdout[2m | src/modules/social/social.service.spec.ts[2m > [22m[2mSocialService[2m > [22m[2mcreatePost[2m > [22m[2mshould create a post and broadcast it
[22m[39mðŸ§¹ Cleaning up after test...

[90mstdout[2m | src/modules/social/social.service.spec.ts[2m > [22m[2mSocialService[2m > [22m[2mjoinGroup[2m > [22m[2mshould allow a user to join a group and create a welcome post
[22m[39mðŸ§¹ Cleaning up after test...

[90mstdout[2m | src/modules/social/social.service.spec.ts[2m > [22m[2mSocialService[2m > [22m[2mjoinGroup[2m > [22m[2mshould throw error if group is full
[22m[39mðŸ§¹ Cleaning up after test...

[90mstdout[2m | src/modules/social/social.service.spec.ts[2m > [22m[2mSocialService[2m > [22m[2mupdateGroupStreak[2m > [22m[2mshould increment group streak if all members are active
[22m[39mðŸ§¹ Cleaning up after test...

[90mstdout[2m | src/modules/social/social.service.spec.ts[2m > [22m[2mSocialService[2m > [22m[2mupdateGroupStreak[2m > [22m[2mshould nudge group if some members are inactive
[22m[39mðŸ§¹ Cleaning up after test...

[90mstdout[2m | src/modules/social/social.service.spec.ts[2m > [22m[2mSocialService[2m > [22m[2mcheckChallengeProgress[2m > [22m[2mshould complete challenge and reward members if target reached
[22m[39mðŸ§¹ Cleaning up after test...

[90mstdout[2m | src/modules/social/social.service.spec.ts[2m > [22m[2mSocialService[2m > [22m[2mcheckChallengeProgress[2m > [22m[2mshould fail challenge if expired and target not reached
[22m[39mðŸ§¹ Cleaning up after test...

[90mstdout[2m | src/modules/social/social.service.spec.ts[2m > [22m[2mSocialService[2m > [22m[2mgenerateCompetitiveNudge[2m > [22m[2mshould generate nudge for the user in second place
[22m[39m[Push Notification] to u2: {"vi":"Cá»‘ lÃªn!","en":"Keep going!","zh":"åŠ æ²¹ï¼"} - {"vi":"Báº¡n chá»‰ cÃ¡ch leader 200 Ä‘iá»ƒm. Há»c thÃªm 1 bÃ i Ä‘á»ƒ vÆ°á»£t qua nÃ o!","en":"You are only 200 points behind leader. Finish one more lesson to overtake!","zh":"ä½ åªè½åŽ leader 200 åˆ†ã€‚å†å­¦ä¸€è¯¾å°±èƒ½è¶…è¿‡äº†ï¼"}
ðŸ§¹ Cleaning up after test...

[90mstdout[2m | src/modules/social/social.service.spec.ts[2m > [22m[2mSocialService[2m > [22m[2mgetFeed[2m > [22m[2mshould return posts for user groups and public posts
[22m[39mðŸ§¹ Cleaning up after test...

[90mstdout[2m | src/modules/social/social.service.spec.ts[2m > [22m[2mSocialService[2m > [22m[2mcreateGroup[2m > [22m[2mshould create a group and add the creator as leader
[22m[39mðŸ§¹ Cleaning up after test...

[90mstdout[2m | src/modules/social/social.service.spec.ts[2m > [22m[2mSocialService[2m > [22m[2mgetGroupDetails[2m > [22m[2mshould return group with members and challenges
[22m[39mðŸ§¹ Cleaning up after test...

[90mstdout[2m | src/modules/social/social.service.spec.ts[2m > [22m[2mSocialService[2m > [22m[2mgetRecommendedGroups[2m > [22m[2mshould return fallback groups if user has no profile
[22m[39mðŸ§¹ Cleaning up after test...

[90mstdout[2m | src/modules/social/social.service.spec.ts[2m > [22m[2mSocialService[2m > [22m[2mgetRecommendedGroups[2m > [22m[2mshould return learning groups for beginners
[22m[39mðŸ§¹ Cleaning up after test...

[90mstdout[2m | src/modules/social/social.service.spec.ts[2m > [22m[2mSocialService[2m > [22m[2mcreateGroupChallenge[2m > [22m[2mshould create a challenge and announce it
[22m[39mðŸ§¹ Cleaning up after test...

[90mstdout[2m | src/modules/social/social.service.spec.ts
[22m[39mðŸ”§ Vitest setup: Starting MSW mock server...
âœ… Vitest teardown complete

[90mstdout[2m | test/unit/courses/courses.service.spec.ts[2m > [22m[2mCoursesService[2m > [22m[2mcreateCourse[2m > [22m[2mshould create course with localized JSONB content (vi/en/zh)
[22m[39mðŸ§¹ Cleaning up after test...

[90mstdout[2m | test/unit/courses/courses.service.spec.ts[2m > [22m[2mCoursesService[2m > [22m[2mcreateCourse[2m > [22m[2mshould validate JSONB structure via ValidationService
[22m[39mðŸ§¹ Cleaning up after test...

[90mstdout[2m | test/unit/courses/courses.service.spec.ts[2m > [22m[2mCoursesService[2m > [22m[2mfindAllCourses[2m > [22m[2mshould return paginated courses with default values
[22m[39mðŸ§¹ Cleaning up after test...

[90mstdout[2m | test/unit/courses/courses.service.spec.ts[2m > [22m[2mCoursesService[2m > [22m[2mfindAllCourses[2m > [22m[2mshould filter by published status
[22m[39mðŸ§¹ Cleaning up after test...

[90mstdout[2m | test/unit/courses/courses.service.spec.ts[2m > [22m[2mCoursesService[2m > [22m[2mfindAllCourses[2m > [22m[2mshould filter by level (BEGINNER, INTERMEDIATE, ADVANCED)
[22m[39mðŸ§¹ Cleaning up after test...

[90mstdout[2m | test/unit/courses/courses.service.spec.ts[2m > [22m[2mCoursesService[2m > [22m[2mfindAllCourses[2m > [22m[2mshould enforce max limit of 100
[22m[39mðŸ§¹ Cleaning up after test...

[90mstdout[2m | test/unit/courses/courses.service.spec.ts[2m > [22m[2mCoursesService[2m > [22m[2mfindAllCourses[2m > [22m[2mshould handle page boundaries correctly
[22m[39mðŸ§¹ Cleaning up after test...

[90mstdout[2m | test/unit/courses/courses.service.spec.ts[2m > [22m[2mCoursesService[2m > [22m[2mfindOneCourse[2m > [22m[2mshould return course with published lessons ordered by order field
[22m[39mðŸ§¹ Cleaning up after test...

[90mstdout[2m | test/unit/courses/courses.service.spec.ts[2m > [22m[2mCoursesService[2m > [22m[2mfindOneCourse[2m > [22m[2mshould throw NotFoundException if course not found
[22m[39mðŸ§¹ Cleaning up after test...

[90mstdout[2m | test/unit/courses/courses.service.spec.ts[2m > [22m[2mCoursesService[2m > [22m[2mupdateCourse[2m > [22m[2mshould update course and preserve localization structure
[22m[39mðŸ§¹ Cleaning up after test...

[90mstdout[2m | test/unit/courses/courses.service.spec.ts[2m > [22m[2mCoursesService[2m > [22m[2mupdateCourse[2m > [22m[2mshould allow partial updates
[22m[39mðŸ§¹ Cleaning up after test...

[90mstdout[2m | test/unit/courses/courses.service.spec.ts[2m > [22m[2mCoursesService[2m > [22m[2mremoveCourse[2m > [22m[2mshould delete course
[22m[39mðŸ§¹ Cleaning up after test...

[90mstdout[2m | test/unit/courses/courses.service.spec.ts[2m > [22m[2mCoursesService[2m > [22m[2mupdateProgress[2m > [22m[2mshould update progress and award points on first completion
[22m[39mðŸ§¹ Cleaning up after test...

[90mstdout[2m | test/unit/courses/courses.service.spec.ts[2m > [22m[2mCoursesService[2m > [22m[2mupdateProgress[2m > [22m[2mshould not award points if already completed (idempotent)
[22m[39mðŸ§¹ Cleaning up after test...

[90mstdout[2m | test/unit/courses/courses.service.spec.ts[2m > [22m[2mCoursesService[2m > [22m[2mupdateProgress[2m > [22m[2mshould increment durationSpent on existing progress
[22m[39mðŸ§¹ Cleaning up after test...

[90mstdout[2m | test/unit/courses/courses.service.spec.ts[2m > [22m[2mCoursesService[2m > [22m[2mupdateProgress[2m > [22m[2mshould set completedAt timestamp on first completion only
[22m[39mðŸ§¹ Cleaning up after test...

[90mstdout[2m | test/unit/courses/courses.service.spec.ts[2m > [22m[2mCoursesService[2m > [22m[2mgetUserProgress[2m > [22m[2mshould return all progress for a user in a specific course
[22m[39mðŸ§¹ Cleaning up after test...

[90mstdout[2m | test/unit/courses/courses.service.spec.ts[2m > [22m[2mCoursesService[2m > [22m[2mfindOneLesson[2m > [22m[2mshould return lesson by id
[22m[39mðŸ§¹ Cleaning up after test...

 [32mâœ“[39m test/unit/courses/courses.service.spec.ts[2m > [22mCoursesService[2m > [22mcreateCourse[2m > [22mshould create course with localized JSONB content (vi/en/zh)
 [32mâœ“[39m test/unit/courses/courses.service.spec.ts[2m > [22mCoursesService[2m > [22mcreateCourse[2m > [22mshould validate JSONB structure via ValidationService
 [32mâœ“[39m test/unit/courses/courses.service.spec.ts[2m > [22mCoursesService[2m > [22mfindAllCourses[2m > [22mshould return paginated courses with default values
 [32mâœ“[39m test/unit/courses/courses.service.spec.ts[2m > [22mCoursesService[2m > [22mfindAllCourses[2m > [22mshould filter by published status
 [32mâœ“[39m test/unit/courses/courses.service.spec.ts[2m > [22mCoursesService[2m > [22mfindAllCourses[2m > [22mshould filter by level (BEGINNER, INTERMEDIATE, ADVANCED)
 [32mâœ“[39m test/unit/courses/courses.service.spec.ts[2m > [22mCoursesService[2m > [22mfindAllCourses[2m > [22mshould enforce max limit of 100
 [32mâœ“[39m test/unit/courses/courses.service.spec.ts[2m > [22mCoursesService[2m > [22mfindAllCourses[2m > [22mshould handle page boundaries correctly
 [32mâœ“[39m test/unit/courses/courses.service.spec.ts[2m > [22mCoursesService[2m > [22mfindOneCourse[2m > [22mshould return course with published lessons ordered by order field
 [32mâœ“[39m test/unit/courses/courses.service.spec.ts[2m > [22mCoursesService[2m > [22mfindOneCourse[2m > [22mshould throw NotFoundException if course not found
 [32mâœ“[39m test/unit/courses/courses.service.spec.ts[2m > [22mCoursesService[2m > [22mupdateCourse[2m > [22mshould update course and preserve localization structure
 [32mâœ“[39m test/unit/courses/courses.service.spec.ts[2m > [22mCoursesService[2m > [22mupdateCourse[2m > [22mshould allow partial updates
 [32mâœ“[39m test/unit/courses/courses.service.spec.ts[2m > [22mCoursesService[2m > [22mremoveCourse[2m > [22mshould delete course
 [32mâœ“[39m test/unit/courses/courses.service.spec.ts[2m > [22mCoursesService[2m > [22mupdateProgress[2m > [22mshould update progress and award points on first completion
 [32mâœ“[39m test/unit/courses/courses.service.spec.ts[2m > [22mCoursesService[2m > [22mupdateProgress[2m > [22mshould not award points if already completed (idempotent)
 [32mâœ“[39m test/unit/courses/courses.service.spec.ts[2m > [22mCoursesService[2m > [22mupdateProgress[2m > [22mshould increment durationSpent on existing progress
 [32mâœ“[39m test/unit/courses/courses.service.spec.ts[2m > [22mCoursesService[2m > [22mupdateProgress[2m > [22mshould set completedAt timestamp on first completion only
 [32mâœ“[39m test/unit/courses/courses.service.spec.ts[2m > [22mCoursesService[2m > [22mgetUserProgress[2m > [22mshould return all progress for a user in a specific course
 [32mâœ“[39m test/unit/courses/courses.service.spec.ts[2m > [22mCoursesService[2m > [22mfindOneLesson[2m > [22mshould return lesson by id
 [32mâœ“[39m test/unit/courses/courses.service.spec.ts[2m > [22mCoursesService[2m > [22mfindOneLesson[2m > [22mshould throw NotFoundException if lesson not found
[90mstdout[2m | test/unit/courses/courses.service.spec.ts[2m > [22m[2mCoursesService[2m > [22m[2mfindOneLesson[2m > [22m[2mshould throw NotFoundException if lesson not found
[22m[39mðŸ§¹ Cleaning up after test...

[90mstdout[2m | test/unit/courses/courses.service.spec.ts
[22m[39mðŸ”§ Vitest setup: Starting MSW mock server...
âœ… Vitest teardown complete

[90mstdout[2m | src/auth/auth.service.spec.ts
[22m[39mðŸ”§ Vitest setup: Starting MSW mock server...

[90mstdout[2m | src/auth/auth.service.spec.ts[2m > [22m[2mAuthService[2m > [22m[2mshould be defined
[22m[39mðŸ§¹ Cleaning up after test...

[90mstdout[2m | src/auth/auth.service.spec.ts[2m > [22m[2mAuthService[2m > [22m[2mgenerateTokens[2m > [22m[2mshould generate tokens and save to DB
[22m[39mðŸ§¹ Cleaning up after test...

 [32mâœ“[39m src/auth/auth.service.spec.ts[2m > [22mAuthService[2m > [22mshould be defined
 [32mâœ“[39m src/auth/auth.service.spec.ts[2m > [22mAuthService[2m > [22mgenerateTokens[2m > [22mshould generate tokens and save to DB
[90mstdout[2m | src/auth/auth.service.spec.ts[2m > [22m[2mAuthService[2m > [22m[2mvalidateUser[2m > [22m[2mshould return user without password if valid
[22m[39mðŸ§¹ Cleaning up after test...

 [32mâœ“[39m src/auth/auth.service.spec.ts[2m > [22mAuthService[2m > [22mvalidateUser[2m > [22mshould return user without password if valid
[90mstdout[2m | src/auth/auth.service.spec.ts[2m > [22m[2mAuthService[2m > [22m[2mvalidateUser[2m > [22m[2mshould return null if password invalid
[22m[39mðŸ§¹ Cleaning up after test...

[90mstdout[2m | src/auth/auth.service.spec.ts[2m > [22m[2mAuthService[2m > [22m[2mvalidateUser[2m > [22m[2mshould return null if user not found
[22m[39mðŸ§¹ Cleaning up after test...

[90mstdout[2m | src/auth/auth.service.spec.ts[2m > [22m[2mAuthService[2m > [22m[2mlogin[2m > [22m[2mshould throw UnauthorizedException if validation fails
[22m[39mðŸ§¹ Cleaning up after test...

[90mstdout[2m | src/auth/auth.service.spec.ts[2m > [22m[2mAuthService[2m > [22m[2mlogin[2m > [22m[2mshould return access and refresh tokens on success
[22m[39mðŸ§¹ Cleaning up after test...

[90mstdout[2m | src/auth/auth.service.spec.ts[2m > [22m[2mAuthService[2m > [22m[2mrefreshToken[2m > [22m[2mshould refresh tokens correctly
[22m[39mðŸ§¹ Cleaning up after test...

[90mstdout[2m | src/auth/auth.service.spec.ts[2m > [22m[2mAuthService[2m > [22m[2mrefreshToken[2m > [22m[2mshould throw if token is expired
[22m[39mðŸ§¹ Cleaning up after test...

[90mstdout[2m | src/auth/auth.service.spec.ts[2m > [22m[2mAuthService[2m > [22m[2mrefreshToken[2m > [22m[2mshould revoke all tokens if reused
[22m[39mðŸ§¹ Cleaning up after test...

 [32mâœ“[39m src/auth/auth.service.spec.ts[2m > [22mAuthService[2m > [22mvalidateUser[2m > [22mshould return null if password invalid
 [32mâœ“[39m src/auth/auth.service.spec.ts[2m > [22mAuthService[2m > [22mvalidateUser[2m > [22mshould return null if user not found
 [32mâœ“[39m src/auth/auth.service.spec.ts[2m > [22mAuthService[2m > [22mlogin[2m > [22mshould throw UnauthorizedException if validation fails
 [32mâœ“[39m src/auth/auth.service.spec.ts[2m > [22mAuthService[2m > [22mlogin[2m > [22mshould return access and refresh tokens on success
 [32mâœ“[39m src/auth/auth.service.spec.ts[2m > [22mAuthService[2m > [22mrefreshToken[2m > [22mshould refresh tokens correctly
 [32mâœ“[39m src/auth/auth.service.spec.ts[2m > [22mAuthService[2m > [22mrefreshToken[2m > [22mshould throw if token is expired
 [32mâœ“[39m src/auth/auth.service.spec.ts[2m > [22mAuthService[2m > [22mrefreshToken[2m > [22mshould revoke all tokens if reused
[90mstdout[2m | src/auth/auth.service.spec.ts[2m > [22m[2mAuthService[2m > [22m[2mregister[2m > [22m[2mshould create user and return tokens
[22m[39mðŸ§¹ Cleaning up after test...

[90mstdout[2m | src/auth/auth.service.spec.ts[2m > [22m[2mAuthService[2m > [22m[2mregister[2m > [22m[2mshould throw ConflictException if email already exists
[22m[39mðŸ§¹ Cleaning up after test...

 [32mâœ“[39m src/auth/auth.service.spec.ts[2m > [22mAuthService[2m > [22mregister[2m > [22mshould create user and return tokens
 [32mâœ“[39m src/auth/auth.service.spec.ts[2m > [22mAuthService[2m > [22mregister[2m > [22mshould throw ConflictException if email already exists
[90mstdout[2m | src/auth/auth.service.spec.ts[2m > [22m[2mAuthService[2m > [22m[2mregister[2m > [22m[2mshould hash password with bcrypt before saving
[22m[39mðŸ§¹ Cleaning up after test...

 [32mâœ“[39m src/auth/auth.service.spec.ts[2m > [22mAuthService[2m > [22mregister[2m > [22mshould hash password with bcrypt before saving
[90mstdout[2m | src/auth/auth.service.spec.ts[2m > [22m[2mAuthService[2m > [22m[2mregister[2m > [22m[2mshould handle Prisma P2002 error (duplicate email)
[22m[39mðŸ§¹ Cleaning up after test...

 [32mâœ“[39m src/auth/auth.service.spec.ts[2m > [22mAuthService[2m > [22mregister[2m > [22mshould handle Prisma P2002 error (duplicate email)
 [32mâœ“[39m src/auth/auth.service.spec.ts[2m > [22mAuthService[2m > [22mregister[2m > [22mshould generate default i18n name from email if name not provided
[90mstdout[2m | src/auth/auth.service.spec.ts[2m > [22m[2mAuthService[2m > [22m[2mregister[2m > [22m[2mshould generate default i18n name from email if name not provided
[22m[39mðŸ§¹ Cleaning up after test...

[90mstdout[2m | src/auth/auth.service.spec.ts
[22m[39mâœ… Vitest teardown complete

[90mstdout[2m | test/simulation-ai.integration.spec.ts
[22m[39mðŸ”§ Vitest setup: Starting MSW mock server...

[90mstdout[2m | test/simulation-ai.integration.spec.ts[2m > [22m[2mFinancial Simulation AI Integration[2m > [22m[2mFull Simulation Flow[2m > [22m[2mshould start simulation and generate AI scenario
[22m[39mðŸ§¹ Cleaning up after test...

 [32mâœ“[39m test/simulation-ai.integration.spec.ts[2m > [22mFinancial Simulation AI Integration[2m > [22mFull Simulation Flow[2m > [22mshould start simulation and generate AI scenario
[90mstdout[2m | test/simulation-ai.integration.spec.ts[2m > [22m[2mFinancial Simulation AI Integration[2m > [22m[2mFull Simulation Flow[2m > [22m[2mshould continue simulation, make decision and calculate impact
[22m[39mðŸ§¹ Cleaning up after test...

[90mstdout[2m | test/simulation-ai.integration.spec.ts[2m > [22m[2mFinancial Simulation AI Integration[2m > [22m[2mFull Simulation Flow[2m > [22m[2mshould verify market simulation trade updates portfolio
[22m[39mðŸ§¹ Cleaning up after test...

 [32mâœ“[39m test/simulation-ai.integration.spec.ts[2m > [22mFinancial Simulation AI Integration[2m > [22mFull Simulation Flow[2m > [22mshould continue simulation, make decision and calculate impact
 [32mâœ“[39m test/simulation-ai.integration.spec.ts[2m > [22mFinancial Simulation AI Integration[2m > [22mFull Simulation Flow[2m > [22mshould verify market simulation trade updates portfolio
[90mstdout[2m | test/simulation-ai.integration.spec.ts[2m > [22m[2mFinancial Simulation AI Integration[2m > [22m[2mFull Simulation Flow[2m > [22m[2mshould validate simulation history logs via behavior tracking
[22m[39mðŸ§¹ Cleaning up after test...

[90mstdout[2m | test/simulation-ai.integration.spec.ts
[22m[39mâœ… Vitest teardown complete

 [32mâœ“[39m test/simulation-ai.integration.spec.ts[2m > [22mFinancial Simulation AI Integration[2m > [22mFull Simulation Flow[2m > [22mshould validate simulation history logs via behavior tracking
[90mstdout[2m | src/checklists/checklists.service.spec.ts[2m > [22m[2mChecklistsService[2m > [22m[2mshould be defined
[22m[39mðŸ§¹ Cleaning up after test...

[90mstdout[2m | src/checklists/checklists.service.spec.ts[2m > [22m[2mChecklistsService[2m > [22m[2mupdateItem[2m > [22m[2mshould update item and calculate progress correctly
[22m[39mðŸ§¹ Cleaning up after test...

[90mstdout[2m | src/checklists/checklists.service.spec.ts[2m > [22m[2mChecklistsService[2m > [22m[2mupdateItem[2m > [22m[2mshould reward when 100% completed
[22m[39mðŸ§¹ Cleaning up after test...

[90mstdout[2m | src/checklists/checklists.service.spec.ts[2m > [22m[2mChecklistsService[2m > [22m[2mupdateItem[2m > [22m[2mshould not reward if already 100% completed before
[22m[39mðŸ§¹ Cleaning up after test...

[90mstdout[2m | src/checklists/checklists.service.spec.ts[2m > [22m[2mChecklistsService[2m > [22m[2mupdateItem[2m > [22m[2mshould throw NotFoundException for non-existent checklist
[22m[39mðŸ§¹ Cleaning up after test...

[90mstdout[2m | src/checklists/checklists.service.spec.ts[2m > [22m[2mChecklistsService[2m > [22m[2mupdateItem[2m > [22m[2mshould throw NotFoundException for wrong user
[22m[39mðŸ§¹ Cleaning up after test...

[90mstdout[2m | src/checklists/checklists.service.spec.ts[2m > [22m[2mChecklistsService[2m > [22m[2mupdateItem[2m > [22m[2mshould mark item as incomplete and recalculate progress
[22m[39mðŸ§¹ Cleaning up after test...

[90mstdout[2m | src/checklists/checklists.service.spec.ts[2m > [22m[2mChecklistsService[2m > [22m[2mupdateItem[2m > [22m[2mshould set completedAt timestamp when completing item
[22m[39mðŸ§¹ Cleaning up after test...

[90mstdout[2m | src/checklists/checklists.service.spec.ts[2m > [22m[2mChecklistsService[2m > [22m[2mcreate[2m > [22m[2mshould create a new checklist with 0 progress
[22m[39mðŸ§¹ Cleaning up after test...

[90mstdout[2m | src/checklists/checklists.service.spec.ts[2m > [22m[2mChecklistsService[2m > [22m[2mfindAll[2m > [22m[2mshould return all checklists ordered by updatedAt desc
[22m[39mðŸ§¹ Cleaning up after test...

[90mstdout[2m | src/checklists/checklists.service.spec.ts[2m > [22m[2mChecklistsService[2m > [22m[2mfindAll[2m > [22m[2mshould return empty array if no checklists exist
[22m[39mðŸ§¹ Cleaning up after test...

[90mstdout[2m | src/checklists/checklists.service.spec.ts[2m > [22m[2mChecklistsService[2m > [22m[2mProgress calculation[2m > [22m[2mshould calculate 0% for all incomplete items
[22m[39mðŸ§¹ Cleaning up after test...

[90mstdout[2m | src/checklists/checklists.service.spec.ts[2m > [22m[2mChecklistsService[2m > [22m[2mProgress calculation[2m > [22m[2mshould round progress correctly
[22m[39mðŸ§¹ Cleaning up after test...

[90mstdout[2m | src/checklists/checklists.service.spec.ts
[22m[39mðŸ”§ Vitest setup: Starting MSW mock server...
âœ… Vitest teardown complete

 [32mâœ“[39m src/checklists/checklists.service.spec.ts[2m > [22mChecklistsService[2m > [22mshould be defined
 [32mâœ“[39m src/checklists/checklists.service.spec.ts[2m > [22mChecklistsService[2m > [22mupdateItem[2m > [22mshould update item and calculate progress correctly
 [32mâœ“[39m src/checklists/checklists.service.spec.ts[2m > [22mChecklistsService[2m > [22mupdateItem[2m > [22mshould reward when 100% completed
 [32mâœ“[39m src/checklists/checklists.service.spec.ts[2m > [22mChecklistsService[2m > [22mupdateItem[2m > [22mshould not reward if already 100% completed before
 [32mâœ“[39m src/checklists/checklists.service.spec.ts[2m > [22mChecklistsService[2m > [22mupdateItem[2m > [22mshould throw NotFoundException for non-existent checklist
 [32mâœ“[39m src/checklists/checklists.service.spec.ts[2m > [22mChecklistsService[2m > [22mupdateItem[2m > [22mshould throw NotFoundException for wrong user
 [32mâœ“[39m src/checklists/checklists.service.spec.ts[2m > [22mChecklistsService[2m > [22mupdateItem[2m > [22mshould mark item as incomplete and recalculate progress
 [32mâœ“[39m src/checklists/checklists.service.spec.ts[2m > [22mChecklistsService[2m > [22mupdateItem[2m > [22mshould set completedAt timestamp when completing item
 [32mâœ“[39m src/checklists/checklists.service.spec.ts[2m > [22mChecklistsService[2m > [22mcreate[2m > [22mshould create a new checklist with 0 progress
 [32mâœ“[39m src/checklists/checklists.service.spec.ts[2m > [22mChecklistsService[2m > [22mfindAll[2m > [22mshould return all checklists ordered by updatedAt desc
 [32mâœ“[39m src/checklists/checklists.service.spec.ts[2m > [22mChecklistsService[2m > [22mfindAll[2m > [22mshould return empty array if no checklists exist
 [32mâœ“[39m src/checklists/checklists.service.spec.ts[2m > [22mChecklistsService[2m > [22mProgress calculation[2m > [22mshould calculate 0% for all incomplete items
 [32mâœ“[39m src/checklists/checklists.service.spec.ts[2m > [22mChecklistsService[2m > [22mProgress calculation[2m > [22mshould round progress correctly
[90mstdout[2m | src/courses/courses.controller.spec.ts[2m > [22m[2mCoursesController[2m > [22m[2mshould be defined
[22m[39mðŸ§¹ Cleaning up after test...

[90mstdout[2m | src/courses/courses.controller.spec.ts[2m > [22m[2mCoursesController[2m > [22m[2mcreateCourse (POST /courses)[2m > [22m[2mshould create course with localized content
[22m[39mðŸ§¹ Cleaning up after test...

[90mstdout[2m | src/courses/courses.controller.spec.ts[2m > [22m[2mCoursesController[2m > [22m[2mcreateCourse (POST /courses)[2m > [22m[2mshould require ADMIN or TEACHER role
[22m[39mðŸ§¹ Cleaning up after test...

[90mstdout[2m | src/courses/courses.controller.spec.ts[2m > [22m[2mCoursesController[2m > [22m[2mfindAll (GET /courses)[2m > [22m[2mshould return paginated courses
[22m[39mðŸ§¹ Cleaning up after test...

[90mstdout[2m | src/courses/courses.controller.spec.ts[2m > [22m[2mCoursesController[2m > [22m[2mfindAll (GET /courses)[2m > [22m[2mshould accept pagination parameters
[22m[39mðŸ§¹ Cleaning up after test...

[90mstdout[2m | src/courses/courses.controller.spec.ts[2m > [22m[2mCoursesController[2m > [22m[2mfindAll (GET /courses)[2m > [22m[2mshould filter by level
[22m[39mðŸ§¹ Cleaning up after test...

[90mstdout[2m | src/courses/courses.controller.spec.ts[2m > [22m[2mCoursesController[2m > [22m[2mfindOne (GET /courses/:id)[2m > [22m[2mshould return course by id
[22m[39mðŸ§¹ Cleaning up after test...

[90mstdout[2m | src/courses/courses.controller.spec.ts[2m > [22m[2mCoursesController[2m > [22m[2mfindLesson (GET /courses/lessons/:id)[2m > [22m[2mshould return lesson by id
[22m[39mðŸ§¹ Cleaning up after test...

[90mstdout[2m | src/courses/courses.controller.spec.ts[2m > [22m[2mCoursesController[2m > [22m[2mupdateCourse (PATCH /courses/:id)[2m > [22m[2mshould update course
[22m[39mðŸ§¹ Cleaning up after test...

[90mstdout[2m | src/courses/courses.controller.spec.ts[2m > [22m[2mCoursesController[2m > [22m[2mremoveCourse (DELETE /courses/:id)[2m > [22m[2mshould delete course
[22m[39mðŸ§¹ Cleaning up after test...

[90mstdout[2m | src/courses/courses.controller.spec.ts[2m > [22m[2mCoursesController[2m > [22m[2mremoveCourse (DELETE /courses/:id)[2m > [22m[2mshould require ADMIN role
[22m[39mðŸ§¹ Cleaning up after test...

[90mstdout[2m | src/courses/courses.controller.spec.ts[2m > [22m[2mCoursesController[2m > [22m[2mcreateLesson (POST /courses/lessons)[2m > [22m[2mshould create lesson
[22m[39mðŸ§¹ Cleaning up after test...

[90mstdout[2m | src/courses/courses.controller.spec.ts[2m > [22m[2mCoursesController[2m > [22m[2mupdateLesson (PATCH /courses/lessons/:id)[2m > [22m[2mshould update lesson
[22m[39mðŸ§¹ Cleaning up after test...

[90mstdout[2m | src/courses/courses.controller.spec.ts[2m > [22m[2mCoursesController[2m > [22m[2mremoveLesson (DELETE /courses/lessons/:id)[2m > [22m[2mshould delete lesson
[22m[39mðŸ§¹ Cleaning up after test...

[90mstdout[2m | src/courses/courses.controller.spec.ts[2m > [22m[2mCoursesController[2m > [22m[2mupdateProgress (POST /courses/lessons/:id/progress)[2m > [22m[2mshould update user progress with correct params
[22m[39mðŸ§¹ Cleaning up after test...

[90mstdout[2m | src/courses/courses.controller.spec.ts[2m > [22m[2mCoursesController[2m > [22m[2mupdateProgress (POST /courses/lessons/:id/progress)[2m > [22m[2mshould extract userId from JWT token
[22m[39mðŸ§¹ Cleaning up after test...

 [32mâœ“[39m src/courses/courses.controller.spec.ts[2m > [22mCoursesController[2m > [22mshould be defined
 [32mâœ“[39m src/courses/courses.controller.spec.ts[2m > [22mCoursesController[2m > [22mcreateCourse (POST /courses)[2m > [22mshould create course with localized content
 [32mâœ“[39m src/courses/courses.controller.spec.ts[2m > [22mCoursesController[2m > [22mcreateCourse (POST /courses)[2m > [22mshould require ADMIN or TEACHER role
 [32mâœ“[39m src/courses/courses.controller.spec.ts[2m > [22mCoursesController[2m > [22mfindAll (GET /courses)[2m > [22mshould return paginated courses
 [32mâœ“[39m src/courses/courses.controller.spec.ts[2m > [22mCoursesController[2m > [22mfindAll (GET /courses)[2m > [22mshould accept pagination parameters
 [32mâœ“[39m src/courses/courses.controller.spec.ts[2m > [22mCoursesController[2m > [22mfindAll (GET /courses)[2m > [22mshould filter by level
 [32mâœ“[39m src/courses/courses.controller.spec.ts[2m > [22mCoursesController[2m > [22mfindOne (GET /courses/:id)[2m > [22mshould return course by id
 [32mâœ“[39m src/courses/courses.controller.spec.ts[2m > [22mCoursesController[2m > [22mfindLesson (GET /courses/lessons/:id)[2m > [22mshould return lesson by id
 [32mâœ“[39m src/courses/courses.controller.spec.ts[2m > [22mCoursesController[2m > [22mupdateCourse (PATCH /courses/:id)[2m > [22mshould update course
 [32mâœ“[39m src/courses/courses.controller.spec.ts[2m > [22mCoursesController[2m > [22mremoveCourse (DELETE /courses/:id)[2m > [22mshould delete course
 [32mâœ“[39m src/courses/courses.controller.spec.ts[2m > [22mCoursesController[2m > [22mremoveCourse (DELETE /courses/:id)[2m > [22mshould require ADMIN role
 [32mâœ“[39m src/courses/courses.controller.spec.ts[2m > [22mCoursesController[2m > [22mcreateLesson (POST /courses/lessons)[2m > [22mshould create lesson
 [32mâœ“[39m src/courses/courses.controller.spec.ts[2m > [22mCoursesController[2m > [22mupdateLesson (PATCH /courses/lessons/:id)[2m > [22mshould update lesson
 [32mâœ“[39m src/courses/courses.controller.spec.ts[2m > [22mCoursesController[2m > [22mremoveLesson (DELETE /courses/lessons/:id)[2m > [22mshould delete lesson
 [32mâœ“[39m src/courses/courses.controller.spec.ts[2m > [22mCoursesController[2m > [22mupdateProgress (POST /courses/lessons/:id/progress)[2m > [22mshould update user progress with correct params
 [32mâœ“[39m src/courses/courses.controller.spec.ts[2m > [22mCoursesController[2m > [22mupdateProgress (POST /courses/lessons/:id/progress)[2m > [22mshould extract userId from JWT token
 [32mâœ“[39m src/courses/courses.controller.spec.ts[2m > [22mCoursesController[2m > [22mgetMentorAdvice (GET /courses/:id/mentor-advice)[2m > [22mshould get AI-generated course advice
[90mstdout[2m | src/courses/courses.controller.spec.ts[2m > [22m[2mCoursesController[2m > [22m[2mgetMentorAdvice (GET /courses/:id/mentor-advice)[2m > [22m[2mshould get AI-generated course advice
[22m[39mðŸ§¹ Cleaning up after test...

[90mstdout[2m | src/courses/courses.controller.spec.ts
[22m[39mðŸ”§ Vitest setup: Starting MSW mock server...
âœ… Vitest teardown complete

[90mstdout[2m | src/modules/social/social.integration.spec.ts[2m > [22m[2mSocial Integration[2m > [22m[2mEnd-to-end Social Flow[2m > [22m[2mshould handle full cycle: join group -> welcome post -> leaderboard nudge -> notification
[22m[39m[Push Notification] to u2: {"vi":"Cá»‘ lÃªn!","en":"Keep going!","zh":"åŠ æ²¹ï¼"} - {"vi":"Báº¡n chá»‰ cÃ¡ch user1 200 Ä‘iá»ƒm. Há»c thÃªm 1 bÃ i Ä‘á»ƒ vÆ°á»£t qua nÃ o!","en":"You are only 200 points behind user1. Finish one more lesson to overtake!","zh":"ä½ åªè½åŽ user1 200 åˆ†ã€‚å†å­¦ä¸€è¯¾å°±èƒ½è¶…è¿‡äº†ï¼"}
ðŸ§¹ Cleaning up after test...

[90mstdout[2m | src/modules/social/social.integration.spec.ts[2m > [22m[2mSocial Integration[2m > [22m[2mEnd-to-end Social Flow[2m > [22m[2mshould synchronize WebSocket broadcasts with REST API actions
[22m[39mðŸ§¹ Cleaning up after test...

[90mstdout[2m | src/modules/social/social.integration.spec.ts[2m > [22m[2mSocial Integration[2m > [22m[2mEnd-to-end Social Flow[2m > [22m[2mshould handle challenge progression and cross-service rewards
[22m[39mðŸ§¹ Cleaning up after test...

 [32mâœ“[39m src/modules/social/social.integration.spec.ts[2m > [22mSocial Integration[2m > [22mEnd-to-end Social Flow[2m > [22mshould handle full cycle: join group -> welcome post -> leaderboard nudge -> notification
 [32mâœ“[39m src/modules/social/social.integration.spec.ts[2m > [22mSocial Integration[2m > [22mEnd-to-end Social Flow[2m > [22mshould synchronize WebSocket broadcasts with REST API actions
 [32mâœ“[39m src/modules/social/social.integration.spec.ts[2m > [22mSocial Integration[2m > [22mEnd-to-end Social Flow[2m > [22mshould handle challenge progression and cross-service rewards
 [32mâœ“[39m src/modules/social/social.integration.spec.ts[2m > [22mSocial Integration[2m > [22mWebSocket + Service Interactions[2m > [22mshould handle group streak updates and conditional nudging
[90mstdout[2m | src/modules/social/social.integration.spec.ts[2m > [22m[2mSocial Integration[2m > [22m[2mWebSocket + Service Interactions[2m > [22m[2mshould handle group streak updates and conditional nudging
[22m[39mðŸ§¹ Cleaning up after test...

[90mstdout[2m | src/modules/social/social.integration.spec.ts
[22m[39mðŸ”§ Vitest setup: Starting MSW mock server...
âœ… Vitest teardown complete

[90mstdout[2m | src/behavior/investment-profile.service.spec.ts[2m > [22m[2mInvestmentProfileService (Pure Unit Test)[2m > [22m[2mshould analyze behavior and sync profile
[22m[39mðŸ§¹ Cleaning up after test...

[90mstdout[2m | src/behavior/investment-profile.service.spec.ts[2m > [22m[2mInvestmentProfileService (Pure Unit Test)[2m > [22m[2mRisk score calculation[2m > [22m[2mshould calculate risk score from high-risk behavior logs
[22m[39mðŸ§¹ Cleaning up after test...

[90mstdout[2m | src/behavior/investment-profile.service.spec.ts[2m > [22m[2mInvestmentProfileService (Pure Unit Test)[2m > [22m[2mRisk score calculation[2m > [22m[2mshould calculate risk score from conservative behavior
[22m[39mðŸ§¹ Cleaning up after test...

[90mstdout[2m | src/behavior/investment-profile.service.spec.ts[2m > [22m[2mInvestmentProfileService (Pure Unit Test)[2m > [22m[2mKnowledge level assessment[2m > [22m[2mshould set knowledge to BEGINNER for new user with few lessons
[22m[39mðŸ§¹ Cleaning up after test...

[90mstdout[2m | src/behavior/investment-profile.service.spec.ts[2m > [22m[2mInvestmentProfileService (Pure Unit Test)[2m > [22m[2mKnowledge level assessment[2m > [22m[2mshould assess knowledge from completed lessons count
[22m[39mðŸ§¹ Cleaning up after test...

[90mstdout[2m | src/behavior/investment-profile.service.spec.ts[2m > [22m[2mInvestmentProfileService (Pure Unit Test)[2m > [22m[2mProfile sync from behavior patterns[2m > [22m[2mshould sync profile with JSONB investment philosophy
[22m[39mðŸ§¹ Cleaning up after test...

[90mstdout[2m | src/behavior/investment-profile.service.spec.ts[2m > [22m[2mInvestmentProfileService (Pure Unit Test)[2m > [22m[2mProfile sync from behavior patterns[2m > [22m[2mshould create new profile if none exists
[22m[39mðŸ§¹ Cleaning up after test...

[90mstdout[2m | src/behavior/investment-profile.service.spec.ts[2m > [22m[2mInvestmentProfileService (Pure Unit Test)[2m > [22m[2mProfile sync from behavior patterns[2m > [22m[2mshould update existing profile with new analysis
[22m[39mðŸ§¹ Cleaning up after test...

[90mstdout[2m | src/behavior/investment-profile.service.spec.ts[2m > [22m[2mInvestmentProfileService (Pure Unit Test)[2m > [22m[2mProfile sync from behavior patterns[2m > [22m[2mshould include locale in AI prompt
[22m[39mðŸ§¹ Cleaning up after test...

[90mstdout[2m | src/behavior/investment-profile.service.spec.ts
[22m[39mðŸ”§ Vitest setup: Starting MSW mock server...
âœ… Vitest teardown complete

 [32mâœ“[39m src/behavior/investment-profile.service.spec.ts[2m > [22mInvestmentProfileService (Pure Unit Test)[2m > [22mshould analyze behavior and sync profile
 [32mâœ“[39m src/behavior/investment-profile.service.spec.ts[2m > [22mInvestmentProfileService (Pure Unit Test)[2m > [22mRisk score calculation[2m > [22mshould calculate risk score from high-risk behavior logs
 [32mâœ“[39m src/behavior/investment-profile.service.spec.ts[2m > [22mInvestmentProfileService (Pure Unit Test)[2m > [22mRisk score calculation[2m > [22mshould calculate risk score from conservative behavior
 [32mâœ“[39m src/behavior/investment-profile.service.spec.ts[2m > [22mInvestmentProfileService (Pure Unit Test)[2m > [22mKnowledge level assessment[2m > [22mshould set knowledge to BEGINNER for new user with few lessons
 [32mâœ“[39m src/behavior/investment-profile.service.spec.ts[2m > [22mInvestmentProfileService (Pure Unit Test)[2m > [22mKnowledge level assessment[2m > [22mshould assess knowledge from completed lessons count
 [32mâœ“[39m src/behavior/investment-profile.service.spec.ts[2m > [22mInvestmentProfileService (Pure Unit Test)[2m > [22mProfile sync from behavior patterns[2m > [22mshould sync profile with JSONB investment philosophy
 [32mâœ“[39m src/behavior/investment-profile.service.spec.ts[2m > [22mInvestmentProfileService (Pure Unit Test)[2m > [22mProfile sync from behavior patterns[2m > [22mshould create new profile if none exists
 [32mâœ“[39m src/behavior/investment-profile.service.spec.ts[2m > [22mInvestmentProfileService (Pure Unit Test)[2m > [22mProfile sync from behavior patterns[2m > [22mshould update existing profile with new analysis
 [32mâœ“[39m src/behavior/investment-profile.service.spec.ts[2m > [22mInvestmentProfileService (Pure Unit Test)[2m > [22mProfile sync from behavior patterns[2m > [22mshould include locale in AI prompt
[90mstdout[2m | test/social-ws.integration.spec.ts
[22m[39mðŸ”§ Vitest setup: Starting MSW mock server...

[90mstdout[2m | test/social-ws.integration.spec.ts[2m > [22m[2mSocial WebSocket Integration[2m > [22m[2mConnect WS â†’ Identify â†’ Broadcast â†’ Check via REST
[22m[39mClient connected: kZQ9StOBOFiATkynAAAC
Client connected: sXHDCGVxcz0BbKMUAAAD

[90mstdout[2m | test/social-ws.integration.spec.ts[2m > [22m[2mSocial WebSocket Integration[2m > [22m[2mConnect WS â†’ Identify â†’ Broadcast â†’ Check via REST
[22m[39mðŸ§¹ Cleaning up after test...

[90mstdout[2m | test/social-ws.integration.spec.ts[2m > [22m[2mSocial WebSocket Integration[2m > [22m[2mJoin group â†’ Post achievement â†’ Friends notified (WS)
[22m[39mClient disconnected: kZQ9StOBOFiATkynAAAC
Client disconnected: sXHDCGVxcz0BbKMUAAAD

 [32mâœ“[39m test/social-ws.integration.spec.ts[2m > [22mSocial WebSocket Integration[2m > [22mConnect WS â†’ Identify â†’ Broadcast â†’ Check via REST
[90mstdout[2m | test/social-ws.integration.spec.ts[2m > [22m[2mSocial WebSocket Integration[2m > [22m[2mJoin group â†’ Post achievement â†’ Friends notified (WS)
[22m[39mClient connected: h5X1cUku53mmi40wAAAF

[90mstdout[2m | test/social-ws.integration.spec.ts[2m > [22m[2mSocial WebSocket Integration[2m > [22m[2mJoin group â†’ Post achievement â†’ Friends notified (WS)
[22m[39mðŸ§¹ Cleaning up after test...

[90mstdout[2m | test/social-ws.integration.spec.ts[2m > [22m[2mSocial WebSocket Integration[2m > [22m[2mLeaderboard update via aggregation (Community Stats)
[22m[39mClient disconnected: h5X1cUku53mmi40wAAAF

[90mstdout[2m | test/social-ws.integration.spec.ts[2m > [22m[2mSocial WebSocket Integration[2m > [22m[2mLeaderboard update via aggregation (Community Stats)
[22m[39mðŸ§¹ Cleaning up after test...

 [32mâœ“[39m test/social-ws.integration.spec.ts[2m > [22mSocial WebSocket Integration[2m > [22mJoin group â†’ Post achievement â†’ Friends notified (WS)
 [32mâœ“[39m test/social-ws.integration.spec.ts[2m > [22mSocial WebSocket Integration[2m > [22mLeaderboard update via aggregation (Community Stats)
[90mstdout[2m | test/social-ws.integration.spec.ts[2m > [22m[2mSocial WebSocket Integration[2m > [22m[2mTest concurrent WebSocket connections
[22m[39mClient connected: f30qeyNlDdgn8lroAAAL
Client connected: aV5sUMVevoHc0zpfAAAM
Client connected: Jr7ZnSTkJeY_hoEJAAAN
Client connected: 1emghia6LfXeB5KWAAAO
Client connected: KibXTglZ_TX1kC_2AAAP
ðŸ§¹ Cleaning up after test...

[90mstdout[2m | test/social-ws.integration.spec.ts[2m > [22m[2mSocial WebSocket Integration
[22m[39mClient disconnected: f30qeyNlDdgn8lroAAAL
Client disconnected: aV5sUMVevoHc0zpfAAAM
Client disconnected: Jr7ZnSTkJeY_hoEJAAAN
Client disconnected: 1emghia6LfXeB5KWAAAO
Client disconnected: KibXTglZ_TX1kC_2AAAP

[90mstdout[2m | test/social-ws.integration.spec.ts
[22m[39mâœ… Vitest teardown complete

 [32mâœ“[39m test/social-ws.integration.spec.ts[2m > [22mSocial WebSocket Integration[2m > [22mTest concurrent WebSocket connections
[90mstdout[2m | src/common/validation.service.spec.ts[2m > [22m[2mValidationService[2m > [22m[2mvalidate[2m > [22m[2mshould validate correct BEHAVIOR_LOG_PAYLOAD
[22m[39mðŸ§¹ Cleaning up after test...

[90mstdout[2m | src/common/validation.service.spec.ts[2m > [22m[2mValidationService[2m > [22m[2mvalidate[2m > [22m[2mshould validate minimal BEHAVIOR_LOG_PAYLOAD
[22m[39mðŸ§¹ Cleaning up after test...

[90mstdout[2m | src/common/validation.service.spec.ts[2m > [22m[2mValidationService[2m > [22m[2mvalidate[2m > [22m[2mshould validate correct I18N_TEXT with all locales
[22m[39mðŸ§¹ Cleaning up after test...

[90mstdout[2m | src/common/validation.service.spec.ts[2m > [22m[2mValidationService[2m > [22m[2mvalidate[2m > [22m[2mshould reject I18N_TEXT missing required locale
[22m[39mðŸ§¹ Cleaning up after test...

[90mstdout[2m | src/common/validation.service.spec.ts[2m > [22m[2mValidationService[2m > [22m[2mvalidate[2m > [22m[2mshould validate USER_METADATA with optional fields
[22m[39mðŸ§¹ Cleaning up after test...

[90mstdout[2m | src/common/validation.service.spec.ts[2m > [22m[2mValidationService[2m > [22m[2mvalidate[2m > [22m[2mshould reject USER_METADATA with invalid URL
[22m[39mðŸ§¹ Cleaning up after test...

[90mstdout[2m | src/common/validation.service.spec.ts[2m > [22m[2mValidationService[2m > [22m[2mvalidate[2m > [22m[2mshould validate SOCIAL_POST_CONTENT
[22m[39mðŸ§¹ Cleaning up after test...

[90mstdout[2m | src/common/validation.service.spec.ts[2m > [22m[2mValidationService[2m > [22m[2mvalidate[2m > [22m[2mshould validate SIMULATION_EVENT with nested options
[22m[39mðŸ§¹ Cleaning up after test...

[90mstdout[2m | src/common/validation.service.spec.ts[2m > [22m[2mValidationService[2m > [22m[2mvalidate[2m > [22m[2mshould reject SIMULATION_EVENT with missing required fields
[22m[39mðŸ§¹ Cleaning up after test...

[90mstdout[2m | src/common/validation.service.spec.ts[2m > [22m[2mValidationService[2m > [22m[2mvalidate[2m > [22m[2mshould validate INVESTMENT_PHILOSOPHY
[22m[39mðŸ§¹ Cleaning up after test...

[90mstdout[2m | src/common/validation.service.spec.ts[2m > [22m[2mValidationService[2m > [22m[2mvalidate[2m > [22m[2mshould reject INVESTMENT_PHILOSOPHY with invalid enum
[22m[39mðŸ§¹ Cleaning up after test...

[90mstdout[2m | src/common/validation.service.spec.ts[2m > [22m[2mValidationService[2m > [22m[2mvalidate[2m > [22m[2mshould validate FINANCIAL_GOALS array
[22m[39mðŸ§¹ Cleaning up after test...

[90mstdout[2m | src/common/validation.service.spec.ts[2m > [22m[2mValidationService[2m > [22m[2mvalidate[2m > [22m[2mshould validate CHECKLIST_ITEMS
[22m[39mðŸ§¹ Cleaning up after test...

[90mstdout[2m | src/common/validation.service.spec.ts[2m > [22m[2mValidationService[2m > [22m[2mvalidate[2m > [22m[2mshould validate PORTFOLIO_ASSETS with mixed types
[22m[39mðŸ§¹ Cleaning up after test...

[90mstdout[2m | src/common/validation.service.spec.ts[2m > [22m[2mValidationService[2m > [22m[2mvalidate[2m > [22m[2mshould validate SIMULATION_STATUS with optional fields
[22m[39mðŸ§¹ Cleaning up after test...

[90mstdout[2m | src/common/validation.service.spec.ts[2m > [22m[2mValidationService[2m > [22m[2mvalidate[2m > [22m[2mshould validate COURSE_RECOMMENDATION with i18n reason
[22m[39mðŸ§¹ Cleaning up after test...

[90mstdout[2m | src/common/validation.service.spec.ts[2m > [22m[2mValidationService[2m > [22m[2mvalidate[2m > [22m[2mshould validate CHAT_MESSAGE_METADATA
[22m[39mðŸ§¹ Cleaning up after test...

[90mstdout[2m | src/common/validation.service.spec.ts[2m > [22m[2mValidationService[2m > [22m[2mvalidate[2m > [22m[2mshould throw error for validation failure
[22m[39mðŸ§¹ Cleaning up after test...

[90mstdout[2m | src/common/validation.service.spec.ts[2m > [22m[2mValidationService[2m > [22m[2mvalidate[2m > [22m[2mshould throw error for undefined schema key
[22m[39mðŸ§¹ Cleaning up after test...

[90mstdout[2m | src/common/validation.service.spec.ts[2m > [22m[2mValidationService[2m > [22m[2mvalidate[2m > [22m[2mshould validate empty BEHAVIOR_LOG_PAYLOAD as valid
[22m[39mðŸ§¹ Cleaning up after test...

[90mstdout[2m | src/common/validation.service.spec.ts[2m > [22m[2mValidationService[2m > [22m[2mvalidate[2m > [22m[2mshould validate SIMULATION_DECISIONS with multiple decision types
[22m[39mðŸ§¹ Cleaning up after test...

 [32mâœ“[39m src/common/validation.service.spec.ts[2m > [22mValidationService[2m > [22mvalidate[2m > [22mshould validate correct BEHAVIOR_LOG_PAYLOAD
 [32mâœ“[39m src/common/validation.service.spec.ts[2m > [22mValidationService[2m > [22mvalidate[2m > [22mshould validate minimal BEHAVIOR_LOG_PAYLOAD
 [32mâœ“[39m src/common/validation.service.spec.ts[2m > [22mValidationService[2m > [22mvalidate[2m > [22mshould validate correct I18N_TEXT with all locales
 [32mâœ“[39m src/common/validation.service.spec.ts[2m > [22mValidationService[2m > [22mvalidate[2m > [22mshould reject I18N_TEXT missing required locale
 [32mâœ“[39m src/common/validation.service.spec.ts[2m > [22mValidationService[2m > [22mvalidate[2m > [22mshould validate USER_METADATA with optional fields
 [32mâœ“[39m src/common/validation.service.spec.ts[2m > [22mValidationService[2m > [22mvalidate[2m > [22mshould reject USER_METADATA with invalid URL
 [32mâœ“[39m src/common/validation.service.spec.ts[2m > [22mValidationService[2m > [22mvalidate[2m > [22mshould validate SOCIAL_POST_CONTENT
 [32mâœ“[39m src/common/validation.service.spec.ts[2m > [22mValidationService[2m > [22mvalidate[2m > [22mshould validate SIMULATION_EVENT with nested options
 [32mâœ“[39m src/common/validation.service.spec.ts[2m > [22mValidationService[2m > [22mvalidate[2m > [22mshould reject SIMULATION_EVENT with missing required fields
 [32mâœ“[39m src/common/validation.service.spec.ts[2m > [22mValidationService[2m > [22mvalidate[2m > [22mshould validate INVESTMENT_PHILOSOPHY
 [32mâœ“[39m src/common/validation.service.spec.ts[2m > [22mValidationService[2m > [22mvalidate[2m > [22mshould reject INVESTMENT_PHILOSOPHY with invalid enum
 [32mâœ“[39m src/common/validation.service.spec.ts[2m > [22mValidationService[2m > [22mvalidate[2m > [22mshould validate FINANCIAL_GOALS array
 [32mâœ“[39m src/common/validation.service.spec.ts[2m > [22mValidationService[2m > [22mvalidate[2m > [22mshould validate CHECKLIST_ITEMS
 [32mâœ“[39m src/common/validation.service.spec.ts[2m > [22mValidationService[2m > [22mvalidate[2m > [22mshould validate PORTFOLIO_ASSETS with mixed types
 [32mâœ“[39m src/common/validation.service.spec.ts[2m > [22mValidationService[2m > [22mvalidate[2m > [22mshould validate SIMULATION_STATUS with optional fields
 [32mâœ“[39m src/common/validation.service.spec.ts[2m > [22mValidationService[2m > [22mvalidate[2m > [22mshould validate COURSE_RECOMMENDATION with i18n reason
 [32mâœ“[39m src/common/validation.service.spec.ts[2m > [22mValidationService[2m > [22mvalidate[2m > [22mshould validate CHAT_MESSAGE_METADATA
 [32mâœ“[39m src/common/validation.service.spec.ts[2m > [22mValidationService[2m > [22mvalidate[2m > [22mshould throw error for validation failure
 [32mâœ“[39m src/common/validation.service.spec.ts[2m > [22mValidationService[2m > [22mvalidate[2m > [22mshould throw error for undefined schema key
 [32mâœ“[39m src/common/validation.service.spec.ts[2m > [22mValidationService[2m > [22mvalidate[2m > [22mshould validate empty BEHAVIOR_LOG_PAYLOAD as valid
 [32mâœ“[39m src/common/validation.service.spec.ts[2m > [22mValidationService[2m > [22mvalidate[2m > [22mshould validate SIMULATION_DECISIONS with multiple decision types
 [32mâœ“[39m src/common/validation.service.spec.ts[2m > [22mValidationService[2m > [22mvalidate[2m > [22mshould handle passthrough fields in INVESTMENT_PHILOSOPHY
[90mstdout[2m | src/common/validation.service.spec.ts[2m > [22m[2mValidationService[2m > [22m[2mvalidate[2m > [22m[2mshould handle passthrough fields in INVESTMENT_PHILOSOPHY
[22m[39mðŸ§¹ Cleaning up after test...

[90mstdout[2m | src/common/validation.service.spec.ts
[22m[39mðŸ”§ Vitest setup: Starting MSW mock server...
âœ… Vitest teardown complete

[90mstdout[2m | test/gamification-nudge.e2e-spec.ts[2m > [22m[2mGamification & Nudge System (Integration)[2m > [22m[2mUser Inactivity & Streak Nudge[2m > [22m[2mshould trigger a nudge when user is inactive for 20-24 hours
[22m[39mðŸ§¹ Cleaning up after test...

[90mstdout[2m | test/gamification-nudge.e2e-spec.ts[2m > [22m[2mGamification & Nudge System (Integration)[2m > [22m[2mUser Inactivity & Streak Nudge[2m > [22m[2mshould preserve streak logic via LossAversionService
[22m[39mðŸ§¹ Cleaning up after test...

[90mstdout[2m | test/gamification-nudge.e2e-spec.ts[2m > [22m[2mGamification & Nudge System (Integration)[2m > [22m[2mSocial Proof Nudge Generation[2m > [22m[2mshould generate social proof based on cohort behavior
[22m[39mðŸ§¹ Cleaning up after test...

[90mstdout[2m | test/gamification-nudge.e2e-spec.ts[2m > [22m[2mGamification & Nudge System (Integration)[2m > [22m[2mSocial Proof Nudge Generation[2m > [22m[2mshould verify realtime activity social proof
[22m[39mðŸ§¹ Cleaning up after test...

 [32mâœ“[39m test/gamification-nudge.e2e-spec.ts[2m > [22mGamification & Nudge System (Integration)[2m > [22mUser Inactivity & Streak Nudge[2m > [22mshould trigger a nudge when user is inactive for 20-24 hours
 [32mâœ“[39m test/gamification-nudge.e2e-spec.ts[2m > [22mGamification & Nudge System (Integration)[2m > [22mUser Inactivity & Streak Nudge[2m > [22mshould preserve streak logic via LossAversionService
 [32mâœ“[39m test/gamification-nudge.e2e-spec.ts[2m > [22mGamification & Nudge System (Integration)[2m > [22mSocial Proof Nudge Generation[2m > [22mshould generate social proof based on cohort behavior
 [32mâœ“[39m test/gamification-nudge.e2e-spec.ts[2m > [22mGamification & Nudge System (Integration)[2m > [22mSocial Proof Nudge Generation[2m > [22mshould verify realtime activity social proof
 [32mâœ“[39m test/gamification-nudge.e2e-spec.ts[2m > [22mGamification & Nudge System (Integration)[2m > [22mVariable Rewards & Adaptive Adjustment[2m > [22mshould simulate reward distribution/adjustment based on performance
[90mstdout[2m | test/gamification-nudge.e2e-spec.ts[2m > [22m[2mGamification & Nudge System (Integration)[2m > [22m[2mVariable Rewards & Adaptive Adjustment[2m > [22m[2mshould simulate reward distribution/adjustment based on performance
[22m[39mðŸ§¹ Cleaning up after test...

[90mstdout[2m | test/gamification-nudge.e2e-spec.ts
[22m[39mðŸ”§ Vitest setup: Starting MSW mock server...
âœ… Vitest teardown complete

[90mstdout[2m | src/prisma/prisma.service.spec.ts[2m > [22m[2mPrismaService[2m > [22m[2monModuleInit[2m > [22m[2mshould connect to database on module init
[22m[39mðŸ§¹ Cleaning up after test...

[90mstdout[2m | src/prisma/prisma.service.spec.ts[2m > [22m[2mPrismaService[2m > [22m[2monModuleInit[2m > [22m[2mshould handle connection failure gracefully
[22m[39mðŸ§¹ Cleaning up after test...

[90mstdout[2m | src/prisma/prisma.service.spec.ts[2m > [22m[2mPrismaService[2m > [22m[2monModuleInit[2m > [22m[2mshould not throw error when database is unavailable
[22m[39mðŸ§¹ Cleaning up after test...

[90mstdout[2m | src/prisma/prisma.service.spec.ts[2m > [22m[2mPrismaService[2m > [22m[2monModuleDestroy[2m > [22m[2mshould disconnect from database on module destroy
[22m[39mðŸ§¹ Cleaning up after test...

[90mstdout[2m | src/prisma/prisma.service.spec.ts[2m > [22m[2mPrismaService[2m > [22m[2monModuleDestroy[2m > [22m[2mshould handle disconnection errors
[22m[39mðŸ§¹ Cleaning up after test...

[90mstdout[2m | src/prisma/prisma.service.spec.ts[2m > [22m[2mPrismaService[2m > [22m[2mtransaction handling[2m > [22m[2mshould support Prisma transactions
[22m[39mðŸ§¹ Cleaning up after test...

[90mstdout[2m | src/prisma/prisma.service.spec.ts[2m > [22m[2mPrismaService[2m > [22m[2mtransaction handling[2m > [22m[2mshould rollback transaction on error
[22m[39mðŸ§¹ Cleaning up after test...

[90mstdout[2m | src/prisma/prisma.service.spec.ts[2m > [22m[2mPrismaService[2m > [22m[2mtransaction handling[2m > [22m[2mshould support sequential operations in transaction
[22m[39mðŸ§¹ Cleaning up after test...

[90mstdout[2m | src/prisma/prisma.service.spec.ts[2m > [22m[2mPrismaService[2m > [22m[2merror handling[2m > [22m[2mshould handle unique constraint violation
[22m[39mðŸ§¹ Cleaning up after test...

[90mstdout[2m | src/prisma/prisma.service.spec.ts[2m > [22m[2mPrismaService[2m > [22m[2merror handling[2m > [22m[2mshould handle foreign key constraint violation
[22m[39mðŸ§¹ Cleaning up after test...

[90mstdout[2m | src/prisma/prisma.service.spec.ts[2m > [22m[2mPrismaService[2m > [22m[2merror handling[2m > [22m[2mshould handle record not found
[22m[39mðŸ§¹ Cleaning up after test...

[90mstdout[2m | src/prisma/prisma.service.spec.ts[2m > [22m[2mPrismaService[2m > [22m[2mconnection lifecycle[2m > [22m[2mshould allow reconnection after disconnect
[22m[39mðŸ§¹ Cleaning up after test...

[90mstdout[2m | src/prisma/prisma.service.spec.ts[2m > [22m[2mPrismaService[2m > [22m[2mconnection lifecycle[2m > [22m[2mshould be singleton across module
[22m[39mðŸ§¹ Cleaning up after test...

[90mstdout[2m | src/prisma/prisma.service.spec.ts[2m > [22m[2mPrismaService[2m > [22m[2mquery operations[2m > [22m[2mshould support findMany queries
[22m[39mðŸ§¹ Cleaning up after test...

[90mstdout[2m | src/prisma/prisma.service.spec.ts[2m > [22m[2mPrismaService[2m > [22m[2mquery operations[2m > [22m[2mshould support findUnique queries
[22m[39mðŸ§¹ Cleaning up after test...

[90mstdout[2m | src/prisma/prisma.service.spec.ts[2m > [22m[2mPrismaService[2m > [22m[2mquery operations[2m > [22m[2mshould support create operations
[22m[39mðŸ§¹ Cleaning up after test...

[90mstdout[2m | src/prisma/prisma.service.spec.ts[2m > [22m[2mPrismaService[2m > [22m[2mquery operations[2m > [22m[2mshould support update operations
[22m[39mðŸ§¹ Cleaning up after test...

[90mstdout[2m | src/prisma/prisma.service.spec.ts[2m > [22m[2mPrismaService[2m > [22m[2mquery operations[2m > [22m[2mshould support delete operations
[22m[39mðŸ§¹ Cleaning up after test...

 [32mâœ“[39m src/prisma/prisma.service.spec.ts[2m > [22mPrismaService[2m > [22monModuleInit[2m > [22mshould connect to database on module init
 [32mâœ“[39m src/prisma/prisma.service.spec.ts[2m > [22mPrismaService[2m > [22monModuleInit[2m > [22mshould handle connection failure gracefully
 [32mâœ“[39m src/prisma/prisma.service.spec.ts[2m > [22mPrismaService[2m > [22monModuleInit[2m > [22mshould not throw error when database is unavailable
 [32mâœ“[39m src/prisma/prisma.service.spec.ts[2m > [22mPrismaService[2m > [22monModuleDestroy[2m > [22mshould disconnect from database on module destroy
 [32mâœ“[39m src/prisma/prisma.service.spec.ts[2m > [22mPrismaService[2m > [22monModuleDestroy[2m > [22mshould handle disconnection errors
 [32mâœ“[39m src/prisma/prisma.service.spec.ts[2m > [22mPrismaService[2m > [22mtransaction handling[2m > [22mshould support Prisma transactions
 [32mâœ“[39m src/prisma/prisma.service.spec.ts[2m > [22mPrismaService[2m > [22mtransaction handling[2m > [22mshould rollback transaction on error
 [32mâœ“[39m src/prisma/prisma.service.spec.ts[2m > [22mPrismaService[2m > [22mtransaction handling[2m > [22mshould support sequential operations in transaction
 [32mâœ“[39m src/prisma/prisma.service.spec.ts[2m > [22mPrismaService[2m > [22merror handling[2m > [22mshould handle unique constraint violation
 [32mâœ“[39m src/prisma/prisma.service.spec.ts[2m > [22mPrismaService[2m > [22merror handling[2m > [22mshould handle foreign key constraint violation
 [32mâœ“[39m src/prisma/prisma.service.spec.ts[2m > [22mPrismaService[2m > [22merror handling[2m > [22mshould handle record not found
 [32mâœ“[39m src/prisma/prisma.service.spec.ts[2m > [22mPrismaService[2m > [22mconnection lifecycle[2m > [22mshould allow reconnection after disconnect
 [32mâœ“[39m src/prisma/prisma.service.spec.ts[2m > [22mPrismaService[2m > [22mconnection lifecycle[2m > [22mshould be singleton across module
 [32mâœ“[39m src/prisma/prisma.service.spec.ts[2m > [22mPrismaService[2m > [22mquery operations[2m > [22mshould support findMany queries
 [32mâœ“[39m src/prisma/prisma.service.spec.ts[2m > [22mPrismaService[2m > [22mquery operations[2m > [22mshould support findUnique queries
 [32mâœ“[39m src/prisma/prisma.service.spec.ts[2m > [22mPrismaService[2m > [22mquery operations[2m > [22mshould support create operations
 [32mâœ“[39m src/prisma/prisma.service.spec.ts[2m > [22mPrismaService[2m > [22mquery operations[2m > [22mshould support update operations
 [32mâœ“[39m src/prisma/prisma.service.spec.ts[2m > [22mPrismaService[2m > [22mquery operations[2m > [22mshould support delete operations
[90mstdout[2m | src/prisma/prisma.service.spec.ts
[22m[39mðŸ”§ Vitest setup: Starting MSW mock server...
âœ… Vitest teardown complete

 [2m[90mâ†“[39m[22m test/integration/ai-course-flow.e2e-spec.ts[2m > [22mAI & Course Integration (e2e)[2m > [22mAI Module[2m > [22mshould create a chat thread
 [2m[90mâ†“[39m[22m test/integration/ai-course-flow.e2e-spec.ts[2m > [22mAI & Course Integration (e2e)[2m > [22mAI Module[2m > [22mshould fail to generate response without thread
 [2m[90mâ†“[39m[22m test/integration/ai-course-flow.e2e-spec.ts[2m > [22mAI & Course Integration (e2e)[2m > [22mCourse Module[2m > [22mshould return all courses
 [2m[90mâ†“[39m[22m test/integration/ai-course-flow.e2e-spec.ts[2m > [22mAI & Course Integration (e2e)[2m > [22mCourse Module[2m > [22mshould update lesson progress
[90mstdout[2m | test/integration/ai-course-flow.e2e-spec.ts
[22m[39mðŸ”§ Vitest setup: Starting MSW mock server...
âœ… Vitest teardown complete

[90mstdout[2m | src/storage/unstorage.service.spec.ts
[22m[39mðŸ”§ Vitest setup: Starting MSW mock server...

[90mstdout[2m | src/storage/unstorage.service.spec.ts[2m > [22m[2mUnstorageService[2m > [22m[2mshould be defined
[22m[39mðŸ§¹ Cleaning up after test...

[90mstdout[2m | src/storage/unstorage.service.spec.ts[2m > [22m[2mUnstorageService[2m > [22m[2mFile Operations[2m > [22m[2mshould upload file successfully
[22m[39mðŸ§¹ Cleaning up after test...

[90mstdout[2m | src/storage/unstorage.service.spec.ts[2m > [22m[2mUnstorageService[2m > [22m[2mFile Operations[2m > [22m[2mshould download file successfully
[22m[39mðŸ§¹ Cleaning up after test...

[90mstdout[2m | src/storage/unstorage.service.spec.ts[2m > [22m[2mUnstorageService[2m > [22m[2mFile Operations[2m > [22m[2mshould throw error when downloading non-existent file
[22m[39mðŸ§¹ Cleaning up after test...

[90mstdout[2m | src/storage/unstorage.service.spec.ts[2m > [22m[2mUnstorageService[2m > [22m[2mFile Operations[2m > [22m[2mshould delete file successfully
[22m[39mðŸ§¹ Cleaning up after test...

[90mstdout[2m | src/storage/unstorage.service.spec.ts[2m > [22m[2mUnstorageService[2m > [22m[2mFile Operations[2m > [22m[2mshould check file existence
[22m[39mðŸ§¹ Cleaning up after test...

[90mstdout[2m | src/storage/unstorage.service.spec.ts[2m > [22m[2mUnstorageService[2m > [22m[2mFile Operations[2m > [22m[2mshould return false when file existence check fails
[22m[39mðŸ§¹ Cleaning up after test...

[90mstdout[2m | src/storage/unstorage.service.spec.ts[2m > [22m[2mUnstorageService[2m > [22m[2mList Operations[2m > [22m[2mshould list files with prefix
[22m[39mðŸ§¹ Cleaning up after test...

[90mstdout[2m | src/storage/unstorage.service.spec.ts[2m > [22m[2mUnstorageService[2m > [22m[2mList Operations[2m > [22m[2mshould list all files when no prefix provided
[22m[39mðŸ§¹ Cleaning up after test...

[90mstdout[2m | src/storage/unstorage.service.spec.ts[2m > [22m[2mUnstorageService[2m > [22m[2mList Operations[2m > [22m[2mshould throw error when listing fails
[22m[39mðŸ§¹ Cleaning up after test...

[90mstdout[2m | src/storage/unstorage.service.spec.ts[2m > [22m[2mUnstorageService[2m > [22m[2mPublic URL Generation[2m > [22m[2mshould generate public URL for fs driver
[22m[39mðŸ§¹ Cleaning up after test...

[90mstdout[2m | src/storage/unstorage.service.spec.ts[2m > [22m[2mUnstorageService[2m > [22m[2mPublic URL Generation[2m > [22m[2mshould generate public URL for gcs driver
[22m[39mðŸ§¹ Cleaning up after test...

[90mstdout[2m | src/storage/unstorage.service.spec.ts[2m > [22m[2mUnstorageService[2m > [22m[2mPublic URL Generation[2m > [22m[2mshould generate public URL for r2 driver
[22m[39mðŸ§¹ Cleaning up after test...

[90mstdout[2m | src/storage/unstorage.service.spec.ts[2m > [22m[2mUnstorageService[2m > [22m[2mPresigned URLs[2m > [22m[2mshould return presigned upload URL placeholder
[22m[39mðŸ§¹ Cleaning up after test...

[90mstdout[2m | src/storage/unstorage.service.spec.ts[2m > [22m[2mUnstorageService[2m > [22m[2mPresigned URLs[2m > [22m[2mshould use default expiration time
[22m[39mðŸ§¹ Cleaning up after test...

[90mstdout[2m | src/storage/unstorage.service.spec.ts[2m > [22m[2mUnstorageService[2m > [22m[2mError Handling[2m > [22m[2mshould handle upload failure
[22m[39mðŸ§¹ Cleaning up after test...

[90mstdout[2m | src/storage/unstorage.service.spec.ts[2m > [22m[2mUnstorageService[2m > [22m[2mError Handling[2m > [22m[2mshould handle download failure
[22m[39mðŸ§¹ Cleaning up after test...

[90mstdout[2m | src/storage/unstorage.service.spec.ts[2m > [22m[2mUnstorageService[2m > [22m[2mError Handling[2m > [22m[2mshould handle delete failure
[22m[39mðŸ§¹ Cleaning up after test...

[90mstdout[2m | src/storage/unstorage.service.spec.ts[2m > [22m[2mUnstorageService[2m > [22m[2mDriver Initialization[2m > [22m[2mshould initialize with fs driver by default
[22m[39mðŸ§¹ Cleaning up after test...

 [32mâœ“[39m src/storage/unstorage.service.spec.ts[2m > [22mUnstorageService[2m > [22mshould be defined
 [32mâœ“[39m src/storage/unstorage.service.spec.ts[2m > [22mUnstorageService[2m > [22mFile Operations[2m > [22mshould upload file successfully
 [32mâœ“[39m src/storage/unstorage.service.spec.ts[2m > [22mUnstorageService[2m > [22mFile Operations[2m > [22mshould download file successfully
 [32mâœ“[39m src/storage/unstorage.service.spec.ts[2m > [22mUnstorageService[2m > [22mFile Operations[2m > [22mshould throw error when downloading non-existent file
 [32mâœ“[39m src/storage/unstorage.service.spec.ts[2m > [22mUnstorageService[2m > [22mFile Operations[2m > [22mshould delete file successfully
 [32mâœ“[39m src/storage/unstorage.service.spec.ts[2m > [22mUnstorageService[2m > [22mFile Operations[2m > [22mshould check file existence
 [32mâœ“[39m src/storage/unstorage.service.spec.ts[2m > [22mUnstorageService[2m > [22mFile Operations[2m > [22mshould return false when file existence check fails
 [32mâœ“[39m src/storage/unstorage.service.spec.ts[2m > [22mUnstorageService[2m > [22mList Operations[2m > [22mshould list files with prefix
 [32mâœ“[39m src/storage/unstorage.service.spec.ts[2m > [22mUnstorageService[2m > [22mList Operations[2m > [22mshould list all files when no prefix provided
 [32mâœ“[39m src/storage/unstorage.service.spec.ts[2m > [22mUnstorageService[2m > [22mList Operations[2m > [22mshould throw error when listing fails
 [32mâœ“[39m src/storage/unstorage.service.spec.ts[2m > [22mUnstorageService[2m > [22mPublic URL Generation[2m > [22mshould generate public URL for fs driver
 [32mâœ“[39m src/storage/unstorage.service.spec.ts[2m > [22mUnstorageService[2m > [22mPublic URL Generation[2m > [22mshould generate public URL for gcs driver
 [32mâœ“[39m src/storage/unstorage.service.spec.ts[2m > [22mUnstorageService[2m > [22mPublic URL Generation[2m > [22mshould generate public URL for r2 driver
 [32mâœ“[39m src/storage/unstorage.service.spec.ts[2m > [22mUnstorageService[2m > [22mPresigned URLs[2m > [22mshould return presigned upload URL placeholder
 [32mâœ“[39m src/storage/unstorage.service.spec.ts[2m > [22mUnstorageService[2m > [22mPresigned URLs[2m > [22mshould use default expiration time
 [32mâœ“[39m src/storage/unstorage.service.spec.ts[2m > [22mUnstorageService[2m > [22mError Handling[2m > [22mshould handle upload failure
 [32mâœ“[39m src/storage/unstorage.service.spec.ts[2m > [22mUnstorageService[2m > [22mError Handling[2m > [22mshould handle download failure
 [32mâœ“[39m src/storage/unstorage.service.spec.ts[2m > [22mUnstorageService[2m > [22mError Handling[2m > [22mshould handle delete failure
 [32mâœ“[39m src/storage/unstorage.service.spec.ts[2m > [22mUnstorageService[2m > [22mDriver Initialization[2m > [22mshould initialize with fs driver by default
 [32mâœ“[39m src/storage/unstorage.service.spec.ts[2m > [22mUnstorageService[2m > [22mDriver Initialization[2m > [22mshould throw error for unsupported driver
[90mstdout[2m | src/storage/unstorage.service.spec.ts[2m > [22m[2mUnstorageService[2m > [22m[2mDriver Initialization[2m > [22m[2mshould throw error for unsupported driver
[22m[39mðŸ§¹ Cleaning up after test...

[90mstdout[2m | src/storage/unstorage.service.spec.ts
[22m[39mâœ… Vitest teardown complete

[90mstdout[2m | src/behavior/streak.service.spec.ts[2m > [22m[2mStreakService[2m > [22m[2mupdateStreak[2m > [22m[2mshould initialize streak if it does not exist
[22m[39mðŸ§¹ Cleaning up after test...

[90mstdout[2m | src/behavior/streak.service.spec.ts[2m > [22m[2mStreakService[2m > [22m[2mupdateStreak[2m > [22m[2mshould increment streak if last activity was yesterday
[22m[39mðŸ§¹ Cleaning up after test...

[90mstdout[2m | src/behavior/streak.service.spec.ts[2m > [22m[2mStreakService[2m > [22m[2mupdateStreak[2m > [22m[2mshould reward points for 7-day milestone
[22m[39mðŸ§¹ Cleaning up after test...

[90mstdout[2m | src/behavior/streak.service.spec.ts[2m > [22m[2mStreakService[2m > [22m[2mupdateStreak[2m > [22m[2mshould use freeze if streak is broken but freezes are available
[22m[39mðŸ§¹ Cleaning up after test...

[90mstdout[2m | src/behavior/streak.service.spec.ts[2m > [22m[2mStreakService[2m > [22m[2mupdateStreak[2m > [22m[2mshould reset streak if broken and no freezes remaining
[22m[39mðŸ§¹ Cleaning up after test...

[90mstdout[2m | src/behavior/streak.service.spec.ts[2m > [22m[2mStreakService[2m > [22m[2mupdateStreak[2m > [22m[2mshould not update if user already active today
[22m[39mðŸ§¹ Cleaning up after test...

[90mstdout[2m | src/behavior/streak.service.spec.ts[2m > [22m[2mStreakService[2m > [22m[2mupdateStreak[2m > [22m[2mshould update longest streak when current exceeds it
[22m[39mðŸ§¹ Cleaning up after test...

[90mstdout[2m | src/behavior/streak.service.spec.ts[2m > [22m[2mStreakService[2m > [22m[2mupdateStreak[2m > [22m[2mshould unfreeze streak when user becomes active
[22m[39mðŸ§¹ Cleaning up after test...

[90mstdout[2m | src/behavior/streak.service.spec.ts[2m > [22m[2mStreakService[2m > [22m[2mupdateStreak[2m > [22m[2mshould reward for multiple of 7 days (14, 21, etc)
[22m[39mðŸ§¹ Cleaning up after test...

[90mstdout[2m | src/behavior/streak.service.spec.ts[2m > [22m[2mStreakService[2m > [22m[2mgetStreak[2m > [22m[2mshould return user streak
[22m[39mðŸ§¹ Cleaning up after test...

 [32mâœ“[39m src/behavior/streak.service.spec.ts[2m > [22mStreakService[2m > [22mupdateStreak[2m > [22mshould initialize streak if it does not exist
 [32mâœ“[39m src/behavior/streak.service.spec.ts[2m > [22mStreakService[2m > [22mupdateStreak[2m > [22mshould increment streak if last activity was yesterday
 [32mâœ“[39m src/behavior/streak.service.spec.ts[2m > [22mStreakService[2m > [22mupdateStreak[2m > [22mshould reward points for 7-day milestone
 [32mâœ“[39m src/behavior/streak.service.spec.ts[2m > [22mStreakService[2m > [22mupdateStreak[2m > [22mshould use freeze if streak is broken but freezes are available
 [32mâœ“[39m src/behavior/streak.service.spec.ts[2m > [22mStreakService[2m > [22mupdateStreak[2m > [22mshould reset streak if broken and no freezes remaining
 [32mâœ“[39m src/behavior/streak.service.spec.ts[2m > [22mStreakService[2m > [22mupdateStreak[2m > [22mshould not update if user already active today
 [32mâœ“[39m src/behavior/streak.service.spec.ts[2m > [22mStreakService[2m > [22mupdateStreak[2m > [22mshould update longest streak when current exceeds it
 [32mâœ“[39m src/behavior/streak.service.spec.ts[2m > [22mStreakService[2m > [22mupdateStreak[2m > [22mshould unfreeze streak when user becomes active
 [32mâœ“[39m src/behavior/streak.service.spec.ts[2m > [22mStreakService[2m > [22mupdateStreak[2m > [22mshould reward for multiple of 7 days (14, 21, etc)
 [32mâœ“[39m src/behavior/streak.service.spec.ts[2m > [22mStreakService[2m > [22mgetStreak[2m > [22mshould return user streak
 [32mâœ“[39m src/behavior/streak.service.spec.ts[2m > [22mStreakService[2m > [22mgetStreak[2m > [22mshould return null if streak does not exist
[90mstdout[2m | src/behavior/streak.service.spec.ts[2m > [22m[2mStreakService[2m > [22m[2mgetStreak[2m > [22m[2mshould return null if streak does not exist
[22m[39mðŸ§¹ Cleaning up after test...

[90mstdout[2m | src/behavior/streak.service.spec.ts
[22m[39mðŸ”§ Vitest setup: Starting MSW mock server...
âœ… Vitest teardown complete

[90mstdout[2m | src/config/dynamic-config.service.spec.ts[2m > [22m[2mDynamicConfigService[2m > [22m[2mshould be defined
[22m[39mðŸ§¹ Cleaning up after test...

[90mstdout[2m | src/config/dynamic-config.service.spec.ts[2m > [22m[2mDynamicConfigService[2m > [22m[2monModuleInit[2m > [22m[2mshould load config on module init in production
[22m[39mðŸ§¹ Cleaning up after test...

[90mstdout[2m | src/config/dynamic-config.service.spec.ts[2m > [22m[2mDynamicConfigService[2m > [22m[2monModuleInit[2m > [22m[2mshould skip loading config in test environment
[22m[39mðŸ§¹ Cleaning up after test...

[90mstdout[2m | src/config/dynamic-config.service.spec.ts[2m > [22m[2mDynamicConfigService[2m > [22m[2monModuleInit[2m > [22m[2mshould skip loading config when VITEST is set
[22m[39mðŸ§¹ Cleaning up after test...

[90mstdout[2m | src/config/dynamic-config.service.spec.ts[2m > [22m[2mDynamicConfigService[2m > [22m[2mloadConfig[2m > [22m[2mshould load settings from database
[22m[39mðŸ§¹ Cleaning up after test...

[90mstdout[2m | src/config/dynamic-config.service.spec.ts[2m > [22m[2mDynamicConfigService[2m > [22m[2mloadConfig[2m > [22m[2mshould cache loaded settings
[22m[39mðŸ§¹ Cleaning up after test...

[90mstdout[2m | src/config/dynamic-config.service.spec.ts[2m > [22m[2mDynamicConfigService[2m > [22m[2mloadConfig[2m > [22m[2mshould handle database errors gracefully
[22m[39mðŸ§¹ Cleaning up after test...

[90mstdout[2m | src/config/dynamic-config.service.spec.ts[2m > [22m[2mDynamicConfigService[2m > [22m[2mloadConfig[2m > [22m[2mshould log error when database fails
[22m[39mðŸ§¹ Cleaning up after test...

[90mstdout[2m | src/config/dynamic-config.service.spec.ts[2m > [22m[2mDynamicConfigService[2m > [22m[2mget[2m > [22m[2mshould retrieve cached config value
[22m[39mðŸ§¹ Cleaning up after test...

[90mstdout[2m | src/config/dynamic-config.service.spec.ts[2m > [22m[2mDynamicConfigService[2m > [22m[2mget[2m > [22m[2mshould return default value when key not found
[22m[39mðŸ§¹ Cleaning up after test...

[90mstdout[2m | src/config/dynamic-config.service.spec.ts[2m > [22m[2mDynamicConfigService[2m > [22m[2mget[2m > [22m[2mshould return empty string when no default provided
[22m[39mðŸ§¹ Cleaning up after test...

[90mstdout[2m | src/config/dynamic-config.service.spec.ts[2m > [22m[2mDynamicConfigService[2m > [22m[2mget[2m > [22m[2mshould handle multiple sequential gets
[22m[39mðŸ§¹ Cleaning up after test...

[90mstdout[2m | src/config/dynamic-config.service.spec.ts[2m > [22m[2mDynamicConfigService[2m > [22m[2mConfig Updates[2m > [22m[2mshould reflect new values after reload
[22m[39mðŸ§¹ Cleaning up after test...

[90mstdout[2m | src/config/dynamic-config.service.spec.ts[2m > [22m[2mDynamicConfigService[2m > [22m[2mConfig Updates[2m > [22m[2mshould handle empty settings array
[22m[39mðŸ§¹ Cleaning up after test...

[90mstdout[2m | src/config/dynamic-config.service.spec.ts[2m > [22m[2mDynamicConfigService[2m > [22m[2mEdge Cases[2m > [22m[2mshould handle settings with special characters
[22m[39mðŸ§¹ Cleaning up after test...

[90mstdout[2m | src/config/dynamic-config.service.spec.ts[2m > [22m[2mDynamicConfigService[2m > [22m[2mEdge Cases[2m > [22m[2mshould handle settings with empty values
[22m[39mðŸ§¹ Cleaning up after test...

 [32mâœ“[39m src/config/dynamic-config.service.spec.ts[2m > [22mDynamicConfigService[2m > [22mshould be defined
 [31mÃ—[39m src/config/dynamic-config.service.spec.ts[2m > [22mDynamicConfigService[2m > [22monModuleInit[2m > [22mshould load config on module init in production
[31m   â†’ expected "spy" to be called at least once[39m
 [32mâœ“[39m src/config/dynamic-config.service.spec.ts[2m > [22mDynamicConfigService[2m > [22monModuleInit[2m > [22mshould skip loading config in test environment
 [32mâœ“[39m src/config/dynamic-config.service.spec.ts[2m > [22mDynamicConfigService[2m > [22monModuleInit[2m > [22mshould skip loading config when VITEST is set
 [32mâœ“[39m src/config/dynamic-config.service.spec.ts[2m > [22mDynamicConfigService[2m > [22mloadConfig[2m > [22mshould load settings from database
 [32mâœ“[39m src/config/dynamic-config.service.spec.ts[2m > [22mDynamicConfigService[2m > [22mloadConfig[2m > [22mshould cache loaded settings
 [32mâœ“[39m src/config/dynamic-config.service.spec.ts[2m > [22mDynamicConfigService[2m > [22mloadConfig[2m > [22mshould handle database errors gracefully
 [32mâœ“[39m src/config/dynamic-config.service.spec.ts[2m > [22mDynamicConfigService[2m > [22mloadConfig[2m > [22mshould log error when database fails
 [32mâœ“[39m src/config/dynamic-config.service.spec.ts[2m > [22mDynamicConfigService[2m > [22mget[2m > [22mshould retrieve cached config value
 [32mâœ“[39m src/config/dynamic-config.service.spec.ts[2m > [22mDynamicConfigService[2m > [22mget[2m > [22mshould return default value when key not found
 [32mâœ“[39m src/config/dynamic-config.service.spec.ts[2m > [22mDynamicConfigService[2m > [22mget[2m > [22mshould return empty string when no default provided
 [32mâœ“[39m src/config/dynamic-config.service.spec.ts[2m > [22mDynamicConfigService[2m > [22mget[2m > [22mshould handle multiple sequential gets
 [32mâœ“[39m src/config/dynamic-config.service.spec.ts[2m > [22mDynamicConfigService[2m > [22mConfig Updates[2m > [22mshould reflect new values after reload
 [32mâœ“[39m src/config/dynamic-config.service.spec.ts[2m > [22mDynamicConfigService[2m > [22mConfig Updates[2m > [22mshould handle empty settings array
 [32mâœ“[39m src/config/dynamic-config.service.spec.ts[2m > [22mDynamicConfigService[2m > [22mEdge Cases[2m > [22mshould handle settings with special characters
 [32mâœ“[39m src/config/dynamic-config.service.spec.ts[2m > [22mDynamicConfigService[2m > [22mEdge Cases[2m > [22mshould handle settings with empty values
 [32mâœ“[39m src/config/dynamic-config.service.spec.ts[2m > [22mDynamicConfigService[2m > [22mEdge Cases[2m > [22mshould handle very long setting values
[90mstdout[2m | src/config/dynamic-config.service.spec.ts[2m > [22m[2mDynamicConfigService[2m > [22m[2mEdge Cases[2m > [22m[2mshould handle very long setting values
[22m[39mðŸ§¹ Cleaning up after test...

[90mstdout[2m | src/config/dynamic-config.service.spec.ts
[22m[39mðŸ”§ Vitest setup: Starting MSW mock server...
âœ… Vitest teardown complete

[90mstdout[2m | test/integration/behavior-flow.e2e-spec.ts
[22m[39mðŸ”§ Vitest setup: Starting MSW mock server...

[90mstdout[2m | test/integration/behavior-flow.e2e-spec.ts[2m > [22m[2mBehavior & Gamification Integration (e2e)[2m > [22m[2mBehavior Tracking[2m > [22m[2mshould log a user behavior event
[22m[39mðŸ§¹ Cleaning up after test...

[90mstdout[2m | test/integration/behavior-flow.e2e-spec.ts[2m > [22m[2mBehavior & Gamification Integration (e2e)[2m > [22m[2mBehavior Tracking[2m > [22m[2mshould retrieve behavior logs for user
[22m[39mðŸ§¹ Cleaning up after test...

[90mstdout[2m | test/integration/behavior-flow.e2e-spec.ts[2m > [22m[2mBehavior & Gamification Integration (e2e)[2m > [22m[2mGamification & Streaks[2m > [22m[2mshould get current streak
[22m[39mðŸ§¹ Cleaning up after test...

[90mstdout[2m | test/integration/behavior-flow.e2e-spec.ts[2m > [22m[2mBehavior & Gamification Integration (e2e)[2m > [22m[2mGamification & Streaks[2m > [22m[2mshould trigger a nudge check (social proof)
[22m[39mðŸ§¹ Cleaning up after test...

 [32mâœ“[39m test/integration/behavior-flow.e2e-spec.ts[2m > [22mBehavior & Gamification Integration (e2e)[2m > [22mBehavior Tracking[2m > [22mshould log a user behavior event
 [31mÃ—[39m test/integration/behavior-flow.e2e-spec.ts[2m > [22mBehavior & Gamification Integration (e2e)[2m > [22mBehavior Tracking[2m > [22mshould retrieve behavior logs for user
[31m   â†’ expected 0 to be greater than 0[39m
 [32mâœ“[39m test/integration/behavior-flow.e2e-spec.ts[2m > [22mBehavior & Gamification Integration (e2e)[2m > [22mGamification & Streaks[2m > [22mshould get current streak
 [31mÃ—[39m test/integration/behavior-flow.e2e-spec.ts[2m > [22mBehavior & Gamification Integration (e2e)[2m > [22mGamification & Streaks[2m > [22mshould trigger a nudge check (social proof)
[31m   â†’ expected {} to have property "type"[39m
[90mstdout[2m | test/integration/behavior-flow.e2e-spec.ts
[22m[39mâœ… Vitest teardown complete

[90mstdout[2m | src/modules/social/challenges.service.spec.ts[2m > [22m[2mSocialService - P2P Challenges[2m > [22m[2mChallenge Creation & Invitation[2m > [22m[2mshould create a challenge and post an announcement from the leader
[22m[39mðŸ§¹ Cleaning up after test...

[90mstdout[2m | src/modules/social/challenges.service.spec.ts[2m > [22m[2mSocialService - P2P Challenges[2m > [22m[2mChallenge Creation & Invitation[2m > [22m[2mshould fallback to system user if no leader is found for announcement
[22m[39mðŸ§¹ Cleaning up after test...

[90mstdout[2m | src/modules/social/challenges.service.spec.ts[2m > [22m[2mSocialService - P2P Challenges[2m > [22m[2mProgress Tracking & Winner Determination[2m > [22m[2mshould reward all members and delete challenge when target is reached
[22m[39mðŸ§¹ Cleaning up after test...

[90mstdout[2m | src/modules/social/challenges.service.spec.ts[2m > [22m[2mSocialService - P2P Challenges[2m > [22m[2mProgress Tracking & Winner Determination[2m > [22m[2mshould fail and delete challenge if expired without reaching target
[22m[39mðŸ§¹ Cleaning up after test...

[90mstdout[2m | src/modules/social/challenges.service.spec.ts[2m > [22m[2mSocialService - P2P Challenges[2m > [22m[2mProgress Tracking & Winner Determination[2m > [22m[2mshould do nothing if challenge is neither reached nor expired
[22m[39mðŸ§¹ Cleaning up after test...

[90mstdout[2m | src/modules/social/challenges.service.spec.ts[2m > [22m[2mSocialService - P2P Challenges[2m > [22m[2mCompetitive P2P Nudges[2m > [22m[2mshould send push notification to trailing user when someone is leading
[22m[39m[Push Notification] to follower: {"vi":"Cá»‘ lÃªn!","en":"Keep going!","zh":"åŠ æ²¹ï¼"} - {"vi":"Báº¡n chá»‰ cÃ¡ch leader 50 Ä‘iá»ƒm. Há»c thÃªm 1 bÃ i Ä‘á»ƒ vÆ°á»£t qua nÃ o!","en":"You are only 50 points behind leader. Finish one more lesson to overtake!","zh":"ä½ åªè½åŽ leader 50 åˆ†ã€‚å†å­¦ä¸€è¯¾å°±èƒ½è¶…è¿‡äº†ï¼"}
ðŸ§¹ Cleaning up after test...

 [32mâœ“[39m src/modules/social/challenges.service.spec.ts[2m > [22mSocialService - P2P Challenges[2m > [22mChallenge Creation & Invitation[2m > [22mshould create a challenge and post an announcement from the leader
 [32mâœ“[39m src/modules/social/challenges.service.spec.ts[2m > [22mSocialService - P2P Challenges[2m > [22mChallenge Creation & Invitation[2m > [22mshould fallback to system user if no leader is found for announcement
 [32mâœ“[39m src/modules/social/challenges.service.spec.ts[2m > [22mSocialService - P2P Challenges[2m > [22mProgress Tracking & Winner Determination[2m > [22mshould reward all members and delete challenge when target is reached
 [32mâœ“[39m src/modules/social/challenges.service.spec.ts[2m > [22mSocialService - P2P Challenges[2m > [22mProgress Tracking & Winner Determination[2m > [22mshould fail and delete challenge if expired without reaching target
 [32mâœ“[39m src/modules/social/challenges.service.spec.ts[2m > [22mSocialService - P2P Challenges[2m > [22mProgress Tracking & Winner Determination[2m > [22mshould do nothing if challenge is neither reached nor expired
 [32mâœ“[39m src/modules/social/challenges.service.spec.ts[2m > [22mSocialService - P2P Challenges[2m > [22mCompetitive P2P Nudges[2m > [22mshould send push notification to trailing user when someone is leading
 [32mâœ“[39m src/modules/social/challenges.service.spec.ts[2m > [22mSocialService - P2P Challenges[2m > [22mCompetitive P2P Nudges[2m > [22mshould return null if there are fewer than 2 members
[90mstdout[2m | src/modules/social/challenges.service.spec.ts[2m > [22m[2mSocialService - P2P Challenges[2m > [22m[2mCompetitive P2P Nudges[2m > [22m[2mshould return null if there are fewer than 2 members
[22m[39mðŸ§¹ Cleaning up after test...

[90mstdout[2m | src/modules/social/challenges.service.spec.ts
[22m[39mðŸ”§ Vitest setup: Starting MSW mock server...
âœ… Vitest teardown complete

[90mstdout[2m | test/unit/courses/lessons.service.spec.ts[2m > [22m[2mLessons CRUD[2m > [22m[2mcreateLesson[2m > [22m[2mshould create VIDEO lesson with localized content
[22m[39mðŸ§¹ Cleaning up after test...

[90mstdout[2m | test/unit/courses/lessons.service.spec.ts[2m > [22m[2mLessons CRUD[2m > [22m[2mcreateLesson[2m > [22m[2mshould create READING lesson
[22m[39mðŸ§¹ Cleaning up after test...

[90mstdout[2m | test/unit/courses/lessons.service.spec.ts[2m > [22m[2mLessons CRUD[2m > [22m[2mcreateLesson[2m > [22m[2mshould create QUIZ lesson
[22m[39mðŸ§¹ Cleaning up after test...

[90mstdout[2m | test/unit/courses/lessons.service.spec.ts[2m > [22m[2mLessons CRUD[2m > [22m[2mcreateLesson[2m > [22m[2mshould auto-assign order if not provided
[22m[39mðŸ§¹ Cleaning up after test...

[90mstdout[2m | test/unit/courses/lessons.service.spec.ts[2m > [22m[2mLessons CRUD[2m > [22m[2mcreateLesson[2m > [22m[2mshould set order to 1 for first lesson in course
[22m[39mðŸ§¹ Cleaning up after test...

[90mstdout[2m | test/unit/courses/lessons.service.spec.ts[2m > [22m[2mLessons CRUD[2m > [22m[2mcreateLesson[2m > [22m[2mshould respect explicitly provided order
[22m[39mðŸ§¹ Cleaning up after test...

[90mstdout[2m | test/unit/courses/lessons.service.spec.ts[2m > [22m[2mLessons CRUD[2m > [22m[2mupdateLesson[2m > [22m[2mshould update lesson content preserving localization
[22m[39mðŸ§¹ Cleaning up after test...

[90mstdout[2m | test/unit/courses/lessons.service.spec.ts[2m > [22m[2mLessons CRUD[2m > [22m[2mupdateLesson[2m > [22m[2mshould allow reordering lessons
[22m[39mðŸ§¹ Cleaning up after test...

[90mstdout[2m | test/unit/courses/lessons.service.spec.ts[2m > [22m[2mLessons CRUD[2m > [22m[2mupdateLesson[2m > [22m[2mshould allow changing lesson type
[22m[39mðŸ§¹ Cleaning up after test...

[90mstdout[2m | test/unit/courses/lessons.service.spec.ts[2m > [22m[2mLessons CRUD[2m > [22m[2mremoveLesson[2m > [22m[2mshould delete lesson
[22m[39mðŸ§¹ Cleaning up after test...

 [32mâœ“[39m test/unit/courses/lessons.service.spec.ts[2m > [22mLessons CRUD[2m > [22mcreateLesson[2m > [22mshould create VIDEO lesson with localized content
 [32mâœ“[39m test/unit/courses/lessons.service.spec.ts[2m > [22mLessons CRUD[2m > [22mcreateLesson[2m > [22mshould create READING lesson
 [32mâœ“[39m test/unit/courses/lessons.service.spec.ts[2m > [22mLessons CRUD[2m > [22mcreateLesson[2m > [22mshould create QUIZ lesson
 [32mâœ“[39m test/unit/courses/lessons.service.spec.ts[2m > [22mLessons CRUD[2m > [22mcreateLesson[2m > [22mshould auto-assign order if not provided
 [32mâœ“[39m test/unit/courses/lessons.service.spec.ts[2m > [22mLessons CRUD[2m > [22mcreateLesson[2m > [22mshould set order to 1 for first lesson in course
 [32mâœ“[39m test/unit/courses/lessons.service.spec.ts[2m > [22mLessons CRUD[2m > [22mcreateLesson[2m > [22mshould respect explicitly provided order
 [32mâœ“[39m test/unit/courses/lessons.service.spec.ts[2m > [22mLessons CRUD[2m > [22mupdateLesson[2m > [22mshould update lesson content preserving localization
 [32mâœ“[39m test/unit/courses/lessons.service.spec.ts[2m > [22mLessons CRUD[2m > [22mupdateLesson[2m > [22mshould allow reordering lessons
 [32mâœ“[39m test/unit/courses/lessons.service.spec.ts[2m > [22mLessons CRUD[2m > [22mupdateLesson[2m > [22mshould allow changing lesson type
 [32mâœ“[39m test/unit/courses/lessons.service.spec.ts[2m > [22mLessons CRUD[2m > [22mremoveLesson[2m > [22mshould delete lesson
 [32mâœ“[39m test/unit/courses/lessons.service.spec.ts[2m > [22mLessons CRUD[2m > [22mlesson ordering[2m > [22mshould maintain sequential order for multiple lessons
[90mstdout[2m | test/unit/courses/lessons.service.spec.ts[2m > [22m[2mLessons CRUD[2m > [22m[2mlesson ordering[2m > [22m[2mshould maintain sequential order for multiple lessons
[22m[39mðŸ§¹ Cleaning up after test...

[90mstdout[2m | test/unit/courses/lessons.service.spec.ts
[22m[39mðŸ”§ Vitest setup: Starting MSW mock server...
âœ… Vitest teardown complete

[90mstdout[2m | src/modules/nudge/nudge.service.spec.ts[2m > [22m[2mNudgeService[2m > [22m[2mshould be defined
[22m[39mðŸ§¹ Cleaning up after test...

[90mstdout[2m | src/modules/nudge/nudge.service.spec.ts[2m > [22m[2mNudgeService[2m > [22m[2mhandleStreakNudges[2m > [22m[2mshould find users with streaks between 20-24 hours ago and send nudges
[22m[39mðŸ§¹ Cleaning up after test...

[90mstdout[2m | src/modules/nudge/nudge.service.spec.ts[2m > [22m[2mNudgeService[2m > [22m[2mhandleStreakNudges[2m > [22m[2mshould not send nudges if no users match criteria
[22m[39mðŸ§¹ Cleaning up after test...

[90mstdout[2m | src/modules/nudge/nudge.service.spec.ts[2m > [22m[2mNudgeService[2m > [22m[2mhandleStreakNudges[2m > [22m[2mshould filter out frozen streaks
[22m[39mðŸ§¹ Cleaning up after test...

[90mstdout[2m | src/modules/nudge/nudge.service.spec.ts[2m > [22m[2mNudgeService[2m > [22m[2mhandleStreakNudges[2m > [22m[2mshould filter out zero-streak users
[22m[39mðŸ§¹ Cleaning up after test...

[90mstdout[2m | src/modules/nudge/nudge.service.spec.ts[2m > [22m[2mNudgeService[2m > [22m[2mhandleStreakNudges[2m > [22m[2mshould send nudges to multiple users
[22m[39mðŸ§¹ Cleaning up after test...

[90mstdout[2m | src/modules/nudge/nudge.service.spec.ts[2m > [22m[2mNudgeService[2m > [22m[2mhandleStreakNudges[2m > [22m[2mshould include correct time boundaries (20-24 hours)
[22m[39mðŸ§¹ Cleaning up after test...

[90mstdout[2m | src/modules/nudge/nudge.service.spec.ts[2m > [22m[2mNudgeService[2m > [22m[2mhandleStreakNudges[2m > [22m[2mshould log user streak data in nudge payload
[22m[39mðŸ§¹ Cleaning up after test...

[90mstdout[2m | src/modules/nudge/nudge.service.spec.ts[2m > [22m[2mNudgeService[2m > [22m[2mhandleStreakNudges[2m > [22m[2mshould use nudge-system as sessionId
[22m[39mðŸ§¹ Cleaning up after test...

 [32mâœ“[39m src/modules/nudge/nudge.service.spec.ts[2m > [22mNudgeService[2m > [22mshould be defined
 [32mâœ“[39m src/modules/nudge/nudge.service.spec.ts[2m > [22mNudgeService[2m > [22mhandleStreakNudges[2m > [22mshould find users with streaks between 20-24 hours ago and send nudges
 [32mâœ“[39m src/modules/nudge/nudge.service.spec.ts[2m > [22mNudgeService[2m > [22mhandleStreakNudges[2m > [22mshould not send nudges if no users match criteria
 [32mâœ“[39m src/modules/nudge/nudge.service.spec.ts[2m > [22mNudgeService[2m > [22mhandleStreakNudges[2m > [22mshould filter out frozen streaks
 [31mÃ—[39m src/modules/nudge/nudge.service.spec.ts[2m > [22mNudgeService[2m > [22mhandleStreakNudges[2m > [22mshould filter out zero-streak users
[31m   â†’ usersToNudge is not iterable[39m
 [32mâœ“[39m src/modules/nudge/nudge.service.spec.ts[2m > [22mNudgeService[2m > [22mhandleStreakNudges[2m > [22mshould send nudges to multiple users
 [31mÃ—[39m src/modules/nudge/nudge.service.spec.ts[2m > [22mNudgeService[2m > [22mhandleStreakNudges[2m > [22mshould include correct time boundaries (20-24 hours)
[31m   â†’ usersToNudge is not iterable[39m
 [32mâœ“[39m src/modules/nudge/nudge.service.spec.ts[2m > [22mNudgeService[2m > [22mhandleStreakNudges[2m > [22mshould log user streak data in nudge payload
 [32mâœ“[39m src/modules/nudge/nudge.service.spec.ts[2m > [22mNudgeService[2m > [22mhandleStreakNudges[2m > [22mshould use nudge-system as sessionId
 [32mâœ“[39m src/modules/nudge/nudge.service.spec.ts[2m > [22mNudgeService[2m > [22mhandleStreakNudges[2m > [22mshould use correct event path
[90mstdout[2m | src/modules/nudge/nudge.service.spec.ts[2m > [22m[2mNudgeService[2m > [22m[2mhandleStreakNudges[2m > [22m[2mshould use correct event path
[22m[39mðŸ§¹ Cleaning up after test...

[90mstdout[2m | src/modules/nudge/nudge.service.spec.ts
[22m[39mðŸ”§ Vitest setup: Starting MSW mock server...
âœ… Vitest teardown complete

[90mstdout[2m | test/course-progress.integration.spec.ts
[22m[39mðŸ”§ Vitest setup: Starting MSW mock server...

 [2m[90mâ†“[39m[22m test/course-progress.integration.spec.ts[2m > [22mCourse Learning Flow (Integration)[2m > [22mFull Learning Lifecycle[2m > [22mshould setup a course with localized content
 [2m[90mâ†“[39m[22m test/course-progress.integration.spec.ts[2m > [22mCourse Learning Flow (Integration)[2m > [22mFull Learning Lifecycle[2m > [22mshould start a lesson (progress persistence)
 [2m[90mâ†“[39m[22m test/course-progress.integration.spec.ts[2m > [22mCourse Learning Flow (Integration)[2m > [22mFull Learning Lifecycle[2m > [22mshould complete lesson â†’ trigger points calculation
 [2m[90mâ†“[39m[22m test/course-progress.integration.spec.ts[2m > [22mCourse Learning Flow (Integration)[2m > [22mFull Learning Lifecycle[2m > [22mshould verify dashboard stats update
 [2m[90mâ†“[39m[22m test/course-progress.integration.spec.ts[2m > [22mCourse Learning Flow (Integration)[2m > [22mFull Learning Lifecycle[2m > [22mshould test course content localization
 [2m[90mâ†“[39m[22m test/course-progress.integration.spec.ts[2m > [22mCourse Learning Flow (Integration)[2m > [22mFull Learning Lifecycle[2m > [22mshould be idempotent (completing again does not award extra points)
[90mstdout[2m | test/course-progress.integration.spec.ts
[22m[39mâœ… Vitest teardown complete

[90mstdout[2m | test/analytics-reporting.integration.spec.ts[2m > [22m[2mAnalytics Reporting Integration[2m > [22m[2mPipeline: Actions -> BehaviorLog -> Daily Report -> Export CSV[2m > [22m[2mshould complete the full analytics pipeline
[22m[39mðŸ§¹ Cleaning up after test...

[90mstdout[2m | test/analytics-reporting.integration.spec.ts[2m > [22m[2mAnalytics Reporting Integration[2m > [22m[2mConversion Funnel: Register -> First Simulation[2m > [22m[2mshould calculate funnel conversion rates correctly
[22m[39mðŸ§¹ Cleaning up after test...

[90mstdout[2m | test/analytics-reporting.integration.spec.ts[2m > [22m[2mAnalytics Reporting Integration[2m > [22m[2mReal-time Metrics: Prometheus/WS Updates[2m > [22m[2mshould update Prometheus gauges and emit via WebSocket
[22m[39mðŸ§¹ Cleaning up after test...

[90mstdout[2m | test/analytics-reporting.integration.spec.ts[2m > [22m[2mAnalytics Reporting Integration[2m > [22m[2mSegment-based Filtering[2m > [22m[2mshould filter users by behavior segment
[22m[39mðŸ§¹ Cleaning up after test...

[90mstdout[2m | test/analytics-reporting.integration.spec.ts
[22m[39mðŸ”§ Vitest setup: Starting MSW mock server...
âœ… Vitest teardown complete

 [32mâœ“[39m test/analytics-reporting.integration.spec.ts[2m > [22mAnalytics Reporting Integration[2m > [22mPipeline: Actions -> BehaviorLog -> Daily Report -> Export CSV[2m > [22mshould complete the full analytics pipeline
 [32mâœ“[39m test/analytics-reporting.integration.spec.ts[2m > [22mAnalytics Reporting Integration[2m > [22mConversion Funnel: Register -> First Simulation[2m > [22mshould calculate funnel conversion rates correctly
 [32mâœ“[39m test/analytics-reporting.integration.spec.ts[2m > [22mAnalytics Reporting Integration[2m > [22mReal-time Metrics: Prometheus/WS Updates[2m > [22mshould update Prometheus gauges and emit via WebSocket
 [32mâœ“[39m test/analytics-reporting.integration.spec.ts[2m > [22mAnalytics Reporting Integration[2m > [22mSegment-based Filtering[2m > [22mshould filter users by behavior segment
[90mstdout[2m | src/modules/social/community-stats.service.spec.ts[2m > [22m[2mCommunityStatsService[2m > [22m[2mshould be defined
[22m[39mðŸ§¹ Cleaning up after test...

[90mstdout[2m | src/modules/social/community-stats.service.spec.ts[2m > [22m[2mCommunityStatsService[2m > [22m[2mgetCommunityImpact[2m > [22m[2mshould calculate total community impact correctly
[22m[39mðŸ§¹ Cleaning up after test...

[90mstdout[2m | src/modules/social/community-stats.service.spec.ts[2m > [22m[2mCommunityStatsService[2m > [22m[2mgetCommunityImpact[2m > [22m[2mshould return 0 impact points if aggregate returns null
[22m[39mðŸ§¹ Cleaning up after test...

[90mstdout[2m | src/modules/social/community-stats.service.spec.ts[2m > [22m[2mCommunityStatsService[2m > [22m[2mgetUsersOnline[2m > [22m[2mshould aggregate users online based on recent behavior logs
[22m[39mðŸ§¹ Cleaning up after test...

[90mstdout[2m | src/modules/social/community-stats.service.spec.ts[2m > [22m[2mCommunityStatsService[2m > [22m[2mgetRecentGlobalAchievements[2m > [22m[2mshould fetch recent global achievements
[22m[39mðŸ§¹ Cleaning up after test...

[90mstdout[2m | src/modules/social/community-stats.service.spec.ts[2m > [22m[2mCommunityStatsService[2m > [22m[2mtriggerRealtimeUpdate[2m > [22m[2mshould fetch all stats and emit to gateway
[22m[39mðŸ§¹ Cleaning up after test...

 [32mâœ“[39m src/modules/social/community-stats.service.spec.ts[2m > [22mCommunityStatsService[2m > [22mshould be defined
 [32mâœ“[39m src/modules/social/community-stats.service.spec.ts[2m > [22mCommunityStatsService[2m > [22mgetCommunityImpact[2m > [22mshould calculate total community impact correctly
 [32mâœ“[39m src/modules/social/community-stats.service.spec.ts[2m > [22mCommunityStatsService[2m > [22mgetCommunityImpact[2m > [22mshould return 0 impact points if aggregate returns null
 [32mâœ“[39m src/modules/social/community-stats.service.spec.ts[2m > [22mCommunityStatsService[2m > [22mgetUsersOnline[2m > [22mshould aggregate users online based on recent behavior logs
 [32mâœ“[39m src/modules/social/community-stats.service.spec.ts[2m > [22mCommunityStatsService[2m > [22mgetRecentGlobalAchievements[2m > [22mshould fetch recent global achievements
 [32mâœ“[39m src/modules/social/community-stats.service.spec.ts[2m > [22mCommunityStatsService[2m > [22mtriggerRealtimeUpdate[2m > [22mshould fetch all stats and emit to gateway
 [32mâœ“[39m src/modules/social/community-stats.service.spec.ts[2m > [22mCommunityStatsService[2m > [22mHigh-concurrency data updates (Mock)[2m > [22mshould handle multiple simultaneous update requests
[90mstdout[2m | src/modules/social/community-stats.service.spec.ts[2m > [22m[2mCommunityStatsService[2m > [22m[2mHigh-concurrency data updates (Mock)[2m > [22m[2mshould handle multiple simultaneous update requests
[22m[39mðŸ§¹ Cleaning up after test...

[90mstdout[2m | src/modules/social/community-stats.service.spec.ts
[22m[39mðŸ”§ Vitest setup: Starting MSW mock server...
âœ… Vitest teardown complete

[90mstdout[2m | src/behavior/behavior.service.spec.ts[2m > [22m[2mBehaviorService[2m > [22m[2mshould log an event
[22m[39mðŸ§¹ Cleaning up after test...

[90mstdout[2m | src/behavior/behavior.service.spec.ts[2m > [22m[2mBehaviorService[2m > [22m[2mshould fetch user behaviors
[22m[39mðŸ§¹ Cleaning up after test...

[90mstdout[2m | src/behavior/behavior.service.spec.ts[2m > [22m[2mBehaviorService[2m > [22m[2mEvent aggregation by session[2m > [22m[2mshould log events with same session ID
[22m[39mðŸ§¹ Cleaning up after test...

[90mstdout[2m | src/behavior/behavior.service.spec.ts[2m > [22m[2mBehaviorService[2m > [22m[2mJSONB payload handling[2m > [22m[2mshould store complex nested JSONB payload
[22m[39mðŸ§¹ Cleaning up after test...

[90mstdout[2m | src/behavior/behavior.service.spec.ts[2m > [22m[2mBehaviorService[2m > [22m[2mJSONB payload handling[2m > [22m[2mshould handle JSONB deviceInfo
[22m[39mðŸ§¹ Cleaning up after test...

[90mstdout[2m | src/behavior/behavior.service.spec.ts[2m > [22m[2mBehaviorService[2m > [22m[2mHigh-volume event streams[2m > [22m[2mshould handle 100+ events without error
[22m[39mðŸ§¹ Cleaning up after test...

[90mstdout[2m | src/behavior/behavior.service.spec.ts[2m > [22m[2mBehaviorService[2m > [22m[2mHigh-volume event streams[2m > [22m[2mshould handle rapid sequential logging
[22m[39mðŸ§¹ Cleaning up after test...

[90mstdout[2m | src/behavior/behavior.service.spec.ts[2m > [22m[2mBehaviorService[2m > [22m[2mPrivacy filtering[2m > [22m[2mshould allow undefined userId for anonymous tracking
[22m[39mðŸ§¹ Cleaning up after test...

[90mstdout[2m | src/behavior/behavior.service.spec.ts[2m > [22m[2mBehaviorService[2m > [22m[2mPrivacy filtering[2m > [22m[2mshould set default actionCategory to GENERAL if not provided
[22m[39mðŸ§¹ Cleaning up after test...

 [32mâœ“[39m src/behavior/behavior.service.spec.ts[2m > [22mBehaviorService[2m > [22mshould log an event
 [32mâœ“[39m src/behavior/behavior.service.spec.ts[2m > [22mBehaviorService[2m > [22mshould fetch user behaviors
 [32mâœ“[39m src/behavior/behavior.service.spec.ts[2m > [22mBehaviorService[2m > [22mEvent aggregation by session[2m > [22mshould log events with same session ID
 [32mâœ“[39m src/behavior/behavior.service.spec.ts[2m > [22mBehaviorService[2m > [22mJSONB payload handling[2m > [22mshould store complex nested JSONB payload
 [32mâœ“[39m src/behavior/behavior.service.spec.ts[2m > [22mBehaviorService[2m > [22mJSONB payload handling[2m > [22mshould handle JSONB deviceInfo
 [32mâœ“[39m src/behavior/behavior.service.spec.ts[2m > [22mBehaviorService[2m > [22mHigh-volume event streams[2m > [22mshould handle 100+ events without error
 [32mâœ“[39m src/behavior/behavior.service.spec.ts[2m > [22mBehaviorService[2m > [22mHigh-volume event streams[2m > [22mshould handle rapid sequential logging
 [32mâœ“[39m src/behavior/behavior.service.spec.ts[2m > [22mBehaviorService[2m > [22mPrivacy filtering[2m > [22mshould allow undefined userId for anonymous tracking
 [32mâœ“[39m src/behavior/behavior.service.spec.ts[2m > [22mBehaviorService[2m > [22mPrivacy filtering[2m > [22mshould set default actionCategory to GENERAL if not provided
 [32mâœ“[39m src/behavior/behavior.service.spec.ts[2m > [22mBehaviorService[2m > [22mPrivacy filtering[2m > [22mshould set default duration to 0 if not provided
[90mstdout[2m | src/behavior/behavior.service.spec.ts[2m > [22m[2mBehaviorService[2m > [22m[2mPrivacy filtering[2m > [22m[2mshould set default duration to 0 if not provided
[22m[39mðŸ§¹ Cleaning up after test...

[90mstdout[2m | src/behavior/behavior.service.spec.ts
[22m[39mðŸ”§ Vitest setup: Starting MSW mock server...
âœ… Vitest teardown complete

[90mstdout[2m | src/modules/simulation/simulation.service.spec.ts[2m > [22m[2mSimulationService (Pure Unit Test)[2m > [22m[2mVirtual Portfolio[2m > [22m[2mshould create portfolio if not exists
[22m[39mðŸ§¹ Cleaning up after test...

[90mstdout[2m | src/modules/simulation/simulation.service.spec.ts[2m > [22m[2mSimulationService (Pure Unit Test)[2m > [22m[2mVirtual Portfolio[2m > [22m[2mshould process trade BUY correctly
[22m[39mðŸ§¹ Cleaning up after test...

[90mstdout[2m | src/modules/simulation/simulation.service.spec.ts[2m > [22m[2mSimulationService (Pure Unit Test)[2m > [22m[2mVirtual Portfolio[2m > [22m[2mshould throw error for insufficient balance
[22m[39mðŸ§¹ Cleaning up after test...

[90mstdout[2m | src/modules/simulation/simulation.service.spec.ts[2m > [22m[2mSimulationService (Pure Unit Test)[2m > [22m[2mBudget Decision[2m > [22m[2mshould provide feedback for 50/30/20 rule
[22m[39mðŸ§¹ Cleaning up after test...

[90mstdout[2m | src/modules/simulation/simulation.service.spec.ts[2m > [22m[2mSimulationService (Pure Unit Test)[2m > [22m[2mBudget Decision[2m > [22m[2mshould warn for high wants
[22m[39mðŸ§¹ Cleaning up after test...

[90mstdout[2m | src/modules/simulation/simulation.service.spec.ts[2m > [22m[2mSimulationService (Pure Unit Test)[2m > [22m[2mStress Test[2m > [22m[2mshould calculate survival months and emit nudge
[22m[39mðŸ§¹ Cleaning up after test...

[90mstdout[2m | src/modules/simulation/simulation.service.spec.ts[2m > [22m[2mSimulationService (Pure Unit Test)[2m > [22m[2mCommitment Devices[2m > [22m[2mshould create a commitment and lock funds
[22m[39mðŸ§¹ Cleaning up after test...

[90mstdout[2m | src/modules/simulation/simulation.service.spec.ts[2m > [22m[2mSimulationService (Pure Unit Test)[2m > [22m[2mCommitment Devices[2m > [22m[2mshould penalize early withdrawal
[22m[39mðŸ§¹ Cleaning up after test...

[90mstdout[2m | src/modules/simulation/simulation.service.spec.ts[2m > [22m[2mSimulationService (Pure Unit Test)[2m > [22m[2mCommitment Devices[2m > [22m[2mshould return full amount for on-time withdrawal
[22m[39mðŸ§¹ Cleaning up after test...

 [32mâœ“[39m src/modules/simulation/simulation.service.spec.ts[2m > [22mSimulationService (Pure Unit Test)[2m > [22mVirtual Portfolio[2m > [22mshould create portfolio if not exists
 [32mâœ“[39m src/modules/simulation/simulation.service.spec.ts[2m > [22mSimulationService (Pure Unit Test)[2m > [22mVirtual Portfolio[2m > [22mshould process trade BUY correctly
 [32mâœ“[39m src/modules/simulation/simulation.service.spec.ts[2m > [22mSimulationService (Pure Unit Test)[2m > [22mVirtual Portfolio[2m > [22mshould throw error for insufficient balance
 [32mâœ“[39m src/modules/simulation/simulation.service.spec.ts[2m > [22mSimulationService (Pure Unit Test)[2m > [22mBudget Decision[2m > [22mshould provide feedback for 50/30/20 rule
 [32mâœ“[39m src/modules/simulation/simulation.service.spec.ts[2m > [22mSimulationService (Pure Unit Test)[2m > [22mBudget Decision[2m > [22mshould warn for high wants
 [32mâœ“[39m src/modules/simulation/simulation.service.spec.ts[2m > [22mSimulationService (Pure Unit Test)[2m > [22mStress Test[2m > [22mshould calculate survival months and emit nudge
 [32mâœ“[39m src/modules/simulation/simulation.service.spec.ts[2m > [22mSimulationService (Pure Unit Test)[2m > [22mCommitment Devices[2m > [22mshould create a commitment and lock funds
 [32mâœ“[39m src/modules/simulation/simulation.service.spec.ts[2m > [22mSimulationService (Pure Unit Test)[2m > [22mCommitment Devices[2m > [22mshould penalize early withdrawal
 [32mâœ“[39m src/modules/simulation/simulation.service.spec.ts[2m > [22mSimulationService (Pure Unit Test)[2m > [22mCommitment Devices[2m > [22mshould return full amount for on-time withdrawal
 [32mâœ“[39m src/modules/simulation/simulation.service.spec.ts[2m > [22mSimulationService (Pure Unit Test)[2m > [22mLong Term Impact[2m > [22mshould calculate future value and emit nudge
[90mstdout[2m | src/modules/simulation/simulation.service.spec.ts[2m > [22m[2mSimulationService (Pure Unit Test)[2m > [22m[2mLong Term Impact[2m > [22m[2mshould calculate future value and emit nudge
[22m[39mðŸ§¹ Cleaning up after test...

[90mstdout[2m | src/modules/simulation/simulation.service.spec.ts
[22m[39mðŸ”§ Vitest setup: Starting MSW mock server...
âœ… Vitest teardown complete

[90mstdout[2m | src/modules/social/chat.service.spec.ts[2m > [22m[2mChatService[2m > [22m[2mmessage persistence[2m > [22m[2mshould save a message and update thread timestamp
[22m[39mðŸ§¹ Cleaning up after test...

[90mstdout[2m | src/modules/social/chat.service.spec.ts[2m > [22m[2mChatService[2m > [22m[2mchat history retrieval[2m > [22m[2mshould retrieve messages for a thread
[22m[39mðŸ§¹ Cleaning up after test...

[90mstdout[2m | src/modules/social/chat.service.spec.ts[2m > [22m[2mChatService[2m > [22m[2mchat history retrieval[2m > [22m[2mshould return empty list if no messages found
[22m[39mðŸ§¹ Cleaning up after test...

[90mstdout[2m | src/modules/social/chat.service.spec.ts[2m > [22m[2mChatService[2m > [22m[2mgroup chat creation[2m > [22m[2mshould create a new group with the creator as leader
[22m[39mðŸ§¹ Cleaning up after test...

[90mstdout[2m | src/modules/social/chat.service.spec.ts[2m > [22m[2mChatService[2m > [22m[2mmessage encryption/masking[2m > [22m[2mshould mask emails in content
[22m[39mðŸ§¹ Cleaning up after test...

[90mstdout[2m | src/modules/social/chat.service.spec.ts[2m > [22m[2mChatService[2m > [22m[2mmessage encryption/masking[2m > [22m[2mshould mask names and addresses
[22m[39mðŸ§¹ Cleaning up after test...

[90mstdout[2m | src/modules/social/chat.service.spec.ts[2m > [22m[2mChatService[2m > [22m[2mmessage encryption/masking[2m > [22m[2mshould mask content before saving
[22m[39mðŸ§¹ Cleaning up after test...

[90mstdout[2m | src/modules/social/chat.service.spec.ts[2m > [22m[2mChatService[2m > [22m[2mmessage encryption/masking[2m > [22m[2mshould mask content when retrieving history
[22m[39mðŸ§¹ Cleaning up after test...

[90mstdout[2m | src/modules/social/chat.service.spec.ts[2m > [22m[2mChatService[2m > [22m[2mthread management[2m > [22m[2mshould create a thread
[22m[39mðŸ§¹ Cleaning up after test...

 [32mâœ“[39m src/modules/social/chat.service.spec.ts[2m > [22mChatService[2m > [22mmessage persistence[2m > [22mshould save a message and update thread timestamp
 [32mâœ“[39m src/modules/social/chat.service.spec.ts[2m > [22mChatService[2m > [22mchat history retrieval[2m > [22mshould retrieve messages for a thread
 [32mâœ“[39m src/modules/social/chat.service.spec.ts[2m > [22mChatService[2m > [22mchat history retrieval[2m > [22mshould return empty list if no messages found
 [32mâœ“[39m src/modules/social/chat.service.spec.ts[2m > [22mChatService[2m > [22mgroup chat creation[2m > [22mshould create a new group with the creator as leader
 [32mâœ“[39m src/modules/social/chat.service.spec.ts[2m > [22mChatService[2m > [22mmessage encryption/masking[2m > [22mshould mask emails in content
 [32mâœ“[39m src/modules/social/chat.service.spec.ts[2m > [22mChatService[2m > [22mmessage encryption/masking[2m > [22mshould mask names and addresses
 [32mâœ“[39m src/modules/social/chat.service.spec.ts[2m > [22mChatService[2m > [22mmessage encryption/masking[2m > [22mshould mask content before saving
 [32mâœ“[39m src/modules/social/chat.service.spec.ts[2m > [22mChatService[2m > [22mmessage encryption/masking[2m > [22mshould mask content when retrieving history
 [32mâœ“[39m src/modules/social/chat.service.spec.ts[2m > [22mChatService[2m > [22mthread management[2m > [22mshould create a thread
 [32mâœ“[39m src/modules/social/chat.service.spec.ts[2m > [22mChatService[2m > [22mthread management[2m > [22mshould get user threads
[90mstdout[2m | src/modules/social/chat.service.spec.ts[2m > [22m[2mChatService[2m > [22m[2mthread management[2m > [22m[2mshould get user threads
[22m[39mðŸ§¹ Cleaning up after test...

[90mstdout[2m | src/modules/social/chat.service.spec.ts
[22m[39mðŸ”§ Vitest setup: Starting MSW mock server...
âœ… Vitest teardown complete

[90mstdout[2m | src/modules/social/social.controller.spec.ts[2m > [22m[2mSocialController[2m > [22m[2mshould be defined
[22m[39mðŸ§¹ Cleaning up after test...

[90mstdout[2m | src/modules/social/social.controller.spec.ts[2m > [22m[2mSocialController[2m > [22m[2mgetFeed[2m > [22m[2mshould return social feed
[22m[39mðŸ§¹ Cleaning up after test...

[90mstdout[2m | src/modules/social/social.controller.spec.ts[2m > [22m[2mSocialController[2m > [22m[2mcreatePost[2m > [22m[2mshould create a new post
[22m[39mðŸ§¹ Cleaning up after test...

[90mstdout[2m | src/modules/social/social.controller.spec.ts[2m > [22m[2mSocialController[2m > [22m[2mgetRecommendations[2m > [22m[2mshould return group recommendations
[22m[39mðŸ§¹ Cleaning up after test...

[90mstdout[2m | src/modules/social/social.controller.spec.ts[2m > [22m[2mSocialController[2m > [22m[2mcreateGroup[2m > [22m[2mshould create a new group
[22m[39mðŸ§¹ Cleaning up after test...

[90mstdout[2m | src/modules/social/social.controller.spec.ts[2m > [22m[2mSocialController[2m > [22m[2mjoinGroup[2m > [22m[2mshould join a group
[22m[39mðŸ§¹ Cleaning up after test...

[90mstdout[2m | src/modules/social/social.controller.spec.ts[2m > [22m[2mSocialController[2m > [22m[2mgetGroupDetails[2m > [22m[2mshould return group details
[22m[39mðŸ§¹ Cleaning up after test...

[90mstdout[2m | src/modules/social/social.controller.spec.ts[2m > [22m[2mSocialController[2m > [22m[2mcreateChallenge[2m > [22m[2mshould create a group challenge
[22m[39mðŸ§¹ Cleaning up after test...

 [32mâœ“[39m src/modules/social/social.controller.spec.ts[2m > [22mSocialController[2m > [22mshould be defined
 [32mâœ“[39m src/modules/social/social.controller.spec.ts[2m > [22mSocialController[2m > [22mgetFeed[2m > [22mshould return social feed
 [32mâœ“[39m src/modules/social/social.controller.spec.ts[2m > [22mSocialController[2m > [22mcreatePost[2m > [22mshould create a new post
 [32mâœ“[39m src/modules/social/social.controller.spec.ts[2m > [22mSocialController[2m > [22mgetRecommendations[2m > [22mshould return group recommendations
 [32mâœ“[39m src/modules/social/social.controller.spec.ts[2m > [22mSocialController[2m > [22mcreateGroup[2m > [22mshould create a new group
 [32mâœ“[39m src/modules/social/social.controller.spec.ts[2m > [22mSocialController[2m > [22mjoinGroup[2m > [22mshould join a group
 [32mâœ“[39m src/modules/social/social.controller.spec.ts[2m > [22mSocialController[2m > [22mgetGroupDetails[2m > [22mshould return group details
 [32mâœ“[39m src/modules/social/social.controller.spec.ts[2m > [22mSocialController[2m > [22mcreateChallenge[2m > [22mshould create a group challenge
 [32mâœ“[39m src/modules/social/social.controller.spec.ts[2m > [22mSocialController[2m > [22mError Handling[2m > [22mshould propagate errors from social service
[90mstdout[2m | src/modules/social/social.controller.spec.ts[2m > [22m[2mSocialController[2m > [22m[2mError Handling[2m > [22m[2mshould propagate errors from social service
[22m[39mðŸ§¹ Cleaning up after test...

[90mstdout[2m | src/modules/social/social.controller.spec.ts
[22m[39mðŸ”§ Vitest setup: Starting MSW mock server...
âœ… Vitest teardown complete

[90mstdout[2m | src/common/gamification.service.spec.ts[2m > [22m[2mGamificationService (Pure Unit Test)[2m > [22m[2mlogEvent[2m > [22m[2mshould increment user points and log behavior
[22m[39mðŸ§¹ Cleaning up after test...

[90mstdout[2m | src/common/gamification.service.spec.ts[2m > [22m[2mGamificationService (Pure Unit Test)[2m > [22m[2mlogEvent[2m > [22m[2mshould use simulation system ID when metadata has isSimulation true
[22m[39mðŸ§¹ Cleaning up after test...

[90mstdout[2m | src/common/gamification.service.spec.ts[2m > [22m[2mGamificationService (Pure Unit Test)[2m > [22m[2mdeductPoints[2m > [22m[2mshould deduct points if user has enough
[22m[39mðŸ§¹ Cleaning up after test...

[90mstdout[2m | src/common/gamification.service.spec.ts[2m > [22m[2mGamificationService (Pure Unit Test)[2m > [22m[2mdeductPoints[2m > [22m[2mshould throw error if user has insufficient points
[22m[39mðŸ§¹ Cleaning up after test...

[90mstdout[2m | src/common/gamification.service.spec.ts[2m > [22m[2mGamificationService (Pure Unit Test)[2m > [22m[2mdeductPoints[2m > [22m[2mshould throw error if user does not exist
[22m[39mðŸ§¹ Cleaning up after test...

[90mstdout[2m | src/common/gamification.service.spec.ts[2m > [22m[2mGamificationService (Pure Unit Test)[2m > [22m[2mdeductPoints[2m > [22m[2mshould log deduction with correct session ID
[22m[39mðŸ§¹ Cleaning up after test...

[90mstdout[2m | src/common/gamification.service.spec.ts[2m > [22m[2mGamificationService (Pure Unit Test)[2m > [22m[2mPoint calculation with streak multipliers (edge cases)[2m > [22m[2mshould handle zero points correctly
[22m[39mðŸ§¹ Cleaning up after test...

[90mstdout[2m | src/common/gamification.service.spec.ts[2m > [22m[2mGamificationService (Pure Unit Test)[2m > [22m[2mPoint calculation with streak multipliers (edge cases)[2m > [22m[2mshould handle large point values
[22m[39mðŸ§¹ Cleaning up after test...

 [32mâœ“[39m src/common/gamification.service.spec.ts[2m > [22mGamificationService (Pure Unit Test)[2m > [22mlogEvent[2m > [22mshould increment user points and log behavior
 [32mâœ“[39m src/common/gamification.service.spec.ts[2m > [22mGamificationService (Pure Unit Test)[2m > [22mlogEvent[2m > [22mshould use simulation system ID when metadata has isSimulation true
 [32mâœ“[39m src/common/gamification.service.spec.ts[2m > [22mGamificationService (Pure Unit Test)[2m > [22mdeductPoints[2m > [22mshould deduct points if user has enough
 [32mâœ“[39m src/common/gamification.service.spec.ts[2m > [22mGamificationService (Pure Unit Test)[2m > [22mdeductPoints[2m > [22mshould throw error if user has insufficient points
 [32mâœ“[39m src/common/gamification.service.spec.ts[2m > [22mGamificationService (Pure Unit Test)[2m > [22mdeductPoints[2m > [22mshould throw error if user does not exist
 [32mâœ“[39m src/common/gamification.service.spec.ts[2m > [22mGamificationService (Pure Unit Test)[2m > [22mdeductPoints[2m > [22mshould log deduction with correct session ID
 [32mâœ“[39m src/common/gamification.service.spec.ts[2m > [22mGamificationService (Pure Unit Test)[2m > [22mPoint calculation with streak multipliers (edge cases)[2m > [22mshould handle zero points correctly
 [32mâœ“[39m src/common/gamification.service.spec.ts[2m > [22mGamificationService (Pure Unit Test)[2m > [22mPoint calculation with streak multipliers (edge cases)[2m > [22mshould handle large point values
 [32mâœ“[39m src/common/gamification.service.spec.ts[2m > [22mGamificationService (Pure Unit Test)[2m > [22mPoint calculation with streak multipliers (edge cases)[2m > [22mshould include custom metadata in payload
[90mstdout[2m | src/common/gamification.service.spec.ts[2m > [22m[2mGamificationService (Pure Unit Test)[2m > [22m[2mPoint calculation with streak multipliers (edge cases)[2m > [22m[2mshould include custom metadata in payload
[22m[39mðŸ§¹ Cleaning up after test...

[90mstdout[2m | src/common/gamification.service.spec.ts
[22m[39mðŸ”§ Vitest setup: Starting MSW mock server...
âœ… Vitest teardown complete

[90mstdout[2m | src/auth/auth.controller.spec.ts
[22m[39mðŸ”§ Vitest setup: Starting MSW mock server...

[90mstdout[2m | src/auth/auth.controller.spec.ts[2m > [22m[2mAuthController[2m > [22m[2mshould be defined
[22m[39mðŸ§¹ Cleaning up after test...

[90mstdout[2m | src/auth/auth.controller.spec.ts[2m > [22m[2mAuthController[2m > [22m[2msignIn[2m > [22m[2mshould call authService.login
[22m[39mðŸ§¹ Cleaning up after test...

[90mstdout[2m | src/auth/auth.controller.spec.ts[2m > [22m[2mAuthController[2m > [22m[2msignIn[2m > [22m[2mshould return access_token, refresh_token, and user object
[22m[39mðŸ§¹ Cleaning up after test...

[90mstdout[2m | src/auth/auth.controller.spec.ts[2m > [22m[2mAuthController[2m > [22m[2mValidation (Integration)[2m > [22m[2mshould fail if email is invalid
[22m[39mðŸ§¹ Cleaning up after test...

[90mstdout[2m | src/auth/auth.controller.spec.ts[2m > [22m[2mAuthController[2m > [22m[2mValidation (Integration)[2m > [22m[2mshould fail if password is too short in RegisterDto
[22m[39mðŸ§¹ Cleaning up after test...

[90mstdout[2m | src/auth/auth.controller.spec.ts[2m > [22m[2mAuthController[2m > [22m[2msignUp[2m > [22m[2mshould call authService.register
[22m[39mðŸ§¹ Cleaning up after test...

[90mstdout[2m | src/auth/auth.controller.spec.ts[2m > [22m[2mAuthController[2m > [22m[2msignUp[2m > [22m[2mshould return tokens and user on successful registration
[22m[39mðŸ§¹ Cleaning up after test...

[90mstdout[2m | src/auth/auth.controller.spec.ts[2m > [22m[2mAuthController[2m > [22m[2mrefresh[2m > [22m[2mshould call authService.refreshToken
[22m[39mðŸ§¹ Cleaning up after test...

[90mstdout[2m | src/auth/auth.controller.spec.ts[2m > [22m[2mAuthController[2m > [22m[2mrefresh[2m > [22m[2mshould return new tokens on successful refresh
[22m[39mðŸ§¹ Cleaning up after test...

 [32mâœ“[39m src/auth/auth.controller.spec.ts[2m > [22mAuthController[2m > [22mshould be defined
 [32mâœ“[39m src/auth/auth.controller.spec.ts[2m > [22mAuthController[2m > [22msignIn[2m > [22mshould call authService.login
 [32mâœ“[39m src/auth/auth.controller.spec.ts[2m > [22mAuthController[2m > [22msignIn[2m > [22mshould return access_token, refresh_token, and user object
 [32mâœ“[39m src/auth/auth.controller.spec.ts[2m > [22mAuthController[2m > [22mValidation (Integration)[2m > [22mshould fail if email is invalid
 [32mâœ“[39m src/auth/auth.controller.spec.ts[2m > [22mAuthController[2m > [22mValidation (Integration)[2m > [22mshould fail if password is too short in RegisterDto
 [32mâœ“[39m src/auth/auth.controller.spec.ts[2m > [22mAuthController[2m > [22msignUp[2m > [22mshould call authService.register
 [32mâœ“[39m src/auth/auth.controller.spec.ts[2m > [22mAuthController[2m > [22msignUp[2m > [22mshould return tokens and user on successful registration
 [32mâœ“[39m src/auth/auth.controller.spec.ts[2m > [22mAuthController[2m > [22mrefresh[2m > [22mshould call authService.refreshToken
 [32mâœ“[39m src/auth/auth.controller.spec.ts[2m > [22mAuthController[2m > [22mrefresh[2m > [22mshould return new tokens on successful refresh
 [32mâœ“[39m src/auth/auth.controller.spec.ts[2m > [22mAuthController[2m > [22mGuards[2m > [22mshould have JwtAuthGuard on profile-related endpoints in UsersController
[90mstdout[2m | src/auth/auth.controller.spec.ts[2m > [22m[2mAuthController[2m > [22m[2mGuards[2m > [22m[2mshould have JwtAuthGuard on profile-related endpoints in UsersController
[22m[39mðŸ§¹ Cleaning up after test...

[90mstdout[2m | src/auth/auth.controller.spec.ts
[22m[39mâœ… Vitest teardown complete

[90mstdout[2m | test/massive-stress.e2e-spec.ts
[22m[39mðŸ”§ Vitest setup: Starting MSW mock server...

[90mstdout[2m | test/massive-stress.e2e-spec.ts[2m > [22m[2mMassive Persona Stress Test (1000+ Actions Simulation)
[22m[39mðŸ‘¥ Setting up 50 users...

 [2m[90mâ†“[39m[22m test/massive-stress.e2e-spec.ts[2m > [22mMassive Persona Stress Test (1000+ Actions Simulation)[2m > [22mNÃªn xá»­ lÃ½ 5000 hÃ nh vi AI-driven nudges Ä‘á»“ng thá»i
[90mstdout[2m | test/massive-stress.e2e-spec.ts
[22m[39mâœ… Vitest teardown complete

[90mstdout[2m | src/common/i18n.service.spec.ts[2m > [22m[2mI18nService[2m > [22m[2mtranslate[2m > [22m[2mshould return Vietnamese translation by default
[22m[39mðŸ§¹ Cleaning up after test...

[90mstdout[2m | src/common/i18n.service.spec.ts[2m > [22m[2mI18nService[2m > [22m[2mtranslate[2m > [22m[2mshould return English translation
[22m[39mðŸ§¹ Cleaning up after test...

[90mstdout[2m | src/common/i18n.service.spec.ts[2m > [22m[2mI18nService[2m > [22m[2mtranslate[2m > [22m[2mshould return Chinese translation
[22m[39mðŸ§¹ Cleaning up after test...

[90mstdout[2m | src/common/i18n.service.spec.ts[2m > [22m[2mI18nService[2m > [22m[2mtranslate[2m > [22m[2mshould replace parameters correctly
[22m[39mðŸ§¹ Cleaning up after test...

[90mstdout[2m | src/common/i18n.service.spec.ts[2m > [22m[2mI18nService[2m > [22m[2mtranslate[2m > [22m[2mshould return the key if translation is not found
[22m[39mðŸ§¹ Cleaning up after test...

[90mstdout[2m | src/common/i18n.service.spec.ts[2m > [22m[2mI18nService[2m > [22m[2mtranslate[2m > [22m[2mshould replace multiple parameters in all locales
[22m[39mðŸ§¹ Cleaning up after test...

[90mstdout[2m | src/common/i18n.service.spec.ts[2m > [22m[2mI18nService[2m > [22m[2mtranslate[2m > [22m[2mshould handle complex parameter replacement
[22m[39mðŸ§¹ Cleaning up after test...

[90mstdout[2m | src/common/i18n.service.spec.ts[2m > [22m[2mI18nService[2m > [22m[2mtranslate[2m > [22m[2mshould fallback to Vietnamese when locale not found
[22m[39mðŸ§¹ Cleaning up after test...

[90mstdout[2m | src/common/i18n.service.spec.ts[2m > [22m[2mI18nService[2m > [22m[2mtranslate[2m > [22m[2mshould handle nested key lookups
[22m[39mðŸ§¹ Cleaning up after test...

[90mstdout[2m | src/common/i18n.service.spec.ts[2m > [22m[2mI18nService[2m > [22m[2mtranslate[2m > [22m[2mshould return key if intermediate path is invalid
[22m[39mðŸ§¹ Cleaning up after test...

[90mstdout[2m | src/common/i18n.service.spec.ts[2m > [22m[2mI18nService[2m > [22m[2mtranslate[2m > [22m[2mshould handle empty parameters object
[22m[39mðŸ§¹ Cleaning up after test...

[90mstdout[2m | src/common/i18n.service.spec.ts[2m > [22m[2mI18nService[2m > [22m[2mtranslate[2m > [22m[2mshould convert non-string parameter values to strings
[22m[39mðŸ§¹ Cleaning up after test...

[90mstdout[2m | src/common/i18n.service.spec.ts[2m > [22m[2mI18nService[2m > [22m[2mgetLocalizedField[2m > [22m[2mshould return field for specific locale
[22m[39mðŸ§¹ Cleaning up after test...

[90mstdout[2m | src/common/i18n.service.spec.ts[2m > [22m[2mI18nService[2m > [22m[2mgetLocalizedField[2m > [22m[2mshould fallback to vi if locale not found
[22m[39mðŸ§¹ Cleaning up after test...

[90mstdout[2m | src/common/i18n.service.spec.ts[2m > [22m[2mI18nService[2m > [22m[2mgetLocalizedField[2m > [22m[2mshould return empty string if field is null
[22m[39mðŸ§¹ Cleaning up after test...

[90mstdout[2m | src/common/i18n.service.spec.ts[2m > [22m[2mI18nService[2m > [22m[2mgetLocalizedField[2m > [22m[2mshould extract Vietnamese field from JSONB
[22m[39mðŸ§¹ Cleaning up after test...

[90mstdout[2m | src/common/i18n.service.spec.ts[2m > [22m[2mI18nService[2m > [22m[2mgetLocalizedField[2m > [22m[2mshould extract Chinese field from JSONB
[22m[39mðŸ§¹ Cleaning up after test...

[90mstdout[2m | src/common/i18n.service.spec.ts[2m > [22m[2mI18nService[2m > [22m[2mgetLocalizedField[2m > [22m[2mshould fallback to en if vi is missing
[22m[39mðŸ§¹ Cleaning up after test...

[90mstdout[2m | src/common/i18n.service.spec.ts[2m > [22m[2mI18nService[2m > [22m[2mgetLocalizedField[2m > [22m[2mshould handle plain string as-is
[22m[39mðŸ§¹ Cleaning up after test...

[90mstdout[2m | src/common/i18n.service.spec.ts[2m > [22m[2mI18nService[2m > [22m[2mgetLocalizedField[2m > [22m[2mshould return empty string if field is undefined
[22m[39mðŸ§¹ Cleaning up after test...

[90mstdout[2m | src/common/i18n.service.spec.ts[2m > [22m[2mI18nService[2m > [22m[2mgetLocalizedField[2m > [22m[2mshould return empty string if field is empty object
[22m[39mðŸ§¹ Cleaning up after test...

[90mstdout[2m | src/common/i18n.service.spec.ts[2m > [22m[2mI18nService[2m > [22m[2mgetLocalizedField[2m > [22m[2mshould prioritize requested locale over fallbacks
[22m[39mðŸ§¹ Cleaning up after test...

[90mstdout[2m | src/common/i18n.service.spec.ts
[22m[39mðŸ”§ Vitest setup: Starting MSW mock server...
âœ… Vitest teardown complete

 [32mâœ“[39m src/common/i18n.service.spec.ts[2m > [22mI18nService[2m > [22mtranslate[2m > [22mshould return Vietnamese translation by default
 [32mâœ“[39m src/common/i18n.service.spec.ts[2m > [22mI18nService[2m > [22mtranslate[2m > [22mshould return English translation
 [32mâœ“[39m src/common/i18n.service.spec.ts[2m > [22mI18nService[2m > [22mtranslate[2m > [22mshould return Chinese translation
 [32mâœ“[39m src/common/i18n.service.spec.ts[2m > [22mI18nService[2m > [22mtranslate[2m > [22mshould replace parameters correctly
 [32mâœ“[39m src/common/i18n.service.spec.ts[2m > [22mI18nService[2m > [22mtranslate[2m > [22mshould return the key if translation is not found
 [32mâœ“[39m src/common/i18n.service.spec.ts[2m > [22mI18nService[2m > [22mtranslate[2m > [22mshould replace multiple parameters in all locales
 [32mâœ“[39m src/common/i18n.service.spec.ts[2m > [22mI18nService[2m > [22mtranslate[2m > [22mshould handle complex parameter replacement
 [32mâœ“[39m src/common/i18n.service.spec.ts[2m > [22mI18nService[2m > [22mtranslate[2m > [22mshould fallback to Vietnamese when locale not found
 [32mâœ“[39m src/common/i18n.service.spec.ts[2m > [22mI18nService[2m > [22mtranslate[2m > [22mshould handle nested key lookups
 [32mâœ“[39m src/common/i18n.service.spec.ts[2m > [22mI18nService[2m > [22mtranslate[2m > [22mshould return key if intermediate path is invalid
 [32mâœ“[39m src/common/i18n.service.spec.ts[2m > [22mI18nService[2m > [22mtranslate[2m > [22mshould handle empty parameters object
 [32mâœ“[39m src/common/i18n.service.spec.ts[2m > [22mI18nService[2m > [22mtranslate[2m > [22mshould convert non-string parameter values to strings
 [32mâœ“[39m src/common/i18n.service.spec.ts[2m > [22mI18nService[2m > [22mgetLocalizedField[2m > [22mshould return field for specific locale
 [32mâœ“[39m src/common/i18n.service.spec.ts[2m > [22mI18nService[2m > [22mgetLocalizedField[2m > [22mshould fallback to vi if locale not found
 [32mâœ“[39m src/common/i18n.service.spec.ts[2m > [22mI18nService[2m > [22mgetLocalizedField[2m > [22mshould return empty string if field is null
 [32mâœ“[39m src/common/i18n.service.spec.ts[2m > [22mI18nService[2m > [22mgetLocalizedField[2m > [22mshould extract Vietnamese field from JSONB
 [32mâœ“[39m src/common/i18n.service.spec.ts[2m > [22mI18nService[2m > [22mgetLocalizedField[2m > [22mshould extract Chinese field from JSONB
 [32mâœ“[39m src/common/i18n.service.spec.ts[2m > [22mI18nService[2m > [22mgetLocalizedField[2m > [22mshould fallback to en if vi is missing
 [32mâœ“[39m src/common/i18n.service.spec.ts[2m > [22mI18nService[2m > [22mgetLocalizedField[2m > [22mshould handle plain string as-is
 [32mâœ“[39m src/common/i18n.service.spec.ts[2m > [22mI18nService[2m > [22mgetLocalizedField[2m > [22mshould return empty string if field is undefined
 [32mâœ“[39m src/common/i18n.service.spec.ts[2m > [22mI18nService[2m > [22mgetLocalizedField[2m > [22mshould return empty string if field is empty object
 [32mâœ“[39m src/common/i18n.service.spec.ts[2m > [22mI18nService[2m > [22mgetLocalizedField[2m > [22mshould prioritize requested locale over fallbacks
[90mstdout[2m | src/courses/courses.service.spec.ts[2m > [22m[2mCoursesService (Pure Unit Test)[2m > [22m[2mcreateCourse[2m > [22m[2mshould create a course
[22m[39mðŸ§¹ Cleaning up after test...

[90mstdout[2m | src/courses/courses.service.spec.ts[2m > [22m[2mCoursesService (Pure Unit Test)[2m > [22m[2mfindOneCourse[2m > [22m[2mshould return course with lessons
[22m[39mðŸ§¹ Cleaning up after test...

[90mstdout[2m | src/courses/courses.service.spec.ts[2m > [22m[2mCoursesService (Pure Unit Test)[2m > [22m[2mfindOneCourse[2m > [22m[2mshould throw NotFoundException if course not found
[22m[39mðŸ§¹ Cleaning up after test...

[90mstdout[2m | src/courses/courses.service.spec.ts[2m > [22m[2mCoursesService (Pure Unit Test)[2m > [22m[2mupdateProgress[2m > [22m[2mshould upsert progress and reward points for first completion
[22m[39mðŸ§¹ Cleaning up after test...

[90mstdout[2m | src/courses/courses.service.spec.ts[2m > [22m[2mCoursesService (Pure Unit Test)[2m > [22m[2mupdateProgress[2m > [22m[2mshould not reward points if already completed
[22m[39mðŸ§¹ Cleaning up after test...

[90mstdout[2m | src/courses/courses.service.spec.ts[2m > [22m[2mCoursesService (Pure Unit Test)[2m > [22m[2mcreateLesson[2m > [22m[2mshould determine order automatically if not provided
[22m[39mðŸ§¹ Cleaning up after test...

[90mstdout[2m | src/courses/courses.service.spec.ts[2m > [22m[2mCoursesService (Pure Unit Test)[2m > [22m[2mcreateLesson[2m > [22m[2mshould start with order 1 if no lessons exist
[22m[39mðŸ§¹ Cleaning up after test...

[90mstdout[2m | src/courses/courses.service.spec.ts[2m > [22m[2mCoursesService (Pure Unit Test)[2m > [22m[2mupdateLesson[2m > [22m[2mshould update lesson data
[22m[39mðŸ§¹ Cleaning up after test...

 [32mâœ“[39m src/courses/courses.service.spec.ts[2m > [22mCoursesService (Pure Unit Test)[2m > [22mcreateCourse[2m > [22mshould create a course
 [32mâœ“[39m src/courses/courses.service.spec.ts[2m > [22mCoursesService (Pure Unit Test)[2m > [22mfindOneCourse[2m > [22mshould return course with lessons
 [32mâœ“[39m src/courses/courses.service.spec.ts[2m > [22mCoursesService (Pure Unit Test)[2m > [22mfindOneCourse[2m > [22mshould throw NotFoundException if course not found
 [32mâœ“[39m src/courses/courses.service.spec.ts[2m > [22mCoursesService (Pure Unit Test)[2m > [22mupdateProgress[2m > [22mshould upsert progress and reward points for first completion
 [32mâœ“[39m src/courses/courses.service.spec.ts[2m > [22mCoursesService (Pure Unit Test)[2m > [22mupdateProgress[2m > [22mshould not reward points if already completed
 [32mâœ“[39m src/courses/courses.service.spec.ts[2m > [22mCoursesService (Pure Unit Test)[2m > [22mcreateLesson[2m > [22mshould determine order automatically if not provided
 [32mâœ“[39m src/courses/courses.service.spec.ts[2m > [22mCoursesService (Pure Unit Test)[2m > [22mcreateLesson[2m > [22mshould start with order 1 if no lessons exist
 [32mâœ“[39m src/courses/courses.service.spec.ts[2m > [22mCoursesService (Pure Unit Test)[2m > [22mupdateLesson[2m > [22mshould update lesson data
 [32mâœ“[39m src/courses/courses.service.spec.ts[2m > [22mCoursesService (Pure Unit Test)[2m > [22mremoveLesson[2m > [22mshould delete lesson
[90mstdout[2m | src/courses/courses.service.spec.ts[2m > [22m[2mCoursesService (Pure Unit Test)[2m > [22m[2mremoveLesson[2m > [22m[2mshould delete lesson
[22m[39mðŸ§¹ Cleaning up after test...

[90mstdout[2m | src/courses/courses.service.spec.ts
[22m[39mðŸ”§ Vitest setup: Starting MSW mock server...
âœ… Vitest teardown complete

[90mstdout[2m | test/unit/ai/ai.service.spec.ts[2m > [22m[2mAiService[2m > [22m[2mcheckUserAIUsage[2m > [22m[2mshould throw ForbiddenException if rate limit is exceeded
[22m[39mðŸ§¹ Cleaning up after test...

[90mstdout[2m | test/unit/ai/ai.service.spec.ts[2m > [22m[2mAiService[2m > [22m[2mcheckUserAIUsage[2m > [22m[2mshould throw ForbiddenException if monthly budget is exceeded
[22m[39mðŸ§¹ Cleaning up after test...

[90mstdout[2m | test/unit/ai/ai.service.spec.ts[2m > [22m[2mAiService[2m > [22m[2mcheckUserAIUsage[2m > [22m[2mshould return total tokens used if within limits
[22m[39mðŸ§¹ Cleaning up after test...

[90mstdout[2m | test/unit/ai/ai.service.spec.ts[2m > [22m[2mAiService[2m > [22m[2mmaskPII[2m > [22m[2mshould mask email and sensitive fields
[22m[39mðŸ§¹ Cleaning up after test...

[90mstdout[2m | test/unit/ai/ai.service.spec.ts[2m > [22m[2mAiService[2m > [22m[2mgenerateResponse[2m > [22m[2mshould return cached response for FAQ if available
[22m[39mðŸ§¹ Cleaning up after test...

[90mstdout[2m | test/unit/ai/ai.service.spec.ts[2m > [22m[2mAiService[2m > [22m[2mgenerateResponse[2m > [22m[2mshould generate new response and cache it for FAQ
[22m[39mðŸ§¹ Cleaning up after test...

 [32mâœ“[39m test/unit/ai/ai.service.spec.ts[2m > [22mAiService[2m > [22mcheckUserAIUsage[2m > [22mshould throw ForbiddenException if rate limit is exceeded
 [32mâœ“[39m test/unit/ai/ai.service.spec.ts[2m > [22mAiService[2m > [22mcheckUserAIUsage[2m > [22mshould throw ForbiddenException if monthly budget is exceeded
 [32mâœ“[39m test/unit/ai/ai.service.spec.ts[2m > [22mAiService[2m > [22mcheckUserAIUsage[2m > [22mshould return total tokens used if within limits
 [32mâœ“[39m test/unit/ai/ai.service.spec.ts[2m > [22mAiService[2m > [22mmaskPII[2m > [22mshould mask email and sensitive fields
 [32mâœ“[39m test/unit/ai/ai.service.spec.ts[2m > [22mAiService[2m > [22mgenerateResponse[2m > [22mshould return cached response for FAQ if available
 [32mâœ“[39m test/unit/ai/ai.service.spec.ts[2m > [22mAiService[2m > [22mgenerateResponse[2m > [22mshould generate new response and cache it for FAQ
 [32mâœ“[39m test/unit/ai/ai.service.spec.ts[2m > [22mAiService[2m > [22mparseActionCards[2m > [22mshould extract action card metadata
[90mstdout[2m | test/unit/ai/ai.service.spec.ts[2m > [22m[2mAiService[2m > [22m[2mparseActionCards[2m > [22m[2mshould extract action card metadata
[22m[39mðŸ§¹ Cleaning up after test...

[90mstdout[2m | test/unit/ai/ai.service.spec.ts
[22m[39mðŸ”§ Vitest setup: Starting MSW mock server...
âœ… Vitest teardown complete

[90mstdout[2m | test/persona-simulation.e2e-spec.ts
[22m[39mðŸ”§ Vitest setup: Starting MSW mock server...

 [2m[90mâ†“[39m[22m test/persona-simulation.e2e-spec.ts[2m > [22mDeep Persona Simulation (Whale vs Risk-Averse)[2m > [22mWhale Persona nÃªn nháº­n Social Proof Nudge khi giao dá»‹ch lá»›n
 [2m[90mâ†“[39m[22m test/persona-simulation.e2e-spec.ts[2m > [22mDeep Persona Simulation (Whale vs Risk-Averse)[2m > [22mRisk-Averse Persona nÃªn nháº­n Loss Aversion Nudge khi gáº·p rá»§i ro cao
[90mstdout[2m | test/persona-simulation.e2e-spec.ts
[22m[39mâœ… Vitest teardown complete

[90mstdout[2m | test/auth-profile.integration.spec.ts
[22m[39m[dotenv@17.2.3] injecting env (0) from .env -- tip: ðŸ“¡ add observability to secrets: https://dotenvx.com/ops

[90mstdout[2m | test/auth-profile.integration.spec.ts
[22m[39mðŸ”§ Vitest setup: Starting MSW mock server...

[90mstdout[2m | test/auth-profile.integration.spec.ts[2m > [22m[2mAuth & Profile Integration[2m > [22m[2m1. Register â†’ Login â†’ Get Profile
[22m[39mðŸ§¹ Cleaning up after test...

[90mstdout[2m | test/auth-profile.integration.spec.ts[2m > [22m[2mAuth & Profile Integration[2m > [22m[2m2. Update Profile (Multi-locale)
[22m[39mðŸ§¹ Cleaning up after test...

[90mstdout[2m | test/auth-profile.integration.spec.ts[2m > [22m[2mAuth & Profile Integration[2m > [22m[2m3. Change Password
[22m[39mðŸ§¹ Cleaning up after test...

[90mstdout[2m | test/auth-profile.integration.spec.ts[2m > [22m[2mAuth & Profile Integration[2m > [22m[2m4. Token Refresh Logic
[22m[39mðŸ§¹ Cleaning up after test...

 [31mÃ—[39m test/auth-profile.integration.spec.ts[2m > [22mAuth & Profile Integration[2m > [22m1. Register â†’ Login â†’ Get Profile[33m 4088[2mms[22m[39m
[31m   â†’ expected 201 "Created", got 500 "Internal Server Error"[39m
 [31mÃ—[39m test/auth-profile.integration.spec.ts[2m > [22mAuth & Profile Integration[2m > [22m2. Update Profile (Multi-locale)
[31m   â†’ expected 200 "OK", got 401 "Unauthorized"[39m
 [31mÃ—[39m test/auth-profile.integration.spec.ts[2m > [22mAuth & Profile Integration[2m > [22m3. Change Password
[31m   â†’ expected 200 "OK", got 401 "Unauthorized"[39m
 [31mÃ—[39m test/auth-profile.integration.spec.ts[2m > [22mAuth & Profile Integration[2m > [22m4. Token Refresh Logic
[31m   â†’ expected 200 "OK", got 400 "Bad Request"[39m
[90mstdout[2m | test/auth-profile.integration.spec.ts[2m > [22m[2mAuth & Profile Integration[2m > [22m[2m5. Token Reuse Detection (Security)
[22m[39mðŸ§¹ Cleaning up after test...

 [31mÃ—[39m test/auth-profile.integration.spec.ts[2m > [22mAuth & Profile Integration[2m > [22m5. Token Reuse Detection (Security)[33m 4060[2mms[22m[39m
[31m   â†’ expected 401 "Unauthorized", got 500 "Internal Server Error"[39m
[90mstdout[2m | test/auth-profile.integration.spec.ts
[22m[39mâœ… Vitest teardown complete

[90mstdout[2m | src/modules/social/activity-feed.service.spec.ts[2m > [22m[2mActivityFeedService (SocialService)[2m > [22m[2mFeed Generation & Pagination[2m > [22m[2mshould fetch feed with pagination (limit and offset)
[22m[39mðŸ§¹ Cleaning up after test...

[90mstdout[2m | src/modules/social/activity-feed.service.spec.ts[2m > [22m[2mActivityFeedService (SocialService)[2m > [22m[2mFeed Generation & Pagination[2m > [22m[2mshould include friends activities in the feed
[22m[39mðŸ§¹ Cleaning up after test...

[90mstdout[2m | src/modules/social/activity-feed.service.spec.ts[2m > [22m[2mActivityFeedService (SocialService)[2m > [22m[2mLike & Comment Functionality[2m > [22m[2mshould increment likesCount when liking a post
[22m[39mðŸ§¹ Cleaning up after test...

[90mstdout[2m | src/modules/social/activity-feed.service.spec.ts[2m > [22m[2mActivityFeedService (SocialService)[2m > [22m[2mLike & Comment Functionality[2m > [22m[2mshould create a behavior log when commenting on a post
[22m[39mðŸ§¹ Cleaning up after test...

 [32mâœ“[39m src/modules/social/activity-feed.service.spec.ts[2m > [22mActivityFeedService (SocialService)[2m > [22mFeed Generation & Pagination[2m > [22mshould fetch feed with pagination (limit and offset)
 [32mâœ“[39m src/modules/social/activity-feed.service.spec.ts[2m > [22mActivityFeedService (SocialService)[2m > [22mFeed Generation & Pagination[2m > [22mshould include friends activities in the feed
 [32mâœ“[39m src/modules/social/activity-feed.service.spec.ts[2m > [22mActivityFeedService (SocialService)[2m > [22mLike & Comment Functionality[2m > [22mshould increment likesCount when liking a post
 [32mâœ“[39m src/modules/social/activity-feed.service.spec.ts[2m > [22mActivityFeedService (SocialService)[2m > [22mLike & Comment Functionality[2m > [22mshould create a behavior log when commenting on a post
 [32mâœ“[39m src/modules/social/activity-feed.service.spec.ts[2m > [22mActivityFeedService (SocialService)[2m > [22mMulti-user Activity Mocking[2m > [22mshould handle feed from multiple users across different groups
[90mstdout[2m | src/modules/social/activity-feed.service.spec.ts[2m > [22m[2mActivityFeedService (SocialService)[2m > [22m[2mMulti-user Activity Mocking[2m > [22m[2mshould handle feed from multiple users across different groups
[22m[39mðŸ§¹ Cleaning up after test...

[90mstdout[2m | src/modules/social/activity-feed.service.spec.ts
[22m[39mðŸ”§ Vitest setup: Starting MSW mock server...
âœ… Vitest teardown complete

[90mstdout[2m | src/storage/storage.service.spec.ts
[22m[39mðŸ”§ Vitest setup: Starting MSW mock server...

[90mstdout[2m | src/storage/storage.service.spec.ts[2m > [22m[2mStorageService[2m > [22m[2mshould be defined
[22m[39mðŸ§¹ Cleaning up after test...

[90mstdout[2m | src/storage/storage.service.spec.ts[2m > [22m[2mStorageService[2m > [22m[2muploadFile[2m > [22m[2mshould upload file successfully
[22m[39mðŸ§¹ Cleaning up after test...

[90mstdout[2m | src/storage/storage.service.spec.ts[2m > [22m[2mStorageService[2m > [22m[2muploadFile[2m > [22m[2mshould throw error if upload fails
[22m[39mðŸ§¹ Cleaning up after test...

[90mstdout[2m | src/storage/storage.service.spec.ts[2m > [22m[2mStorageService[2m > [22m[2mgetPresignedUrl[2m > [22m[2mshould generate a GET presigned URL
[22m[39mðŸ§¹ Cleaning up after test...

[90mstdout[2m | src/storage/storage.service.spec.ts[2m > [22m[2mStorageService[2m > [22m[2mgetPresignedUrl[2m > [22m[2mshould generate a PUT presigned URL
[22m[39mðŸ§¹ Cleaning up after test...

[90mstdout[2m | src/storage/storage.service.spec.ts[2m > [22m[2mStorageService[2m > [22m[2mgetSignedUrl[2m > [22m[2mshould return a presigned GET URL
[22m[39mðŸ§¹ Cleaning up after test...

[90mstdout[2m | src/storage/storage.service.spec.ts[2m > [22m[2mStorageService[2m > [22m[2mError Handling[2m > [22m[2mshould handle presigned URL generation failure
[22m[39mðŸ§¹ Cleaning up after test...

[90mstdout[2m | src/storage/storage.service.spec.ts[2m > [22m[2mStorageService[2m > [22m[2mError Handling[2m > [22m[2mshould use custom expiration time for presigned URLs
[22m[39mðŸ§¹ Cleaning up after test...

 [32mâœ“[39m src/storage/storage.service.spec.ts[2m > [22mStorageService[2m > [22mshould be defined
 [32mâœ“[39m src/storage/storage.service.spec.ts[2m > [22mStorageService[2m > [22muploadFile[2m > [22mshould upload file successfully
 [32mâœ“[39m src/storage/storage.service.spec.ts[2m > [22mStorageService[2m > [22muploadFile[2m > [22mshould throw error if upload fails
 [32mâœ“[39m src/storage/storage.service.spec.ts[2m > [22mStorageService[2m > [22mgetPresignedUrl[2m > [22mshould generate a GET presigned URL
 [32mâœ“[39m src/storage/storage.service.spec.ts[2m > [22mStorageService[2m > [22mgetPresignedUrl[2m > [22mshould generate a PUT presigned URL
 [32mâœ“[39m src/storage/storage.service.spec.ts[2m > [22mStorageService[2m > [22mgetSignedUrl[2m > [22mshould return a presigned GET URL
 [32mâœ“[39m src/storage/storage.service.spec.ts[2m > [22mStorageService[2m > [22mError Handling[2m > [22mshould handle presigned URL generation failure
 [32mâœ“[39m src/storage/storage.service.spec.ts[2m > [22mStorageService[2m > [22mError Handling[2m > [22mshould use custom expiration time for presigned URLs
 [32mâœ“[39m src/storage/storage.service.spec.ts[2m > [22mStorageService[2m > [22mConfiguration Fallback[2m > [22mshould fall back to environment variables if ConfigService unavailable
[90mstdout[2m | src/storage/storage.service.spec.ts[2m > [22m[2mStorageService[2m > [22m[2mConfiguration Fallback[2m > [22m[2mshould fall back to environment variables if ConfigService unavailable
[22m[39mðŸ§¹ Cleaning up after test...

[90mstdout[2m | src/storage/storage.service.spec.ts
[22m[39mâœ… Vitest teardown complete

[90mstdout[2m | test/multi-market-stress.e2e-spec.ts
[22m[39mðŸ”§ Vitest setup: Starting MSW mock server...

[90mstdout[2m | test/multi-market-stress.e2e-spec.ts[2m > [22m[2mMulti-Market Market Stress Test (VI/EN/ZH Localized Content)
[22m[39mðŸ‘¥ Setting up 60 users across vi, en, zh...

 [2m[90mâ†“[39m[22m test/multi-market-stress.e2e-spec.ts[2m > [22mMulti-Market Market Stress Test (VI/EN/ZH Localized Content)[2m > [22mNÃªn xá»­ lÃ½ 3000 hÃ nh vi vá»›i localized content sharding
[90mstdout[2m | test/multi-market-stress.e2e-spec.ts
[22m[39mâœ… Vitest teardown complete

[90mstdout[2m | src/modules/social/social.gateway.spec.ts[2m > [22m[2mSocialGateway[2m > [22m[2mshould be defined
[22m[39mðŸ§¹ Cleaning up after test...

[90mstdout[2m | src/modules/social/social.gateway.spec.ts[2m > [22m[2mSocialGateway[2m > [22m[2mhandleConnection[2m > [22m[2mshould emit connection_established event
[22m[39mClient connected: socket-id
ðŸ§¹ Cleaning up after test...

[90mstdout[2m | src/modules/social/social.gateway.spec.ts[2m > [22m[2mSocialGateway[2m > [22m[2mhandleDisconnect[2m > [22m[2mshould clean up connectedClients and emit user_offline if client was identified
[22m[39mClient disconnected: socket-id
ðŸ§¹ Cleaning up after test...

[90mstdout[2m | src/modules/social/social.gateway.spec.ts[2m > [22m[2mSocialGateway[2m > [22m[2mhandleDisconnect[2m > [22m[2mshould do nothing if client was not identified
[22m[39mClient disconnected: socket-id
ðŸ§¹ Cleaning up after test...

[90mstdout[2m | src/modules/social/social.gateway.spec.ts[2m > [22m[2mSocialGateway[2m > [22m[2mhandleIdentify[2m > [22m[2mshould map userId to socketId and join user room
[22m[39mðŸ§¹ Cleaning up after test...

[90mstdout[2m | src/modules/social/social.gateway.spec.ts[2m > [22m[2mSocialGateway[2m > [22m[2mhandleIdentify[2m > [22m[2mshould force disconnect previous connection if same userId connects again
[22m[39mðŸ§¹ Cleaning up after test...

[90mstdout[2m | src/modules/social/social.gateway.spec.ts[2m > [22m[2mSocialGateway[2m > [22m[2mhandleJoinGroup[2m > [22m[2mshould join group room
[22m[39mðŸ§¹ Cleaning up after test...

[90mstdout[2m | src/modules/social/social.gateway.spec.ts[2m > [22m[2mSocialGateway[2m > [22m[2mBroadcasting methods[2m > [22m[2msendToUser should emit to user room
[22m[39mðŸ§¹ Cleaning up after test...

[90mstdout[2m | src/modules/social/social.gateway.spec.ts[2m > [22m[2mSocialGateway[2m > [22m[2mBroadcasting methods[2m > [22m[2mbroadcastToGroup should emit to group room
[22m[39mðŸ§¹ Cleaning up after test...

 [32mâœ“[39m src/modules/social/social.gateway.spec.ts[2m > [22mSocialGateway[2m > [22mshould be defined
 [32mâœ“[39m src/modules/social/social.gateway.spec.ts[2m > [22mSocialGateway[2m > [22mhandleConnection[2m > [22mshould emit connection_established event
 [32mâœ“[39m src/modules/social/social.gateway.spec.ts[2m > [22mSocialGateway[2m > [22mhandleDisconnect[2m > [22mshould clean up connectedClients and emit user_offline if client was identified
 [32mâœ“[39m src/modules/social/social.gateway.spec.ts[2m > [22mSocialGateway[2m > [22mhandleDisconnect[2m > [22mshould do nothing if client was not identified
 [32mâœ“[39m src/modules/social/social.gateway.spec.ts[2m > [22mSocialGateway[2m > [22mhandleIdentify[2m > [22mshould map userId to socketId and join user room
 [32mâœ“[39m src/modules/social/social.gateway.spec.ts[2m > [22mSocialGateway[2m > [22mhandleIdentify[2m > [22mshould force disconnect previous connection if same userId connects again
 [32mâœ“[39m src/modules/social/social.gateway.spec.ts[2m > [22mSocialGateway[2m > [22mhandleJoinGroup[2m > [22mshould join group room
 [32mâœ“[39m src/modules/social/social.gateway.spec.ts[2m > [22mSocialGateway[2m > [22mBroadcasting methods[2m > [22msendToUser should emit to user room
 [32mâœ“[39m src/modules/social/social.gateway.spec.ts[2m > [22mSocialGateway[2m > [22mBroadcasting methods[2m > [22mbroadcastToGroup should emit to group room
 [32mâœ“[39m src/modules/social/social.gateway.spec.ts[2m > [22mSocialGateway[2m > [22mBroadcasting methods[2m > [22mbroadcastNewPost should emit to all
[90mstdout[2m | src/modules/social/social.gateway.spec.ts[2m > [22m[2mSocialGateway[2m > [22m[2mBroadcasting methods[2m > [22m[2mbroadcastNewPost should emit to all
[22m[39mðŸ§¹ Cleaning up after test...

[90mstdout[2m | src/modules/social/social.gateway.spec.ts
[22m[39mðŸ”§ Vitest setup: Starting MSW mock server...
âœ… Vitest teardown complete

[90mstdout[2m | src/auth/roles.guard.spec.ts[2m > [22m[2mRolesGuard[2m > [22m[2mshould be defined
[22m[39mðŸ§¹ Cleaning up after test...

[90mstdout[2m | src/auth/roles.guard.spec.ts[2m > [22m[2mRolesGuard[2m > [22m[2mcanActivate[2m > [22m[2mshould allow access when no roles required
[22m[39mðŸ§¹ Cleaning up after test...

[90mstdout[2m | src/auth/roles.guard.spec.ts[2m > [22m[2mRolesGuard[2m > [22m[2mcanActivate[2m > [22m[2mshould allow access when user has required role (STUDENT)
[22m[39mðŸ§¹ Cleaning up after test...

[90mstdout[2m | src/auth/roles.guard.spec.ts[2m > [22m[2mRolesGuard[2m > [22m[2mcanActivate[2m > [22m[2mshould allow access when user has required role (TEACHER)
[22m[39mðŸ§¹ Cleaning up after test...

[90mstdout[2m | src/auth/roles.guard.spec.ts[2m > [22m[2mRolesGuard[2m > [22m[2mcanActivate[2m > [22m[2mshould allow access when user has required role (ADMIN)
[22m[39mðŸ§¹ Cleaning up after test...

[90mstdout[2m | src/auth/roles.guard.spec.ts[2m > [22m[2mRolesGuard[2m > [22m[2mcanActivate[2m > [22m[2mshould allow access when user has one of multiple required roles
[22m[39mðŸ§¹ Cleaning up after test...

[90mstdout[2m | src/auth/roles.guard.spec.ts[2m > [22m[2mRolesGuard[2m > [22m[2mcanActivate[2m > [22m[2mshould deny access when user lacks required role
[22m[39mðŸ§¹ Cleaning up after test...

[90mstdout[2m | src/auth/roles.guard.spec.ts[2m > [22m[2mRolesGuard[2m > [22m[2mcanActivate[2m > [22m[2mshould deny access when user has no role
[22m[39mðŸ§¹ Cleaning up after test...

[90mstdout[2m | src/auth/roles.guard.spec.ts[2m > [22m[2mRolesGuard[2m > [22m[2mcanActivate[2m > [22m[2mshould handle multiple required roles (deny if none match)
[22m[39mðŸ§¹ Cleaning up after test...

 [32mâœ“[39m src/auth/roles.guard.spec.ts[2m > [22mRolesGuard[2m > [22mshould be defined
 [32mâœ“[39m src/auth/roles.guard.spec.ts[2m > [22mRolesGuard[2m > [22mcanActivate[2m > [22mshould allow access when no roles required
 [32mâœ“[39m src/auth/roles.guard.spec.ts[2m > [22mRolesGuard[2m > [22mcanActivate[2m > [22mshould allow access when user has required role (STUDENT)
 [32mâœ“[39m src/auth/roles.guard.spec.ts[2m > [22mRolesGuard[2m > [22mcanActivate[2m > [22mshould allow access when user has required role (TEACHER)
 [32mâœ“[39m src/auth/roles.guard.spec.ts[2m > [22mRolesGuard[2m > [22mcanActivate[2m > [22mshould allow access when user has required role (ADMIN)
 [32mâœ“[39m src/auth/roles.guard.spec.ts[2m > [22mRolesGuard[2m > [22mcanActivate[2m > [22mshould allow access when user has one of multiple required roles
 [32mâœ“[39m src/auth/roles.guard.spec.ts[2m > [22mRolesGuard[2m > [22mcanActivate[2m > [22mshould deny access when user lacks required role
 [32mâœ“[39m src/auth/roles.guard.spec.ts[2m > [22mRolesGuard[2m > [22mcanActivate[2m > [22mshould deny access when user has no role
 [32mâœ“[39m src/auth/roles.guard.spec.ts[2m > [22mRolesGuard[2m > [22mcanActivate[2m > [22mshould handle multiple required roles (deny if none match)
 [32mâœ“[39m src/auth/roles.guard.spec.ts[2m > [22mRolesGuard[2m > [22mcanActivate[2m > [22mshould extract roles from handler and class metadata
[90mstdout[2m | src/auth/roles.guard.spec.ts[2m > [22m[2mRolesGuard[2m > [22m[2mcanActivate[2m > [22m[2mshould extract roles from handler and class metadata
[22m[39mðŸ§¹ Cleaning up after test...

[90mstdout[2m | src/auth/roles.guard.spec.ts
[22m[39mðŸ”§ Vitest setup: Starting MSW mock server...
âœ… Vitest teardown complete

[90mstdout[2m | src/modules/nudge/nudge-engine.service.spec.ts[2m > [22m[2mNudgeEngineService (Pure Unit Test)[2m > [22m[2mshould be defined
[22m[39mðŸ§¹ Cleaning up after test...

[90mstdout[2m | src/modules/nudge/nudge-engine.service.spec.ts[2m > [22m[2mNudgeEngineService (Pure Unit Test)[2m > [22m[2mgenerateNudge[2m > [22m[2mshould return null for unknown context
[22m[39mðŸ§¹ Cleaning up after test...

[90mstdout[2m | src/modules/nudge/nudge-engine.service.spec.ts[2m > [22m[2mNudgeEngineService (Pure Unit Test)[2m > [22m[2mgenerateNudge[2m > [22m[2mINVESTMENT_DECISION[2m > [22m[2mshould return SOCIAL_PROOF nudge for HUNTER persona
[22m[39mðŸ§¹ Cleaning up after test...

[90mstdout[2m | src/modules/nudge/nudge-engine.service.spec.ts[2m > [22m[2mNudgeEngineService (Pure Unit Test)[2m > [22m[2mgenerateNudge[2m > [22m[2mINVESTMENT_DECISION[2m > [22m[2mshould return LOSS_AVERSION nudge for high risk level
[22m[39mðŸ§¹ Cleaning up after test...

[90mstdout[2m | src/modules/nudge/nudge-engine.service.spec.ts[2m > [22m[2mNudgeEngineService (Pure Unit Test)[2m > [22m[2mgenerateNudge[2m > [22m[2mBUDGETING[2m > [22m[2mshould return GOAL_GRADIENT for SAVER persona
[22m[39mðŸ§¹ Cleaning up after test...

[90mstdout[2m | src/modules/nudge/nudge-engine.service.spec.ts[2m > [22m[2mNudgeEngineService (Pure Unit Test)[2m > [22m[2mgenerateNudge[2m > [22m[2mBUDGETING[2m > [22m[2mshould return SALIENCE nudge showing equivalent coffee cups
[22m[39mðŸ§¹ Cleaning up after test...

[90mstdout[2m | src/modules/nudge/nudge-engine.service.spec.ts[2m > [22m[2mNudgeEngineService (Pure Unit Test)[2m > [22m[2mgenerateNudge[2m > [22m[2mSTREAK_WARNING[2m > [22m[2mshould return GOAL_GRADIENT for streak warning
[22m[39mðŸ§¹ Cleaning up after test...

 [32mâœ“[39m src/modules/nudge/nudge-engine.service.spec.ts[2m > [22mNudgeEngineService (Pure Unit Test)[2m > [22mshould be defined
 [32mâœ“[39m src/modules/nudge/nudge-engine.service.spec.ts[2m > [22mNudgeEngineService (Pure Unit Test)[2m > [22mgenerateNudge[2m > [22mshould return null for unknown context
 [32mâœ“[39m src/modules/nudge/nudge-engine.service.spec.ts[2m > [22mNudgeEngineService (Pure Unit Test)[2m > [22mgenerateNudge[2m > [22mINVESTMENT_DECISION[2m > [22mshould return SOCIAL_PROOF nudge for HUNTER persona
 [32mâœ“[39m src/modules/nudge/nudge-engine.service.spec.ts[2m > [22mNudgeEngineService (Pure Unit Test)[2m > [22mgenerateNudge[2m > [22mINVESTMENT_DECISION[2m > [22mshould return LOSS_AVERSION nudge for high risk level
 [32mâœ“[39m src/modules/nudge/nudge-engine.service.spec.ts[2m > [22mNudgeEngineService (Pure Unit Test)[2m > [22mgenerateNudge[2m > [22mBUDGETING[2m > [22mshould return GOAL_GRADIENT for SAVER persona
 [32mâœ“[39m src/modules/nudge/nudge-engine.service.spec.ts[2m > [22mNudgeEngineService (Pure Unit Test)[2m > [22mgenerateNudge[2m > [22mBUDGETING[2m > [22mshould return SALIENCE nudge showing equivalent coffee cups
 [32mâœ“[39m src/modules/nudge/nudge-engine.service.spec.ts[2m > [22mNudgeEngineService (Pure Unit Test)[2m > [22mgenerateNudge[2m > [22mSTREAK_WARNING[2m > [22mshould return GOAL_GRADIENT for streak warning
 [32mâœ“[39m src/modules/nudge/nudge-engine.service.spec.ts[2m > [22mNudgeEngineService (Pure Unit Test)[2m > [22mgenerateNudge[2m > [22mEdge Cases[2m > [22mshould handle missing user profile gracefully
[90mstdout[2m | src/modules/nudge/nudge-engine.service.spec.ts[2m > [22m[2mNudgeEngineService (Pure Unit Test)[2m > [22m[2mgenerateNudge[2m > [22m[2mEdge Cases[2m > [22m[2mshould handle missing user profile gracefully
[22m[39mðŸ§¹ Cleaning up after test...

[90mstdout[2m | src/modules/nudge/nudge-engine.service.spec.ts
[22m[39mðŸ”§ Vitest setup: Starting MSW mock server...
âœ… Vitest teardown complete

 [32mâœ“[39m src/modules/analytics/mentor.service.spec.ts[2m > [22mMentorService (Phase 7 Integration Test)[2m > [22mshould be defined
 [32mâœ“[39m src/modules/analytics/mentor.service.spec.ts[2m > [22mMentorService (Phase 7 Integration Test)[2m > [22mshould select STRICT_COACH persona for a HUNTER user
 [32mâœ“[39m src/modules/analytics/mentor.service.spec.ts[2m > [22mMentorService (Phase 7 Integration Test)[2m > [22mshould trigger variable reward logic (random chance)
[90mstdout[2m | src/modules/analytics/mentor.service.spec.ts[2m > [22m[2mMentorService (Phase 7 Integration Test)[2m > [22m[2mshould be defined
[22m[39mðŸ§¹ Cleaning up after test...

[90mstdout[2m | src/modules/analytics/mentor.service.spec.ts[2m > [22m[2mMentorService (Phase 7 Integration Test)[2m > [22m[2mshould select STRICT_COACH persona for a HUNTER user
[22m[39mðŸ§¹ Cleaning up after test...

[90mstdout[2m | src/modules/analytics/mentor.service.spec.ts[2m > [22m[2mMentorService (Phase 7 Integration Test)[2m > [22m[2mshould trigger variable reward logic (random chance)
[22m[39mðŸ§¹ Cleaning up after test...

[90mstdout[2m | src/modules/analytics/mentor.service.spec.ts
[22m[39mðŸ”§ Vitest setup: Starting MSW mock server...
âœ… Vitest teardown complete

[90mstdout[2m | src/modules/social/friends.service.spec.ts[2m > [22m[2mSocialService - Friends System[2m > [22m[2mFriend Requests[2m > [22m[2mshould send a friend request
[22m[39mðŸ§¹ Cleaning up after test...

[90mstdout[2m | src/modules/social/friends.service.spec.ts[2m > [22m[2mSocialService - Friends System[2m > [22m[2mFriend Requests[2m > [22m[2mshould accept a friend request
[22m[39mðŸ§¹ Cleaning up after test...

[90mstdout[2m | src/modules/social/friends.service.spec.ts[2m > [22m[2mSocialService - Friends System[2m > [22m[2mFriend Requests[2m > [22m[2mshould reject a friend request
[22m[39mðŸ§¹ Cleaning up after test...

[90mstdout[2m | src/modules/social/friends.service.spec.ts[2m > [22m[2mSocialService - Friends System[2m > [22m[2mBlocking[2m > [22m[2mshould block a user
[22m[39mðŸ§¹ Cleaning up after test...

[90mstdout[2m | src/modules/social/friends.service.spec.ts[2m > [22m[2mSocialService - Friends System[2m > [22m[2mBlocking[2m > [22m[2mshould unblock a user
[22m[39mðŸ§¹ Cleaning up after test...

 [32mâœ“[39m src/modules/social/friends.service.spec.ts[2m > [22mSocialService - Friends System[2m > [22mFriend Requests[2m > [22mshould send a friend request
 [32mâœ“[39m src/modules/social/friends.service.spec.ts[2m > [22mSocialService - Friends System[2m > [22mFriend Requests[2m > [22mshould accept a friend request
 [32mâœ“[39m src/modules/social/friends.service.spec.ts[2m > [22mSocialService - Friends System[2m > [22mFriend Requests[2m > [22mshould reject a friend request
 [32mâœ“[39m src/modules/social/friends.service.spec.ts[2m > [22mSocialService - Friends System[2m > [22mBlocking[2m > [22mshould block a user
 [32mâœ“[39m src/modules/social/friends.service.spec.ts[2m > [22mSocialService - Friends System[2m > [22mBlocking[2m > [22mshould unblock a user
 [32mâœ“[39m src/modules/social/friends.service.spec.ts[2m > [22mSocialService - Friends System[2m > [22mActivity Feed[2m > [22mshould get friend activity feed
[90mstdout[2m | src/modules/social/friends.service.spec.ts[2m > [22m[2mSocialService - Friends System[2m > [22m[2mActivity Feed[2m > [22m[2mshould get friend activity feed
[22m[39mðŸ§¹ Cleaning up after test...

[90mstdout[2m | src/modules/social/friends.service.spec.ts
[22m[39mðŸ”§ Vitest setup: Starting MSW mock server...
âœ… Vitest teardown complete

[90mstdout[2m | src/users/users.service.spec.ts[2m > [22m[2mUsersService[2m > [22m[2mshould be defined
[22m[39mðŸ§¹ Cleaning up after test...

[90mstdout[2m | src/users/users.service.spec.ts[2m > [22m[2mUsersService[2m > [22m[2mfindOne[2m > [22m[2mshould find user by email
[22m[39mðŸ§¹ Cleaning up after test...

[90mstdout[2m | src/users/users.service.spec.ts[2m > [22m[2mUsersService[2m > [22m[2mfindById[2m > [22m[2mshould find user by id
[22m[39mðŸ§¹ Cleaning up after test...

[90mstdout[2m | src/users/users.service.spec.ts[2m > [22m[2mUsersService[2m > [22m[2mcreate[2m > [22m[2mshould create a new user
[22m[39mðŸ§¹ Cleaning up after test...

[90mstdout[2m | src/users/users.service.spec.ts[2m > [22m[2mUsersService[2m > [22m[2mgetDashboardStats[2m > [22m[2mshould return correct stats
[22m[39mðŸ§¹ Cleaning up after test...

[90mstdout[2m | src/users/users.service.spec.ts[2m > [22m[2mUsersService[2m > [22m[2mgetDashboardStats[2m > [22m[2mshould handle zero stats
[22m[39mðŸ§¹ Cleaning up after test...

[90mstdout[2m | src/users/users.service.spec.ts
[22m[39mðŸ”§ Vitest setup: Starting MSW mock server...
âœ… Vitest teardown complete

 [32mâœ“[39m src/users/users.service.spec.ts[2m > [22mUsersService[2m > [22mshould be defined
 [32mâœ“[39m src/users/users.service.spec.ts[2m > [22mUsersService[2m > [22mfindOne[2m > [22mshould find user by email
 [32mâœ“[39m src/users/users.service.spec.ts[2m > [22mUsersService[2m > [22mfindById[2m > [22mshould find user by id
 [32mâœ“[39m src/users/users.service.spec.ts[2m > [22mUsersService[2m > [22mcreate[2m > [22mshould create a new user
 [32mâœ“[39m src/users/users.service.spec.ts[2m > [22mUsersService[2m > [22mgetDashboardStats[2m > [22mshould return correct stats
 [32mâœ“[39m src/users/users.service.spec.ts[2m > [22mUsersService[2m > [22mgetDashboardStats[2m > [22mshould handle zero stats
[90mstdout[2m | src/modules/leaderboard/leaderboard.service.spec.ts[2m > [22m[2mLeaderboardService[2m > [22m[2mgetTopUsers[2m > [22m[2mshould return top users with formatted names
[22m[39mðŸ§¹ Cleaning up after test...

[90mstdout[2m | src/modules/leaderboard/leaderboard.service.spec.ts[2m > [22m[2mLeaderboardService[2m > [22m[2mgetGlobalRanking[2m > [22m[2mshould return correct rank and percentile
[22m[39mðŸ§¹ Cleaning up after test...

[90mstdout[2m | src/modules/leaderboard/leaderboard.service.spec.ts[2m > [22m[2mLeaderboardService[2m > [22m[2mgetGlobalRanking[2m > [22m[2mshould throw error if user not found
[22m[39mðŸ§¹ Cleaning up after test...

[90mstdout[2m | src/modules/leaderboard/leaderboard.service.spec.ts[2m > [22m[2mLeaderboardService[2m > [22m[2mgetPeriodicLeaderboard[2m > [22m[2mshould aggregate scores for daily period
[22m[39mðŸ§¹ Cleaning up after test...

[90mstdout[2m | src/modules/leaderboard/leaderboard.service.spec.ts[2m > [22m[2mLeaderboardService[2m > [22m[2mgetPeriodicLeaderboard[2m > [22m[2mshould work for weekly period
[22m[39mðŸ§¹ Cleaning up after test...

[90mstdout[2m | src/modules/leaderboard/leaderboard.service.spec.ts[2m > [22m[2mLeaderboardService[2m > [22m[2mgetPeriodicLeaderboard[2m > [22m[2mshould work for monthly period
[22m[39mðŸ§¹ Cleaning up after test...

[90mstdout[2m | src/modules/leaderboard/leaderboard.service.spec.ts
[22m[39mðŸ”§ Vitest setup: Starting MSW mock server...
âœ… Vitest teardown complete

 [32mâœ“[39m src/modules/leaderboard/leaderboard.service.spec.ts[2m > [22mLeaderboardService[2m > [22mgetTopUsers[2m > [22mshould return top users with formatted names
 [32mâœ“[39m src/modules/leaderboard/leaderboard.service.spec.ts[2m > [22mLeaderboardService[2m > [22mgetGlobalRanking[2m > [22mshould return correct rank and percentile
 [32mâœ“[39m src/modules/leaderboard/leaderboard.service.spec.ts[2m > [22mLeaderboardService[2m > [22mgetGlobalRanking[2m > [22mshould throw error if user not found
 [32mâœ“[39m src/modules/leaderboard/leaderboard.service.spec.ts[2m > [22mLeaderboardService[2m > [22mgetPeriodicLeaderboard[2m > [22mshould aggregate scores for daily period
 [32mâœ“[39m src/modules/leaderboard/leaderboard.service.spec.ts[2m > [22mLeaderboardService[2m > [22mgetPeriodicLeaderboard[2m > [22mshould work for weekly period
 [32mâœ“[39m src/modules/leaderboard/leaderboard.service.spec.ts[2m > [22mLeaderboardService[2m > [22mgetPeriodicLeaderboard[2m > [22mshould work for monthly period
[90mstdout[2m | test/integration/auth-flow.e2e-spec.ts
[22m[39m[dotenv@17.2.3] injecting env (0) from .env -- tip: ðŸ” prevent committing .env to code: https://dotenvx.com/precommit

[90mstdout[2m | test/integration/auth-flow.e2e-spec.ts
[22m[39mðŸ”§ Vitest setup: Starting MSW mock server...

 [2m[90mâ†“[39m[22m test/integration/auth-flow.e2e-spec.ts[2m > [22mAuth Integration (e2e)[2m > [22mshould register a new user
 [2m[90mâ†“[39m[22m test/integration/auth-flow.e2e-spec.ts[2m > [22mAuth Integration (e2e)[2m > [22mshould login and return tokens
 [2m[90mâ†“[39m[22m test/integration/auth-flow.e2e-spec.ts[2m > [22mAuth Integration (e2e)[2m > [22mshould fail login with wrong password
[90mstdout[2m | test/integration/auth-flow.e2e-spec.ts
[22m[39mâœ… Vitest teardown complete

 [2m[90mâ†“[39m[22m test/system-resilience.e2e-spec.ts[2m > [22mSystem Resilience (e2e)[2m > [22mResilience: Global Error Boundary[2m > [22mshould catch forced errors and return structured ErrorId
 [2m[90mâ†“[39m[22m test/system-resilience.e2e-spec.ts[2m > [22mSystem Resilience (e2e)[2m > [22mResilience: Manual Rate Limiting (AI)[2m > [22mshould throw ForbiddenException when AI rate limit exceeded
 [2m[90mâ†“[39m[22m test/system-resilience.e2e-spec.ts[2m > [22mSystem Resilience (e2e)[2m > [22mResilience: Health Check Reliability[2m > [22mshould return 200 for metrics Content successfully
 [2m[90mâ†“[39m[22m test/system-resilience.e2e-spec.ts[2m > [22mSystem Resilience (e2e)[2m > [22mResilience: Security Headers[2m > [22mshould include Helmet security headers on successful requests
[90mstdout[2m | test/system-resilience.e2e-spec.ts
[22m[39mðŸ”§ Vitest setup: Starting MSW mock server...
âœ… Vitest teardown complete

[90mstdout[2m | src/modules/social/sharing.service.spec.ts[2m > [22m[2mSharingService[2m > [22m[2mgenerateAchievementShareLink[2m > [22m[2mshould generate a base64 encoded share link and track the event
[22m[39mðŸ§¹ Cleaning up after test...

[90mstdout[2m | src/modules/social/sharing.service.spec.ts[2m > [22m[2mSharingService[2m > [22m[2mgetSocialMetaTags[2m > [22m[2mshould generate localized meta tags for an achievement
[22m[39mðŸ§¹ Cleaning up after test...

[90mstdout[2m | src/modules/social/sharing.service.spec.ts[2m > [22m[2mSharingService[2m > [22m[2mgetSocialMetaTags[2m > [22m[2mshould return default tags if achievement is not found
[22m[39mðŸ§¹ Cleaning up after test...

[90mstdout[2m | src/modules/social/sharing.service.spec.ts[2m > [22m[2mSharingService[2m > [22m[2mtrackViralLoop[2m > [22m[2mshould log a visit event for the viral loop
[22m[39mðŸ§¹ Cleaning up after test...

 [32mâœ“[39m src/modules/social/sharing.service.spec.ts[2m > [22mSharingService[2m > [22mgenerateAchievementShareLink[2m > [22mshould generate a base64 encoded share link and track the event
 [32mâœ“[39m src/modules/social/sharing.service.spec.ts[2m > [22mSharingService[2m > [22mgetSocialMetaTags[2m > [22mshould generate localized meta tags for an achievement
 [32mâœ“[39m src/modules/social/sharing.service.spec.ts[2m > [22mSharingService[2m > [22mgetSocialMetaTags[2m > [22mshould return default tags if achievement is not found
 [32mâœ“[39m src/modules/social/sharing.service.spec.ts[2m > [22mSharingService[2m > [22mtrackViralLoop[2m > [22mshould log a visit event for the viral loop
[90mstdout[2m | src/modules/social/sharing.service.spec.ts
[22m[39mðŸ”§ Vitest setup: Starting MSW mock server...
âœ… Vitest teardown complete

[90mstdout[2m | src/modules/analytics/predictive.service.spec.ts[2m > [22m[2mPredictiveService (Plan 1 - Unit Test)[2m > [22m[2mshould calculate HIGH churn risk when activity gap is large
[22m[39mðŸ§¹ Cleaning up after test...

[90mstdout[2m | src/modules/analytics/predictive.service.spec.ts[2m > [22m[2mPredictiveService (Plan 1 - Unit Test)[2m > [22m[2mshould calculate LOW churn risk when activity gap is small
[22m[39mðŸ§¹ Cleaning up after test...

[90mstdout[2m | src/modules/analytics/predictive.service.spec.ts[2m > [22m[2mPredictiveService (Plan 1 - Unit Test)[2m > [22m[2mshould return LOW risk if not enough logs
[22m[39mðŸ§¹ Cleaning up after test...

[90mstdout[2m | src/modules/analytics/predictive.service.spec.ts[2m > [22m[2mPredictiveService (Plan 1 - Unit Test)[2m > [22m[2mshould include persona context in financial simulation
[22m[39mðŸ§¹ Cleaning up after test...

[90mstdout[2m | src/modules/analytics/predictive.service.spec.ts
[22m[39mðŸ”§ Vitest setup: Starting MSW mock server...
âœ… Vitest teardown complete

 [32mâœ“[39m src/modules/analytics/predictive.service.spec.ts[2m > [22mPredictiveService (Plan 1 - Unit Test)[2m > [22mshould calculate HIGH churn risk when activity gap is large
 [32mâœ“[39m src/modules/analytics/predictive.service.spec.ts[2m > [22mPredictiveService (Plan 1 - Unit Test)[2m > [22mshould calculate LOW churn risk when activity gap is small
 [32mâœ“[39m src/modules/analytics/predictive.service.spec.ts[2m > [22mPredictiveService (Plan 1 - Unit Test)[2m > [22mshould return LOW risk if not enough logs
 [32mâœ“[39m src/modules/analytics/predictive.service.spec.ts[2m > [22mPredictiveService (Plan 1 - Unit Test)[2m > [22mshould include persona context in financial simulation
[90mstdout[2m | test/social-stress.e2e-spec.ts
[22m[39mðŸ”§ Vitest setup: Starting MSW mock server...

[90mstdout[2m | test/social-stress.e2e-spec.ts[2m > [22m[2mSocial Stress Test (1000+ Connections Simulation)[2m > [22m[2mNÃªn xá»­ lÃ½ thÃ nh cÃ´ng 500 káº¿t ná»‘i WebSocket Ä‘á»“ng thá»i
[22m[39mðŸš€ Äang khá»Ÿi táº¡o 500 káº¿t ná»‘i trÃªn port 63741...

[90mstdout[2m | test/social-stress.e2e-spec.ts[2m > [22m[2mSocial Stress Test (1000+ Connections Simulation)[2m > [22m[2mNÃªn xá»­ lÃ½ thÃ nh cÃ´ng 500 káº¿t ná»‘i WebSocket Ä‘á»“ng thá»i
[22m[39mClient connected: WQpcj-_Nz7sE2mbSAABC
Client connected: O8YVOOZbM71B07oJAABD
Client connected: J68nVl7Id-ES8s4DAABE
Client connected: YZZglFy9g9h6YGmAAABF
Client connected: RTivD3v1xg4C7aaqAABG
Client connected: irc2uzpby2cg882lAABH
Client connected: XyKAIoHn-2uHzDKjAABI
Client connected: 9svW6hf2luSW4C7HAABJ
Client connected: t2s1NMyUgAm5WjIjAABK
Client connected: 3EEunU_icImHT-fbAABL
Client connected: bQSE9mRyrhSCMKHNAABM
Client connected: 6KQEXgceNx-xcZpGAABN
Client connected: 4drYjrwYx_RcD4RYAABO
Client connected: qcUgmfZ9pGrBpG0WAABP
Client connected: GG26G7HLKWikFPOwAABQ
Client connected: IuDngbNwo4T3pB9OAABR
Client connected: r6dj9z40I4XiYNgfAABS
Client connected: AQK9ayom6L1pG5kgAABT
Client connected: HOr1OunOSilaD7_LAABU
Client connected: Ci9k2EnwcpVY5qacAABV
Client connected: CPH2XscV12olMW3kAABW
Client connected: iNxYlOwGXLcdUGWTAABX
Client connected: 8W0E6onWKN7FEu8GAABY
Client connected: RBpwA2C0wbl4kuSBAABZ
Client connected: En_RSWh5E9eRPL0WAABa
Client connected: kw7l0nOrWR-gB8GSAABb
Client connected: n4gMlDRWHVdPkXXVAABc
Client connected: hB_0YUMsa56mowd6AABd
Client connected: a2J9uQZrreiiaz0BAABe
Client connected: RPlQKpQiNckTYsGnAABf
Client connected: yuDIwCi3ZCCK5HtYAABg
Client connected: 4wKKHJimhJx_i00qAABh
Client connected: z4JIhY9b_DRhORo8AABi
Client connected: 0EcYYvUuHE3XhJtFAABj
Client connected: tvfjFZ1M7qCVuhXLAABk
Client connected: r3MKIn2ekvsV6oc3AABl
Client connected: yfyKjdhieCYoYpR3AABm
Client connected: L8Ev2OAF3wvmkYlrAABn
Client connected: 5ujB9X6GlMyAxfezAABo
Client connected: 9umWXvShKnokBnsXAABp
Client connected: ByR-vPJUmclp3H09AABq
Client connected: HM1BZyLdhsepIzNFAABr
Client connected: WPM2p52zrtiuDr-SAABs
Client connected: ALNWq7sa-2ULut-HAABt
Client connected: VMoD7n6fausGW-YjAABu
Client connected: 83UZ_qjkTYsjUnAxAABv
Client connected: RJpNQvgWi4p8Yx3BAABw
Client connected: DQHsLL1I4j8xhE6UAABx
Client connected: jrSB-N1VwF4BSTeTAABy
Client connected: laTeIee-PMejdUaoAABz

[90mstdout[2m | test/social-stress.e2e-spec.ts[2m > [22m[2mSocial Stress Test (1000+ Connections Simulation)[2m > [22m[2mNÃªn xá»­ lÃ½ thÃ nh cÃ´ng 500 káº¿t ná»‘i WebSocket Ä‘á»“ng thá»i
[22m[39mClient connected: GPeBl-uBs_Pe-YaaAACm
Client connected: FH6yHfPCtT6J70LSAACn
Client connected: TITUnF3TCJj3oekoAACo
Client connected: esoRriJ4koMNYuo-AACp
Client connected: gh9W-VOKoItwDIVJAACq
Client connected: rZtu8Dp2z-LVwbiAAACr
Client connected: oVKsY863iwnqlppiAACs
Client connected: 17zehxXnR81dGrIeAACt
Client connected: pC9DeFVjPRwYJsYBAACu
Client connected: 5BrJ46PUwbamNTiUAACv
Client connected: Lo9kGZmFHvu0Vkw6AACw
Client connected: 5bMnSbFWjbwJXoH4AACx
Client connected: rHOH-IHzkhMT9M8jAACy
Client connected: DemfkuddDU_GVZC5AACz
Client connected: ZIASUpFEPbh-huACAAC0
Client connected: JS1lKs3EcnbVemzgAAC1
Client connected: HXmZdpByA64X1Yt6AAC2
Client connected: qmQqCFNJtIZqdjeGAAC3
Client connected: PNCtdb73PrsZ0VgtAAC4
Client connected: 3ZtedetAzbhptA4WAAC5
Client connected: lKkzDuD4OSau5VYmAAC6
Client connected: E4v0TZh-yDhSvzYmAAC7
Client connected: nVu_UbGPaknXtf13AAC8
Client connected: UOlQwwTvrIkKSCrmAAC9
Client connected: xDZpkQnkDp-VlPwPAAC-
Client connected: pJ-FmBQXBpOkgS2BAAC_
Client connected: zvc9ZquC7S_hJlwcAADA
Client connected: kqgwKJoXjRoDG5GXAADB
Client connected: -WwoPEmmh5lKNgLVAADC
Client connected: 4o1g5FCdgWtBKlVlAADD
Client connected: ffbfRuEqoOxUEw0iAADE
Client connected: EyXSgVG4D5-ASIeeAADF
Client connected: KiCMF1erfL1anbAcAADG
Client connected: QmpP_r5yfQgRPz69AADH
Client connected: t9yn3zG5qCxHLufyAADI
Client connected: tC7B5ioN-tLvun0pAADJ
Client connected: gwP75M1ylEzFm6yfAADK
Client connected: BERyv_c414i48r__AADL
Client connected: S6f5QYoX5b-9zOKDAADM
Client connected: VSjkx1IOnCeXME93AADN
Client connected: -r2Li6c7JvIuZn2KAADO
Client connected: SI2PvJNjIJZeQ662AADP
Client connected: kvLyd6BCOe5-4M4hAADQ
Client connected: Kzaq_BLc_3IJ3SwOAADR
Client connected: ezREmcXa8pXL2SCgAADS
Client connected: kVc_Orx_h7M3iZdZAADT
Client connected: hTmx-z4CfTt_fB5aAADU
Client connected: CnPbhE5N9S2YLfY8AADV
Client connected: SjyxaxG9g99JVsB0AADW
Client connected: i7cHIk4RMM0bAs3HAADX

[90mstdout[2m | test/social-stress.e2e-spec.ts[2m > [22m[2mSocial Stress Test (1000+ Connections Simulation)[2m > [22m[2mNÃªn xá»­ lÃ½ thÃ nh cÃ´ng 500 káº¿t ná»‘i WebSocket Ä‘á»“ng thá»i
[22m[39mClient connected: 2_COq0SpO8EtYJ7NAAEK
Client connected: Kj069aNBCIt_Q8e9AAEL
Client connected: EBVUF8TB2mQ07rMuAAEM
Client connected: hbHSOkJWgZ13T4CTAAEN
Client connected: 5nfer7TZLRY0PTcSAAEO
Client connected: -YmTcQFzf9AymYfTAAEP
Client connected: s8-5_WAAZV9sI8GxAAEQ
Client connected: jBS0YJnJr1Ekw4c0AAER
Client connected: 6eeaT_gfw910ZxfQAAES
Client connected: 8y4s1Yfd_dfywZNAAAET
Client connected: -mgS44CqFYqmKugmAAEU
Client connected: tORjWw5CoVOEFCgVAAEV
Client connected: mOEW7yGbbaExyPPnAAEW
Client connected: N9L85q8GqkbX2DLXAAEX
Client connected: cdMufA6WJlcl0BVYAAEY
Client connected: MNBmjdQWggyD5uZXAAEZ
Client connected: eDZLVdPgRLFu3YsMAAEa
Client connected: ey1KlhIuOMD8lt6EAAEb
Client connected: GjqXNq-AZ0CzPM6BAAEc
Client connected: q0gNXT9X5Q3-LsFzAAEd
Client connected: 6u5E30rBD1qxgtQdAAEe
Client connected: vt8DSvppOzCPTEaLAAEf
Client connected: zLUj38Hk947b4A1NAAEg
Client connected: Au1s4z2U48WfbigzAAEh
Client connected: Hqc-OLf9SFB_-1z3AAEi
Client connected: 2e1-DUFpDmp1qrYtAAEj
Client connected: SzlhWwCZ-1kCXOnZAAEk
Client connected: sNDLG5p4h_feBiVjAAEl
Client connected: YvO77B1GfA2QAMGVAAEm
Client connected: 8uz3iFXb5QBuDru3AAEn
Client connected: iS3ULw3_2UFiiqY3AAEo
Client connected: Fp3tM1-AZBWt4OTvAAEp
Client connected: U9tZ9ICka9kpmLllAAEq
Client connected: 8fB2AktMX1P6XfkDAAEr
Client connected: sb0zgc-V0peoHAKWAAEs
Client connected: oDIvucEcJCdp7NdjAAEt
Client connected: afyFRmLsUSLBnmn6AAEu
Client connected: IFnaG7K-5MqSRtVAAAEv
Client connected: ClWgt5oOZJm4v6vqAAEw
Client connected: 4ePUHAhik_RuphqkAAEx
Client connected: rPviX44UEYQPgnahAAEy
Client connected: 5f8QE0BhNeddsRMZAAEz
Client connected: ybTjOtqQI2MPJ9TsAAE0
Client connected: L-8RFmVBiEnts281AAE1
Client connected: ilQ2TWk4oKz798xSAAE2
Client connected: zK2LRkgYFNjIlfcPAAE3
Client connected: TAONylPER4djwO70AAE4
Client connected: RZwkdA6aURpi_c6hAAE5
Client connected: 4Zi1Rp3d3abk-8FTAAE6
Client connected: TOAna8ZzzSmyAgSTAAE7

[90mstdout[2m | test/social-stress.e2e-spec.ts[2m > [22m[2mSocial Stress Test (1000+ Connections Simulation)[2m > [22m[2mNÃªn xá»­ lÃ½ thÃ nh cÃ´ng 500 káº¿t ná»‘i WebSocket Ä‘á»“ng thá»i
[22m[39mClient connected: 3eHY2bYa_ynOUiZ1AAFu
Client connected: 297_g1BH7jpArUKBAAFv
Client connected: X7z8the8qGOH_12kAAFw
Client connected: 5TrLg5UP8tJeSu3-AAFx
Client connected: uL0OTGyuXs6PhjxKAAFy
Client connected: kHi9tIrYC8wPAsbpAAFz
Client connected: qBo62VlkOJJ2WM2WAAF0
Client connected: pdJx1SeG0qB0PnIVAAF1
Client connected: OXJ1bz2dpDy_Dqy5AAF2
Client connected: K0ab5eO_M79eyOuaAAF3
Client connected: fgaDfkhMOs1riHY4AAF4
Client connected: oUAxhGvqn6o3lbQRAAF5
Client connected: u3BMxK0QBrH20h1yAAF6
Client connected: mCnvAaolzOrlRMLHAAF7
Client connected: YS9cu500JCOw19IMAAF8
Client connected: _LPxgyVLBPMp6697AAF9
Client connected: 4GYZArdXDrCH8dU1AAF-
Client connected: pq7fyl_aFmLOGsD3AAF_
Client connected: sMpOW_nMWw5Ls9o6AAGA
Client connected: bQS8n561QZJBiDJLAAGB
Client connected: a5y65GyXWfsU1p01AAGC
Client connected: i6ElCZL7ZK2sru-6AAGD
Client connected: ZHw6CckATzb76Vb2AAGE
Client connected: zVE34UVmVWwCBLjiAAGF
Client connected: sMhoJd4qq0ugxSSyAAGG
Client connected: WgbVrThf3tBGoIC4AAGH
Client connected: 17eOpF-kkQWj_CFQAAGI
Client connected: qTzKMyQnrQY0RdiOAAGJ
Client connected: YMyFkTK_Ig-3mYdxAAGK
Client connected: _zlQL-XPWI6oAjzXAAGL
Client connected: 72y6kniBtwWAaWvZAAGM
Client connected: 6DCJpHVV83rNlS4lAAGN
Client connected: wyk7ipWAMqEtVmNKAAGO
Client connected: v2vifav4Oq0LKaB7AAGP
Client connected: a3f96UmOwuZWsiBXAAGQ
Client connected: 8hE-zag7eZL3Q1SPAAGR
Client connected: DhrSq5UbQX0vyXlXAAGS
Client connected: j-xvebj5-Jt0IN7QAAGT
Client connected: tA7IW57qAHroj5l2AAGU
Client connected: H9I_p8ZTjIF6JDUaAAGV
Client connected: cglADGOl6hjgAmepAAGW
Client connected: rNNbjLQCVh418cb4AAGX
Client connected: jjzWMBF8-OJr01iHAAGY
Client connected: hoZh5nOcZwniq7PUAAGZ
Client connected: FrhUsbHYDlgyPCFWAAGa
Client connected: zmC044ku2PMAJogfAAGb
Client connected: LRTpT3mtqaamhd5iAAGc
Client connected: Vvfvp20hfbLiir1tAAGd
Client connected: SIzj1o_MyINjJg70AAGe
Client connected: VwQlfiEJkmARYqUHAAGf

[90mstdout[2m | test/social-stress.e2e-spec.ts[2m > [22m[2mSocial Stress Test (1000+ Connections Simulation)[2m > [22m[2mNÃªn xá»­ lÃ½ thÃ nh cÃ´ng 500 káº¿t ná»‘i WebSocket Ä‘á»“ng thá»i
[22m[39mClient connected: 2wDeGLtUzoUadf6TAAHS
Client connected: Ntc7k4tStB1kG7ctAAHT
Client connected: neZTmJQxpYei1BTWAAHU
Client connected: mLLAuyEjLcpqE8sYAAHV
Client connected: jCM6AaRb9NQqBPRyAAHW
Client connected: WbFpouwV1tkFhbh2AAHX
Client connected: N3mPInW7mg7GNijzAAHY
Client connected: _A_qIdgYU13gmJncAAHZ
Client connected: hmOydlEuctwukeW4AAHa
Client connected: 26fzD9-5crhY-2QuAAHb
Client connected: LCd9U-LzFetxc3siAAHc
Client connected: 2CJ5pMICqPjWZSkkAAHd
Client connected: UjsZBPSeyd9Jq-zGAAHe
Client connected: v4ho5ZaRwLuU3czJAAHf
Client connected: qKEtO_oMyRKAq_EgAAHg
Client connected: 9DgTmT1brKQTLaXcAAHh
Client connected: fEiq6LS_rZsGSnoKAAHi
Client connected: zOqaGiuhLCKR8oILAAHj
Client connected: m1n02EzLow7cbYpmAAHk
Client connected: MbejdGNaazThNerUAAHl
Client connected: CqS2a0yowUXQFeOqAAHm
Client connected: lAFChDLOWft2P-DwAAHn
Client connected: h0kcUyqN4ktmOScfAAHo
Client connected: eSE_f5D5KK4hmgpjAAHp
Client connected: 3jhuifSn_BHz9SA6AAHq
Client connected: C2xvY4dqNCr_n3IpAAHr
Client connected: arJyPBy6m3Sd5To6AAHs
Client connected: _IJKfzlbfsdQl1KRAAHt
Client connected: 2dDr8aruhI0Iwx5ZAAHu
Client connected: LOdIIrA-yRb0J9F9AAHv
Client connected: TT21ZefqPR1OaoNFAAHw
Client connected: Ub2k2uonWoy6zP37AAHx
Client connected: seQiykpC3zLhSHM2AAHy
Client connected: -nxwHB4yGdl6dIqrAAHz
Client connected: XbKzBpqumJIa0n14AAH0
Client connected: tZn3ngDEyyLpmOZpAAH1
Client connected: AqP8H8zMVd_iQT_WAAH2
Client connected: RcdHrqTuVbH0am-EAAH3
Client connected: rEYn0cmTc7Xt62ppAAH4
Client connected: tmLJ_wSsdSBwmo7wAAH5
Client connected: thhLMWfZCNWKOVJjAAH6
Client connected: 3DB7HIwsUQuud2MvAAH7
Client connected: 0K40BdJr91mVN5DmAAH8
Client connected: xDEZub0g3oJypjp7AAH9
Client connected: 6SKEgjtlWdIS53NGAAH-
Client connected: tpTkD00X4Q3ZcF6_AAH_
Client connected: YNgVMuctSznAL1VoAAIA
Client connected: _Xibq6LuVFA0L2acAAIB
Client connected: pUWN4kKF84WMApPsAAIC
Client connected: vEeRIIdE200E62aGAAID

[90mstdout[2m | test/social-stress.e2e-spec.ts[2m > [22m[2mSocial Stress Test (1000+ Connections Simulation)[2m > [22m[2mNÃªn xá»­ lÃ½ thÃ nh cÃ´ng 500 káº¿t ná»‘i WebSocket Ä‘á»“ng thá»i
[22m[39mClient connected: MJfUsodh0uFQuiApAAI2
Client connected: sFUP7xiEYQ9zKm9VAAI3
Client connected: KHpWYXW3SjVSvJLpAAI4
Client connected: bydAHhKBBBdFicJ6AAI5
Client connected: yxCntlF-m2XhRcAmAAI6
Client connected: 72EKwciu8YSI77G8AAI7
Client connected: VzZyW4WPXG3XnlEhAAI8
Client connected: 5d7TBbAmi2VO-oyFAAI9
Client connected: ymusNBLfCdscznHqAAI-
Client connected: q1tGu9vW7bss4aOFAAI_
Client connected: pQcKYWYVK-DLr8aMAAJA
Client connected: GGZX5NxzUy1MKPPlAAJB
Client connected: EDG2v92shbpO3V6XAAJC
Client connected: q4Q6a_9rnLSVwAv_AAJD
Client connected: WyvjbcloSJQ0Fj3VAAJE
Client connected: K9syq48uhNWvKJi6AAJF
Client connected: voCzc-xDqfWhaHSLAAJG
Client connected: ta2LsueUjZfFpV_AAAJH
Client connected: GqqHU2afcIDZZRIHAAJI
Client connected: L8c2TnCByaeyhOm6AAJJ
Client connected: jW7xTr8EmrS4GyH7AAJK
Client connected: 7JPc3_Y43E5XAgQ6AAJL
Client connected: 1nM1oby4wVrq-zpkAAJM
Client connected: B5SiguMCLb3JHbfLAAJN
Client connected: XFlF-hRrzPIHb3XsAAJO
Client connected: WA0K1fBujh37R96vAAJP
Client connected: clvxS2jCVuinpqUyAAJQ
Client connected: DSh0ELa_yNMgoicEAAJR
Client connected: cgyEN5E0byg52n1-AAJS
Client connected: 4mXFJMiawwJpJmdAAAJT
Client connected: KhwI7L2TG21v3wvAAAJU
Client connected: Kowxo999OBcCUlF2AAJV
Client connected: apXYdEe-S54CoQGGAAJW
Client connected: T2b94lNnzuNdh0lfAAJX
Client connected: 81ku35-qyc6oUNiRAAJY
Client connected: XJ3uXsFPtQ25unWYAAJZ
Client connected: FRdmgAb6kvd0I71zAAJa
Client connected: BoiAXKdshc8TSJWVAAJb
Client connected: _nCqpc6J6mJCfxhvAAJc
Client connected: i_lZNCYhr-NadDgxAAJd
Client connected: 5OVWhHh54iP2gHYhAAJe
Client connected: MgLeXSdvSFq7XBjEAAJf
Client connected: J5ndAfBhfzzTq-VuAAJg
Client connected: qh0Ryef1iZeCVXtFAAJh
Client connected: D7JLe1WQ3-v1AH4FAAJi
Client connected: ukocmRFxLfHM5m3XAAJj
Client connected: EkmTUnQYt_E6Vt_cAAJk
Client connected: 0FjWUrc9ywgc-TUDAAJl
Client connected: a4714zKVXAnmZqTeAAJm
Client connected: V2ubrX4XITnr7XIBAAJn

[90mstdout[2m | test/social-stress.e2e-spec.ts[2m > [22m[2mSocial Stress Test (1000+ Connections Simulation)[2m > [22m[2mNÃªn xá»­ lÃ½ thÃ nh cÃ´ng 500 káº¿t ná»‘i WebSocket Ä‘á»“ng thá»i
[22m[39mClient connected: 2iG8u_iS1bU3CyN5AAKa
Client connected: P7YGgQZd9QZ1qOIeAAKb
Client connected: lmnoMlcmBa3nmzeLAAKc
Client connected: 04yIQVJDAnXVID7jAAKd
Client connected: 06WILd237M7e47F8AAKe
Client connected: naxAs2zTUalUzQycAAKf
Client connected: 0ZhBiXZ3nsazetQxAAKg
Client connected: ejJ9DAucK08PTK9aAAKh
Client connected: tW0ognZbXJeHB3tpAAKi
Client connected: S7VBmI-CglDTPA7tAAKj
Client connected: KofL-UWMVc9EbpisAAKk
Client connected: SOrfB0A0z465KYlAAAKl
Client connected: rwdlS04qQAbc73OLAAKm
Client connected: B9x4pCHOqTsfVv_eAAKn
Client connected: Pai8x1pORyls1scSAAKo
Client connected: T8rDr1HdVB7_bTWeAAKp
Client connected: zxoIEipuN7BvI-2oAAKq
Client connected: bBAQV9lHTnqWkbloAAKr
Client connected: Ag9bzy6d0nW1raUhAAKs
Client connected: YK7maIN-Sso5rgiZAAKt
Client connected: 1WPNiTdYTvZXlWepAAKu
Client connected: OPGg-JHFmRt8fshvAAKv
Client connected: c04N9rvyG5GDc8KlAAKw
Client connected: 2oVe95SH3IX6Q2hjAAKx
Client connected: fCbAgthopQOkXiyOAAKy
Client connected: L2Muy2jSgTwwCPA4AAKz
Client connected: VasVy-jNAfheJW7UAAK0
Client connected: Gcnl8b9fXP2EGEnXAAK1
Client connected: kj2p1u8Y2UW9LTSZAAK2
Client connected: hxThkTuGaB2YcNioAAK3
Client connected: -DXfEKA5BuD0Ih3gAAK4
Client connected: hSr-29YaD1U6yXuhAAK5
Client connected: cwElWoRt_Yc5mOMZAAK6
Client connected: H_a5t64EqRnVORHxAAK7
Client connected: 3mWtaeTClJvLcLmrAAK8
Client connected: ydg3U-G91RPfWhacAAK9
Client connected: Smi-vEG5b8OXYtnDAAK-
Client connected: 9IL3ye0hCQEVypE2AAK_
Client connected: 1tcAdeppYOO-MghXAALA
Client connected: jn8iL499tSrohZISAALB
Client connected: 2yxZA2tj2B-hmTToAALC
Client connected: FUzZ1LnXT-rgLJ_9AALD
Client connected: l2jw22Jg-H2qRhb_AALE
Client connected: -UkSEsIKxAMtt3HiAALF
Client connected: eFxP_Ggnuw2amT34AALG
Client connected: EvFpmOWOUUGwhM_eAALH
Client connected: HZj-UQTUej55ovdRAALI
Client connected: ftob8XfT71l1OQNAAALJ
Client connected: edtZkBq_SDcuXp5hAALK
Client connected: tKCdlihZ7rIBf4L2AALL

[90mstdout[2m | test/social-stress.e2e-spec.ts[2m > [22m[2mSocial Stress Test (1000+ Connections Simulation)[2m > [22m[2mNÃªn xá»­ lÃ½ thÃ nh cÃ´ng 500 káº¿t ná»‘i WebSocket Ä‘á»“ng thá»i
[22m[39mClient connected: 5KTIOTkCASiNOzGpAAL-
Client connected: 1puUFdTFWGB9ko9gAAL_
Client connected: t8yKd6qRp7Z2htoHAAMA
Client connected: 218lvMRVeii8I2ClAAMB
Client connected: Uuc2PxHIM_aX6zKZAAMC
Client connected: gKquby2dOiAsWHrkAAMD
Client connected: Ciu0O82IQLbuRYC2AAME
Client connected: CuEPi63x4ifBSoqhAAMF
Client connected: Xew-Il4p7xudQuWKAAMG
Client connected: C-iWj7w0SYGFhnkZAAMH
Client connected: xNvaaJ0nlo2jhEvNAAMI
Client connected: 0g-r9KJGdbcI8gUOAAMJ
Client connected: 8hpmfAQB0qKYyKcIAAMK
Client connected: RKISJsRAyPN5IpCaAAML
Client connected: 1qiktKPaUE_YYAKHAAMM
Client connected: aDyufvDnuCAY8NafAAMN
Client connected: aq9NT4oOEjK4znZYAAMO
Client connected: lMkvpqEjS_4KDePlAAMP
Client connected: GK_no-RvpoHgkQ_RAAMQ
Client connected: Rvo27h9FOMyg1cuhAAMR
Client connected: z_-xw_KsWrAWji9kAAMS
Client connected: 6T-MyHG-be7W3tHBAAMT
Client connected: S59f1O4k_820VMEOAAMU
Client connected: HvaxsjeQpG4-I6HRAAMV
Client connected: yVvwu3TGZLvcahoiAAMW
Client connected: Wa5kBXaC6i6rmP8PAAMX
Client connected: 5DaZzDY714sKD6E0AAMY
Client connected: VEp5xRwA_fJ4-YAyAAMZ
Client connected: VTj28IMU9io1B6snAAMa
Client connected: Pfv74ImZvpvchNcSAAMb
Client connected: 2bTASXDI23o25LamAAMc
Client connected: Ywwq1R6UKqQJdgWWAAMd
Client connected: jcDIxadcJk3UE5_lAAMe
Client connected: RXYdQY2q_08NksULAAMf
Client connected: SWERpYrvGeoEXWtoAAMg
Client connected: y1sngmumxIduiTxzAAMh
Client connected: 1esrBFlWjqF_iNavAAMi
Client connected: rRO1zV47HZdbCpfHAAMj
Client connected: iY4Nl98MxOIpsMxQAAMk
Client connected: 9LDHTGyOZDJCIonbAAMl
Client connected: S5vNH-jHCav6k9LXAAMm
Client connected: h4Cv88xC9dr_z4lPAAMn
Client connected: YkdtJ_WXyTgNt3QkAAMo
Client connected: OBJT_1sgQHzdgjrxAAMp
Client connected: yc-G6Qumvoui-o2GAAMq
Client connected: Rnik-xquvaW1USf1AAMr
Client connected: YbwXwm0HAoglfzv-AAMs
Client connected: iVS6niBg6p54h601AAMt
Client connected: 1oEZFKi5zaDyzW_bAAMu
Client connected: TLp8Du0_UjIynuSrAAMv

[90mstdout[2m | test/social-stress.e2e-spec.ts[2m > [22m[2mSocial Stress Test (1000+ Connections Simulation)[2m > [22m[2mNÃªn xá»­ lÃ½ thÃ nh cÃ´ng 500 káº¿t ná»‘i WebSocket Ä‘á»“ng thá»i
[22m[39mClient connected: Nr7IUC8pZ054toyrAANi
Client connected: haOuLNZYdfAUOZNAAANj
Client connected: QTlT0kEQ-vKlr6iyAANk
Client connected: pimPw_eujgbHmexSAANl
Client connected: s2zq_j3vGHGQrsQ0AANm
Client connected: _KMXYhKOku-iTr_QAANn
Client connected: RyZAPfDhLz8UzUoOAANo
Client connected: 4N9FF_bTkI7y4dfLAANp
Client connected: M-4vjvS4wVORYShpAANq
Client connected: VKkcBJ9G3udFPjJMAANr
Client connected: A1NptnaTXhKa-Pv2AANs
Client connected: zhom2iasPjMlmW0iAANt
Client connected: TeWwxWrm_sQjejbEAANu
Client connected: zq1xU3WiVoK42RVMAANv
Client connected: 1xuUsVVtSxyohpQuAANw
Client connected: 942PM2JSQxEObROiAANx
Client connected: OUa-juE_1luWyNLiAANy
Client connected: 7xMCtJXKFdn-0AdOAANz
Client connected: 7zKWNF_UexkfGSyaAAN0
Client connected: BrdfI8VpfvwqdNe4AAN1
Client connected: as1PfZ5rzEw7hwnYAAN2
Client connected: zg2v3Piiubse85CNAAN3
Client connected: 4tETryG4BNaD--9fAAN4
Client connected: iA7y81OFzp9EunBxAAN5
Client connected: bhXp_61MaSoKJcEfAAN6
Client connected: 94vBluBUbfSNEXzIAAN7
Client connected: 2s0Bqfk5jTkHEeicAAN8
Client connected: evZiR7e14nvLTfTaAAN9
Client connected: j60d4UxV0tTy6KHzAAN-
Client connected: JvkOlWyfYF7_YO8gAAN_
Client connected: PnLaQgIaXA7QZj1QAAOA
Client connected: eMIKZ9SgI_8w49i2AAOB
Client connected: LNWMafwsVA0V5DjpAAOC
Client connected: owjr4NmMyWTmx1sCAAOD
Client connected: BXSnChIU76rJ20cGAAOE
Client connected: 1BMUhtrfStKGq5X7AAOF
Client connected: 4z_DTx4NXIhSewcqAAOG
Client connected: D2Ugr0Y9zVZsRb9GAAOH
Client connected: I5SbNWdkqvo0k0bkAAOI
Client connected: 4SMk8KUzzVMBTUpvAAOJ
Client connected: u5JIBmcJcNyafhXFAAOK
Client connected: 0TfNH8GBSGjyPGT5AAOL
Client connected: Nl7WiZXRwZdqJPRFAAOM
Client connected: nBAJu8rulLFyt3FoAAON
Client connected: Qa50w8qRUymvbaP7AAOO
Client connected: 0IvuH-A0olsA-hH0AAOP
Client connected: drnDqpbOj2WpuVZiAAOQ
Client connected: PiJJDe09GUPLl8DPAAOR
Client connected: RR1ZLekZVzaZl7eBAAOS
Client connected: ZbfrCFyC8IhBrxZAAAOT

[90mstdout[2m | test/social-stress.e2e-spec.ts[2m > [22m[2mSocial Stress Test (1000+ Connections Simulation)[2m > [22m[2mNÃªn xá»­ lÃ½ thÃ nh cÃ´ng 500 káº¿t ná»‘i WebSocket Ä‘á»“ng thá»i
[22m[39mClient connected: ZJVvJTZpd0RMp9SsAAPG
Client connected: FnrV1q8VkZ0D-GhXAAPH
Client connected: LeuvqvHZPddHHVq2AAPI
Client connected: iK-OP91huzsgXTHkAAPJ
Client connected: ovtsFkYV2_ZK8cuYAAPK
Client connected: JcCYmPaPVt3PQdiuAAPL
Client connected: S-U0tjq_WaicznB-AAPM
Client connected: 9Gq2wRfkQbu0FcApAAPN
Client connected: pWLWGE_IdIlAYGlfAAPO
Client connected: pC3-gkxY-f9xrargAAPP
Client connected: WCaAMmtdk4pmhj63AAPQ
Client connected: ecLbTMTDpNBhxT1CAAPR
Client connected: 9ytFQzC_-iH0x83FAAPS
Client connected: IQtHKXMmROkNILbWAAPT
Client connected: _iUJ8O2YPuHMyqvHAAPU
Client connected: TRZsWaaw2V53GHnaAAPV
Client connected: C5Ux8ACjpggG2XTGAAPW
Client connected: C3a-5YX31McfXkQCAAPX
Client connected: NbpI8oalMw6JuV1yAAPY
Client connected: xrhvH9LZxq_IBdYCAAPZ
Client connected: OSAvwADFwl8Glo5sAAPa
Client connected: 5AZhXXaOYNwPiHabAAPb
Client connected: YTLHBnxGFVMjzKdBAAPc
Client connected: SSWKl-0RwdYQspMNAAPd
Client connected: eCoNZ4_j5gyIx0DSAAPe
Client connected: gcYzCwUxI6N6kD1yAAPf
Client connected: Dr4VX0mA1RZDgaVYAAPg
Client connected: hF1QBeAPDY-jaT4CAAPh
Client connected: mOxFc1VwrBO2KHrMAAPi
Client connected: C9MGI4lH26DIy1RHAAPj
Client connected: Vd4BYyOYp-U_5o6UAAPk
Client connected: UoOlYZohjyUEdT9YAAPl
Client connected: sSVPg5M2bkA3MUPIAAPm
Client connected: OMftprMO2QWYijnDAAPn
Client connected: aMDRpZxM0x7hbVhdAAPo
Client connected: Jk-5-odAiYXfewElAAPp
Client connected: RPZp7D8L76aTi4jPAAPq
Client connected: qJ9YScv8UzSp4V5HAAPr
Client connected: R_M_7GirZjqSKf6LAAPs
Client connected: yCVwogtfR0wOUIZlAAPt
Client connected: fQYHsTJnnObVKA3MAAPu
Client connected: p4SILVW7I1mqkCv2AAPv
Client connected: FxZeKslKjFDmDkXEAAPw
Client connected: XofA9qBCYSMS5I7GAAPx
Client connected: Y-trdanfwOuLaTSzAAPy
Client connected: Y6DswMcp9aLoHcwgAAPz
Client connected: VM4UH5j7-8F6Jg7aAAP0
Client connected: -23s3300DJEu2azHAAP1
Client connected: LQYFoee-pVyo56uuAAP2
Client connected: uh7hUwQNzqVC7QgsAAP3
âœ… ÄÃ£ káº¿t ná»‘i 500 clients.
ðŸ“¢ Testing Broadcast latency...
â±ï¸ Broadcast duration: 10ms
ðŸ§¹ Cleaning up after test...

[90mstdout[2m | test/social-stress.e2e-spec.ts[2m > [22m[2mSocial Stress Test (1000+ Connections Simulation)
[22m[39mClient disconnected: WQpcj-_Nz7sE2mbSAABC
Client disconnected: O8YVOOZbM71B07oJAABD
Client disconnected: J68nVl7Id-ES8s4DAABE
Client disconnected: YZZglFy9g9h6YGmAAABF
Client disconnected: RTivD3v1xg4C7aaqAABG
Client disconnected: irc2uzpby2cg882lAABH
Client disconnected: XyKAIoHn-2uHzDKjAABI
Client disconnected: 9svW6hf2luSW4C7HAABJ
Client disconnected: t2s1NMyUgAm5WjIjAABK
Client disconnected: 3EEunU_icImHT-fbAABL
Client disconnected: bQSE9mRyrhSCMKHNAABM
Client disconnected: 6KQEXgceNx-xcZpGAABN
Client disconnected: 4drYjrwYx_RcD4RYAABO
Client disconnected: qcUgmfZ9pGrBpG0WAABP
Client disconnected: GG26G7HLKWikFPOwAABQ
Client disconnected: IuDngbNwo4T3pB9OAABR
Client disconnected: r6dj9z40I4XiYNgfAABS
Client disconnected: AQK9ayom6L1pG5kgAABT
Client disconnected: HOr1OunOSilaD7_LAABU
Client disconnected: Ci9k2EnwcpVY5qacAABV
Client disconnected: CPH2XscV12olMW3kAABW
Client disconnected: iNxYlOwGXLcdUGWTAABX
Client disconnected: 8W0E6onWKN7FEu8GAABY
Client disconnected: RBpwA2C0wbl4kuSBAABZ
Client disconnected: En_RSWh5E9eRPL0WAABa
Client disconnected: kw7l0nOrWR-gB8GSAABb
Client disconnected: n4gMlDRWHVdPkXXVAABc
Client disconnected: hB_0YUMsa56mowd6AABd
Client disconnected: a2J9uQZrreiiaz0BAABe
Client disconnected: RPlQKpQiNckTYsGnAABf
Client disconnected: yuDIwCi3ZCCK5HtYAABg
Client disconnected: 4wKKHJimhJx_i00qAABh
Client disconnected: z4JIhY9b_DRhORo8AABi
Client disconnected: 0EcYYvUuHE3XhJtFAABj
Client disconnected: tvfjFZ1M7qCVuhXLAABk
Client disconnected: r3MKIn2ekvsV6oc3AABl
Client disconnected: yfyKjdhieCYoYpR3AABm
Client disconnected: L8Ev2OAF3wvmkYlrAABn
Client disconnected: 5ujB9X6GlMyAxfezAABo
Client disconnected: 9umWXvShKnokBnsXAABp
Client disconnected: ByR-vPJUmclp3H09AABq
Client disconnected: HM1BZyLdhsepIzNFAABr
Client disconnected: WPM2p52zrtiuDr-SAABs
Client disconnected: ALNWq7sa-2ULut-HAABt
Client disconnected: VMoD7n6fausGW-YjAABu
Client disconnected: 83UZ_qjkTYsjUnAxAABv
Client disconnected: RJpNQvgWi4p8Yx3BAABw
Client disconnected: DQHsLL1I4j8xhE6UAABx
Client disconnected: jrSB-N1VwF4BSTeTAABy
Client disconnected: laTeIee-PMejdUaoAABz
Client disconnected: GPeBl-uBs_Pe-YaaAACm
Client disconnected: FH6yHfPCtT6J70LSAACn
Client disconnected: TITUnF3TCJj3oekoAACo
Client disconnected: esoRriJ4koMNYuo-AACp
Client disconnected: gh9W-VOKoItwDIVJAACq
Client disconnected: rZtu8Dp2z-LVwbiAAACr
Client disconnected: oVKsY863iwnqlppiAACs
Client disconnected: 17zehxXnR81dGrIeAACt
Client disconnected: pC9DeFVjPRwYJsYBAACu
Client disconnected: 5BrJ46PUwbamNTiUAACv
Client disconnected: Lo9kGZmFHvu0Vkw6AACw
Client disconnected: 5bMnSbFWjbwJXoH4AACx
Client disconnected: rHOH-IHzkhMT9M8jAACy
Client disconnected: DemfkuddDU_GVZC5AACz
Client disconnected: ZIASUpFEPbh-huACAAC0
Client disconnected: JS1lKs3EcnbVemzgAAC1
Client disconnected: HXmZdpByA64X1Yt6AAC2
Client disconnected: qmQqCFNJtIZqdjeGAAC3
Client disconnected: PNCtdb73PrsZ0VgtAAC4
Client disconnected: 3ZtedetAzbhptA4WAAC5
Client disconnected: lKkzDuD4OSau5VYmAAC6
Client disconnected: E4v0TZh-yDhSvzYmAAC7
Client disconnected: nVu_UbGPaknXtf13AAC8
Client disconnected: UOlQwwTvrIkKSCrmAAC9
Client disconnected: xDZpkQnkDp-VlPwPAAC-
Client disconnected: pJ-FmBQXBpOkgS2BAAC_
Client disconnected: zvc9ZquC7S_hJlwcAADA
Client disconnected: kqgwKJoXjRoDG5GXAADB
Client disconnected: -WwoPEmmh5lKNgLVAADC
Client disconnected: 4o1g5FCdgWtBKlVlAADD
Client disconnected: ffbfRuEqoOxUEw0iAADE
Client disconnected: EyXSgVG4D5-ASIeeAADF
Client disconnected: KiCMF1erfL1anbAcAADG
Client disconnected: QmpP_r5yfQgRPz69AADH
Client disconnected: t9yn3zG5qCxHLufyAADI
Client disconnected: tC7B5ioN-tLvun0pAADJ
Client disconnected: gwP75M1ylEzFm6yfAADK
Client disconnected: BERyv_c414i48r__AADL
Client disconnected: S6f5QYoX5b-9zOKDAADM
Client disconnected: VSjkx1IOnCeXME93AADN
Client disconnected: -r2Li6c7JvIuZn2KAADO
Client disconnected: SI2PvJNjIJZeQ662AADP
Client disconnected: kvLyd6BCOe5-4M4hAADQ
Client disconnected: Kzaq_BLc_3IJ3SwOAADR
Client disconnected: ezREmcXa8pXL2SCgAADS
Client disconnected: kVc_Orx_h7M3iZdZAADT
Client disconnected: hTmx-z4CfTt_fB5aAADU
Client disconnected: CnPbhE5N9S2YLfY8AADV
Client disconnected: SjyxaxG9g99JVsB0AADW
Client disconnected: i7cHIk4RMM0bAs3HAADX
Client disconnected: 2_COq0SpO8EtYJ7NAAEK
Client disconnected: Kj069aNBCIt_Q8e9AAEL
Client disconnected: EBVUF8TB2mQ07rMuAAEM
Client disconnected: hbHSOkJWgZ13T4CTAAEN
Client disconnected: 5nfer7TZLRY0PTcSAAEO
Client disconnected: -YmTcQFzf9AymYfTAAEP
Client disconnected: s8-5_WAAZV9sI8GxAAEQ
Client disconnected: jBS0YJnJr1Ekw4c0AAER
Client disconnected: 6eeaT_gfw910ZxfQAAES
Client disconnected: 8y4s1Yfd_dfywZNAAAET
Client disconnected: -mgS44CqFYqmKugmAAEU
Client disconnected: tORjWw5CoVOEFCgVAAEV
Client disconnected: mOEW7yGbbaExyPPnAAEW
Client disconnected: N9L85q8GqkbX2DLXAAEX
Client disconnected: cdMufA6WJlcl0BVYAAEY
Client disconnected: MNBmjdQWggyD5uZXAAEZ
Client disconnected: eDZLVdPgRLFu3YsMAAEa
Client disconnected: ey1KlhIuOMD8lt6EAAEb
Client disconnected: GjqXNq-AZ0CzPM6BAAEc
Client disconnected: q0gNXT9X5Q3-LsFzAAEd
Client disconnected: 6u5E30rBD1qxgtQdAAEe
Client disconnected: vt8DSvppOzCPTEaLAAEf
Client disconnected: zLUj38Hk947b4A1NAAEg
Client disconnected: Au1s4z2U48WfbigzAAEh
Client disconnected: Hqc-OLf9SFB_-1z3AAEi
Client disconnected: 2e1-DUFpDmp1qrYtAAEj
Client disconnected: SzlhWwCZ-1kCXOnZAAEk
Client disconnected: sNDLG5p4h_feBiVjAAEl
Client disconnected: YvO77B1GfA2QAMGVAAEm
Client disconnected: 8uz3iFXb5QBuDru3AAEn
Client disconnected: iS3ULw3_2UFiiqY3AAEo
Client disconnected: Fp3tM1-AZBWt4OTvAAEp
Client disconnected: U9tZ9ICka9kpmLllAAEq
Client disconnected: 8fB2AktMX1P6XfkDAAEr
Client disconnected: sb0zgc-V0peoHAKWAAEs
Client disconnected: oDIvucEcJCdp7NdjAAEt
Client disconnected: afyFRmLsUSLBnmn6AAEu
Client disconnected: IFnaG7K-5MqSRtVAAAEv
Client disconnected: ClWgt5oOZJm4v6vqAAEw
Client disconnected: 4ePUHAhik_RuphqkAAEx
Client disconnected: rPviX44UEYQPgnahAAEy
Client disconnected: 5f8QE0BhNeddsRMZAAEz
Client disconnected: ybTjOtqQI2MPJ9TsAAE0
Client disconnected: L-8RFmVBiEnts281AAE1
Client disconnected: ilQ2TWk4oKz798xSAAE2
Client disconnected: zK2LRkgYFNjIlfcPAAE3
Client disconnected: TAONylPER4djwO70AAE4
Client disconnected: RZwkdA6aURpi_c6hAAE5
Client disconnected: 4Zi1Rp3d3abk-8FTAAE6
Client disconnected: TOAna8ZzzSmyAgSTAAE7
Client disconnected: 3eHY2bYa_ynOUiZ1AAFu
Client disconnected: 297_g1BH7jpArUKBAAFv
Client disconnected: X7z8the8qGOH_12kAAFw
Client disconnected: 5TrLg5UP8tJeSu3-AAFx
Client disconnected: uL0OTGyuXs6PhjxKAAFy
Client disconnected: kHi9tIrYC8wPAsbpAAFz
Client disconnected: qBo62VlkOJJ2WM2WAAF0
Client disconnected: pdJx1SeG0qB0PnIVAAF1
Client disconnected: OXJ1bz2dpDy_Dqy5AAF2
Client disconnected: K0ab5eO_M79eyOuaAAF3
Client disconnected: fgaDfkhMOs1riHY4AAF4
Client disconnected: oUAxhGvqn6o3lbQRAAF5
Client disconnected: u3BMxK0QBrH20h1yAAF6
Client disconnected: mCnvAaolzOrlRMLHAAF7
Client disconnected: YS9cu500JCOw19IMAAF8
Client disconnected: _LPxgyVLBPMp6697AAF9
Client disconnected: 4GYZArdXDrCH8dU1AAF-
Client disconnected: pq7fyl_aFmLOGsD3AAF_
Client disconnected: sMpOW_nMWw5Ls9o6AAGA
Client disconnected: bQS8n561QZJBiDJLAAGB
Client disconnected: a5y65GyXWfsU1p01AAGC
Client disconnected: i6ElCZL7ZK2sru-6AAGD
Client disconnected: ZHw6CckATzb76Vb2AAGE
Client disconnected: zVE34UVmVWwCBLjiAAGF
Client disconnected: sMhoJd4qq0ugxSSyAAGG
Client disconnected: WgbVrThf3tBGoIC4AAGH
Client disconnected: 17eOpF-kkQWj_CFQAAGI
Client disconnected: qTzKMyQnrQY0RdiOAAGJ
Client disconnected: YMyFkTK_Ig-3mYdxAAGK
Client disconnected: _zlQL-XPWI6oAjzXAAGL
Client disconnected: 72y6kniBtwWAaWvZAAGM
Client disconnected: 6DCJpHVV83rNlS4lAAGN
Client disconnected: wyk7ipWAMqEtVmNKAAGO
Client disconnected: v2vifav4Oq0LKaB7AAGP
Client disconnected: a3f96UmOwuZWsiBXAAGQ
Client disconnected: 8hE-zag7eZL3Q1SPAAGR
Client disconnected: DhrSq5UbQX0vyXlXAAGS
Client disconnected: j-xvebj5-Jt0IN7QAAGT
Client disconnected: tA7IW57qAHroj5l2AAGU
Client disconnected: H9I_p8ZTjIF6JDUaAAGV
Client disconnected: cglADGOl6hjgAmepAAGW
Client disconnected: rNNbjLQCVh418cb4AAGX
Client disconnected: jjzWMBF8-OJr01iHAAGY
Client disconnected: hoZh5nOcZwniq7PUAAGZ
Client disconnected: FrhUsbHYDlgyPCFWAAGa
Client disconnected: zmC044ku2PMAJogfAAGb
Client disconnected: LRTpT3mtqaamhd5iAAGc
Client disconnected: Vvfvp20hfbLiir1tAAGd
Client disconnected: SIzj1o_MyINjJg70AAGe
Client disconnected: VwQlfiEJkmARYqUHAAGf
Client disconnected: 2wDeGLtUzoUadf6TAAHS
Client disconnected: Ntc7k4tStB1kG7ctAAHT
Client disconnected: neZTmJQxpYei1BTWAAHU
Client disconnected: mLLAuyEjLcpqE8sYAAHV
Client disconnected: jCM6AaRb9NQqBPRyAAHW
Client disconnected: WbFpouwV1tkFhbh2AAHX
Client disconnected: N3mPInW7mg7GNijzAAHY
Client disconnected: _A_qIdgYU13gmJncAAHZ
Client disconnected: hmOydlEuctwukeW4AAHa
Client disconnected: 26fzD9-5crhY-2QuAAHb
Client disconnected: LCd9U-LzFetxc3siAAHc
Client disconnected: 2CJ5pMICqPjWZSkkAAHd
Client disconnected: UjsZBPSeyd9Jq-zGAAHe
Client disconnected: v4ho5ZaRwLuU3czJAAHf
Client disconnected: qKEtO_oMyRKAq_EgAAHg
Client disconnected: 9DgTmT1brKQTLaXcAAHh
Client disconnected: fEiq6LS_rZsGSnoKAAHi
Client disconnected: zOqaGiuhLCKR8oILAAHj
Client disconnected: m1n02EzLow7cbYpmAAHk
Client disconnected: MbejdGNaazThNerUAAHl
Client disconnected: CqS2a0yowUXQFeOqAAHm
Client disconnected: lAFChDLOWft2P-DwAAHn
Client disconnected: h0kcUyqN4ktmOScfAAHo
Client disconnected: eSE_f5D5KK4hmgpjAAHp
Client disconnected: 3jhuifSn_BHz9SA6AAHq
Client disconnected: C2xvY4dqNCr_n3IpAAHr
Client disconnected: arJyPBy6m3Sd5To6AAHs
Client disconnected: _IJKfzlbfsdQl1KRAAHt
Client disconnected: 2dDr8aruhI0Iwx5ZAAHu
Client disconnected: LOdIIrA-yRb0J9F9AAHv
Client disconnected: TT21ZefqPR1OaoNFAAHw
Client disconnected: Ub2k2uonWoy6zP37AAHx
Client disconnected: seQiykpC3zLhSHM2AAHy
Client disconnected: -nxwHB4yGdl6dIqrAAHz
Client disconnected: XbKzBpqumJIa0n14AAH0
Client disconnected: tZn3ngDEyyLpmOZpAAH1
Client disconnected: AqP8H8zMVd_iQT_WAAH2
Client disconnected: RcdHrqTuVbH0am-EAAH3
Client disconnected: rEYn0cmTc7Xt62ppAAH4
Client disconnected: tmLJ_wSsdSBwmo7wAAH5
Client disconnected: thhLMWfZCNWKOVJjAAH6
Client disconnected: 3DB7HIwsUQuud2MvAAH7
Client disconnected: 0K40BdJr91mVN5DmAAH8
Client disconnected: xDEZub0g3oJypjp7AAH9
Client disconnected: 6SKEgjtlWdIS53NGAAH-
Client disconnected: tpTkD00X4Q3ZcF6_AAH_
Client disconnected: YNgVMuctSznAL1VoAAIA
Client disconnected: _Xibq6LuVFA0L2acAAIB
Client disconnected: pUWN4kKF84WMApPsAAIC
Client disconnected: vEeRIIdE200E62aGAAID
Client disconnected: MJfUsodh0uFQuiApAAI2
Client disconnected: sFUP7xiEYQ9zKm9VAAI3
Client disconnected: KHpWYXW3SjVSvJLpAAI4
Client disconnected: bydAHhKBBBdFicJ6AAI5
Client disconnected: yxCntlF-m2XhRcAmAAI6
Client disconnected: 72EKwciu8YSI77G8AAI7
Client disconnected: VzZyW4WPXG3XnlEhAAI8
Client disconnected: 5d7TBbAmi2VO-oyFAAI9
Client disconnected: ymusNBLfCdscznHqAAI-
Client disconnected: q1tGu9vW7bss4aOFAAI_
Client disconnected: pQcKYWYVK-DLr8aMAAJA
Client disconnected: GGZX5NxzUy1MKPPlAAJB
Client disconnected: EDG2v92shbpO3V6XAAJC
Client disconnected: q4Q6a_9rnLSVwAv_AAJD
Client disconnected: WyvjbcloSJQ0Fj3VAAJE
Client disconnected: K9syq48uhNWvKJi6AAJF
Client disconnected: voCzc-xDqfWhaHSLAAJG
Client disconnected: ta2LsueUjZfFpV_AAAJH
Client disconnected: GqqHU2afcIDZZRIHAAJI
Client disconnected: L8c2TnCByaeyhOm6AAJJ
Client disconnected: jW7xTr8EmrS4GyH7AAJK
Client disconnected: 7JPc3_Y43E5XAgQ6AAJL
Client disconnected: 1nM1oby4wVrq-zpkAAJM
Client disconnected: B5SiguMCLb3JHbfLAAJN
Client disconnected: XFlF-hRrzPIHb3XsAAJO
Client disconnected: WA0K1fBujh37R96vAAJP
Client disconnected: clvxS2jCVuinpqUyAAJQ
Client disconnected: DSh0ELa_yNMgoicEAAJR
Client disconnected: cgyEN5E0byg52n1-AAJS
Client disconnected: 4mXFJMiawwJpJmdAAAJT
Client disconnected: KhwI7L2TG21v3wvAAAJU
Client disconnected: Kowxo999OBcCUlF2AAJV
Client disconnected: apXYdEe-S54CoQGGAAJW
Client disconnected: T2b94lNnzuNdh0lfAAJX
Client disconnected: 81ku35-qyc6oUNiRAAJY
Client disconnected: XJ3uXsFPtQ25unWYAAJZ
Client disconnected: FRdmgAb6kvd0I71zAAJa
Client disconnected: BoiAXKdshc8TSJWVAAJb
Client disconnected: _nCqpc6J6mJCfxhvAAJc
Client disconnected: i_lZNCYhr-NadDgxAAJd
Client disconnected: 5OVWhHh54iP2gHYhAAJe
Client disconnected: MgLeXSdvSFq7XBjEAAJf
Client disconnected: J5ndAfBhfzzTq-VuAAJg
Client disconnected: qh0Ryef1iZeCVXtFAAJh
Client disconnected: D7JLe1WQ3-v1AH4FAAJi
Client disconnected: ukocmRFxLfHM5m3XAAJj
Client disconnected: EkmTUnQYt_E6Vt_cAAJk
Client disconnected: 0FjWUrc9ywgc-TUDAAJl
Client disconnected: a4714zKVXAnmZqTeAAJm
Client disconnected: V2ubrX4XITnr7XIBAAJn
Client disconnected: 2iG8u_iS1bU3CyN5AAKa
Client disconnected: P7YGgQZd9QZ1qOIeAAKb
Client disconnected: lmnoMlcmBa3nmzeLAAKc
Client disconnected: 04yIQVJDAnXVID7jAAKd
Client disconnected: 06WILd237M7e47F8AAKe
Client disconnected: naxAs2zTUalUzQycAAKf
Client disconnected: 0ZhBiXZ3nsazetQxAAKg
Client disconnected: ejJ9DAucK08PTK9aAAKh
Client disconnected: tW0ognZbXJeHB3tpAAKi
Client disconnected: S7VBmI-CglDTPA7tAAKj
Client disconnected: KofL-UWMVc9EbpisAAKk
Client disconnected: SOrfB0A0z465KYlAAAKl
Client disconnected: rwdlS04qQAbc73OLAAKm
Client disconnected: B9x4pCHOqTsfVv_eAAKn
Client disconnected: Pai8x1pORyls1scSAAKo
Client disconnected: T8rDr1HdVB7_bTWeAAKp
Client disconnected: zxoIEipuN7BvI-2oAAKq
Client disconnected: bBAQV9lHTnqWkbloAAKr
Client disconnected: Ag9bzy6d0nW1raUhAAKs
Client disconnected: YK7maIN-Sso5rgiZAAKt
Client disconnected: 1WPNiTdYTvZXlWepAAKu
Client disconnected: OPGg-JHFmRt8fshvAAKv
Client disconnected: c04N9rvyG5GDc8KlAAKw
Client disconnected: 2oVe95SH3IX6Q2hjAAKx
Client disconnected: fCbAgthopQOkXiyOAAKy
Client disconnected: L2Muy2jSgTwwCPA4AAKz
Client disconnected: VasVy-jNAfheJW7UAAK0
Client disconnected: Gcnl8b9fXP2EGEnXAAK1
Client disconnected: kj2p1u8Y2UW9LTSZAAK2
Client disconnected: hxThkTuGaB2YcNioAAK3
Client disconnected: -DXfEKA5BuD0Ih3gAAK4
Client disconnected: hSr-29YaD1U6yXuhAAK5
Client disconnected: cwElWoRt_Yc5mOMZAAK6
Client disconnected: H_a5t64EqRnVORHxAAK7
Client disconnected: 3mWtaeTClJvLcLmrAAK8
Client disconnected: ydg3U-G91RPfWhacAAK9
Client disconnected: Smi-vEG5b8OXYtnDAAK-
Client disconnected: 9IL3ye0hCQEVypE2AAK_
Client disconnected: 1tcAdeppYOO-MghXAALA
Client disconnected: jn8iL499tSrohZISAALB
Client disconnected: 2yxZA2tj2B-hmTToAALC
Client disconnected: FUzZ1LnXT-rgLJ_9AALD
Client disconnected: l2jw22Jg-H2qRhb_AALE
Client disconnected: -UkSEsIKxAMtt3HiAALF
Client disconnected: eFxP_Ggnuw2amT34AALG
Client disconnected: EvFpmOWOUUGwhM_eAALH
Client disconnected: HZj-UQTUej55ovdRAALI
Client disconnected: ftob8XfT71l1OQNAAALJ
Client disconnected: edtZkBq_SDcuXp5hAALK
Client disconnected: tKCdlihZ7rIBf4L2AALL
Client disconnected: 5KTIOTkCASiNOzGpAAL-
Client disconnected: 1puUFdTFWGB9ko9gAAL_
Client disconnected: t8yKd6qRp7Z2htoHAAMA
Client disconnected: 218lvMRVeii8I2ClAAMB
Client disconnected: Uuc2PxHIM_aX6zKZAAMC
Client disconnected: gKquby2dOiAsWHrkAAMD
Client disconnected: Ciu0O82IQLbuRYC2AAME
Client disconnected: CuEPi63x4ifBSoqhAAMF
Client disconnected: Xew-Il4p7xudQuWKAAMG
Client disconnected: C-iWj7w0SYGFhnkZAAMH
Client disconnected: xNvaaJ0nlo2jhEvNAAMI
Client disconnected: 0g-r9KJGdbcI8gUOAAMJ
Client disconnected: 8hpmfAQB0qKYyKcIAAMK
Client disconnected: RKISJsRAyPN5IpCaAAML
Client disconnected: 1qiktKPaUE_YYAKHAAMM
Client disconnected: aDyufvDnuCAY8NafAAMN
Client disconnected: aq9NT4oOEjK4znZYAAMO
Client disconnected: lMkvpqEjS_4KDePlAAMP
Client disconnected: GK_no-RvpoHgkQ_RAAMQ
Client disconnected: Rvo27h9FOMyg1cuhAAMR
Client disconnected: z_-xw_KsWrAWji9kAAMS
Client disconnected: 6T-MyHG-be7W3tHBAAMT
Client disconnected: S59f1O4k_820VMEOAAMU
Client disconnected: HvaxsjeQpG4-I6HRAAMV
Client disconnected: yVvwu3TGZLvcahoiAAMW
Client disconnected: Wa5kBXaC6i6rmP8PAAMX
Client disconnected: 5DaZzDY714sKD6E0AAMY
Client disconnected: VEp5xRwA_fJ4-YAyAAMZ
Client disconnected: VTj28IMU9io1B6snAAMa
Client disconnected: Pfv74ImZvpvchNcSAAMb
Client disconnected: 2bTASXDI23o25LamAAMc
Client disconnected: Ywwq1R6UKqQJdgWWAAMd
Client disconnected: jcDIxadcJk3UE5_lAAMe
Client disconnected: RXYdQY2q_08NksULAAMf
Client disconnected: SWERpYrvGeoEXWtoAAMg
Client disconnected: y1sngmumxIduiTxzAAMh
Client disconnected: 1esrBFlWjqF_iNavAAMi
Client disconnected: rRO1zV47HZdbCpfHAAMj
Client disconnected: iY4Nl98MxOIpsMxQAAMk
Client disconnected: 9LDHTGyOZDJCIonbAAMl
Client disconnected: S5vNH-jHCav6k9LXAAMm
Client disconnected: h4Cv88xC9dr_z4lPAAMn
Client disconnected: YkdtJ_WXyTgNt3QkAAMo
Client disconnected: OBJT_1sgQHzdgjrxAAMp
Client disconnected: yc-G6Qumvoui-o2GAAMq
Client disconnected: Rnik-xquvaW1USf1AAMr
Client disconnected: YbwXwm0HAoglfzv-AAMs
Client disconnected: iVS6niBg6p54h601AAMt
Client disconnected: 1oEZFKi5zaDyzW_bAAMu
Client disconnected: TLp8Du0_UjIynuSrAAMv
Client disconnected: Nr7IUC8pZ054toyrAANi
Client disconnected: haOuLNZYdfAUOZNAAANj
Client disconnected: QTlT0kEQ-vKlr6iyAANk
Client disconnected: pimPw_eujgbHmexSAANl
Client disconnected: s2zq_j3vGHGQrsQ0AANm
Client disconnected: _KMXYhKOku-iTr_QAANn
Client disconnected: RyZAPfDhLz8UzUoOAANo
Client disconnected: 4N9FF_bTkI7y4dfLAANp
Client disconnected: M-4vjvS4wVORYShpAANq
Client disconnected: VKkcBJ9G3udFPjJMAANr
Client disconnected: A1NptnaTXhKa-Pv2AANs
Client disconnected: zhom2iasPjMlmW0iAANt
Client disconnected: TeWwxWrm_sQjejbEAANu
Client disconnected: zq1xU3WiVoK42RVMAANv
Client disconnected: 1xuUsVVtSxyohpQuAANw
Client disconnected: 942PM2JSQxEObROiAANx
Client disconnected: OUa-juE_1luWyNLiAANy
Client disconnected: 7xMCtJXKFdn-0AdOAANz
Client disconnected: 7zKWNF_UexkfGSyaAAN0
Client disconnected: BrdfI8VpfvwqdNe4AAN1
Client disconnected: as1PfZ5rzEw7hwnYAAN2
Client disconnected: zg2v3Piiubse85CNAAN3
Client disconnected: 4tETryG4BNaD--9fAAN4
Client disconnected: iA7y81OFzp9EunBxAAN5
Client disconnected: bhXp_61MaSoKJcEfAAN6
Client disconnected: 94vBluBUbfSNEXzIAAN7
Client disconnected: 2s0Bqfk5jTkHEeicAAN8
Client disconnected: evZiR7e14nvLTfTaAAN9
Client disconnected: j60d4UxV0tTy6KHzAAN-
Client disconnected: JvkOlWyfYF7_YO8gAAN_
Client disconnected: PnLaQgIaXA7QZj1QAAOA
Client disconnected: eMIKZ9SgI_8w49i2AAOB
Client disconnected: LNWMafwsVA0V5DjpAAOC
Client disconnected: owjr4NmMyWTmx1sCAAOD
Client disconnected: BXSnChIU76rJ20cGAAOE
Client disconnected: 1BMUhtrfStKGq5X7AAOF
Client disconnected: 4z_DTx4NXIhSewcqAAOG
Client disconnected: D2Ugr0Y9zVZsRb9GAAOH
Client disconnected: I5SbNWdkqvo0k0bkAAOI
Client disconnected: 4SMk8KUzzVMBTUpvAAOJ
Client disconnected: u5JIBmcJcNyafhXFAAOK
Client disconnected: 0TfNH8GBSGjyPGT5AAOL
Client disconnected: Nl7WiZXRwZdqJPRFAAOM
Client disconnected: nBAJu8rulLFyt3FoAAON
Client disconnected: Qa50w8qRUymvbaP7AAOO
Client disconnected: 0IvuH-A0olsA-hH0AAOP
Client disconnected: drnDqpbOj2WpuVZiAAOQ
Client disconnected: PiJJDe09GUPLl8DPAAOR
Client disconnected: RR1ZLekZVzaZl7eBAAOS
Client disconnected: ZbfrCFyC8IhBrxZAAAOT
Client disconnected: ZJVvJTZpd0RMp9SsAAPG
Client disconnected: FnrV1q8VkZ0D-GhXAAPH
Client disconnected: LeuvqvHZPddHHVq2AAPI
Client disconnected: iK-OP91huzsgXTHkAAPJ
Client disconnected: ovtsFkYV2_ZK8cuYAAPK
Client disconnected: JcCYmPaPVt3PQdiuAAPL
Client disconnected: S-U0tjq_WaicznB-AAPM
Client disconnected: 9Gq2wRfkQbu0FcApAAPN
Client disconnected: pWLWGE_IdIlAYGlfAAPO
Client disconnected: pC3-gkxY-f9xrargAAPP
Client disconnected: WCaAMmtdk4pmhj63AAPQ
Client disconnected: ecLbTMTDpNBhxT1CAAPR
Client disconnected: 9ytFQzC_-iH0x83FAAPS
Client disconnected: IQtHKXMmROkNILbWAAPT
Client disconnected: _iUJ8O2YPuHMyqvHAAPU
Client disconnected: TRZsWaaw2V53GHnaAAPV
Client disconnected: C5Ux8ACjpggG2XTGAAPW
Client disconnected: C3a-5YX31McfXkQCAAPX
Client disconnected: NbpI8oalMw6JuV1yAAPY
Client disconnected: xrhvH9LZxq_IBdYCAAPZ
Client disconnected: OSAvwADFwl8Glo5sAAPa
Client disconnected: 5AZhXXaOYNwPiHabAAPb
Client disconnected: YTLHBnxGFVMjzKdBAAPc
Client disconnected: SSWKl-0RwdYQspMNAAPd
Client disconnected: eCoNZ4_j5gyIx0DSAAPe
Client disconnected: gcYzCwUxI6N6kD1yAAPf
Client disconnected: Dr4VX0mA1RZDgaVYAAPg
Client disconnected: hF1QBeAPDY-jaT4CAAPh
Client disconnected: mOxFc1VwrBO2KHrMAAPi
Client disconnected: C9MGI4lH26DIy1RHAAPj
Client disconnected: Vd4BYyOYp-U_5o6UAAPk
Client disconnected: UoOlYZohjyUEdT9YAAPl
Client disconnected: sSVPg5M2bkA3MUPIAAPm
Client disconnected: OMftprMO2QWYijnDAAPn
Client disconnected: aMDRpZxM0x7hbVhdAAPo
Client disconnected: Jk-5-odAiYXfewElAAPp
Client disconnected: RPZp7D8L76aTi4jPAAPq
Client disconnected: qJ9YScv8UzSp4V5HAAPr
Client disconnected: R_M_7GirZjqSKf6LAAPs
Client disconnected: yCVwogtfR0wOUIZlAAPt
Client disconnected: fQYHsTJnnObVKA3MAAPu
Client disconnected: p4SILVW7I1mqkCv2AAPv
Client disconnected: FxZeKslKjFDmDkXEAAPw
Client disconnected: XofA9qBCYSMS5I7GAAPx
Client disconnected: Y-trdanfwOuLaTSzAAPy
Client disconnected: Y6DswMcp9aLoHcwgAAPz
Client disconnected: VM4UH5j7-8F6Jg7aAAP0
Client disconnected: -23s3300DJEu2azHAAP1
Client disconnected: LQYFoee-pVyo56uuAAP2
Client disconnected: uh7hUwQNzqVC7QgsAAP3

 [32mâœ“[39m test/social-stress.e2e-spec.ts[2m > [22mSocial Stress Test (1000+ Connections Simulation)[2m > [22mNÃªn xá»­ lÃ½ thÃ nh cÃ´ng 500 káº¿t ná»‘i WebSocket Ä‘á»“ng thá»i[33m 1093[2mms[22m[39m
[90mstdout[2m | test/social-stress.e2e-spec.ts
[22m[39mâœ… Vitest teardown complete

[90mstdout[2m | src/modules/analytics/simulation-bot.spec.ts[2m > [22m[2mBehavioral Simulation (Plan 2)[2m > [22m[2mSimulation: RUSH_USER should trigger STRICT_COACH persona
[22m[39mðŸ§¹ Cleaning up after test...

 [32mâœ“[39m src/modules/analytics/simulation-bot.spec.ts[2m > [22mBehavioral Simulation (Plan 2)[2m > [22mSimulation: RUSH_USER should trigger STRICT_COACH persona
 [32mâœ“[39m src/modules/analytics/simulation-bot.spec.ts[2m > [22mBehavioral Simulation (Plan 2)[2m > [22mSimulation: LAZY_USER should trigger SUPPORTIVE_BUDDY persona
[90mstdout[2m | src/modules/analytics/simulation-bot.spec.ts[2m > [22m[2mBehavioral Simulation (Plan 2)[2m > [22m[2mSimulation: LAZY_USER should trigger SUPPORTIVE_BUDDY persona
[22m[39mðŸ§¹ Cleaning up after test...

[90mstdout[2m | src/modules/analytics/simulation-bot.spec.ts
[22m[39mðŸ”§ Vitest setup: Starting MSW mock server...
âœ… Vitest teardown complete

[90mstdout[2m | src/modules/analytics/analytics.service.spec.ts[2m > [22m[2mAnalyticsService[2m > [22m[2mhandleSystemHealthCheck[2m > [22m[2mshould log health check and warn on high error rates
[22m[39mðŸ§¹ Cleaning up after test...

[90mstdout[2m | src/modules/analytics/analytics.service.spec.ts[2m > [22m[2mAnalyticsService[2m > [22m[2mgetUserLearningHabits[2m > [22m[2mshould return habits based on logs
[22m[39mðŸ§¹ Cleaning up after test...

[90mstdout[2m | src/modules/analytics/analytics.service.spec.ts[2m > [22m[2mAnalyticsService[2m > [22m[2mgetUserLearningHabits[2m > [22m[2mshould return null if no logs found
[22m[39mðŸ§¹ Cleaning up after test...

[90mstdout[2m | src/modules/analytics/analytics.service.spec.ts[2m > [22m[2mAnalyticsService[2m > [22m[2mgetUserPersona[2m > [22m[2mshould classify as HUNTER for risk-taking behavior
[22m[39mðŸ§¹ Cleaning up after test...

[90mstdout[2m | src/modules/analytics/analytics.service.spec.ts[2m > [22m[2mAnalyticsService[2m > [22m[2mgetUserPersona[2m > [22m[2mshould classify as SAVER for commitment-focused behavior
[22m[39mðŸ§¹ Cleaning up after test...

[90mstdout[2m | src/modules/analytics/analytics.service.spec.ts
[22m[39mðŸ”§ Vitest setup: Starting MSW mock server...
âœ… Vitest teardown complete

 [32mâœ“[39m src/modules/analytics/analytics.service.spec.ts[2m > [22mAnalyticsService[2m > [22mhandleSystemHealthCheck[2m > [22mshould log health check and warn on high error rates
 [32mâœ“[39m src/modules/analytics/analytics.service.spec.ts[2m > [22mAnalyticsService[2m > [22mgetUserLearningHabits[2m > [22mshould return habits based on logs
 [32mâœ“[39m src/modules/analytics/analytics.service.spec.ts[2m > [22mAnalyticsService[2m > [22mgetUserLearningHabits[2m > [22mshould return null if no logs found
 [32mâœ“[39m src/modules/analytics/analytics.service.spec.ts[2m > [22mAnalyticsService[2m > [22mgetUserPersona[2m > [22mshould classify as HUNTER for risk-taking behavior
 [32mâœ“[39m src/modules/analytics/analytics.service.spec.ts[2m > [22mAnalyticsService[2m > [22mgetUserPersona[2m > [22mshould classify as SAVER for commitment-focused behavior
[90mstdout[2m | src/common/gamification-pure.spec.ts[2m > [22m[2mGamification Pure Functions[2m > [22m[2mcalculatePoints[2m > [22m[2mshould calculate base points with no streak
[22m[39mðŸ§¹ Cleaning up after test...

[90mstdout[2m | src/common/gamification-pure.spec.ts[2m > [22m[2mGamification Pure Functions[2m > [22m[2mcalculatePoints[2m > [22m[2mshould apply streak bonus correctly
[22m[39mðŸ§¹ Cleaning up after test...

[90mstdout[2m | src/common/gamification-pure.spec.ts[2m > [22m[2mGamification Pure Functions[2m > [22m[2mcalculatePoints[2m > [22m[2mshould return 0 for unknown actions
[22m[39mðŸ§¹ Cleaning up after test...

[90mstdout[2m | src/common/gamification-pure.spec.ts[2m > [22m[2mGamification Pure Functions[2m > [22m[2mprocessStreak[2m > [22m[2mshould increment streak if last active was yesterday
[22m[39mðŸ§¹ Cleaning up after test...

[90mstdout[2m | src/common/gamification-pure.spec.ts[2m > [22m[2mGamification Pure Functions[2m > [22m[2mprocessStreak[2m > [22m[2mshould maintain streak if active today
[22m[39mðŸ§¹ Cleaning up after test...

[90mstdout[2m | src/common/gamification-pure.spec.ts[2m > [22m[2mGamification Pure Functions[2m > [22m[2mprocessStreak[2m > [22m[2mshould reset streak if last active was before yesterday
[22m[39mðŸ§¹ Cleaning up after test...

[90mstdout[2m | src/common/gamification-pure.spec.ts[2m > [22m[2mGamification Pure Functions[2m > [22m[2mcalculateLevel[2m > [22m[2mshould start at level 1
[22m[39mðŸ§¹ Cleaning up after test...

[90mstdout[2m | src/common/gamification-pure.spec.ts[2m > [22m[2mGamification Pure Functions[2m > [22m[2mcalculateLevel[2m > [22m[2mshould reach level 2 at 100 points
[22m[39mðŸ§¹ Cleaning up after test...

[90mstdout[2m | src/common/gamification-pure.spec.ts[2m > [22m[2mGamification Pure Functions[2m > [22m[2mcalculateLevel[2m > [22m[2mshould reach level 3 at 400 points
[22m[39mðŸ§¹ Cleaning up after test...

[90mstdout[2m | src/common/gamification-pure.spec.ts[2m > [22m[2mGamification Pure Functions[2m > [22m[2mcalculateLevel[2m > [22m[2mshould handle negative points gracefully
[22m[39mðŸ§¹ Cleaning up after test...

[90mstdout[2m | src/common/gamification-pure.spec.ts[2m > [22m[2mGamification Pure Functions[2m > [22m[2mcheckBadges[2m > [22m[2mshould return BRONZE_LEARNER when crossing 100 points
[22m[39mðŸ§¹ Cleaning up after test...

 [32mâœ“[39m src/common/gamification-pure.spec.ts[2m > [22mGamification Pure Functions[2m > [22mcalculatePoints[2m > [22mshould calculate base points with no streak
 [32mâœ“[39m src/common/gamification-pure.spec.ts[2m > [22mGamification Pure Functions[2m > [22mcalculatePoints[2m > [22mshould apply streak bonus correctly
 [32mâœ“[39m src/common/gamification-pure.spec.ts[2m > [22mGamification Pure Functions[2m > [22mcalculatePoints[2m > [22mshould return 0 for unknown actions
 [32mâœ“[39m src/common/gamification-pure.spec.ts[2m > [22mGamification Pure Functions[2m > [22mprocessStreak[2m > [22mshould increment streak if last active was yesterday
 [32mâœ“[39m src/common/gamification-pure.spec.ts[2m > [22mGamification Pure Functions[2m > [22mprocessStreak[2m > [22mshould maintain streak if active today
 [32mâœ“[39m src/common/gamification-pure.spec.ts[2m > [22mGamification Pure Functions[2m > [22mprocessStreak[2m > [22mshould reset streak if last active was before yesterday
 [32mâœ“[39m src/common/gamification-pure.spec.ts[2m > [22mGamification Pure Functions[2m > [22mcalculateLevel[2m > [22mshould start at level 1
 [32mâœ“[39m src/common/gamification-pure.spec.ts[2m > [22mGamification Pure Functions[2m > [22mcalculateLevel[2m > [22mshould reach level 2 at 100 points
 [32mâœ“[39m src/common/gamification-pure.spec.ts[2m > [22mGamification Pure Functions[2m > [22mcalculateLevel[2m > [22mshould reach level 3 at 400 points
 [32mâœ“[39m src/common/gamification-pure.spec.ts[2m > [22mGamification Pure Functions[2m > [22mcalculateLevel[2m > [22mshould handle negative points gracefully
 [32mâœ“[39m src/common/gamification-pure.spec.ts[2m > [22mGamification Pure Functions[2m > [22mcheckBadges[2m > [22mshould return BRONZE_LEARNER when crossing 100 points
 [32mâœ“[39m src/common/gamification-pure.spec.ts[2m > [22mGamification Pure Functions[2m > [22mcheckBadges[2m > [22mshould not return badge if already earned
 [32mâœ“[39m src/common/gamification-pure.spec.ts[2m > [22mGamification Pure Functions[2m > [22mcheckBadges[2m > [22mshould return multiple badges if crossing multiple thresholds
[90mstdout[2m | src/common/gamification-pure.spec.ts[2m > [22m[2mGamification Pure Functions[2m > [22m[2mcheckBadges[2m > [22m[2mshould not return badge if already earned
[22m[39mðŸ§¹ Cleaning up after test...

[90mstdout[2m | src/common/gamification-pure.spec.ts[2m > [22m[2mGamification Pure Functions[2m > [22m[2mcheckBadges[2m > [22m[2mshould return multiple badges if crossing multiple thresholds
[22m[39mðŸ§¹ Cleaning up after test...

[90mstdout[2m | src/common/gamification-pure.spec.ts
[22m[39mðŸ”§ Vitest setup: Starting MSW mock server...
âœ… Vitest teardown complete

[90mstdout[2m | src/auth/jwt.strategy.spec.ts[2m > [22m[2mJwtStrategy[2m > [22m[2mshould be defined
[22m[39mðŸ§¹ Cleaning up after test...

[90mstdout[2m | src/auth/jwt.strategy.spec.ts[2m > [22m[2mJwtStrategy[2m > [22m[2mvalidate[2m > [22m[2mshould extract user from JWT payload
[22m[39mðŸ§¹ Cleaning up after test...

[90mstdout[2m | src/auth/jwt.strategy.spec.ts[2m > [22m[2mJwtStrategy[2m > [22m[2mvalidate[2m > [22m[2mshould handle payload with different role
[22m[39mðŸ§¹ Cleaning up after test...

[90mstdout[2m | src/auth/jwt.strategy.spec.ts[2m > [22m[2mJwtStrategy[2m > [22m[2mvalidate[2m > [22m[2mshould map sub to both id and userId
[22m[39mðŸ§¹ Cleaning up after test...

[90mstdout[2m | src/auth/jwt.strategy.spec.ts[2m > [22m[2mJwtStrategy[2m > [22m[2mvalidate[2m > [22m[2mshould preserve email from payload
[22m[39mðŸ§¹ Cleaning up after test...

[90mstdout[2m | src/auth/jwt.strategy.spec.ts[2m > [22m[2mJwtStrategy[2m > [22m[2mconstructor[2m > [22m[2mshould use JWT_SECRET from ConfigService
[22m[39mðŸ§¹ Cleaning up after test...

 [32mâœ“[39m src/auth/jwt.strategy.spec.ts[2m > [22mJwtStrategy[2m > [22mshould be defined
 [32mâœ“[39m src/auth/jwt.strategy.spec.ts[2m > [22mJwtStrategy[2m > [22mvalidate[2m > [22mshould extract user from JWT payload
 [32mâœ“[39m src/auth/jwt.strategy.spec.ts[2m > [22mJwtStrategy[2m > [22mvalidate[2m > [22mshould handle payload with different role
 [32mâœ“[39m src/auth/jwt.strategy.spec.ts[2m > [22mJwtStrategy[2m > [22mvalidate[2m > [22mshould map sub to both id and userId
 [32mâœ“[39m src/auth/jwt.strategy.spec.ts[2m > [22mJwtStrategy[2m > [22mvalidate[2m > [22mshould preserve email from payload
 [32mâœ“[39m src/auth/jwt.strategy.spec.ts[2m > [22mJwtStrategy[2m > [22mconstructor[2m > [22mshould use JWT_SECRET from ConfigService
 [32mâœ“[39m src/auth/jwt.strategy.spec.ts[2m > [22mJwtStrategy[2m > [22mconstructor[2m > [22mshould fallback to dev_secret if ConfigService fails
[90mstdout[2m | src/auth/jwt.strategy.spec.ts[2m > [22m[2mJwtStrategy[2m > [22m[2mconstructor[2m > [22m[2mshould fallback to dev_secret if ConfigService fails
[22m[39mðŸ§¹ Cleaning up after test...

[90mstdout[2m | src/auth/jwt.strategy.spec.ts
[22m[39mðŸ”§ Vitest setup: Starting MSW mock server...
âœ… Vitest teardown complete

 [2m[90mâ†“[39m[22m test/example-usage.e2e-spec.ts[2m > [22mExample: Test Helpers Usage (E2E)[2m > [22mAuthentication Examples[2m > [22mshould generate valid JWT token
 [2m[90mâ†“[39m[22m test/example-usage.e2e-spec.ts[2m > [22mExample: Test Helpers Usage (E2E)[2m > [22mAuthentication Examples[2m > [22mshould authenticate requests with generated token
 [2m[90mâ†“[39m[22m test/example-usage.e2e-spec.ts[2m > [22mExample: Test Helpers Usage (E2E)[2m > [22mMock Data Examples[2m > [22mshould use mock users data
 [2m[90mâ†“[39m[22m test/example-usage.e2e-spec.ts[2m > [22mExample: Test Helpers Usage (E2E)[2m > [22mMock Data Examples[2m > [22mshould use mock courses data
 [2m[90mâ†“[39m[22m test/example-usage.e2e-spec.ts[2m > [22mExample: Test Helpers Usage (E2E)[2m > [22mDatabase Cleanup Examples[2m > [22mshould successfully clean up database
[90mstdout[2m | test/example-usage.e2e-spec.ts
[22m[39mðŸ”§ Vitest setup: Starting MSW mock server...
âœ… Vitest teardown complete

[90mstdout[2m | test/unit/analytics/analytics.service.spec.ts[2m > [22m[2mAnalyticsService[2m > [22m[2mhandleSystemHealthCheck[2m > [22m[2mshould run health check and log results
[22m[39mðŸ§¹ Cleaning up after test...

[90mstdout[2m | test/unit/analytics/analytics.service.spec.ts[2m > [22m[2mAnalyticsService[2m > [22m[2mhandleSystemHealthCheck[2m > [22m[2mshould handle DB failure gracefully
[22m[39mðŸ§¹ Cleaning up after test...

[90mstdout[2m | test/unit/analytics/analytics.service.spec.ts[2m > [22m[2mAnalyticsService[2m > [22m[2mgetGlobalSystemStats[2m > [22m[2mshould return global stats
[22m[39mðŸ§¹ Cleaning up after test...

[90mstdout[2m | test/unit/analytics/analytics.service.spec.ts[2m > [22m[2mAnalyticsService[2m > [22m[2mgetUserPersona[2m > [22m[2mshould return OBSERVER for no logs
[22m[39mðŸ§¹ Cleaning up after test...

 [32mâœ“[39m test/unit/analytics/analytics.service.spec.ts[2m > [22mAnalyticsService[2m > [22mhandleSystemHealthCheck[2m > [22mshould run health check and log results
 [32mâœ“[39m test/unit/analytics/analytics.service.spec.ts[2m > [22mAnalyticsService[2m > [22mhandleSystemHealthCheck[2m > [22mshould handle DB failure gracefully
 [32mâœ“[39m test/unit/analytics/analytics.service.spec.ts[2m > [22mAnalyticsService[2m > [22mgetGlobalSystemStats[2m > [22mshould return global stats
 [32mâœ“[39m test/unit/analytics/analytics.service.spec.ts[2m > [22mAnalyticsService[2m > [22mgetUserPersona[2m > [22mshould return OBSERVER for no logs
 [32mâœ“[39m test/unit/analytics/analytics.service.spec.ts[2m > [22mAnalyticsService[2m > [22mgetUserPersona[2m > [22mshould classify as HUNTER if high risk events predominate
[90mstdout[2m | test/unit/analytics/analytics.service.spec.ts[2m > [22m[2mAnalyticsService[2m > [22m[2mgetUserPersona[2m > [22m[2mshould classify as HUNTER if high risk events predominate
[22m[39mðŸ§¹ Cleaning up after test...

[90mstdout[2m | test/unit/analytics/analytics.service.spec.ts
[22m[39mðŸ”§ Vitest setup: Starting MSW mock server...
âœ… Vitest teardown complete

[90mstdout[2m | test/behavioral-stress.e2e-spec.ts
[22m[39mðŸ”§ Vitest setup: Starting MSW mock server...

[90mstdout[2m | test/behavioral-stress.e2e-spec.ts[2m > [22m[2mPHÆ¯Æ NG ÃN 2: Behavioral Stress Test (E2B Inspired)[2m > [22m[2mNÃªn giáº£ láº­p thÃ nh cÃ´ng 50 hÃ nh vi ngÆ°á»i dÃ¹ng mÃ  khÃ´ng cÃ³ lá»—i schema
[22m[39mðŸ§¹ Cleaning up after test...

[90mstdout[2m | test/behavioral-stress.e2e-spec.ts
[22m[39mâœ… Vitest teardown complete

 [31mÃ—[39m test/behavioral-stress.e2e-spec.ts[2m > [22mPHÆ¯Æ NG ÃN 2: Behavioral Stress Test (E2B Inspired)[2m > [22mNÃªn giáº£ láº­p thÃ nh cÃ´ng 50 hÃ nh vi ngÆ°á»i dÃ¹ng mÃ  khÃ´ng cÃ³ lá»—i schema[33m 4059[2mms[22m[39m
[31m   â†’ 
Invalid `prisma.user.upsert()` invocation:


Can't reach database server at `localhost:5432`

Please make sure your database server is running at `localhost:5432`.[39m
[90mstdout[2m | test/app.e2e-spec.ts
[22m[39mðŸ”§ Vitest setup: Starting MSW mock server...

[90mstdout[2m | test/app.e2e-spec.ts[2m > [22m[2mAppController (e2e)
[22m[39mðŸš€ Starting beforeAll...
ðŸ“¦ Module compiled
ðŸ—ï¸ App created
âœ… App initialized

[90mstdout[2m | test/app.e2e-spec.ts[2m > [22m[2mAppController (e2e)[2m > [22m[2m/ (GET)
[22m[39mðŸ§¹ Cleaning up after test...

 [32mâœ“[39m test/app.e2e-spec.ts[2m > [22mAppController (e2e)[2m > [22m/ (GET)
[90mstdout[2m | test/app.e2e-spec.ts[2m > [22m[2mAppController (e2e)
[22m[39mðŸ§¹ Starting afterAll...
ðŸ›‘ App closed

[90mstdout[2m | test/app.e2e-spec.ts
[22m[39mâœ… Vitest teardown complete

[90mstdout[2m | src/modules/store/store.service.spec.ts[2m > [22m[2mStoreService[2m > [22m[2mbuyStreakFreeze[2m > [22m[2mshould successfully buy a streak freeze
[22m[39mðŸ§¹ Cleaning up after test...

[90mstdout[2m | src/modules/store/store.service.spec.ts[2m > [22m[2mStoreService[2m > [22m[2mbuyStreakFreeze[2m > [22m[2mshould throw BadRequestException if user has insufficient points
[22m[39mðŸ§¹ Cleaning up after test...

[90mstdout[2m | src/modules/store/store.service.spec.ts[2m > [22m[2mStoreService[2m > [22m[2mbuyStreakFreeze[2m > [22m[2mshould throw BadRequestException if user does not exist
[22m[39mðŸ§¹ Cleaning up after test...

 [32mâœ“[39m src/modules/store/store.service.spec.ts[2m > [22mStoreService[2m > [22mbuyStreakFreeze[2m > [22mshould successfully buy a streak freeze
 [32mâœ“[39m src/modules/store/store.service.spec.ts[2m > [22mStoreService[2m > [22mbuyStreakFreeze[2m > [22mshould throw BadRequestException if user has insufficient points
 [32mâœ“[39m src/modules/store/store.service.spec.ts[2m > [22mStoreService[2m > [22mbuyStreakFreeze[2m > [22mshould throw BadRequestException if user does not exist
 [32mâœ“[39m src/modules/store/store.service.spec.ts[2m > [22mStoreService[2m > [22mgetStoreItems[2m > [22mshould return list of store items
[90mstdout[2m | src/modules/store/store.service.spec.ts[2m > [22m[2mStoreService[2m > [22m[2mgetStoreItems[2m > [22m[2mshould return list of store items
[22m[39mðŸ§¹ Cleaning up after test...

[90mstdout[2m | src/modules/store/store.service.spec.ts
[22m[39mðŸ”§ Vitest setup: Starting MSW mock server...
âœ… Vitest teardown complete

[90mstdout[2m | src/modules/recommendations/recommendation.service.spec.ts[2m > [22m[2mRecommendationService[2m > [22m[2mshould return personalized recommendations
[22m[39mðŸ§¹ Cleaning up after test...

 [32mâœ“[39m src/modules/recommendations/recommendation.service.spec.ts[2m > [22mRecommendationService[2m > [22mshould return personalized recommendations
 [32mâœ“[39m src/modules/recommendations/recommendation.service.spec.ts[2m > [22mRecommendationService[2m > [22mshould return fallback recommendations if AI fails
[90mstdout[2m | src/modules/recommendations/recommendation.service.spec.ts[2m > [22m[2mRecommendationService[2m > [22m[2mshould return fallback recommendations if AI fails
[22m[39mðŸ§¹ Cleaning up after test...

[90mstdout[2m | src/modules/recommendations/recommendation.service.spec.ts
[22m[39mðŸ”§ Vitest setup: Starting MSW mock server...
âœ… Vitest teardown complete

[90mstdout[2m | test/guards.e2e-spec.ts
[22m[39mðŸ”§ Vitest setup: Starting MSW mock server...

[90mstdout[2m | test/guards.e2e-spec.ts[2m > [22m[2mGuards (Integration)[2m > [22m[2m/users/profile (GET) - should fail without token
[22m[39mðŸ§¹ Cleaning up after test...

[90mstdout[2m | test/guards.e2e-spec.ts[2m > [22m[2mGuards (Integration)[2m > [22m[2m/users/profile (GET) - should succeed with valid token
[22m[39mðŸ§¹ Cleaning up after test...

 [32mâœ“[39m test/guards.e2e-spec.ts[2m > [22mGuards (Integration)[2m > [22m/users/profile (GET) - should fail without token
 [32mâœ“[39m test/guards.e2e-spec.ts[2m > [22mGuards (Integration)[2m > [22m/users/profile (GET) - should succeed with valid token
[90mstdout[2m | test/guards.e2e-spec.ts
[22m[39mâœ… Vitest teardown complete

[90mstdout[2m | src/modules/debug/diagnostic.service.spec.ts[2m > [22m[2mDiagnosticService[2m > [22m[2mrunFullDiagnostics[2m > [22m[2mshould run all diagnostic checks
[22m[39mðŸ§¹ Cleaning up after test...

 [32mâœ“[39m src/modules/debug/diagnostic.service.spec.ts[2m > [22mDiagnosticService[2m > [22mrunFullDiagnostics[2m > [22mshould run all diagnostic checks
 [32mâœ“[39m src/modules/debug/diagnostic.service.spec.ts[2m > [22mDiagnosticService[2m > [22mgenerateMockBehavioralData[2m > [22mshould generate requested number of logs
[90mstdout[2m | src/modules/debug/diagnostic.service.spec.ts[2m > [22m[2mDiagnosticService[2m > [22m[2mgenerateMockBehavioralData[2m > [22m[2mshould generate requested number of logs
[22m[39mðŸ§¹ Cleaning up after test...

[90mstdout[2m | src/modules/debug/diagnostic.service.spec.ts
[22m[39mðŸ”§ Vitest setup: Starting MSW mock server...
âœ… Vitest teardown complete

 [32mâœ“[39m test/unit/common/gamification.service.spec.ts[2m > [22mGamificationService[2m > [22mlogEvent[2m > [22mshould update user points and create log
 [32mâœ“[39m test/unit/common/gamification.service.spec.ts[2m > [22mGamificationService[2m > [22mdeductPoints[2m > [22mshould throw error if insufficient points
 [32mâœ“[39m test/unit/common/gamification.service.spec.ts[2m > [22mGamificationService[2m > [22mdeductPoints[2m > [22mshould deduct points if sufficient
[90mstdout[2m | test/unit/common/gamification.service.spec.ts[2m > [22m[2mGamificationService[2m > [22m[2mlogEvent[2m > [22m[2mshould update user points and create log
[22m[39mðŸ§¹ Cleaning up after test...

[90mstdout[2m | test/unit/common/gamification.service.spec.ts[2m > [22m[2mGamificationService[2m > [22m[2mdeductPoints[2m > [22m[2mshould throw error if insufficient points
[22m[39mðŸ§¹ Cleaning up after test...

[90mstdout[2m | test/unit/common/gamification.service.spec.ts[2m > [22m[2mGamificationService[2m > [22m[2mdeductPoints[2m > [22m[2mshould deduct points if sufficient
[22m[39mðŸ§¹ Cleaning up after test...

[90mstdout[2m | test/unit/common/gamification.service.spec.ts
[22m[39mðŸ”§ Vitest setup: Starting MSW mock server...
âœ… Vitest teardown complete

[90mstdout[2m | test/admin-integrity.e2e-spec.ts
[22m[39mðŸ”§ Vitest setup: Starting MSW mock server...

[90mstdout[2m | test/admin-integrity.e2e-spec.ts[2m > [22m[2mPHÆ¯Æ NG ÃN 3: Admin Integrity Audit[2m > [22m[2mHá»‡ thá»‘ng pháº£i vÆ°á»£t qua bÃ i kiá»ƒm tra tÃ­nh toÃ n váº¹n (Integrity Check)
[22m[39mðŸ” Äang thá»±c hiá»‡n Audit toÃ n bá»™ há»‡ thá»‘ng...

[90mstdout[2m | test/admin-integrity.e2e-spec.ts[2m > [22m[2mPHÆ¯Æ NG ÃN 3: Admin Integrity Audit[2m > [22m[2mHá»‡ thá»‘ng pháº£i vÆ°á»£t qua bÃ i kiá»ƒm tra tÃ­nh toÃ n váº¹n (Integrity Check)
[22m[39mðŸ§¹ Cleaning up after test...

 [31mÃ—[39m test/admin-integrity.e2e-spec.ts[2m > [22mPHÆ¯Æ NG ÃN 3: Admin Integrity Audit[2m > [22mHá»‡ thá»‘ng pháº£i vÆ°á»£t qua bÃ i kiá»ƒm tra tÃ­nh toÃ n váº¹n (Integrity Check)[33m 16296[2mms[22m[39m
[31m   â†’ 
Invalid `prisma.behaviorLog.count()` invocation:


Can't reach database server at `localhost:5432`

Please make sure your database server is running at `localhost:5432`.[39m
[90mstdout[2m | test/admin-integrity.e2e-spec.ts
[22m[39mâœ… Vitest teardown complete

[90mstdout[2m | test/unit/users/users.service.spec.ts[2m > [22m[2mUsersService[2m > [22m[2mgetDashboardStats[2m > [22m[2mshould calculate stats correctly
[22m[39mðŸ§¹ Cleaning up after test...

[90mstdout[2m | test/unit/users/users.service.spec.ts
[22m[39mðŸ”§ Vitest setup: Starting MSW mock server...
âœ… Vitest teardown complete

 [32mâœ“[39m test/unit/users/users.service.spec.ts[2m > [22mUsersService[2m > [22mgetDashboardStats[2m > [22mshould calculate stats correctly
[90mstdout[2m | src/modules/adaptive/adaptive.service.spec.ts[2m > [22m[2mAdaptiveService[2m > [22m[2mshould adjust level up for good performance
[22m[39mðŸ§¹ Cleaning up after test...

 [32mâœ“[39m src/modules/adaptive/adaptive.service.spec.ts[2m > [22mAdaptiveService[2m > [22mshould adjust level up for good performance
 [32mâœ“[39m src/modules/adaptive/adaptive.service.spec.ts[2m > [22mAdaptiveService[2m > [22mshould suggest reinforcement for poor performance
[90mstdout[2m | src/modules/adaptive/adaptive.service.spec.ts[2m > [22m[2mAdaptiveService[2m > [22m[2mshould suggest reinforcement for poor performance
[22m[39mðŸ§¹ Cleaning up after test...

[90mstdout[2m | src/modules/adaptive/adaptive.service.spec.ts
[22m[39mðŸ”§ Vitest setup: Starting MSW mock server...
âœ… Vitest teardown complete

 [32mâœ“[39m test/unit/behavior/behavior.service.spec.ts[2m > [22mBehaviorService[2m > [22mlogEvent[2m > [22mshould create a behavior log
[90mstdout[2m | test/unit/behavior/behavior.service.spec.ts[2m > [22m[2mBehaviorService[2m > [22m[2mlogEvent[2m > [22m[2mshould create a behavior log
[22m[39mðŸ§¹ Cleaning up after test...

[90mstdout[2m | test/unit/behavior/behavior.service.spec.ts
[22m[39mðŸ”§ Vitest setup: Starting MSW mock server...
âœ… Vitest teardown complete

 [32mâœ“[39m src/app.controller.spec.ts[2m > [22mAppController[2m > [22mroot[2m > [22mshould return "Hello World!"
[90mstdout[2m | src/app.controller.spec.ts[2m > [22m[2mAppController[2m > [22m[2mroot[2m > [22m[2mshould return "Hello World!"
[22m[39mðŸ§¹ Cleaning up after test...

[90mstdout[2m | src/app.controller.spec.ts
[22m[39mðŸ”§ Vitest setup: Starting MSW mock server...
âœ… Vitest teardown complete


[2m Test Files [22m [1m[31m30 failed[39m[22m[2m | [22m[1m[32m68 passed[39m[22m[90m (98)[39m
[2m      Tests [22m [1m[31m130 failed[39m[22m[2m | [22m[1m[32m1242 passed[39m[22m[2m | [22m[33m44 skipped[39m[90m (1416)[39m
[2m   Start at [22m 16:37:20
[2m   Duration [22m 107.41s[2m (transform 2.09s, setup 426ms, collect 7.70s, tests 97.34s, environment 0ms, prepare 150ms)[22m

â€‰ELIFECYCLEâ€‰ Test failed. See above for more details.
